{"timers": {"training_iteration": 1.6355364999981248, "restore_env_runners": 1.3290999049786478e-05, "training_step": 1.6354128750026575, "env_runner_sampling_timer": 0.604093665999244, "learner_update_timer": 1.0291517919977196, "synch_weights": 0.000981417004368268}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.902591863764962e-07, "un_batch_to_individual_items": 1.2149195404307518e-05, "normalize_and_clip_actions": 4.061183175756786e-05, "get_actions": 5.600176439692812e-05, "module_to_agent_unmapping": 1.6313687385273977e-06, "listify_data_for_vector_env": 5.5334801787963045e-06, "tensor_to_numpy": 2.5281791180125467e-05}}, "connector_pipeline_timer": 0.0001774012071570256}, "agent_episode_returns_mean": {"vehicle_3": -765.1916205774654, "vehicle_1": -820.5039518448443, "vehicle_0": -1063.9840097020972, "vehicle_2": -752.730958952145}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 4481.0, "vehicle_0": 5808.0, "vehicle_2": 4220.0, "vehicle_3": 4298.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 18807.0}, "num_episodes": 14.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2181406470967901e-05, "add_states_from_episodes_to_batch": 1.679270658777155e-06, "add_time_dim_to_batch_and_zero_pad": 2.6515654655306332e-06, "agent_to_module_mapping": 2.4569869745992063e-06, "numpy_to_tensor": 1.1190771840284252e-05, "batch_individual_items": 8.310188708272499e-06}}, "connector_pipeline_timer": 6.575657260139794e-05}, "episode_len_max": 237, "agent_steps": {"vehicle_3": 85.0681818181818, "vehicle_1": 87.93181818181819, "vehicle_0": 113.72727272727273, "vehicle_2": 83.45454545454545}, "episode_return_mean": -3402.410528245296, "sample": 0.13246891437193464, "num_agent_steps_sampled": {"vehicle_3": 1352.0, "vehicle_1": 1423.0, "vehicle_0": 1932.0, "vehicle_2": 1320.9999999999998}, "episode_return_max": -2791.667997956276, "env_to_module_sum_episodes_length_out": 63.034713079505174, "time_between_sampling": 0.00973206705452113, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 6000.0, "module_episode_returns_mean": {"shared_policy": -1460.63496110656}, "num_episodes_lifetime": 44.0, "env_step_timer": 0.00010161662808414013, "episode_len_min": 80, "weights_seq_no": 0.0, "rlmodule_inference_timer": 6.703017253908266e-05, "episode_return_min": -5251.9936658144, "num_module_steps_sampled": {"shared_policy": 6028.0}, "episode_len_mean": 116.70454545454545, "env_to_module_sum_episodes_length_in": 63.034713079505174, "episode_duration_sec_mean": 0.06429025854578702, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 2102.0072803611424}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 61824, "weights_seq_no": 1.0, "policy_loss": 0.08670715987682343, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.920642852783203, "num_module_steps_trained": 61824, "vf_explained_var": -0.0003960132598876953, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.015148419886827469, "entropy": 1.289945363998413, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 17097.46484375, "curr_entropy_coeff": 0.01, "total_loss": 9.997480392456055, "gradients_default_optimizer_global_norm": 0.2864740490913391, "num_module_steps_trained_lifetime_throughput": 73286.78916894677}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0025911660050041974, "add_observations_from_episodes_to_batch": 0.0003268329965067096, "add_states_from_episodes_to_batch": 3.7909994716756046e-06, "add_time_dim_to_batch_and_zero_pad": 1.654199877521023e-05, "batch_individual_items": 0.10899974999483675, "add_columns_from_episodes_to_train_batch": 0.04028745899995556, "numpy_to_tensor": 0.00012566600344143808, "add_one_ts_to_episodes_and_truncate": 0.004507332996581681, "general_advantage_estimation": 0.014256707996537443}}, "connector_pipeline_timer": 0.17133191699394956}, "num_module_steps_trained_lifetime": 61824, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 966000, "num_env_steps_trained": 966000, "num_module_steps_trained": 61824, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000, "learner_connector_sum_episodes_length_in": 2000, "num_env_steps_trained_lifetime_throughput": 1145091.4141132587, "num_module_steps_trained_throughput": 73286.47827705192, "num_module_steps_trained_lifetime_throughput": 73286.3839758772}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-42", "timestamp": 1750907262, "time_this_iter_s": 1.637413740158081, "time_total_s": 1.637413740158081, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795aaf20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.637413740158081, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.966666666666667, "ram_util_percent": 52.6}}
{"timers": {"training_iteration": 1.6345941358281562, "restore_env_runners": 1.3228919124230743e-05, "training_step": 1.6344700912526604, "env_runner_sampling_timer": 0.6043849739192229, "learner_update_timer": 1.0279205719977471, "synch_weights": 0.000980669084310648, "synch_env_connectors": 0.0008381250008824281}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.575531276961213e-07, "un_batch_to_individual_items": 1.1085569552870608e-05, "normalize_and_clip_actions": 3.280857922117488e-05, "get_actions": 3.541237616345254e-05, "module_to_agent_unmapping": 1.5978286455598267e-06, "listify_data_for_vector_env": 5.07307592502414e-06, "tensor_to_numpy": 1.613692548784501e-05}}, "connector_pipeline_timer": 0.00013377497540951707}, "agent_episode_returns_mean": {"vehicle_3": -641.6525286507607, "vehicle_1": -841.7019398140907, "vehicle_0": -985.8938154256343, "vehicle_2": -838.5493320059776}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 6004.0, "vehicle_0": 7340.0, "vehicle_2": 5750.0, "vehicle_3": 5451.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 24545.0}, "num_episodes": 15.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.1479060744888174e-05, "add_states_from_episodes_to_batch": 1.6249906567335582e-06, "add_time_dim_to_batch_and_zero_pad": 2.525695421459632e-06, "agent_to_module_mapping": 2.378465072264317e-06, "numpy_to_tensor": 9.540031481680334e-06, "batch_individual_items": 7.833949346728883e-06}}, "connector_pipeline_timer": 6.147461083306921e-05}, "episode_len_max": 297, "agent_steps": {"vehicle_3": 84.12, "vehicle_1": 100.3, "vehicle_0": 111.52000000000002, "vehicle_2": 100.9}, "episode_return_mean": -3307.7976111662388, "sample": 0.13121783290651587, "num_agent_steps_sampled": {"vehicle_3": 1153.0, "vehicle_1": 1523.0, "vehicle_0": 1532.0, "vehicle_2": 1530.0}, "episode_return_max": -2383.8851038217545, "env_to_module_sum_episodes_length_out": 81.63793309028736, "time_between_sampling": 0.020119027080954567, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 8000.0, "module_episode_returns_mean": {"shared_policy": -2099.007170846462}, "num_episodes_lifetime": 59.0, "env_step_timer": 0.00010665082192341957, "episode_len_min": 81, "weights_seq_no": 1.0, "rlmodule_inference_timer": 8.853763392607575e-05, "episode_return_min": -5920.167691111565, "num_module_steps_sampled": {"shared_policy": 5738.0}, "episode_len_mean": 134.98, "env_to_module_sum_episodes_length_in": 81.63793309028736, "episode_duration_sec_mean": 0.07035583755932748, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 2101.5600295308327}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 120576, "weights_seq_no": 2.0, "policy_loss": 0.13255052268505096, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.90125560760498, "num_module_steps_trained": 58752, "vf_explained_var": -0.006859898567199707, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.017756128683686256, "entropy": 1.2213835716247559, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 15236.7744140625, "curr_entropy_coeff": 0.01, "total_loss": 10.02514362335205, "gradients_default_optimizer_global_norm": 0.7635987401008606, "num_module_steps_trained_lifetime_throughput": 73227.33407573216}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0025894076749682425, "add_observations_from_episodes_to_batch": 0.00032619091653032225, "add_states_from_episodes_to_batch": 3.7764295120723547e-06, "add_time_dim_to_batch_and_zero_pad": 1.646991884626914e-05, "batch_individual_items": 0.10818741874492843, "add_columns_from_episodes_to_train_batch": 0.0402509848200134, "numpy_to_tensor": 0.00012522184340923558, "add_one_ts_to_episodes_and_truncate": 0.0045025296666426585, "general_advantage_estimation": 0.014240420086571249}}, "connector_pipeline_timer": 0.17045789324401994}, "num_module_steps_trained_lifetime": 120576, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 1884000, "num_env_steps_trained": 918000, "num_module_steps_trained": 58752, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1144159.3829296723, "num_module_steps_trained_throughput": 73226.93848716746, "num_module_steps_trained_lifetime_throughput": 73226.79360291518}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-43", "timestamp": 1750907263, "time_this_iter_s": 1.5431911945343018, "time_total_s": 3.180604934692383, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795a9e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.180604934692383, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 16.5, "ram_util_percent": 52.6}}
{"timers": {"training_iteration": 1.633981856139894, "restore_env_runners": 1.3143709962605498e-05, "training_step": 1.6338576282501125, "env_runner_sampling_timer": 0.6045896196000351, "learner_update_timer": 1.027106103357822, "synch_weights": 0.0009792640534833483, "synch_env_connectors": 0.0008384000008663861}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.256839517568518e-07, "un_batch_to_individual_items": 1.1572638976180283e-05, "normalize_and_clip_actions": 3.4716425353767085e-05, "get_actions": 3.43831298689619e-05, "module_to_agent_unmapping": 1.5545967996445828e-06, "listify_data_for_vector_env": 5.234353985764591e-06, "tensor_to_numpy": 1.5867410193066602e-05}}, "connector_pipeline_timer": 0.00013420147120986713}, "agent_episode_returns_mean": {"vehicle_3": -582.9822966766358, "vehicle_1": -870.35153390646, "vehicle_0": -855.6454490458965, "vehicle_2": -759.006321709156}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 7791.0, "vehicle_0": 8943.0, "vehicle_2": 7075.0, "vehicle_3": 6763.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 30572.0}, "num_episodes": 14.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.1736683426365131e-05, "add_states_from_episodes_to_batch": 1.6120997573047674e-06, "add_time_dim_to_batch_and_zero_pad": 2.502987875163611e-06, "agent_to_module_mapping": 2.4378204938035872e-06, "numpy_to_tensor": 9.237536608592698e-06, "batch_individual_items": 7.924692516906632e-06}}, "connector_pipeline_timer": 6.128029153031232e-05}, "episode_len_max": 297, "agent_steps": {"vehicle_3": 91.48, "vehicle_1": 119.36, "vehicle_0": 110.86000000000001, "vehicle_2": 101.24}, "episode_return_mean": -3067.9855937850475, "sample": 0.1303970129360947, "num_agent_steps_sampled": {"vehicle_3": 1312.0, "vehicle_1": 1787.0, "vehicle_0": 1603.0, "vehicle_2": 1325.0}, "episode_return_max": -2032.046174645424, "env_to_module_sum_episodes_length_out": 69.37546617583266, "time_between_sampling": 0.028951728831759428, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 10000.0, "module_episode_returns_mean": {"shared_policy": -1662.6781222558025}, "num_episodes_lifetime": 73.0, "env_step_timer": 0.00010673754622245411, "episode_len_min": 82, "weights_seq_no": 2.0, "rlmodule_inference_timer": 8.141163237264937e-05, "episode_return_min": -5920.167691111565, "num_module_steps_sampled": {"shared_policy": 6027.0}, "episode_len_mean": 140.35999999999999, "env_to_module_sum_episodes_length_in": 69.37546617583266, "episode_duration_sec_mean": 0.07749741758074379, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 2072.976084409003}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 182400, "weights_seq_no": 3.0, "policy_loss": 0.26233038306236267, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 10.0, "num_module_steps_trained": 61824, "vf_explained_var": -0.014742016792297363, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.01897718757390976, "entropy": 1.1930314302444458, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 11012.9560546875, "curr_entropy_coeff": 0.01, "total_loss": 10.254196166992188, "gradients_default_optimizer_global_norm": 0.28350311517715454, "num_module_steps_trained_lifetime_throughput": 73193.15172719033}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0025916419281595154, "add_observations_from_episodes_to_batch": 0.00032572984737635124, "add_states_from_episodes_to_batch": 3.764495230279863e-06, "add_time_dim_to_batch_and_zero_pad": 1.6416889672836988e-05, "batch_individual_items": 0.10740685788746195, "add_columns_from_episodes_to_train_batch": 0.040254309971796465, "numpy_to_tensor": 0.00012480920492744188, "add_one_ts_to_episodes_and_truncate": 0.004502036449968, "general_advantage_estimation": 0.014224694635726336}}, "connector_pipeline_timer": 0.16966469222159503}, "num_module_steps_trained_lifetime": 182400, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 2850000, "num_env_steps_trained": 966000, "num_module_steps_trained": 61824, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1143621.5898950172, "num_module_steps_trained_throughput": 73192.7506453136, "num_module_steps_trained_lifetime_throughput": 73192.36960204311}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-45", "timestamp": 1750907265, "time_this_iter_s": 1.5752308368682861, "time_total_s": 4.755835771560669, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795a99e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.755835771560669, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 15.3, "ram_util_percent": 52.650000000000006}}
{"timers": {"training_iteration": 1.6347389738284404, "restore_env_runners": 1.3061022797628537e-05, "training_step": 1.6346144619675766, "env_runner_sampling_timer": 0.6045791954840007, "learner_update_timer": 1.027873981904274, "synch_weights": 0.0009780260029704734, "synch_env_connectors": 0.0008387339208486081}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.248064529220895e-07, "un_batch_to_individual_items": 1.2784715341131685e-05, "normalize_and_clip_actions": 3.943270231586201e-05, "get_actions": 3.4479444711936784e-05, "module_to_agent_unmapping": 1.5662623792301363e-06, "listify_data_for_vector_env": 5.732776217419026e-06, "tensor_to_numpy": 1.6076978335700928e-05}}, "connector_pipeline_timer": 0.00014113179505295624}, "agent_episode_returns_mean": {"vehicle_3": -409.6415141952038, "vehicle_1": -576.0146250534058, "vehicle_0": -640.0889540410042, "vehicle_2": -499.9825030708313}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 9637.0, "vehicle_0": 10756.0, "vehicle_2": 8749.0, "vehicle_3": 8480.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 37621.99999999999}, "num_episodes": 21.000000000000004, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2359897120094444e-05, "add_states_from_episodes_to_batch": 1.6189376199192457e-06, "add_time_dim_to_batch_and_zero_pad": 2.496950066975114e-06, "agent_to_module_mapping": 2.5280548243902137e-06, "numpy_to_tensor": 9.202056038636396e-06, "batch_individual_items": 8.256411752945352e-06}}, "connector_pipeline_timer": 6.227319175323794e-05}, "episode_len_max": 223, "agent_steps": {"vehicle_3": 83.8, "vehicle_1": 96.6, "vehicle_0": 97.42, "vehicle_2": 80.98}, "episode_return_mean": -2125.727599030733, "sample": 0.12943368628346463, "num_agent_steps_sampled": {"vehicle_3": 1717.0, "vehicle_1": 1845.9999999999998, "vehicle_0": 1813.0, "vehicle_2": 1674.0000000000002}, "episode_return_max": -1448.9462344646454, "env_to_module_sum_episodes_length_out": 46.88016964822335, "time_between_sampling": 0.037401523166888696, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 12000.0, "module_episode_returns_mean": {"shared_policy": -992.4145699512959}, "num_episodes_lifetime": 94.0, "env_step_timer": 0.00010921416260001822, "episode_len_min": 74, "weights_seq_no": 3.0, "rlmodule_inference_timer": 6.0885212731175487e-05, "episode_return_min": -3862.265799164772, "num_module_steps_sampled": {"shared_policy": 7050.0}, "episode_len_mean": 104.22, "env_to_module_sum_episodes_length_in": 46.88016964822335, "episode_duration_sec_mean": 0.05551906836015404, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1990.1118083007298}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 254976, "weights_seq_no": 4.0, "policy_loss": -0.009055515751242638, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.845048904418945, "num_module_steps_trained": 72576, "vf_explained_var": 0.006641507148742676, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.00986798107624054, "entropy": 1.136168360710144, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 6256.25830078125, "curr_entropy_coeff": 0.01, "total_loss": 9.826604843139648, "gradients_default_optimizer_global_norm": 0.4185934066772461, "num_module_steps_trained_lifetime_throughput": 73175.610872324}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0025946180088547116, "add_observations_from_episodes_to_batch": 0.00032786462895906883, "add_states_from_episodes_to_batch": 3.7535102597903463e-06, "add_time_dim_to_batch_and_zero_pad": 1.6356890734030456e-05, "batch_individual_items": 0.10667333763864671, "add_columns_from_episodes_to_train_batch": 0.040312576872082624, "numpy_to_tensor": 0.00012439694287467136, "add_one_ts_to_episodes_and_truncate": 0.0045096523355069515, "general_advantage_estimation": 0.014229697689378153}}, "connector_pipeline_timer": 0.1690056323893379}, "num_module_steps_trained_lifetime": 254976, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 3984000, "num_env_steps_trained": 1134000, "num_module_steps_trained": 72576, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1143346.3438081022, "num_module_steps_trained_throughput": 73175.23351080029, "num_module_steps_trained_lifetime_throughput": 73174.84513401183}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-47", "timestamp": 1750907267, "time_this_iter_s": 1.7116892337799072, "time_total_s": 6.467525005340576, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795aab60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.467525005340576, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.966666666666665, "ram_util_percent": 52.76666666666667}}
{"timers": {"training_iteration": 1.6357426199201532, "restore_env_runners": 1.2991662599482512e-05, "training_step": 1.6356177465178907, "env_runner_sampling_timer": 0.6045451935292085, "learner_update_timer": 1.0289130108352451, "synch_weights": 0.0009763078229552657, "synch_env_connectors": 0.0008394136616674294}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.239141528190338e-07, "un_batch_to_individual_items": 1.297429115392191e-05, "normalize_and_clip_actions": 3.9294914310806245e-05, "get_actions": 3.400312371200781e-05, "module_to_agent_unmapping": 1.5715470007079289e-06, "listify_data_for_vector_env": 5.759394328553402e-06, "tensor_to_numpy": 1.603505598463572e-05}}, "connector_pipeline_timer": 0.000140489885100355}, "agent_episode_returns_mean": {"vehicle_3": -316.6447901248932, "vehicle_1": -457.2119126486778, "vehicle_0": -502.2114128398896, "vehicle_2": -488.45691725492475}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 11450.0, "vehicle_0": 12520.0, "vehicle_2": 10562.0, "vehicle_3": 10244.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 44775.99999999999}, "num_episodes": 21.000000000000004, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.235122674133096e-05, "add_states_from_episodes_to_batch": 1.6173333179336368e-06, "add_time_dim_to_batch_and_zero_pad": 2.473221026745412e-06, "agent_to_module_mapping": 2.5264521640396818e-06, "numpy_to_tensor": 9.177628601922536e-06, "batch_individual_items": 8.243438407750213e-06}}, "connector_pipeline_timer": 6.229190840539397e-05}, "episode_len_max": 137, "agent_steps": {"vehicle_3": 83.08, "vehicle_1": 88.26000000000002, "vehicle_0": 83.08, "vehicle_2": 88.26000000000002}, "episode_return_mean": -1764.5250220346454, "sample": 0.12861088407977486, "num_agent_steps_sampled": {"vehicle_3": 1764.0000000000002, "vehicle_1": 1813.0, "vehicle_0": 1764.0000000000002, "vehicle_2": 1813.0}, "episode_return_max": -1351.4484890699387, "env_to_module_sum_episodes_length_out": 48.07368632600701, "time_between_sampling": 0.04688262592842722, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 14000.0, "module_episode_returns_mean": {"shared_policy": -709.8057729291916}, "num_episodes_lifetime": 114.99999999999999, "env_step_timer": 0.00011174855976270517, "episode_len_min": 74, "weights_seq_no": 4.0, "rlmodule_inference_timer": 6.242916165415261e-05, "episode_return_min": -2496.347525000572, "num_module_steps_sampled": {"shared_policy": 7153.999999999999}, "episode_len_mean": 93.92, "env_to_module_sum_episodes_length_in": 48.07368632600701, "episode_duration_sec_mean": 0.050750072319060556, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1952.2524387190952}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 328576, "weights_seq_no": 5.0, "policy_loss": -0.05117597430944443, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.862638473510742, "num_module_steps_trained": 73600, "vf_explained_var": 0.013841688632965088, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.016000129282474518, "entropy": 1.0957103967666626, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 5047.4111328125, "curr_entropy_coeff": 0.01, "total_loss": 9.803704261779785, "gradients_default_optimizer_global_norm": 0.34917494654655457, "num_module_steps_trained_lifetime_throughput": 73156.88541649017}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0025989351588114372, "add_observations_from_episodes_to_batch": 0.00032830848271095457, "add_states_from_episodes_to_batch": 3.7393051514844415e-06, "add_time_dim_to_batch_and_zero_pad": 1.6289991873022443e-05, "batch_individual_items": 0.10595875759221018, "add_columns_from_episodes_to_train_batch": 0.04038090360342177, "numpy_to_tensor": 0.0001240671434597817, "add_one_ts_to_episodes_and_truncate": 0.004518966232131712, "general_advantage_estimation": 0.014244993212520488}}, "connector_pipeline_timer": 0.1683874748153867}, "num_module_steps_trained_lifetime": 328576, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 5134000, "num_env_steps_trained": 1150000, "num_module_steps_trained": 73600, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1143054.4418949098, "num_module_steps_trained_throughput": 73156.53399299788, "num_module_steps_trained_lifetime_throughput": 73156.1594737947}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-48", "timestamp": 1750907268, "time_this_iter_s": 1.7372939586639404, "time_total_s": 8.204818964004517, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff45da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.204818964004517, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.6, "ram_util_percent": 53.05}}
{"timers": {"training_iteration": 1.6376334320509311, "restore_env_runners": 1.2911745917654899e-05, "training_step": 1.6375084007127108, "env_runner_sampling_timer": 0.6045557857639529, "learner_update_timer": 1.0307928153068604, "synch_weights": 0.0009749480747193111, "synch_env_connectors": 0.000843150775019416}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.358743144393218e-07, "un_batch_to_individual_items": 1.2727284791680918e-05, "normalize_and_clip_actions": 3.8786839130675865e-05, "get_actions": 3.403979824436057e-05, "module_to_agent_unmapping": 1.5722037935526196e-06, "listify_data_for_vector_env": 5.669258528589036e-06, "tensor_to_numpy": 1.6051811330519193e-05}}, "connector_pipeline_timer": 0.0001397624317641859}, "agent_episode_returns_mean": {"vehicle_3": -149.42245547294615, "vehicle_1": -379.2506388282776, "vehicle_0": -382.2514027476311, "vehicle_2": -368.39444373369224}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 13308.999999999996, "vehicle_0": 14223.999999999998, "vehicle_2": 12385.999999999998, "vehicle_3": 11947.999999999998}, "num_module_steps_sampled_lifetime": {"shared_policy": 51867.00000000001}, "num_episodes": 23.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.21369099322736e-05, "add_states_from_episodes_to_batch": 1.6119705896420852e-06, "add_time_dim_to_batch_and_zero_pad": 2.4657224834157592e-06, "agent_to_module_mapping": 2.4756039606339796e-06, "numpy_to_tensor": 9.202288751819999e-06, "batch_individual_items": 8.15546329156347e-06}}, "connector_pipeline_timer": 6.181826637896176e-05}, "episode_len_max": 216, "agent_steps": {"vehicle_3": 78.18, "vehicle_1": 81.07999999999998, "vehicle_0": 78.18, "vehicle_2": 80.38}, "episode_return_mean": -1279.3189425563812, "sample": 0.1278485422308017, "num_agent_steps_sampled": {"vehicle_3": 1704.0000000000002, "vehicle_1": 1859.0000000000002, "vehicle_0": 1704.0000000000002, "vehicle_2": 1824.0000000000002}, "episode_return_max": -886.1383699178696, "env_to_module_sum_episodes_length_out": 49.116414780075246, "time_between_sampling": 0.05617898401299577, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 16000.0, "module_episode_returns_mean": {"shared_policy": -462.82581322431565}, "num_episodes_lifetime": 137.99999999999997, "env_step_timer": 0.00010792162977160932, "episode_len_min": 64, "weights_seq_no": 5.0, "rlmodule_inference_timer": 6.16956235289003e-05, "episode_return_min": -2496.347525000572, "num_module_steps_sampled": {"shared_policy": 7091.000000000001}, "episode_len_mean": 87.92, "env_to_module_sum_episodes_length_in": 49.116414780075246, "episode_duration_sec_mean": 0.0473677868595405, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1954.1010990418742}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 401664, "weights_seq_no": 6.0, "policy_loss": -0.04279559850692749, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.755980491638184, "num_module_steps_trained": 73088, "vf_explained_var": 0.0012366175651550293, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.017272302880883217, "entropy": 0.9873921871185303, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 3310.065185546875, "curr_entropy_coeff": 0.01, "total_loss": 9.706764221191406, "gradients_default_optimizer_global_norm": 0.772581160068512, "num_module_steps_trained_lifetime_throughput": 73049.69416929198}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026044703872681115, "add_observations_from_episodes_to_batch": 0.0003288466479496569, "add_states_from_episodes_to_batch": 3.72858204984481e-06, "add_time_dim_to_batch_and_zero_pad": 1.625376201078058e-05, "batch_individual_items": 0.10604411084634219, "add_columns_from_episodes_to_train_batch": 0.04045394456736483, "numpy_to_tensor": 0.00012389563201431272, "add_one_ts_to_episodes_and_truncate": 0.00452881322978861, "general_advantage_estimation": 0.01425641286034889}}, "connector_pipeline_timer": 0.16857211381724707}, "num_module_steps_trained_lifetime": 401664, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 6276000, "num_env_steps_trained": 1142000, "num_module_steps_trained": 73088, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1141380.6510925398, "num_module_steps_trained_throughput": 73049.36898521509, "num_module_steps_trained_lifetime_throughput": 73049.03212729128}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-50", "timestamp": 1750907270, "time_this_iter_s": 1.827054738998413, "time_total_s": 10.03187370300293, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff1c540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.03187370300293, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.166666666666668, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.639038018980436, "restore_env_runners": 1.2831798434160512e-05, "training_step": 1.638912818785595, "env_runner_sampling_timer": 0.6045207858263305, "learner_update_timer": 1.0322333059037858, "synch_weights": 0.0009724881739979446, "synch_env_connectors": 0.0008470992673129987}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.273962245588193e-07, "un_batch_to_individual_items": 1.3239575663796772e-05, "normalize_and_clip_actions": 4.070878523692599e-05, "get_actions": 3.374758547923267e-05, "module_to_agent_unmapping": 1.5795787420569164e-06, "listify_data_for_vector_env": 5.888955731684842e-06, "tensor_to_numpy": 1.5984924800819672e-05}}, "connector_pipeline_timer": 0.00014234700891479387}, "agent_episode_returns_mean": {"vehicle_3": -17.745385382175446, "vehicle_1": -268.9380717349053, "vehicle_0": -274.95904020786287, "vehicle_2": -300.0502581214905}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 15190.0, "vehicle_0": 16015.000000000002, "vehicle_2": 14267.0, "vehicle_3": 13739.000000000002}, "num_module_steps_sampled_lifetime": {"shared_policy": 59211.000000000015}, "num_episodes": 25.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2573333447682356e-05, "add_states_from_episodes_to_batch": 1.6330403132637e-06, "add_time_dim_to_batch_and_zero_pad": 2.4992143538723957e-06, "agent_to_module_mapping": 2.5398133790118425e-06, "numpy_to_tensor": 9.285010994809372e-06, "batch_individual_items": 8.352704605987194e-06}}, "connector_pipeline_timer": 6.292482226256939e-05}, "episode_len_max": 216, "agent_steps": {"vehicle_3": 71.66000000000001, "vehicle_1": 78.32, "vehicle_0": 71.66000000000001, "vehicle_2": 77.62}, "episode_return_mean": -861.6927571630478, "sample": 0.12710661758101308, "num_agent_steps_sampled": {"vehicle_3": 1790.9999999999998, "vehicle_1": 1880.9999999999998, "vehicle_0": 1790.9999999999998, "vehicle_2": 1880.9999999999998}, "episode_return_max": -498.21404933929443, "env_to_module_sum_episodes_length_out": 36.65222513886338, "time_between_sampling": 0.0658850542963443, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 18000.0, "module_episode_returns_mean": {"shared_policy": -256.95353868484494}, "num_episodes_lifetime": 162.99999999999997, "env_step_timer": 0.0001087427941259477, "episode_len_min": 64, "weights_seq_no": 6.0, "rlmodule_inference_timer": 6.303342776445083e-05, "episode_return_min": -2302.7684687376022, "num_module_steps_sampled": {"shared_policy": 7343.999999999999}, "episode_len_mean": 82.02, "env_to_module_sum_episodes_length_in": 36.65222513886338, "episode_duration_sec_mean": 0.04407170825987123, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1896.8653163704782}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 477568, "weights_seq_no": 7.0, "policy_loss": -0.1733839511871338, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.389785766601562, "num_module_steps_trained": 75904, "vf_explained_var": 0.0417022705078125, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.012155300006270409, "entropy": 0.946345865726471, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1687.456298828125, "curr_entropy_coeff": 0.01, "total_loss": 9.209368705749512, "gradients_default_optimizer_global_norm": 1.265810251235962, "num_module_steps_trained_lifetime_throughput": 72996.2463046559}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026094881833792485, "add_observations_from_episodes_to_batch": 0.0003306727615236472, "add_states_from_episodes_to_batch": 3.720876271228944e-06, "add_time_dim_to_batch_and_zero_pad": 1.61970643991458e-05, "batch_individual_items": 0.10535897890785514, "add_columns_from_episodes_to_train_batch": 0.04053677429169615, "numpy_to_tensor": 0.00012350001564308456, "add_one_ts_to_episodes_and_truncate": 0.004542590097513834, "general_advantage_estimation": 0.01426879498171331}}, "connector_pipeline_timer": 0.16800164226907693}, "num_module_steps_trained_lifetime": 477568, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 7462000, "num_env_steps_trained": 1186000, "num_module_steps_trained": 75904, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1140545.0133957202, "num_module_steps_trained_throughput": 72995.90724125605, "num_module_steps_trained_lifetime_throughput": 72995.56005551982}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-52", "timestamp": 1750907272, "time_this_iter_s": 1.7800958156585693, "time_total_s": 11.811969518661499, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff46520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.811969518661499, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.5, "ram_util_percent": 53.3}}
{"timers": {"training_iteration": 1.639631915870605, "restore_env_runners": 1.2745150441151945e-05, "training_step": 1.639506602267723, "env_runner_sampling_timer": 0.6043871558880455, "learner_update_timer": 1.0329618390947548, "synch_weights": 0.0009702849622349605, "synch_env_connectors": 0.0008487503546241536}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.228942500380743e-07, "un_batch_to_individual_items": 1.2860088189870341e-05, "normalize_and_clip_actions": 3.896990391221143e-05, "get_actions": 3.360192340123039e-05, "module_to_agent_unmapping": 1.585755523174933e-06, "listify_data_for_vector_env": 5.68361655630782e-06, "tensor_to_numpy": 1.5808692990779322e-05}}, "connector_pipeline_timer": 0.000139384828247931}, "agent_episode_returns_mean": {"vehicle_3": 41.436984174251556, "vehicle_1": -221.0519866538048, "vehicle_0": -261.55325859785074, "vehicle_2": -283.4450189781189}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 17108.0, "vehicle_0": 17544.999999999996, "vehicle_2": 16177.0, "vehicle_3": 15268.999999999996}, "num_module_steps_sampled_lifetime": {"shared_policy": 66098.99999999999}, "num_episodes": 21.000000000000004, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2366817527259939e-05, "add_states_from_episodes_to_batch": 1.611391933185333e-06, "add_time_dim_to_batch_and_zero_pad": 2.4982892893507588e-06, "agent_to_module_mapping": 2.5419318850241935e-06, "numpy_to_tensor": 9.09006276870834e-06, "batch_individual_items": 8.197643253631851e-06}}, "connector_pipeline_timer": 6.222380853155334e-05}, "episode_len_max": 189, "agent_steps": {"vehicle_3": 70.56, "vehicle_1": 89.18, "vehicle_0": 70.56, "vehicle_2": 88.7}, "episode_return_mean": -724.6132800173759, "sample": 0.12632431384684656, "num_agent_steps_sampled": {"vehicle_3": 1530.0, "vehicle_1": 1918.0, "vehicle_0": 1530.0, "vehicle_2": 1910.0}, "episode_return_max": -444.3011897802353, "env_to_module_sum_episodes_length_out": 45.30104394156645, "time_between_sampling": 0.07466989840721885, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 20000.0, "module_episode_returns_mean": {"shared_policy": -117.01306549310686}, "num_episodes_lifetime": 184.00000000000003, "env_step_timer": 0.00010741765610821407, "episode_len_min": 70, "weights_seq_no": 7.0, "rlmodule_inference_timer": 6.174846159886242e-05, "episode_return_min": -996.8068820238113, "num_module_steps_sampled": {"shared_policy": 6888.0}, "episode_len_mean": 91.86000000000004, "env_to_module_sum_episodes_length_in": 45.30104394156645, "episode_duration_sec_mean": 0.048441165719705165, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1884.1663501925573}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 548608, "weights_seq_no": 8.0, "policy_loss": -0.06285594403743744, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.345117568969727, "num_module_steps_trained": 71040, "vf_explained_var": 0.04270613193511963, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.01922309398651123, "entropy": 0.8658643364906311, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1491.30859375, "curr_entropy_coeff": 0.01, "total_loss": 9.277447700500488, "gradients_default_optimizer_global_norm": 0.7001029849052429, "num_module_steps_trained_lifetime_throughput": 72958.016857521}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026125395515626763, "add_observations_from_episodes_to_batch": 0.0003313947838807598, "add_states_from_episodes_to_batch": 3.7074174710821434e-06, "add_time_dim_to_batch_and_zero_pad": 1.6131343760453566e-05, "batch_individual_items": 0.10464612994877383, "add_columns_from_episodes_to_train_batch": 0.04059893487882494, "numpy_to_tensor": 0.00012302751547193881, "add_one_ts_to_episodes_and_truncate": 0.004550547116552669, "general_advantage_estimation": 0.014276466191857401}}, "connector_pipeline_timer": 0.16736864709643748}, "num_module_steps_trained_lifetime": 548608, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 8572000, "num_env_steps_trained": 1110000, "num_module_steps_trained": 71040, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1139948.9123665164, "num_module_steps_trained_throughput": 72957.78007749663, "num_module_steps_trained_lifetime_throughput": 72957.43345867508}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-54", "timestamp": 1750907274, "time_this_iter_s": 1.7006330490112305, "time_total_s": 13.51260256767273, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795a9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.51260256767273, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.366666666666667, "ram_util_percent": 53.29999999999999}}
{"timers": {"training_iteration": 1.640021843381916, "restore_env_runners": 1.2668528922152263e-05, "training_step": 1.6398962787449947, "env_runner_sampling_timer": 0.6042848005791878, "learner_update_timer": 1.0334548857038215, "synch_weights": 0.0009686171126042616, "synch_env_connectors": 0.0008506732611098212}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.200499787730908e-07, "un_batch_to_individual_items": 1.2682346702074339e-05, "normalize_and_clip_actions": 3.873133481799308e-05, "get_actions": 3.486071499841358e-05, "module_to_agent_unmapping": 1.5764952203065955e-06, "listify_data_for_vector_env": 5.675193820726793e-06, "tensor_to_numpy": 1.6054897666157626e-05}}, "connector_pipeline_timer": 0.00014039019743579683}, "agent_episode_returns_mean": {"vehicle_3": 95.23780744314196, "vehicle_1": -197.347876060009, "vehicle_0": -192.1284622716904, "vehicle_2": -205.83773271560665}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 18968.000000000004, "vehicle_0": 19105.0, "vehicle_2": 18003.0, "vehicle_3": 16834.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 72910.0}, "num_episodes": 21.000000000000004, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2280587935676089e-05, "add_states_from_episodes_to_batch": 1.604625957101751e-06, "add_time_dim_to_batch_and_zero_pad": 2.5069796767768654e-06, "agent_to_module_mapping": 2.4887038699693995e-06, "numpy_to_tensor": 9.258530721939586e-06, "batch_individual_items": 8.226596753162233e-06}}, "connector_pipeline_timer": 6.215398787765319e-05}, "episode_len_max": 189, "agent_steps": {"vehicle_3": 75.06, "vehicle_1": 87.85999999999999, "vehicle_0": 74.96, "vehicle_2": 87.18}, "episode_return_mean": -500.07626200199127, "sample": 0.12556333857675478, "num_agent_steps_sampled": {"vehicle_3": 1565.0, "vehicle_1": 1860.0, "vehicle_0": 1560.0, "vehicle_2": 1825.9999999999998}, "episode_return_max": -201.79795861244202, "env_to_module_sum_episodes_length_out": 43.52708208875439, "time_between_sampling": 0.08234287707814042, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 22000.0, "module_episode_returns_mean": {"shared_policy": -102.14688454389572}, "num_episodes_lifetime": 205.0, "env_step_timer": 0.00010582722474891768, "episode_len_min": 70, "weights_seq_no": 8.0, "rlmodule_inference_timer": 6.18934802954769e-05, "episode_return_min": -978.0137264728546, "num_module_steps_sampled": {"shared_policy": 6811.000000000001}, "episode_len_mean": 92.56000000000002, "env_to_module_sum_episodes_length_in": 43.52708208875439, "episode_duration_sec_mean": 0.04924110745996586, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1882.2108567093128}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 618752, "weights_seq_no": 9.0, "policy_loss": -0.058454036712646484, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.446120262145996, "num_module_steps_trained": 70144, "vf_explained_var": 0.07943719625473022, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.018569091334939003, "entropy": 0.8191321492195129, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1286.943603515625, "curr_entropy_coeff": 0.01, "total_loss": 9.383187294006348, "gradients_default_optimizer_global_norm": 0.7340160012245178, "num_module_steps_trained_lifetime_throughput": 72850.89047527881}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002615152486048992, "add_observations_from_episodes_to_batch": 0.00033200583602465284, "add_states_from_episodes_to_batch": 3.692423281145204e-06, "add_time_dim_to_batch_and_zero_pad": 1.6071280366220724e-05, "batch_individual_items": 0.10394310030928935, "add_columns_from_episodes_to_train_batch": 0.04064792053006635, "numpy_to_tensor": 0.0001227080703027337, "add_one_ts_to_episodes_and_truncate": 0.00455914873542341, "general_advantage_estimation": 0.014278135279967666}}, "connector_pipeline_timer": 0.16672672146545134}, "num_module_steps_trained_lifetime": 618752, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 9668000, "num_env_steps_trained": 1096000, "num_module_steps_trained": 70144, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1138263.8178216675, "num_module_steps_trained_throughput": 72850.49740857151, "num_module_steps_trained_lifetime_throughput": 72849.98400698579}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-55", "timestamp": 1750907275, "time_this_iter_s": 1.6807889938354492, "time_total_s": 15.193391561508179, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795aaac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.193391561508179, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.7, "ram_util_percent": 53.3}}
{"timers": {"training_iteration": 1.6407680832880907, "restore_env_runners": 1.2586843611785061e-05, "training_step": 1.6406423851275458, "env_runner_sampling_timer": 0.6041133834034073, "learner_update_timer": 1.034373018096827, "synch_weights": 0.0009677642814399303, "synch_env_connectors": 0.0008540131984483141}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.400631772458051e-07, "un_batch_to_individual_items": 1.2280014757355808e-05, "normalize_and_clip_actions": 3.737486489085032e-05, "get_actions": 3.5268798036308485e-05, "module_to_agent_unmapping": 1.5976454868467488e-06, "listify_data_for_vector_env": 5.50773545637713e-06, "tensor_to_numpy": 1.6279502795816742e-05}}, "connector_pipeline_timer": 0.00013970344026466368}, "agent_episode_returns_mean": {"vehicle_3": 167.4310273432732, "vehicle_1": -108.42596149206162, "vehicle_0": -169.90280511140824, "vehicle_2": -104.62350026845932}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 20871.000000000004, "vehicle_0": 20453.999999999996, "vehicle_2": 19899.999999999993, "vehicle_3": 18182.999999999996}, "num_module_steps_sampled_lifetime": {"shared_policy": 79408.0}, "num_episodes": 18.999999999999996, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.212134474025044e-05, "add_states_from_episodes_to_batch": 1.6519857099049056e-06, "add_time_dim_to_batch_and_zero_pad": 2.5163776268575303e-06, "agent_to_module_mapping": 2.493066539328157e-06, "numpy_to_tensor": 9.494314726579499e-06, "batch_individual_items": 8.202701215463916e-06}}, "connector_pipeline_timer": 6.266010732379074e-05}, "episode_len_max": 190, "agent_steps": {"vehicle_3": 75.01999999999998, "vehicle_1": 102.56, "vehicle_0": 74.91999999999999, "vehicle_2": 100.96}, "episode_return_mean": -215.52124227523802, "sample": 0.12482165319462049, "num_agent_steps_sampled": {"vehicle_3": 1349.0000000000002, "vehicle_1": 1903.0, "vehicle_0": 1349.0000000000002, "vehicle_2": 1897.0}, "episode_return_max": 35.66057801246643, "env_to_module_sum_episodes_length_out": 50.18296374782175, "time_between_sampling": 0.089430159585399, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 24000.0, "module_episode_returns_mean": {"shared_policy": -8.158218700885776}, "num_episodes_lifetime": 224.00000000000006, "env_step_timer": 0.00010578972980569212, "episode_len_min": 65, "weights_seq_no": 9.0, "rlmodule_inference_timer": 6.1020733363462726e-05, "episode_return_min": -586.0960339307785, "num_module_steps_sampled": {"shared_policy": 6498.0}, "episode_len_mean": 107.94, "env_to_module_sum_episodes_length_in": 50.18296374782175, "episode_duration_sec_mean": 0.056941054058552265, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1896.908146682229}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 685696, "weights_seq_no": 10.0, "policy_loss": -0.02498873695731163, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.525810241699219, "num_module_steps_trained": 66944, "vf_explained_var": 0.134069561958313, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.016505872830748558, "entropy": 0.7855591177940369, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1115.673583984375, "curr_entropy_coeff": 0.01, "total_loss": 9.496267318725586, "gradients_default_optimizer_global_norm": 1.2615704536437988, "num_module_steps_trained_lifetime_throughput": 72767.49132389062}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002617651791251773, "add_observations_from_episodes_to_batch": 0.00033201077766226427, "add_states_from_episodes_to_batch": 3.6800790521438672e-06, "add_time_dim_to_batch_and_zero_pad": 1.6004737517095e-05, "batch_individual_items": 0.10401514597617213, "add_columns_from_episodes_to_train_batch": 0.04067653673475935, "numpy_to_tensor": 0.00012242098962689168, "add_one_ts_to_episodes_and_truncate": 0.004563203078073186, "general_advantage_estimation": 0.014278463927157965}}, "connector_pipeline_timer": 0.1668328734207824}, "num_module_steps_trained_lifetime": 685696, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 10714000, "num_env_steps_trained": 1046000, "num_module_steps_trained": 66944, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1136967.5810716308, "num_module_steps_trained_throughput": 72767.29032717727, "num_module_steps_trained_lifetime_throughput": 72766.79184543286}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-57", "timestamp": 1750907277, "time_this_iter_s": 1.7164678573608398, "time_total_s": 16.90985941886902, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795a9da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.90985941886902, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.566666666666665, "ram_util_percent": 53.29999999999999}}
{"timers": {"training_iteration": 1.6409012712052262, "restore_env_runners": 1.2546395209096028e-05, "training_step": 1.640774923776251, "env_runner_sampling_timer": 0.6040096224793484, "learner_update_timer": 1.0346099091659051, "synch_weights": 0.0009671145586486034, "synch_env_connectors": 0.0008536559764874374}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.240605344004874e-07, "un_batch_to_individual_items": 1.2449743987511957e-05, "normalize_and_clip_actions": 3.7696470108240794e-05, "get_actions": 3.469769521431342e-05, "module_to_agent_unmapping": 1.5757510480019076e-06, "listify_data_for_vector_env": 5.527932140761664e-06, "tensor_to_numpy": 1.6089308789335815e-05}}, "connector_pipeline_timer": 0.0001387989786121227}, "agent_episode_returns_mean": {"vehicle_3": 251.4521533823013, "vehicle_1": -23.676408398151402, "vehicle_0": -122.87253202438355, "vehicle_2": -64.41271352767944}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 22735.000000000004, "vehicle_0": 21949.999999999996, "vehicle_2": 21635.000000000004, "vehicle_3": 19669.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 85988.99999999999}, "num_episodes": 18.999999999999996, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2250659854117247e-05, "add_states_from_episodes_to_batch": 1.6247896034260383e-06, "add_time_dim_to_batch_and_zero_pad": 2.5217306963154934e-06, "agent_to_module_mapping": 2.513901500997951e-06, "numpy_to_tensor": 9.330456132602897e-06, "batch_individual_items": 8.205077351709346e-06}}, "connector_pipeline_timer": 6.252024518512834e-05}, "episode_len_max": 236, "agent_steps": {"vehicle_3": 77.8, "vehicle_1": 98.60000000000002, "vehicle_0": 78.24, "vehicle_2": 91.36}, "episode_return_mean": 40.49049950838089, "sample": 0.1240813514748457, "num_agent_steps_sampled": {"vehicle_3": 1485.9999999999998, "vehicle_1": 1864.0000000000002, "vehicle_0": 1495.9999999999998, "vehicle_2": 1735.0}, "episode_return_max": 365.8693583011627, "env_to_module_sum_episodes_length_out": 48.684735827525, "time_between_sampling": 0.09679574904415637, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 26000.0, "module_episode_returns_mean": {"shared_policy": 129.14028248071673}, "num_episodes_lifetime": 243.00000000000006, "env_step_timer": 0.00010348993707165082, "episode_len_min": 65, "weights_seq_no": 10.0, "rlmodule_inference_timer": 6.188598139091682e-05, "episode_return_min": -370.40568125247955, "num_module_steps_sampled": {"shared_policy": 6581.000000000001}, "episode_len_mean": 103.92, "env_to_module_sum_episodes_length_in": 48.684735827525, "episode_duration_sec_mean": 0.05439364911799203, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1905.2773630382826}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 753280, "weights_seq_no": 11.0, "policy_loss": -0.06852109730243683, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.332062721252441, "num_module_steps_trained": 67584, "vf_explained_var": 0.2536275386810303, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.01272397581487894, "entropy": 0.7172868847846985, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1199.509521484375, "curr_entropy_coeff": 0.01, "total_loss": 9.258913040161133, "gradients_default_optimizer_global_norm": 2.636664628982544, "num_module_steps_trained_lifetime_throughput": 72659.03343236439}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002620047353312201, "add_observations_from_episodes_to_batch": 0.00033182316987290114, "add_states_from_episodes_to_batch": 3.6703683252902844e-06, "add_time_dim_to_batch_and_zero_pad": 1.593969013770516e-05, "batch_individual_items": 0.10330929910640688, "add_columns_from_episodes_to_train_batch": 0.040690598027386164, "numpy_to_tensor": 0.00012210302971909763, "add_one_ts_to_episodes_and_truncate": 0.0045635472972592244, "general_advantage_estimation": 0.01427603303791643}}, "connector_pipeline_timer": 0.16613972426655663}, "num_module_steps_trained_lifetime": 753280, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 11770000, "num_env_steps_trained": 1056000, "num_module_steps_trained": 67584, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1135267.1603813807, "num_module_steps_trained_throughput": 72658.53015345384, "num_module_steps_trained_lifetime_throughput": 72657.88004921826}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "b650b_00000", "date": "2025-06-25_20-07-59", "timestamp": 1750907279, "time_this_iter_s": 1.656182050704956, "time_total_s": 18.566041469573975, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795aac00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.566041469573975, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.299999999999997, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6407013259931231, "restore_env_runners": 1.2468431254895623e-05, "training_step": 1.6405744816284962, "env_runner_sampling_timer": 0.6038145054245517, "learner_update_timer": 1.0346024142343067, "synch_weights": 0.0009663046630151601, "synch_env_connectors": 0.0008563427467249575}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.343772140174771e-07, "un_batch_to_individual_items": 1.2076747865551997e-05, "normalize_and_clip_actions": 3.68628869432687e-05, "get_actions": 3.43880949207439e-05, "module_to_agent_unmapping": 1.563862186731998e-06, "listify_data_for_vector_env": 5.423478865248667e-06, "tensor_to_numpy": 1.5934807601988075e-05}}, "connector_pipeline_timer": 0.00013721811728962835}, "agent_episode_returns_mean": {"vehicle_3": 305.3430855178833, "vehicle_1": 11.849160547256469, "vehicle_0": -16.733965783119203, "vehicle_2": -66.79570203065872}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 24547.999999999996, "vehicle_0": 23444.000000000004, "vehicle_2": 23244.999999999993, "vehicle_3": 21186.000000000004}, "num_module_steps_sampled_lifetime": {"shared_policy": 92422.99999999997}, "num_episodes": 18.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2068885345690944e-05, "add_states_from_episodes_to_batch": 1.6188745043650734e-06, "add_time_dim_to_batch_and_zero_pad": 2.525443318059354e-06, "agent_to_module_mapping": 2.517279006374948e-06, "numpy_to_tensor": 9.29499824958274e-06, "batch_individual_items": 8.16415714114809e-06}}, "connector_pipeline_timer": 6.226749244916596e-05}, "episode_len_max": 204, "agent_steps": {"vehicle_3": 87.47999999999998, "vehicle_1": 97.36000000000004, "vehicle_0": 86.48, "vehicle_2": 87.98}, "episode_return_mean": 233.66257707834248, "sample": 0.1232589082964282, "num_agent_steps_sampled": {"vehicle_3": 1517.0, "vehicle_1": 1813.0, "vehicle_0": 1494.0000000000002, "vehicle_2": 1610.0}, "episode_return_max": 754.5011076927185, "env_to_module_sum_episodes_length_out": 54.652503458529075, "time_between_sampling": 0.1030395045816734, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 28000.0, "module_episode_returns_mean": {"shared_policy": 240.502010679245}, "num_episodes_lifetime": 261.0000000000001, "env_step_timer": 9.783711268651083e-05, "episode_len_min": 70, "weights_seq_no": 11.0, "rlmodule_inference_timer": 5.910813416505436e-05, "episode_return_min": -50.58256769180298, "num_module_steps_sampled": {"shared_policy": 6433.999999999999}, "episode_len_mean": 107.66, "env_to_module_sum_episodes_length_in": 54.652503458529075, "episode_duration_sec_mean": 0.05546931499906349, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1937.5391855209527}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 819328, "weights_seq_no": 12.0, "policy_loss": 0.017928848043084145, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.58530330657959, "num_module_steps_trained": 66048, "vf_explained_var": 0.2092854380607605, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.00837191753089428, "entropy": 0.6659115552902222, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1204.7779541015625, "curr_entropy_coeff": 0.01, "total_loss": 9.598247528076172, "gradients_default_optimizer_global_norm": 3.8907432556152344, "num_module_steps_trained_lifetime_throughput": 72571.08398936674}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026222227097856318, "add_observations_from_episodes_to_batch": 0.0003317078581534026, "add_states_from_episodes_to_batch": 3.6594946553656134e-06, "add_time_dim_to_batch_and_zero_pad": 1.5877793251145448e-05, "batch_individual_items": 0.10260107445537348, "add_columns_from_episodes_to_train_batch": 0.04072163121711815, "numpy_to_tensor": 0.00012185782946580555, "add_one_ts_to_episodes_and_truncate": 0.004565595574303946, "general_advantage_estimation": 0.014275006047524961}}, "connector_pipeline_timer": 0.1654644011838461}, "num_module_steps_trained_lifetime": 819328, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 12802000, "num_env_steps_trained": 1032000, "num_module_steps_trained": 66048, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1133876.1111753557, "num_module_steps_trained_throughput": 72570.42551681507, "num_module_steps_trained_lifetime_throughput": 72569.28796486727}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-01", "timestamp": 1750907281, "time_this_iter_s": 1.6231260299682617, "time_total_s": 20.189167499542236, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff1cd60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.189167499542236, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.75, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6413023527331925, "restore_env_runners": 1.2393326918240388e-05, "training_step": 1.6411753738921873, "env_runner_sampling_timer": 0.6035965716202628, "learner_update_timer": 1.035422443432021, "synch_weights": 0.0009650041163965802, "synch_env_connectors": 0.0008589176592357687}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.293081408676017e-07, "un_batch_to_individual_items": 1.2592783176876726e-05, "normalize_and_clip_actions": 3.8200376317539074e-05, "get_actions": 3.421377047379167e-05, "module_to_agent_unmapping": 1.5743902431978724e-06, "listify_data_for_vector_env": 5.613680254583043e-06, "tensor_to_numpy": 1.6080757722098934e-05}}, "connector_pipeline_timer": 0.0001395531427848975}, "agent_episode_returns_mean": {"vehicle_3": 376.37058786153796, "vehicle_1": 29.543111678361893, "vehicle_0": 67.12777065515519, "vehicle_2": -0.5987749505043035}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 26241.0, "vehicle_0": 25050.000000000007, "vehicle_2": 24789.999999999993, "vehicle_3": 22849.999999999996}, "num_module_steps_sampled_lifetime": {"shared_policy": 98931.00000000001}, "num_episodes": 17.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2411924657827149e-05, "add_states_from_episodes_to_batch": 1.658154550895847e-06, "add_time_dim_to_batch_and_zero_pad": 2.537831987293613e-06, "agent_to_module_mapping": 2.513220237889234e-06, "numpy_to_tensor": 9.299595793583436e-06, "batch_individual_items": 8.280989299996184e-06}}, "connector_pipeline_timer": 6.296554192998136e-05}, "episode_len_max": 218, "agent_steps": {"vehicle_3": 93.12, "vehicle_1": 96.12, "vehicle_0": 89.98, "vehicle_2": 89.04}, "episode_return_mean": 472.44269482493394, "sample": 0.12250914792704197, "num_agent_steps_sampled": {"vehicle_3": 1664.0000000000002, "vehicle_1": 1693.0, "vehicle_0": 1605.9999999999998, "vehicle_2": 1545.0}, "episode_return_max": 800.144972205162, "env_to_module_sum_episodes_length_out": 47.90749993659273, "time_between_sampling": 0.1086975337899678, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 30000.0, "module_episode_returns_mean": {"shared_policy": 356.1933550691605}, "num_episodes_lifetime": 278.00000000000017, "env_step_timer": 9.991836210235744e-05, "episode_len_min": 68, "weights_seq_no": 12.0, "rlmodule_inference_timer": 6.147733254878843e-05, "episode_return_min": 40.834388256073, "num_module_steps_sampled": {"shared_policy": 6508.0}, "episode_len_mean": 112.77999999999999, "env_to_module_sum_episodes_length_in": 47.90749993659273, "episode_duration_sec_mean": 0.0583861532798619, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1913.1596464503907}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 886272, "weights_seq_no": 13.0, "policy_loss": -0.11100633442401886, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.369535446166992, "num_module_steps_trained": 66944, "vf_explained_var": 0.17449408769607544, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.02024216391146183, "entropy": 0.6230055093765259, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1446.5001220703125, "curr_entropy_coeff": 0.01, "total_loss": 9.25634765625, "gradients_default_optimizer_global_norm": 3.2272281646728516, "num_module_steps_trained_lifetime_throughput": 72614.2224062904}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002623372562691036, "add_observations_from_episodes_to_batch": 0.0003324928695962579, "add_states_from_episodes_to_batch": 3.6428997155826725e-06, "add_time_dim_to_batch_and_zero_pad": 1.580568536158093e-05, "batch_individual_items": 0.1026866945408022, "add_columns_from_episodes_to_train_batch": 0.04074050198492412, "numpy_to_tensor": 0.00012149216118711239, "add_one_ts_to_episodes_and_truncate": 0.004567610868555798, "general_advantage_estimation": 0.014272711397050579}}, "connector_pipeline_timer": 0.16556909967201627}, "num_module_steps_trained_lifetime": 886272, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 13848000, "num_env_steps_trained": 1046000, "num_module_steps_trained": 66944, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1134552.8715643575, "num_module_steps_trained_throughput": 72613.597897031, "num_module_steps_trained_lifetime_throughput": 72612.5140182999}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-02", "timestamp": 1750907282, "time_this_iter_s": 1.7028610706329346, "time_total_s": 21.89202857017517, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x1795aab60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.89202857017517, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.133333333333333, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.640505875865882, "restore_env_runners": 1.2321893612261429e-05, "training_step": 1.6403786855632128, "env_runner_sampling_timer": 0.6032822946540418, "learner_update_timer": 1.0349365660776741, "synch_weights": 0.0009685882452699361, "synch_env_connectors": 0.0008606251526503483}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.320972172710505e-07, "un_batch_to_individual_items": 1.2044947798924607e-05, "normalize_and_clip_actions": 3.6356096507604705e-05, "get_actions": 3.4227436135166735e-05, "module_to_agent_unmapping": 1.5845167033998044e-06, "listify_data_for_vector_env": 5.338716426546949e-06, "tensor_to_numpy": 1.5885609388022812e-05}}, "connector_pipeline_timer": 0.00013655303998121558}, "agent_episode_returns_mean": {"vehicle_3": 427.3974939751625, "vehicle_1": 101.75029094934463, "vehicle_0": 104.45565018773078, "vehicle_2": -20.762857351303097}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 27779.0, "vehicle_0": 26660.999999999993, "vehicle_2": 26201.999999999993, "vehicle_3": 24531.999999999993}, "num_module_steps_sampled_lifetime": {"shared_policy": 105173.99999999999}, "num_episodes": 17.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2002880255177437e-05, "add_states_from_episodes_to_batch": 1.6280999246059357e-06, "add_time_dim_to_batch_and_zero_pad": 2.509857475187641e-06, "agent_to_module_mapping": 2.495021670926374e-06, "numpy_to_tensor": 9.260596905165059e-06, "batch_individual_items": 8.004383118399349e-06}}, "connector_pipeline_timer": 6.189397816387149e-05}, "episode_len_max": 223, "agent_steps": {"vehicle_3": 98.9, "vehicle_1": 89.5, "vehicle_0": 94.76, "vehicle_2": 81.99999999999999}, "episode_return_mean": 612.840576826334, "sample": 0.12174039477953438, "num_agent_steps_sampled": {"vehicle_3": 1682.0, "vehicle_1": 1538.0, "vehicle_0": 1610.9999999999998, "vehicle_2": 1412.0}, "episode_return_max": 1231.4190994501114, "env_to_module_sum_episodes_length_out": 57.08069781086452, "time_between_sampling": 0.11488880522519122, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 32000.0, "module_episode_returns_mean": {"shared_policy": 463.5075220632553}, "num_episodes_lifetime": 295.00000000000034, "env_step_timer": 9.649948966696729e-05, "episode_len_min": 98, "weights_seq_no": 13.0, "rlmodule_inference_timer": 5.876688831489826e-05, "episode_return_min": 210.6304657459259, "num_module_steps_sampled": {"shared_policy": 6243.0}, "episode_len_mean": 113.34, "env_to_module_sum_episodes_length_in": 57.08069781086452, "episode_duration_sec_mean": 0.058085669379943285, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1989.9635962406444}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 950528, "weights_seq_no": 14.0, "policy_loss": 0.14452752470970154, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.312381744384766, "num_module_steps_trained": 64256, "vf_explained_var": 0.21809852123260498, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.0055049266666173935, "entropy": 0.6976812481880188, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1506.033447265625, "curr_entropy_coeff": 0.01, "total_loss": 9.45158576965332, "gradients_default_optimizer_global_norm": 1.3084126710891724, "num_module_steps_trained_lifetime_throughput": 72621.79332276733}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026251446670181797, "add_observations_from_episodes_to_batch": 0.00033225586094973354, "add_states_from_episodes_to_batch": 3.632310699817009e-06, "add_time_dim_to_batch_and_zero_pad": 1.5731798459116244e-05, "batch_individual_items": 0.10198663551538574, "add_columns_from_episodes_to_train_batch": 0.04075171196509175, "numpy_to_tensor": 0.00012114140957217155, "add_one_ts_to_episodes_and_truncate": 0.004568953509917086, "general_advantage_estimation": 0.014264193033103464}}, "connector_pipeline_timer": 0.16487321783527253}, "num_module_steps_trained_lifetime": 950528, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 14852000, "num_env_steps_trained": 1004000, "num_module_steps_trained": 64256, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1134671.0485500188, "num_module_steps_trained_throughput": 72621.04198058737, "num_module_steps_trained_lifetime_throughput": 72619.92675262682}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-04", "timestamp": 1750907284, "time_this_iter_s": 1.5636789798736572, "time_total_s": 23.455707550048828, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff476a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.455707550048828, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 14.2, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6399818375171658, "restore_env_runners": 1.2244514664299693e-05, "training_step": 1.6398544549575824, "env_runner_sampling_timer": 0.6030295096274776, "learner_update_timer": 1.0346664499969098, "synch_weights": 0.0009669190228118464, "synch_env_connectors": 0.0008624034811424257}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.305852272863427e-07, "un_batch_to_individual_items": 1.2059171351301608e-05, "normalize_and_clip_actions": 3.6703407733249925e-05, "get_actions": 3.451310042189172e-05, "module_to_agent_unmapping": 1.577199660880591e-06, "listify_data_for_vector_env": 5.483477332759579e-06, "tensor_to_numpy": 1.6077596960125407e-05}}, "connector_pipeline_timer": 0.0001374831260080571}, "agent_episode_returns_mean": {"vehicle_3": 422.0860609960557, "vehicle_1": 166.11682955026626, "vehicle_0": 140.59720927476883, "vehicle_2": 42.42157420873643}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 29352.999999999993, "vehicle_0": 28264.000000000004, "vehicle_2": 27545.0, "vehicle_3": 26233.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 111394.99999999997}, "num_episodes": 17.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2133002803718348e-05, "add_states_from_episodes_to_batch": 1.63011040306857e-06, "add_time_dim_to_batch_and_zero_pad": 2.4856338509674448e-06, "agent_to_module_mapping": 2.4609834787699744e-06, "numpy_to_tensor": 9.311033437305141e-06, "batch_individual_items": 8.041493039226887e-06}}, "connector_pipeline_timer": 6.207998482305965e-05}, "episode_len_max": 210, "agent_steps": {"vehicle_3": 98.66, "vehicle_1": 97.82, "vehicle_0": 93.95999999999998, "vehicle_2": 83.34}, "episode_return_mean": 771.2216738247871, "sample": 0.1209541384472079, "num_agent_steps_sampled": {"vehicle_3": 1700.9999999999998, "vehicle_1": 1574.0000000000002, "vehicle_0": 1603.0, "vehicle_2": 1343.0}, "episode_return_max": 1291.4967325925827, "env_to_module_sum_episodes_length_out": 49.28242434772389, "time_between_sampling": 0.11947122190759334, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 34000.0, "module_episode_returns_mean": {"shared_policy": 530.8936876106262}, "num_episodes_lifetime": 312.00000000000034, "env_step_timer": 9.965468048033125e-05, "episode_len_min": 98, "weights_seq_no": 14.0, "rlmodule_inference_timer": 5.949497200728491e-05, "episode_return_min": 313.52747094631195, "num_module_steps_sampled": {"shared_policy": 6221.000000000001}, "episode_len_mean": 121.93999999999997, "env_to_module_sum_episodes_length_in": 49.28242434772389, "episode_duration_sec_mean": 0.06177293331886177, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1983.8729253375618}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 1014528, "weights_seq_no": 15.0, "policy_loss": -0.026715150102972984, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.473030090332031, "num_module_steps_trained": 64000, "vf_explained_var": 0.17594802379608154, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.005367167294025421, "entropy": 0.6323413848876953, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1853.266357421875, "curr_entropy_coeff": 0.01, "total_loss": 9.441600799560547, "gradients_default_optimizer_global_norm": 1.653135061264038, "num_module_steps_trained_lifetime_throughput": 72485.63799455493}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026262157203753647, "add_observations_from_episodes_to_batch": 0.0003321637123425246, "add_states_from_episodes_to_batch": 3.6180675775927208e-06, "add_time_dim_to_batch_and_zero_pad": 1.565657044767304e-05, "batch_individual_items": 0.10128637750022808, "add_columns_from_episodes_to_train_batch": 0.0407582494254009, "numpy_to_tensor": 0.00012078082544165197, "add_one_ts_to_episodes_and_truncate": 0.004569443974808188, "general_advantage_estimation": 0.014254983602778595}}, "connector_pipeline_timer": 0.1641701677468702}, "num_module_steps_trained_lifetime": 1014528, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 15852000, "num_env_steps_trained": 1000000, "num_module_steps_trained": 64000, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1132547.7763804684, "num_module_steps_trained_throughput": 72484.96048407877, "num_module_steps_trained_lifetime_throughput": 72483.92727033985}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-05", "timestamp": 1750907285, "time_this_iter_s": 1.5901298522949219, "time_total_s": 25.04583740234375, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff46840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.04583740234375, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.65, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6400439462319798, "restore_env_runners": 1.2172479534795044e-05, "training_step": 1.6399164499880092, "env_runner_sampling_timer": 0.602891413701251, "learner_update_timer": 1.0348669367469343, "synch_weights": 0.0009644256626165208, "synch_env_connectors": 0.0008636744462974924}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.246435307594499e-07, "un_batch_to_individual_items": 1.2602274986822035e-05, "normalize_and_clip_actions": 3.8121634145748625e-05, "get_actions": 3.4084654002217644e-05, "module_to_agent_unmapping": 1.574536312054887e-06, "listify_data_for_vector_env": 5.661674322957596e-06, "tensor_to_numpy": 1.5915279772944753e-05}}, "connector_pipeline_timer": 0.0001388772343264047}, "agent_episode_returns_mean": {"vehicle_3": 429.03682750463486, "vehicle_1": 140.9078563642502, "vehicle_0": 207.23765998840332, "vehicle_2": 43.342718544006345}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 30870.0, "vehicle_0": 29985.999999999996, "vehicle_2": 28962.999999999996, "vehicle_3": 28076.0}, "num_module_steps_sampled_lifetime": {"shared_policy": 117894.99999999997}, "num_episodes": 18.999999999999996, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2225713404938598e-05, "add_states_from_episodes_to_batch": 1.6076733227226257e-06, "add_time_dim_to_batch_and_zero_pad": 2.4916990182807154e-06, "agent_to_module_mapping": 2.4892359628371036e-06, "numpy_to_tensor": 9.326371974233139e-06, "batch_individual_items": 8.222002623053886e-06}}, "connector_pipeline_timer": 6.240600574052707e-05}, "episode_len_max": 225, "agent_steps": {"vehicle_3": 99.15999999999998, "vehicle_1": 83.56, "vehicle_0": 92.59999999999998, "vehicle_2": 77.64}, "episode_return_mean": 820.5250643849373, "sample": 0.12030326332728807, "num_agent_steps_sampled": {"vehicle_3": 1843.0, "vehicle_1": 1517.0, "vehicle_0": 1722.0, "vehicle_2": 1418.0}, "episode_return_max": 1088.285924077034, "env_to_module_sum_episodes_length_out": 46.07478368935365, "time_between_sampling": 0.12407537339978988, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 36000.0, "module_episode_returns_mean": {"shared_policy": 542.3207451868058}, "num_episodes_lifetime": 331.00000000000045, "env_step_timer": 0.00010361588187479136, "episode_len_min": 98, "weights_seq_no": 15.0, "rlmodule_inference_timer": 6.043003997525078e-05, "episode_return_min": 675.3084032535553, "num_module_steps_sampled": {"shared_policy": 6500.0}, "episode_len_mean": 107.98, "env_to_module_sum_episodes_length_in": 46.07478368935365, "episode_duration_sec_mean": 0.05602684593846787, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1937.8774827010432}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 1081344, "weights_seq_no": 16.0, "policy_loss": 0.02607298642396927, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.589617729187012, "num_module_steps_trained": 66816, "vf_explained_var": 0.24446970224380493, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.013329841196537018, "entropy": 0.5771690607070923, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 1934.2911376953125, "curr_entropy_coeff": 0.01, "total_loss": 9.61391830444336, "gradients_default_optimizer_global_norm": 1.2329705953598022, "num_module_steps_trained_lifetime_throughput": 72443.53501374625}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026290702231788867, "add_observations_from_episodes_to_batch": 0.0003323183252044962, "add_states_from_episodes_to_batch": 3.6077168423854492e-06, "add_time_dim_to_batch_and_zero_pad": 1.5620414784032157e-05, "batch_individual_items": 0.10061409372527313, "add_columns_from_episodes_to_train_batch": 0.040784041101171654, "numpy_to_tensor": 0.00012037384720827037, "add_one_ts_to_episodes_and_truncate": 0.0045725499550325, "general_advantage_estimation": 0.014250399176781838}}, "connector_pipeline_timer": 0.16352375689936163}, "num_module_steps_trained_lifetime": 1081344, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 16896000, "num_env_steps_trained": 1044000, "num_module_steps_trained": 66816, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1131895.4272997486, "num_module_steps_trained_throughput": 72442.95391942382, "num_module_steps_trained_lifetime_throughput": 72442.03201277636}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-07", "timestamp": 1750907287, "time_this_iter_s": 1.6480350494384766, "time_total_s": 26.693872451782227, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x17ff46fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.693872451782227, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 13.333333333333334, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6409118463596695, "restore_env_runners": 1.2101584724858932e-05, "training_step": 1.640784238828133, "env_runner_sampling_timer": 0.6028041949842808, "learner_update_timer": 1.035822394049467, "synch_weights": 0.000962568905989168, "synch_env_connectors": 0.0008634243718496878}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.300043909857372e-07, "un_batch_to_individual_items": 1.2717344652974295e-05, "normalize_and_clip_actions": 3.854402235594492e-05, "get_actions": 3.3885554011897805e-05, "module_to_agent_unmapping": 1.5739446214644797e-06, "listify_data_for_vector_env": 5.7059214891427236e-06, "tensor_to_numpy": 1.581513998198682e-05}}, "connector_pipeline_timer": 0.00013927931582290512}, "agent_episode_returns_mean": {"vehicle_3": 438.4956535232067, "vehicle_1": 169.83323104619978, "vehicle_0": 254.14084810256958, "vehicle_2": 101.8172271990776}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 32566.99999999999, "vehicle_0": 31684.999999999993, "vehicle_2": 30516.000000000004, "vehicle_3": 29897.999999999993}, "num_module_steps_sampled_lifetime": {"shared_policy": 124666.00000000001}, "num_episodes": 20.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.236949155839553e-05, "add_states_from_episodes_to_batch": 1.6208362770082804e-06, "add_time_dim_to_batch_and_zero_pad": 2.4952489706784766e-06, "agent_to_module_mapping": 2.496134351076823e-06, "numpy_to_tensor": 9.24113093095968e-06, "batch_individual_items": 8.25773616366061e-06}}, "connector_pipeline_timer": 6.258645562315467e-05}, "episode_len_max": 167, "agent_steps": {"vehicle_3": 96.41999999999999, "vehicle_1": 83.78, "vehicle_0": 90.22, "vehicle_2": 79.76}, "episode_return_mean": 964.2869589555263, "sample": 0.11982915646861023, "num_agent_steps_sampled": {"vehicle_3": 1822.0, "vehicle_1": 1697.0, "vehicle_0": 1699.0000000000002, "vehicle_2": 1553.0}, "episode_return_max": 1261.8091686964035, "env_to_module_sum_episodes_length_out": 48.809172708613524, "time_between_sampling": 0.12886261640655927, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 38000.0, "module_episode_returns_mean": {"shared_policy": 571.2846654045582}, "num_episodes_lifetime": 351.00000000000045, "env_step_timer": 0.00010387463095191802, "episode_len_min": 90, "weights_seq_no": 16.0, "rlmodule_inference_timer": 6.129633239019957e-05, "episode_return_min": 721.6439806222916, "num_module_steps_sampled": {"shared_policy": 6771.000000000001}, "episode_len_mean": 101.76000000000002, "env_to_module_sum_episodes_length_in": 48.809172708613524, "episode_duration_sec_mean": 0.05386898516022484, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1922.7235310344859}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 1150976, "weights_seq_no": 17.0, "policy_loss": -0.016544844955205917, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.739531517028809, "num_module_steps_trained": 69632, "vf_explained_var": 0.24545824527740479, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.006826865952461958, "entropy": 0.6001352667808533, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 2194.72900390625, "curr_entropy_coeff": 0.01, "total_loss": 9.719033241271973, "gradients_default_optimizer_global_norm": 1.3791719675064087, "num_module_steps_trained_lifetime_throughput": 72260.69655316135}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002633916600951653, "add_observations_from_episodes_to_batch": 0.00033287597199754224, "add_states_from_episodes_to_batch": 3.6037196621208338e-06, "add_time_dim_to_batch_and_zero_pad": 1.559213062943874e-05, "batch_individual_items": 0.09995556987803071, "add_columns_from_episodes_to_train_batch": 0.04083269235016652, "numpy_to_tensor": 0.00012010510872530051, "add_one_ts_to_episodes_and_truncate": 0.004577843625469005, "general_advantage_estimation": 0.014267136014976091}}, "connector_pipeline_timer": 0.16294021183033636}, "num_module_steps_trained_lifetime": 1150976, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 17984000, "num_env_steps_trained": 1088000, "num_module_steps_trained": 69632, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1129044.8101325962, "num_module_steps_trained_throughput": 72260.1815611741, "num_module_steps_trained_lifetime_throughput": 72259.3535693822}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-09", "timestamp": 1750907289, "time_this_iter_s": 1.729175090789795, "time_total_s": 28.42304754257202, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x394205da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.42304754257202, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 15.65, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6417754924761208, "restore_env_runners": 1.2024318919706123e-05, "training_step": 1.6416475285298788, "env_runner_sampling_timer": 0.6025095580344297, "learner_update_timer": 1.0369795988590351, "synch_weights": 0.0009616202969700739, "synch_env_connectors": 0.0008677230481301933}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.473841323265024e-07, "un_batch_to_individual_items": 1.2250136420449405e-05, "normalize_and_clip_actions": 3.668354248550071e-05, "get_actions": 3.3851597953645194e-05, "module_to_agent_unmapping": 1.5633253243432358e-06, "listify_data_for_vector_env": 5.480228225875803e-06, "tensor_to_numpy": 1.583564121527733e-05}}, "connector_pipeline_timer": 0.00013658378134577114}, "agent_episode_returns_mean": {"vehicle_3": 447.52443056941047, "vehicle_1": 154.63706887722014, "vehicle_0": 264.21532366752626, "vehicle_2": 115.35274295926094}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 34237.99999999998, "vehicle_0": 33320.000000000015, "vehicle_2": 32047.00000000001, "vehicle_3": 31651.99999999999}, "num_module_steps_sampled_lifetime": {"shared_policy": 131256.99999999997}, "num_episodes": 17.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2114182344790855e-05, "add_states_from_episodes_to_batch": 1.6224813242099373e-06, "add_time_dim_to_batch_and_zero_pad": 2.491478599474363e-06, "agent_to_module_mapping": 2.4527437009570854e-06, "numpy_to_tensor": 9.140923238461612e-06, "batch_individual_items": 8.069915618981327e-06}}, "connector_pipeline_timer": 6.185128834764692e-05}, "episode_len_max": 167, "agent_steps": {"vehicle_3": 97.14000000000001, "vehicle_1": 91.63999999999999, "vehicle_0": 90.14000000000001, "vehicle_2": 85.54}, "episode_return_mean": 981.7295646238327, "sample": 0.11923424851638835, "num_agent_steps_sampled": {"vehicle_3": 1754.0000000000002, "vehicle_1": 1670.9999999999998, "vehicle_0": 1635.0, "vehicle_2": 1530.9999999999998}, "episode_return_max": 1335.8826183080673, "env_to_module_sum_episodes_length_out": 48.661861602417204, "time_between_sampling": 0.13419555270497296, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 40000.0, "module_episode_returns_mean": {"shared_policy": 549.2455286872387}, "num_episodes_lifetime": 368.0000000000005, "env_step_timer": 9.907230508147606e-05, "episode_len_min": 94, "weights_seq_no": 17.0, "rlmodule_inference_timer": 5.897389255613232e-05, "episode_return_min": 767.402965426445, "num_module_steps_sampled": {"shared_policy": 6591.000000000001}, "episode_len_mean": 108.1, "env_to_module_sum_episodes_length_in": 48.661861602417204, "episode_duration_sec_mean": 0.055528383359196604, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1944.1085955119713}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 1218816, "weights_seq_no": 18.0, "policy_loss": -0.0850965827703476, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.47563648223877, "num_module_steps_trained": 67840, "vf_explained_var": 0.11624175310134888, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.008443009108304977, "entropy": 0.5726414322853088, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 2313.5478515625, "curr_entropy_coeff": 0.01, "total_loss": 9.387346267700195, "gradients_default_optimizer_global_norm": 5.165838718414307, "num_module_steps_trained_lifetime_throughput": 72055.14144084792}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002637570764968764, "add_observations_from_episodes_to_batch": 0.0003331730522407729, "add_states_from_episodes_to_batch": 3.5930924377947904e-06, "add_time_dim_to_batch_and_zero_pad": 1.55445393098321e-05, "batch_individual_items": 0.10006453500927141, "add_columns_from_episodes_to_train_batch": 0.04086265583668513, "numpy_to_tensor": 0.00011976405763814995, "add_one_ts_to_episodes_and_truncate": 0.0045831110192557185, "general_advantage_estimation": 0.014275580484839043}}, "connector_pipeline_timer": 0.1630954972119998}, "num_module_steps_trained_lifetime": 1218816, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 19044000, "num_env_steps_trained": 1060000, "num_module_steps_trained": 67840, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1125842.4290022247, "num_module_steps_trained_throughput": 72054.86934265944, "num_module_steps_trained_lifetime_throughput": 72054.23299869342}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-11", "timestamp": 1750907291, "time_this_iter_s": 1.7295007705688477, "time_total_s": 30.15254831314087, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3942051c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.15254831314087, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 1.6419053225513671, "restore_env_runners": 1.195448574764741e-05, "training_step": 1.641777012824542, "env_runner_sampling_timer": 0.6023538332840543, "learner_update_timer": 1.0372617103704407, "synch_weights": 0.0009632353440281498, "synch_env_connectors": 0.0008710045676864843}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.285820069320648e-07, "un_batch_to_individual_items": 1.2451742380340282e-05, "normalize_and_clip_actions": 3.7585864462014186e-05, "get_actions": 3.477120733566398e-05, "module_to_agent_unmapping": 1.5749366072437762e-06, "listify_data_for_vector_env": 5.529950798355246e-06, "tensor_to_numpy": 1.6245728287103585e-05}}, "connector_pipeline_timer": 0.00013932947732698923}, "agent_episode_returns_mean": {"vehicle_3": 461.2185066628455, "vehicle_1": 226.7899442577362, "vehicle_0": 270.18078646898266, "vehicle_2": 122.53206801056864}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 35866.99999999996, "vehicle_0": 34959.000000000015, "vehicle_2": 33519.00000000002, "vehicle_3": 33442.999999999985}, "num_module_steps_sampled_lifetime": {"shared_policy": 137787.99999999997}, "num_episodes": 20.0, "timers": {"connectors": {"numpy_to_tensor": 4.837499727727845e-05, "batch_individual_items": 5.033349953009747e-05, "agent_to_module_mapping": 1.7395999748259783e-05, "add_observations_from_episodes_to_batch": 6.43335006316192e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "add_time_dim_to_batch_and_zero_pad": 1.5207999240374193e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2090363456544447e-05, "add_states_from_episodes_to_batch": 1.6401561312292545e-06, "add_time_dim_to_batch_and_zero_pad": 2.4798354761528127e-06, "agent_to_module_mapping": 2.476547466698411e-06, "numpy_to_tensor": 9.434716334847654e-06, "batch_individual_items": 8.110400138717474e-06}}, "connector_pipeline_timer": 6.221742771669719e-05}, "episode_len_max": 175, "agent_steps": {"vehicle_3": 96.64, "vehicle_1": 91.67999999999998, "vehicle_0": 89.11999999999998, "vehicle_2": 80.50000000000001}, "episode_return_mean": 1080.721306449175, "sample": 0.11867513975066044, "num_agent_steps_sampled": {"vehicle_3": 1790.9999999999998, "vehicle_1": 1629.0000000000002, "vehicle_0": 1639.0000000000002, "vehicle_2": 1472.0}, "episode_return_max": 1335.8826183080673, "env_to_module_sum_episodes_length_out": 44.98044874404566, "time_between_sampling": 0.13943528487224813, "env_reset_timer": 9.406249955645762e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 42000.0, "module_episode_returns_mean": {"shared_policy": 599.6144967770575}, "num_episodes_lifetime": 388.00000000000045, "env_step_timer": 0.00010093189418918362, "episode_len_min": 90, "weights_seq_no": 18.0, "rlmodule_inference_timer": 6.149698054090515e-05, "episode_return_min": 856.1750428676605, "num_module_steps_sampled": {"shared_policy": 6531.000000000001}, "episode_len_mean": 109.79999999999997, "env_to_module_sum_episodes_length_in": 44.98044874404566, "episode_duration_sec_mean": 0.056945074219547684, "connector_pipeline_timer": 0.0005081250019429717, "num_env_steps_sampled_lifetime_throughput": 1928.1664650721075}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 1286016, "weights_seq_no": 19.0, "policy_loss": -0.012288274243474007, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.460591316223145, "num_module_steps_trained": 67200, "vf_explained_var": 0.1695340871810913, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.0073926858603954315, "entropy": 0.5879884362220764, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 2263.806396484375, "curr_entropy_coeff": 0.01, "total_loss": 9.44464111328125, "gradients_default_optimizer_global_norm": 4.350429534912109, "num_module_steps_trained_lifetime_throughput": 71993.39877866414}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026403967272868095, "add_observations_from_episodes_to_batch": 0.0003336563217365865, "add_states_from_episodes_to_batch": 3.5809115487419075e-06, "add_time_dim_to_batch_and_zero_pad": 1.5478673906168926e-05, "batch_individual_items": 0.09940115798914632, "add_columns_from_episodes_to_train_batch": 0.04089381302836199, "numpy_to_tensor": 0.00011992557707631306, "add_one_ts_to_episodes_and_truncate": 0.0045875228291055265, "general_advantage_estimation": 0.014276095100003066}}, "connector_pipeline_timer": 0.16247074515991422}, "num_module_steps_trained_lifetime": 1286016, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 20094000, "num_env_steps_trained": 1050000, "num_module_steps_trained": 67200, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1124879.4056303047, "num_module_steps_trained_throughput": 71993.18264062815, "num_module_steps_trained_lifetime_throughput": 71992.58298069486}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "b650b_00000", "date": "2025-06-25_20-08-12", "timestamp": 1750907292, "time_this_iter_s": 1.6569058895111084, "time_total_s": 31.809454202651978, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x394207920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.809454202651978, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 14.399999999999999, "ram_util_percent": 53.4}}
{"timers": {"training_iteration": 2.2542897368258186, "restore_env_runners": 1.1881600878754932e-05, "training_step": 2.254161257276293, "env_runner_sampling_timer": 1.2136605924512254, "learner_update_timer": 1.0383400266066836, "synch_weights": 0.0009608025705832267, "synch_env_connectors": 0.0008732099419986522}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.247267493471438e-07, "un_batch_to_individual_items": 1.2768809449144994e-05, "normalize_and_clip_actions": 3.869709483260246e-05, "get_actions": 3.4300496343734586e-05, "module_to_agent_unmapping": 1.5969738490775063e-06, "listify_data_for_vector_env": 5.684210974253996e-06, "tensor_to_numpy": 1.6161339943383877e-05}}, "connector_pipeline_timer": 0.00014028846252543093}, "agent_episode_returns_mean": {"vehicle_3": 456.84075954198835, "vehicle_1": 258.75497392177584, "vehicle_0": 265.24275749921804, "vehicle_2": 166.8491238427162}, "num_agent_steps_sampled_lifetime": {"vehicle_1": 37703.999999999956, "vehicle_0": 36665.000000000015, "vehicle_2": 35157.000000000015, "vehicle_3": 35267.999999999985}, "num_module_steps_sampled_lifetime": {"shared_policy": 144794.00000000006}, "num_episodes": 18.999999999999996, "timers": {"connectors": {"numpy_to_tensor": 4.839999746764079e-05, "batch_individual_items": 5.3066799591761085e-05, "agent_to_module_mapping": 1.952519960468635e-05, "add_observations_from_episodes_to_batch": 6.955020071472973e-05, "add_states_from_episodes_to_batch": 6.0915961512364445e-06, "add_time_dim_to_batch_and_zero_pad": 1.597459922777489e-05}}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.2392159212825616e-05, "add_states_from_episodes_to_batch": 1.6169707883283058e-06, "add_time_dim_to_batch_and_zero_pad": 2.4961463682845143e-06, "agent_to_module_mapping": 2.5358952512398268e-06, "numpy_to_tensor": 9.376970184105513e-06, "batch_individual_items": 8.309027904036286e-06}}, "connector_pipeline_timer": 6.293802794770197e-05}, "episode_len_max": 145, "agent_steps": {"vehicle_3": 94.99999999999999, "vehicle_1": 89.68, "vehicle_0": 88.4, "vehicle_2": 81.91999999999999}, "episode_return_mean": 1147.6876162409785, "sample": 0.11838070871710826, "num_agent_steps_sampled": {"vehicle_3": 1825.0, "vehicle_1": 1837.0, "vehicle_0": 1705.9999999999998, "vehicle_2": 1638.0}, "episode_return_max": 1414.7336410284042, "env_to_module_sum_episodes_length_out": 50.611591207065615, "time_between_sampling": 0.2033961219010026, "env_reset_timer": 9.466659976169467e-05, "num_env_steps_sampled": 2000.0, "num_env_steps_sampled_lifetime": 44000.0, "module_episode_returns_mean": {"shared_policy": 621.1916495943069}, "num_episodes_lifetime": 407.00000000000034, "env_step_timer": 0.00010268775795411816, "episode_len_min": 91, "weights_seq_no": 19.0, "rlmodule_inference_timer": 6.200524961143275e-05, "episode_return_min": 893.3771995306015, "num_module_steps_sampled": {"shared_policy": 7006.000000000001}, "episode_len_mean": 101.55999999999999, "env_to_module_sum_episodes_length_in": 50.611591207065615, "episode_duration_sec_mean": 0.05340427599992834, "connector_pipeline_timer": 0.0005525250016944483, "num_env_steps_sampled_lifetime_throughput": 1938.323131135946}, "learners": {"shared_policy": {"module_train_batch_size_mean": 128.0, "num_module_steps_trained_lifetime": 1357952, "weights_seq_no": 20.0, "policy_loss": 0.011983206495642662, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.827239036560059, "num_module_steps_trained": 71936, "vf_explained_var": 0.17506539821624756, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.010335100814700127, "entropy": 0.5342788696289062, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 149763, "vf_loss_unclipped": 2572.73388671875, "curr_entropy_coeff": 0.01, "total_loss": 9.836979866027832, "gradients_default_optimizer_global_norm": 2.3919389247894287, "num_module_steps_trained_lifetime_throughput": 71989.47228423595}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026434910900548928, "add_observations_from_episodes_to_batch": 0.0003337476685701799, "add_states_from_episodes_to_batch": 3.5696824370646037e-06, "add_time_dim_to_batch_and_zero_pad": 1.5436807191655892e-05, "batch_individual_items": 0.09875957182924228, "add_columns_from_episodes_to_train_batch": 0.040940506568052905, "numpy_to_tensor": 0.00011961632131580845, "add_one_ts_to_episodes_and_truncate": 0.004591065930759654, "general_advantage_estimation": 0.014289157899031539}}, "connector_pipeline_timer": 0.161894438538356}, "num_module_steps_trained_lifetime": 1357952, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 21218000, "num_env_steps_trained": 1124000, "num_module_steps_trained": 71936, "num_trainable_parameters": 149763, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained_lifetime_throughput": 1124818.5243303056, "num_module_steps_trained_throughput": 71989.27207321727, "num_module_steps_trained_lifetime_throughput": 71988.65416809625}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 44000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "b650b_00000", "date": "2025-06-25_20-09-15", "timestamp": 1750907355, "time_this_iter_s": 62.882274866104126, "time_total_s": 94.6917290687561, "pid": 32287, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x394205e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.6917290687561, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 9.607865168539325, "ram_util_percent": 52.896629213483145}}
