{"timers": {"training_iteration": 1.636659541996778, "restore_env_runners": 1.1249998351559043e-05, "training_step": 1.636545916000614, "env_runner_sampling_timer": 0.597695541997382, "learner_update_timer": 1.037048208003398, "synch_weights": 0.0007909169944468886}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 18433.0}, "agent_steps": {"vehicle_0": 88.97826086956523, "vehicle_3": 81.26086956521738, "vehicle_1": 96.8913043478261, "vehicle_2": 79.43478260869566}, "episode_return_max": -2531.4014221429825, "env_to_module_connector": {"connector_pipeline_timer": 6.272993976088099e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4677821811791275e-06, "add_states_from_episodes_to_batch": 1.6748350227242337e-06, "add_observations_from_episodes_to_batch": 1.1759949805675074e-05, "batch_individual_items": 8.094197932762876e-06, "add_time_dim_to_batch_and_zero_pad": 2.5810286570966948e-06, "numpy_to_tensor": 9.515371078621162e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5419980122242123e-06, "add_observations_from_episodes_to_batch": 3.4791999496519566e-05, "batch_individual_items": 2.8896000003442168e-05, "add_time_dim_to_batch_and_zero_pad": 8.29149576020427e-06, "numpy_to_tensor": 3.7833004171261564e-05, "agent_to_module_mapping": 5.5415002861991525e-06}}, "sample": 0.10502656825888611, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.3206121268062175e-06, "get_actions": 4.4262697858653085e-05, "remove_single_ts_time_rank_from_batch": 6.927170455797863e-07, "normalize_and_clip_actions": 3.6140473412627686e-05, "tensor_to_numpy": 1.918104598004699e-05, "un_batch_to_individual_items": 1.1768086989202594e-05, "module_to_agent_unmapping": 1.6719464363548178e-06}}, "connector_pipeline_timer": 0.00015072985858549903}, "rlmodule_inference_timer": 6.410284101055578e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 4158.0, "vehicle_0": 4943.999999999999, "vehicle_3": 4247.0, "vehicle_1": 5083.999999999999}, "env_step_timer": 9.915971945514241e-05, "agent_episode_returns_mean": {"vehicle_2": -702.6316730457803, "vehicle_0": -803.8227598641231, "vehicle_3": -755.8750353170478, "vehicle_1": -859.658289619114}, "env_reset_timer": 9.356249938718975e-05, "num_episodes": 16.0, "env_to_module_sum_episodes_length_out": 68.30916722343983, "episode_return_mean": -3121.987761163193, "num_agent_steps_sampled": {"vehicle_2": 1345.0, "vehicle_0": 1743.0, "vehicle_3": 1360.0, "vehicle_1": 1547.0}, "episode_len_min": 76, "episode_len_mean": 108.34782608695656, "module_episode_returns_mean": {"shared_policy": -1662.4678167908082}, "episode_return_min": -4592.617481470108, "num_env_steps_sampled_lifetime": 6000.0, "env_to_module_sum_episodes_length_in": 68.30916722343983, "num_module_steps_sampled": {"shared_policy": 5995.0}, "episode_duration_sec_mean": 0.055931213021919904, "episode_len_max": 280, "time_between_sampling": 0.015883054352097352, "connector_pipeline_timer": 0.0002421040044282563, "weights_seq_no": 0.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 46.0, "num_env_steps_sampled_lifetime_throughput": 2104.358398766724}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.00259912500041537, "add_time_dim_to_batch_and_zero_pad": 1.1292002454865724e-05, "numpy_to_tensor": 0.000124791004054714, "add_one_ts_to_episodes_and_truncate": 0.00478366699826438, "add_states_from_episodes_to_batch": 4.415996954776347e-06, "batch_individual_items": 0.10779808299412252, "general_advantage_estimation": 0.013266457994177472, "add_columns_from_episodes_to_train_batch": 0.038963041006354615, "add_observations_from_episodes_to_batch": 0.0003559580000001006}}, "connector_pipeline_timer": 0.16811283299466595}, "num_module_steps_trained_lifetime": 61696, "num_module_steps_trained": 61696, "num_env_steps_trained_lifetime": 964000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 964000, "learner_connector_sum_episodes_length_out": 2000, "learner_connector_sum_episodes_length_in": 2000, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1122791.5716090538, "num_module_steps_trained_throughput": 71862.63499815881, "num_module_steps_trained_lifetime_throughput": 71860.87619236908}, "shared_policy": {"vf_loss_unclipped": 16589.123046875, "weights_seq_no": 1.0, "mean_kl_loss": 0.011898345313966274, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 61696, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.847310066223145, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.033128488808870316, "gradients_default_optimizer_global_norm": 0.39830851554870605, "entropy": 1.2621464729309082, "vf_explained_var": -0.004892587661743164, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 61696, "total_loss": 9.870196342468262, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71863.48984665744}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "c13e0_00000", "date": "2025-06-25_18-49-16", "timestamp": 1750902556, "time_this_iter_s": 1.6385149955749512, "time_total_s": 1.6385149955749512, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef2a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6385149955749512, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.366666666666667, "ram_util_percent": 51.56666666666666}}
{"timers": {"training_iteration": 1.6368501286668469, "restore_env_runners": 1.1229168376303277e-05, "training_step": 1.6367359647605917, "env_runner_sampling_timer": 0.5976646103274107, "learner_update_timer": 1.0372680625933572, "synch_weights": 0.0007908174044860061, "synch_env_connectors": 0.0008316669991472736}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 25147.0}, "agent_steps": {"vehicle_0": 95.08, "vehicle_3": 82.43999999999998, "vehicle_1": 84.13999999999999, "vehicle_2": 83.76000000000002}, "episode_return_max": -2005.4348294734955, "env_to_module_connector": {"connector_pipeline_timer": 6.1895879774551e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.501028189792732e-06, "add_states_from_episodes_to_batch": 1.6431176956218934e-06, "add_observations_from_episodes_to_batch": 1.1950510348880163e-05, "batch_individual_items": 8.206840415608583e-06, "add_time_dim_to_batch_and_zero_pad": 2.4852916122541135e-06, "numpy_to_tensor": 9.137799674343536e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5419980122242123e-06, "add_observations_from_episodes_to_batch": 3.4791999496519566e-05, "batch_individual_items": 2.8896000003442168e-05, "add_time_dim_to_batch_and_zero_pad": 8.29149576020427e-06, "numpy_to_tensor": 3.7833004171261564e-05, "agent_to_module_mapping": 5.5415002861991525e-06}}, "sample": 0.10513261660199794, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.576345259852862e-06, "get_actions": 3.479510082848943e-05, "remove_single_ts_time_rank_from_batch": 6.812402024260454e-07, "normalize_and_clip_actions": 3.7533488341361253e-05, "tensor_to_numpy": 1.584855540386454e-05, "un_batch_to_individual_items": 1.2469810233457662e-05, "module_to_agent_unmapping": 1.6543949409468554e-06}}, "connector_pipeline_timer": 0.0001390599528522807}, "rlmodule_inference_timer": 5.790476826318642e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 5825.0, "vehicle_0": 6657.0, "vehicle_3": 5906.0, "vehicle_1": 6758.999999999999}, "env_step_timer": 0.00010912617017743794, "agent_episode_returns_mean": {"vehicle_2": -692.9644908690454, "vehicle_0": -788.792470395565, "vehicle_3": -659.3705683755875, "vehicle_1": -690.5480639028547}, "env_reset_timer": 9.356249938718975e-05, "num_episodes": 20.0, "env_to_module_sum_episodes_length_out": 52.29658183355902, "episode_return_mean": -2831.6755852270126, "num_agent_steps_sampled": {"vehicle_2": 1667.0, "vehicle_0": 1713.0, "vehicle_3": 1659.0000000000002, "vehicle_1": 1675.0}, "episode_len_min": 73, "episode_len_mean": 106.62, "module_episode_returns_mean": {"shared_policy": -1457.4548424148559}, "episode_return_min": -4573.822707414627, "num_env_steps_sampled_lifetime": 8000.0, "env_to_module_sum_episodes_length_in": 52.29658183355902, "num_module_steps_sampled": {"shared_policy": 6713.999999999999}, "episode_duration_sec_mean": 0.055521367539913616, "episode_len_max": 258, "time_between_sampling": 0.026011867359893227, "connector_pipeline_timer": 0.0002421040044282563, "weights_seq_no": 1.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 66.0, "num_env_steps_sampled_lifetime_throughput": 2054.4147839008424}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002600799590363749, "add_time_dim_to_batch_and_zero_pad": 1.1270332397543825e-05, "numpy_to_tensor": 0.00012441517399565784, "add_one_ts_to_episodes_and_truncate": 0.004785457828329526, "add_states_from_episodes_to_batch": 4.399336976348422e-06, "batch_individual_items": 0.10705854800420637, "general_advantage_estimation": 0.013274863004189683, "add_columns_from_episodes_to_train_batch": 0.03900713059629197, "add_observations_from_episodes_to_batch": 0.0003566346700245049}}, "connector_pipeline_timer": 0.16742863841471262}, "num_module_steps_trained_lifetime": 130688, "num_module_steps_trained": 68992, "num_env_steps_trained_lifetime": 2042000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1078000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1122719.7914732657, "num_module_steps_trained_throughput": 71857.81057328456, "num_module_steps_trained_lifetime_throughput": 71856.14312447092}, "shared_policy": {"vf_loss_unclipped": 13047.87109375, "weights_seq_no": 2.0, "mean_kl_loss": 0.0119926230981946, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 68992, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.932174682617188, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.16596804559230804, "gradients_default_optimizer_global_norm": 0.224513977766037, "entropy": 1.2028343677520752, "vf_explained_var": -0.003394007682800293, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 130688, "total_loss": 10.088512420654297, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71858.57643824151}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "c13e0_00000", "date": "2025-06-25_18-49-17", "timestamp": 1750902557, "time_this_iter_s": 1.657789945602417, "time_total_s": 3.296304941177368, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef1940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.296304941177368, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.3, "ram_util_percent": 51.5}}
{"timers": {"training_iteration": 1.6372273878001955, "restore_env_runners": 1.1158126715599792e-05, "training_step": 1.637112887193021, "env_runner_sampling_timer": 0.5983846963041543, "learner_update_timer": 1.0369212857174164, "synch_weights": 0.0007906646404109779, "synch_env_connectors": 0.0008336728291760664}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 31429.0}, "agent_steps": {"vehicle_0": 87.05999999999999, "vehicle_3": 77.21999999999998, "vehicle_1": 71.62, "vehicle_2": 84.98}, "episode_return_max": -1517.9106228351593, "env_to_module_connector": {"connector_pipeline_timer": 6.133341760427823e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4869903544193554e-06, "add_states_from_episodes_to_batch": 1.6329167573256503e-06, "add_observations_from_episodes_to_batch": 1.1792481492825067e-05, "batch_individual_items": 7.954224343871688e-06, "add_time_dim_to_batch_and_zero_pad": 2.4678437071417037e-06, "numpy_to_tensor": 9.145870118023826e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5419980122242123e-06, "add_observations_from_episodes_to_batch": 3.4791999496519566e-05, "batch_individual_items": 2.8896000003442168e-05, "add_time_dim_to_batch_and_zero_pad": 8.29149576020427e-06, "numpy_to_tensor": 3.7833004171261564e-05, "agent_to_module_mapping": 5.5415002861991525e-06}}, "sample": 0.1056892058812259, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.353047249367485e-06, "get_actions": 3.5054715952201164e-05, "remove_single_ts_time_rank_from_batch": 6.802658026193571e-07, "normalize_and_clip_actions": 3.536477327004354e-05, "tensor_to_numpy": 1.5981314154353324e-05, "un_batch_to_individual_items": 1.1803176581714671e-05, "module_to_agent_unmapping": 1.633188402925793e-06}}, "connector_pipeline_timer": 0.00013617622595743075}, "rlmodule_inference_timer": 6.907339695189852e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 7523.0, "vehicle_0": 8390.0, "vehicle_3": 7393.0, "vehicle_1": 8123.0}, "env_step_timer": 0.00010461301483747753, "agent_episode_returns_mean": {"vehicle_2": -609.3062476778031, "vehicle_0": -638.1512742614746, "vehicle_3": -584.7456426882744, "vehicle_1": -465.6693981504441}, "env_reset_timer": 9.356249938718975e-05, "num_episodes": 20.0, "env_to_module_sum_episodes_length_out": 56.69153109386025, "episode_return_mean": -2297.8725688433647, "num_agent_steps_sampled": {"vehicle_2": 1698.0, "vehicle_0": 1733.0, "vehicle_3": 1487.0, "vehicle_1": 1364.0000000000002}, "episode_len_min": 62, "episode_len_mean": 97.38000000000002, "module_episode_returns_mean": {"shared_policy": -1071.3392484402657}, "episode_return_min": -4476.929675459862, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 56.69153109386025, "num_module_steps_sampled": {"shared_policy": 6282.0}, "episode_duration_sec_mean": 0.05251020586103549, "episode_len_max": 255, "time_between_sampling": 0.03594855544060651, "connector_pipeline_timer": 0.0002421040044282563, "weights_seq_no": 2.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 86.0, "num_env_steps_sampled_lifetime_throughput": 2036.437390622158}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026026649244238797, "add_time_dim_to_batch_and_zero_pad": 1.1240969128994037e-05, "numpy_to_tensor": 0.00012408768224777305, "add_one_ts_to_episodes_and_truncate": 0.004787253250047069, "add_states_from_episodes_to_batch": 4.378263600665377e-06, "batch_individual_items": 0.10631614669415794, "general_advantage_estimation": 0.013277344794130477, "add_columns_from_episodes_to_train_batch": 0.039020586370308585, "add_observations_from_episodes_to_batch": 0.0003568079033124377}}, "connector_pipeline_timer": 0.16670467287054924}, "num_module_steps_trained_lifetime": 195456, "num_module_steps_trained": 64768, "num_env_steps_trained_lifetime": 3054000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1012000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1122008.369428447, "num_module_steps_trained_throughput": 71811.98841278399, "num_module_steps_trained_lifetime_throughput": 71810.43097770042}, "shared_policy": {"vf_loss_unclipped": 8831.109375, "weights_seq_no": 3.0, "mean_kl_loss": 0.01746063306927681, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 64768, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.007387793157249689, "gradients_default_optimizer_global_norm": 0.4988044798374176, "entropy": 1.1183182001113892, "vf_explained_var": 0.000425875186920166, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 195456, "total_loss": 9.999696731567383, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71812.77109934292}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "c13e0_00000", "date": "2025-06-25_18-49-19", "timestamp": 1750902559, "time_this_iter_s": 1.6764893531799316, "time_total_s": 4.9727942943573, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef14e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.9727942943573, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 13.266666666666666, "ram_util_percent": 51.56666666666666}}
{"timers": {"training_iteration": 2.2507966743421686, "restore_env_runners": 1.109404544633435e-05, "training_step": 2.250682025411078, "env_runner_sampling_timer": 1.211612833511146, "learner_update_timer": 1.0372600820202496, "synch_weights": 0.0007903754940208891, "synch_env_connectors": 0.0008340815208663116}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 37942.0}, "agent_steps": {"vehicle_0": 89.86, "vehicle_3": 76.50000000000001, "vehicle_1": 71.86000000000001, "vehicle_2": 78.26}, "episode_return_max": -1346.3517007827759, "env_to_module_connector": {"connector_pipeline_timer": 6.231195427437399e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5232409777071392e-06, "add_states_from_episodes_to_batch": 1.639605291449452e-06, "add_observations_from_episodes_to_batch": 1.199173800739696e-05, "batch_individual_items": 8.204212435815312e-06, "add_time_dim_to_batch_and_zero_pad": 2.5021770197319183e-06, "numpy_to_tensor": 9.442356492237879e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.558798198355362e-06, "add_observations_from_episodes_to_batch": 3.407520125620067e-05, "batch_individual_items": 2.752119908109307e-05, "add_time_dim_to_batch_and_zero_pad": 8.4748950030189e-06, "numpy_to_tensor": 3.591620406950824e-05, "agent_to_module_mapping": 5.558101111091673e-06}}, "sample": 0.10316093031297897, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.6183953483222265e-06, "get_actions": 3.575725104943249e-05, "remove_single_ts_time_rank_from_batch": 6.736134885477375e-07, "normalize_and_clip_actions": 3.693029078130114e-05, "tensor_to_numpy": 1.6149894211858342e-05, "un_batch_to_individual_items": 1.233473110562729e-05, "module_to_agent_unmapping": 1.6244375249223408e-06}}, "connector_pipeline_timer": 0.00013942020122225461}, "rlmodule_inference_timer": 6.079495794983973e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 9155.999999999998, "vehicle_0": 10260.0, "vehicle_3": 8930.0, "vehicle_1": 9595.999999999998}, "env_step_timer": 0.00010835779094873428, "agent_episode_returns_mean": {"vehicle_2": -472.72529025554655, "vehicle_0": -536.862591509819, "vehicle_3": -487.30776185989384, "vehicle_1": -399.9836586642265}, "env_reset_timer": 9.143749775830656e-05, "num_episodes": 20.0, "env_to_module_sum_episodes_length_out": 53.12139577505631, "episode_return_mean": -1896.8792950034142, "num_agent_steps_sampled": {"vehicle_2": 1633.0, "vehicle_0": 1870.0, "vehicle_3": 1537.0, "vehicle_1": 1473.0}, "episode_len_min": 62, "episode_len_mean": 94.54, "module_episode_returns_mean": {"shared_policy": -935.0912398815155}, "episode_return_min": -3289.3757014274597, "num_env_steps_sampled_lifetime": 12000.0, "env_to_module_sum_episodes_length_in": 53.12139577505631, "num_module_steps_sampled": {"shared_policy": 6513.0}, "episode_duration_sec_mean": 0.0500482017386821, "episode_len_max": 292, "time_between_sampling": 0.22789333795759753, "connector_pipeline_timer": 0.00023784560471540317, "weights_seq_no": 3.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 106.0, "num_env_steps_sampled_lifetime_throughput": 1982.9167772111314}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026052611951788204, "add_time_dim_to_batch_and_zero_pad": 1.1209389433272008e-05, "numpy_to_tensor": 0.00012368389547213885, "add_one_ts_to_episodes_and_truncate": 0.004794878217544326, "add_states_from_episodes_to_batch": 4.36823093060957e-06, "batch_individual_items": 0.10559214689719733, "general_advantage_estimation": 0.0132890080061645, "add_columns_from_episodes_to_train_batch": 0.03906482759661601, "add_observations_from_episodes_to_batch": 0.00035704148426580654}}, "connector_pipeline_timer": 0.1660458248918308}, "num_module_steps_trained_lifetime": 262528, "num_module_steps_trained": 67072, "num_env_steps_trained_lifetime": 4102000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1048000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1121130.5406461812, "num_module_steps_trained_throughput": 71755.62827431371, "num_module_steps_trained_lifetime_throughput": 71754.12627454358}, "shared_policy": {"vf_loss_unclipped": 6082.41748046875, "weights_seq_no": 4.0, "mean_kl_loss": 0.013678953051567078, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 67072, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.79519271850586, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.017764557152986526, "gradients_default_optimizer_global_norm": 0.6880975365638733, "entropy": 1.0508203506469727, "vf_explained_var": 0.0002709627151489258, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 262528, "total_loss": 9.76965618133545, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71756.34817131738}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "c13e0_00000", "date": "2025-06-25_18-50-22", "timestamp": 1750902622, "time_this_iter_s": 62.99612307548523, "time_total_s": 67.96891736984253, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef2480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.96891736984253, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.932584269662922, "ram_util_percent": 52.23932584269663}}
{"timers": {"training_iteration": 2.247277063018753, "restore_env_runners": 5.089394497885842e-05, "training_step": 2.2471221647469246, "env_runner_sampling_timer": 1.205570331016034, "learner_update_timer": 1.039740633700076, "synch_weights": 0.0007900042390295459, "synch_env_connectors": 0.000835751535667936}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 91926.00000000001}, "agent_steps": {"vehicle_0": 78.63999999999999, "vehicle_3": 75.36, "vehicle_1": 77.22, "vehicle_2": 77.14}, "episode_return_max": -1207.5490065813065, "env_to_module_connector": {"connector_pipeline_timer": 6.309281435482102e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.532551701238833e-06, "add_states_from_episodes_to_batch": 1.6305484238336489e-06, "add_observations_from_episodes_to_batch": 1.234526201806847e-05, "batch_individual_items": 8.371718421977712e-06, "add_time_dim_to_batch_and_zero_pad": 2.519077019833423e-06, "numpy_to_tensor": 9.457909195284433e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3959986467380077e-06, "add_observations_from_episodes_to_batch": 3.1187504646368325e-05, "batch_individual_items": 2.408349610050209e-05, "add_time_dim_to_batch_and_zero_pad": 7.749997166683897e-06, "numpy_to_tensor": 2.654150011949241e-05, "agent_to_module_mapping": 5.249999958323315e-06}}, "sample": 0.10475245860978721, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.71023500262441e-06, "get_actions": 3.787509869509586e-05, "remove_single_ts_time_rank_from_batch": 6.605105595314688e-07, "normalize_and_clip_actions": 3.961556473386439e-05, "tensor_to_numpy": 1.709866997883757e-05, "un_batch_to_individual_items": 1.2881224474712084e-05, "module_to_agent_unmapping": 1.6531696190138152e-06}}, "connector_pipeline_timer": 0.00014615238442328274}, "rlmodule_inference_timer": 6.492684738862531e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 22235.999999999996, "vehicle_0": 24819.000000000007, "vehicle_3": 21975.0, "vehicle_1": 22895.999999999996}, "env_step_timer": 0.00010690718702108617, "agent_episode_returns_mean": {"vehicle_2": -436.14270160079, "vehicle_0": -414.45437538862234, "vehicle_3": -375.85743159174905, "vehicle_1": -389.56697418928144}, "env_reset_timer": 8.043749767239206e-05, "num_episodes": 21.000000000000004, "env_to_module_sum_episodes_length_out": 46.164008351634365, "episode_return_mean": -1616.0214823889733, "num_agent_steps_sampled": {"vehicle_2": 1802.0, "vehicle_0": 1777.0, "vehicle_3": 1695.0, "vehicle_1": 1729.0000000000002}, "episode_len_min": 67, "episode_len_mean": 84.43, "module_episode_returns_mean": {"shared_policy": -709.2313293421269}, "episode_return_min": -2190.6628773212433, "num_env_steps_sampled_lifetime": 28000.0, "env_to_module_sum_episodes_length_in": 46.164008351634365, "num_module_steps_sampled": {"shared_policy": 7003.0}, "episode_duration_sec_mean": 0.04543017572956161, "episode_len_max": 163, "time_between_sampling": 0.35848478814134516, "connector_pipeline_timer": 0.0002163540011679288, "weights_seq_no": 4.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 278.00000000000006, "num_env_steps_sampled_lifetime_throughput": 1960.0308356099908}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026088131632039085, "add_time_dim_to_batch_and_zero_pad": 1.1189795515684164e-05, "numpy_to_tensor": 0.00012335288653761884, "add_one_ts_to_episodes_and_truncate": 0.004800118185394466, "add_states_from_episodes_to_batch": 4.347048574350846e-06, "batch_individual_items": 0.1056764904282199, "general_advantage_estimation": 0.013301325006088847, "add_columns_from_episodes_to_train_batch": 0.03912157890065704, "add_observations_from_episodes_to_batch": 0.0003579394094714821}}, "connector_pipeline_timer": 0.16620774248289608}, "num_module_steps_trained_lifetime": 334720, "num_module_steps_trained": 72192, "num_env_steps_trained_lifetime": 5230000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1128000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1118846.054882323, "num_module_steps_trained_throughput": 71609.57205927266, "num_module_steps_trained_lifetime_throughput": 71607.99022219324}, "shared_policy": {"vf_loss_unclipped": 4799.88818359375, "weights_seq_no": 5.0, "mean_kl_loss": 0.012165119871497154, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 72192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.782148361206055, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.029882434755563736, "gradients_default_optimizer_global_norm": 0.49900975823402405, "entropy": 1.0102540254592896, "vf_explained_var": 0.015265166759490967, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 334720, "total_loss": 9.744597434997559, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71610.35345184462}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "c13e0_00000", "date": "2025-06-25_18-50-24", "timestamp": 1750902624, "time_this_iter_s": 1.9010839462280273, "time_total_s": 69.87000131607056, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.87000131607056, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.566666666666666, "ram_util_percent": 52.666666666666664}}
{"timers": {"training_iteration": 2.2420458807185635, "restore_env_runners": 5.0442505530345743e-05, "training_step": 2.2418909755995045, "env_runner_sampling_timer": 1.1996098127058865, "learner_update_timer": 1.0404665731930585, "synch_weights": 0.0007901129466492994, "synch_env_connectors": 0.0008387131903187388}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 98845.00000000001}, "agent_steps": {"vehicle_0": 77.28, "vehicle_3": 77.4, "vehicle_1": 74.06000000000002, "vehicle_2": 77.94}, "episode_return_max": -898.813178896904, "env_to_module_connector": {"connector_pipeline_timer": 6.261972453208819e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.60702892529552e-06, "add_states_from_episodes_to_batch": 1.6198486219411635e-06, "add_observations_from_episodes_to_batch": 1.2268683951016552e-05, "batch_individual_items": 8.388142008952234e-06, "add_time_dim_to_batch_and_zero_pad": 2.539308183585872e-06, "numpy_to_tensor": 9.348932572325003e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3959986467380077e-06, "add_observations_from_episodes_to_batch": 3.1187504646368325e-05, "batch_individual_items": 2.408349610050209e-05, "add_time_dim_to_batch_and_zero_pad": 7.749997166683897e-06, "numpy_to_tensor": 2.654150011949241e-05, "agent_to_module_mapping": 5.249999958323315e-06}}, "sample": 0.10512137887240565, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.8396421348340154e-06, "get_actions": 3.524672942314499e-05, "remove_single_ts_time_rank_from_batch": 6.500555129744181e-07, "normalize_and_clip_actions": 3.960105326399836e-05, "tensor_to_numpy": 1.601786280935708e-05, "un_batch_to_individual_items": 1.3181641084048142e-05, "module_to_agent_unmapping": 1.6275455860647932e-06}}, "connector_pipeline_timer": 0.0001426095139113601}, "rlmodule_inference_timer": 6.1965609982142e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 23942.0, "vehicle_0": 26582.000000000004, "vehicle_3": 23740.999999999996, "vehicle_1": 24580.0}, "env_step_timer": 0.00011028695163146102, "agent_episode_returns_mean": {"vehicle_2": -381.4136010301113, "vehicle_0": -367.8978696823119, "vehicle_3": -366.50721235513686, "vehicle_1": -201.2085089755058}, "env_reset_timer": 8.043749767239206e-05, "num_episodes": 23.999999999999996, "env_to_module_sum_episodes_length_out": 36.248749176889724, "episode_return_mean": -1317.0271979939937, "num_agent_steps_sampled": {"vehicle_2": 1705.9999999999998, "vehicle_0": 1763.0, "vehicle_3": 1765.9999999999998, "vehicle_1": 1684.0000000000002}, "episode_len_min": 61, "episode_len_mean": 89.52, "module_episode_returns_mean": {"shared_policy": -694.6307507252693}, "episode_return_min": -2518.5532681941986, "num_env_steps_sampled_lifetime": 30000.0, "env_to_module_sum_episodes_length_in": 36.248749176889724, "num_module_steps_sampled": {"shared_policy": 6918.999999999999}, "episode_duration_sec_mean": 0.04836235503986245, "episode_len_max": 260, "time_between_sampling": 0.32053372853930207, "connector_pipeline_timer": 0.0002163540011679288, "weights_seq_no": 5.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 302.00000000000006, "num_env_steps_sampled_lifetime_throughput": 1909.5976526196507}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026136079516085437, "add_time_dim_to_batch_and_zero_pad": 1.1175397502585088e-05, "numpy_to_tensor": 0.00012302810767975375, "add_one_ts_to_episodes_and_truncate": 0.004806937423586392, "add_states_from_episodes_to_batch": 4.327328123932403e-06, "batch_individual_items": 0.10496831719390963, "general_advantage_estimation": 0.013319418426046593, "add_columns_from_episodes_to_train_batch": 0.03918104020169844, "add_observations_from_episodes_to_batch": 0.0003584058554093988}}, "connector_pipeline_timer": 0.16558796713808976}, "num_module_steps_trained_lifetime": 406144, "num_module_steps_trained": 71424, "num_env_steps_trained_lifetime": 6346000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1116000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1117567.7819105177, "num_module_steps_trained_throughput": 71527.6270927117, "num_module_steps_trained_lifetime_throughput": 71526.09849739909}, "shared_policy": {"vf_loss_unclipped": 3021.893798828125, "weights_seq_no": 6.0, "mean_kl_loss": 0.015202841721475124, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 71424, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.56551742553711, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.06573601067066193, "gradients_default_optimizer_global_norm": 0.8136591911315918, "entropy": 0.9256449341773987, "vf_explained_var": 0.01567476987838745, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 406144, "total_loss": 9.493565559387207, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71528.37197537153}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "c13e0_00000", "date": "2025-06-25_18-50-26", "timestamp": 1750902626, "time_this_iter_s": 1.7264277935028076, "time_total_s": 71.59642910957336, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.59642910957336, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.299999999999997, "ram_util_percent": 52.3}}
{"timers": {"training_iteration": 2.237321998161324, "restore_env_runners": 4.9986000441206335e-05, "training_step": 2.2371670870934746, "env_runner_sampling_timer": 1.1941322754088366, "learner_update_timer": 1.0412125437110773, "synch_weights": 0.0007951909871701813, "synch_env_connectors": 0.0008426614783759878}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 105788.00000000001}, "agent_steps": {"vehicle_0": 78.38000000000001, "vehicle_3": 73.62, "vehicle_1": 77.63999999999999, "vehicle_2": 85.24}, "episode_return_max": -624.4848009347916, "env_to_module_connector": {"connector_pipeline_timer": 6.165190852355986e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5093003528080676e-06, "add_states_from_episodes_to_batch": 1.6476166471127823e-06, "add_observations_from_episodes_to_batch": 1.2127286754245326e-05, "batch_individual_items": 8.217243304676124e-06, "add_time_dim_to_batch_and_zero_pad": 2.442643845005892e-06, "numpy_to_tensor": 9.157669418430238e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3959986467380077e-06, "add_observations_from_episodes_to_batch": 3.1187504646368325e-05, "batch_individual_items": 2.408349610050209e-05, "add_time_dim_to_batch_and_zero_pad": 7.749997166683897e-06, "numpy_to_tensor": 2.654150011949241e-05, "agent_to_module_mapping": 5.249999958323315e-06}}, "sample": 0.1057739837506682, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.6590654517058875e-06, "get_actions": 3.474011505297884e-05, "remove_single_ts_time_rank_from_batch": 6.413851144982522e-07, "normalize_and_clip_actions": 3.850722236417076e-05, "tensor_to_numpy": 1.5788254318065785e-05, "un_batch_to_individual_items": 1.2746535334342605e-05, "module_to_agent_unmapping": 1.6029977601636418e-06}}, "connector_pipeline_timer": 0.0001398336204295709}, "rlmodule_inference_timer": 8.814977563693382e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 25854.0, "vehicle_0": 28296.0, "vehicle_3": 25335.999999999996, "vehicle_1": 26302.0}, "env_step_timer": 0.00010881620405155889, "agent_episode_returns_mean": {"vehicle_2": -345.97835111379624, "vehicle_0": -357.7177384018897, "vehicle_3": -290.00578083038334, "vehicle_1": -73.18315100789069}, "env_reset_timer": 8.043749767239206e-05, "num_episodes": 22.0, "env_to_module_sum_episodes_length_out": 48.532916688509076, "episode_return_mean": -1066.8850195419789, "num_agent_steps_sampled": {"vehicle_2": 1912.0, "vehicle_0": 1714.0000000000002, "vehicle_3": 1595.0, "vehicle_1": 1722.0}, "episode_len_min": 61, "episode_len_mean": 88.58, "module_episode_returns_mean": {"shared_policy": -570.1204810380935}, "episode_return_min": -2764.758493542671, "num_env_steps_sampled_lifetime": 32000.0, "env_to_module_sum_episodes_length_in": 48.532916688509076, "num_module_steps_sampled": {"shared_policy": 6943.0}, "episode_duration_sec_mean": 0.050691945900034625, "episode_len_max": 272, "time_between_sampling": 0.31647483495934725, "connector_pipeline_timer": 0.0002163540011679288, "weights_seq_no": 6.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 324.00000000000006, "num_env_steps_sampled_lifetime_throughput": 1922.6543746092045}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002619852292108583, "add_time_dim_to_batch_and_zero_pad": 1.1167803517419146e-05, "numpy_to_tensor": 0.00012268991655927983, "add_one_ts_to_episodes_and_truncate": 0.004812319299337648, "add_states_from_episodes_to_batch": 4.311554833812918e-06, "batch_individual_items": 0.10428136486195876, "general_advantage_estimation": 0.013329589241753289, "add_columns_from_episodes_to_train_batch": 0.03925341062963079, "add_observations_from_episodes_to_batch": 0.0003586159568574489}}, "connector_pipeline_timer": 0.16499415329675565}, "num_module_steps_trained_lifetime": 477696, "num_module_steps_trained": 71552, "num_env_steps_trained_lifetime": 7464000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1118000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1118344.833835533, "num_module_steps_trained_throughput": 71577.17237262744, "num_module_steps_trained_lifetime_throughput": 71575.6918580742}, "shared_policy": {"vf_loss_unclipped": 2456.88134765625, "weights_seq_no": 7.0, "mean_kl_loss": 0.01042360533028841, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 71552, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.684121131896973, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.0049810465425252914, "gradients_default_optimizer_global_norm": 1.1026281118392944, "entropy": 0.884635865688324, "vf_explained_var": 0.01899343729019165, "curr_kl_coeff": 0.20000000298023224, "num_module_steps_trained_lifetime": 477696, "total_loss": 9.672379493713379, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71577.85859649084}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "c13e0_00000", "date": "2025-06-25_18-50-28", "timestamp": 1750902628, "time_this_iter_s": 1.7717759609222412, "time_total_s": 73.3682050704956, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef16c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.3682050704956, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.433333333333334, "ram_util_percent": 52.29999999999999}}
{"timers": {"training_iteration": 2.2325830444297354, "restore_env_runners": 4.952364043129947e-05, "training_step": 2.2324283737225668, "env_runner_sampling_timer": 1.1882210039048027, "learner_update_timer": 1.0423815724339789, "synch_weights": 0.000795804077324035, "synch_env_connectors": 0.0008456211136360979}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 112852.00000000001}, "agent_steps": {"vehicle_0": 74.28, "vehicle_3": 74.28, "vehicle_1": 73.61999999999999, "vehicle_2": 73.45999999999998}, "episode_return_max": -666.9242386817932, "env_to_module_connector": {"connector_pipeline_timer": 6.266395070410942e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5697896490351256e-06, "add_states_from_episodes_to_batch": 1.6438730246916956e-06, "add_observations_from_episodes_to_batch": 1.2374760060369035e-05, "batch_individual_items": 8.335421687175091e-06, "add_time_dim_to_batch_and_zero_pad": 2.518218289355035e-06, "numpy_to_tensor": 9.244664407435617e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3959986467380077e-06, "add_observations_from_episodes_to_batch": 3.1187504646368325e-05, "batch_individual_items": 2.408349610050209e-05, "add_time_dim_to_batch_and_zero_pad": 7.749997166683897e-06, "numpy_to_tensor": 2.654150011949241e-05, "agent_to_module_mapping": 5.249999958323315e-06}}, "sample": 0.10611974460502241, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.817683161504904e-06, "get_actions": 3.463724444641002e-05, "remove_single_ts_time_rank_from_batch": 6.660244558154335e-07, "normalize_and_clip_actions": 3.9747921488459205e-05, "tensor_to_numpy": 1.6018173943540332e-05, "un_batch_to_individual_items": 1.3256004184206924e-05, "module_to_agent_unmapping": 1.6464041185437064e-06}}, "connector_pipeline_timer": 0.00014221552508941849}, "rlmodule_inference_timer": 6.339793618866089e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 27582.0, "vehicle_0": 30098.0, "vehicle_3": 27137.999999999996, "vehicle_1": 28034.0}, "env_step_timer": 0.00010995078499300551, "agent_episode_returns_mean": {"vehicle_2": -265.3339386844635, "vehicle_0": -295.33035284519195, "vehicle_3": -236.44840264797213, "vehicle_1": -38.475157481431964}, "env_reset_timer": 8.043749767239206e-05, "num_episodes": 23.999999999999996, "env_to_module_sum_episodes_length_out": 37.412177210414164, "episode_return_mean": -835.5878499042989, "num_agent_steps_sampled": {"vehicle_2": 1728.0, "vehicle_0": 1802.0, "vehicle_3": 1802.0, "vehicle_1": 1732.0}, "episode_len_min": 64, "episode_len_mean": 81.92, "module_episode_returns_mean": {"shared_policy": -400.4379086971283}, "episode_return_min": -1207.7015184164047, "num_env_steps_sampled_lifetime": 34000.0, "env_to_module_sum_episodes_length_in": 37.412177210414164, "num_module_steps_sampled": {"shared_policy": 7063.999999999999}, "episode_duration_sec_mean": 0.044223005819512766, "episode_len_max": 145, "time_between_sampling": 0.31247305830354755, "connector_pipeline_timer": 0.0002163540011679288, "weights_seq_no": 7.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 348.00000000000006, "num_env_steps_sampled_lifetime_throughput": 1887.6181977219478}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026225125191983376, "add_time_dim_to_batch_and_zero_pad": 1.1139455424089523e-05, "numpy_to_tensor": 0.00012233135738744515, "add_one_ts_to_episodes_and_truncate": 0.004818694436335747, "add_states_from_episodes_to_batch": 4.289269260730554e-06, "batch_individual_items": 0.10359533705338843, "general_advantage_estimation": 0.013343472929352866, "add_columns_from_episodes_to_train_batch": 0.039321729023371194, "add_observations_from_episodes_to_batch": 0.0003597918772775971}}, "connector_pipeline_timer": 0.16439929051378413}, "num_module_steps_trained_lifetime": 550656, "num_module_steps_trained": 72960, "num_env_steps_trained_lifetime": 8604000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1140000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1118691.139409797, "num_module_steps_trained_throughput": 71599.08036836542, "num_module_steps_trained_lifetime_throughput": 71597.73619650201}, "shared_policy": {"vf_loss_unclipped": 2066.4326171875, "weights_seq_no": 8.0, "mean_kl_loss": 0.020124446600675583, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 72960, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.63200569152832, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.05695190280675888, "gradients_default_optimizer_global_norm": 1.3443509340286255, "entropy": 0.8996220231056213, "vf_explained_var": 0.027261018753051758, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 550656, "total_loss": 9.68398666381836, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71599.64414820787}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "c13e0_00000", "date": "2025-06-25_18-50-29", "timestamp": 1750902629, "time_this_iter_s": 1.7651872634887695, "time_total_s": 75.13339233398438, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721b600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.13339233398438, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.8, "ram_util_percent": 51.8}}
{"timers": {"training_iteration": 2.8450827273154355, "restore_env_runners": 4.908757400605399e-05, "training_step": 2.8449279729053685, "env_runner_sampling_timer": 1.7984455759457636, "learner_update_timer": 1.044649379619627, "synch_weights": 0.0007990785365153299, "synch_env_connectors": 0.0008450161524746564}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 119962.0}, "agent_steps": {"vehicle_0": 67.30000000000001, "vehicle_3": 67.30000000000001, "vehicle_1": 59.92000000000001, "vehicle_2": 59.92000000000001}, "episode_return_max": -261.59147465229034, "env_to_module_connector": {"connector_pipeline_timer": 6.10527555733186e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.496737326693178e-06, "add_states_from_episodes_to_batch": 1.5794858535406807e-06, "add_observations_from_episodes_to_batch": 1.2147616422657168e-05, "batch_individual_items": 8.076870013484165e-06, "add_time_dim_to_batch_and_zero_pad": 2.3975862925365077e-06, "numpy_to_tensor": 8.978906209586976e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5463985113892682e-06, "add_observations_from_episodes_to_batch": 3.263750404585153e-05, "batch_individual_items": 2.518389737815596e-05, "add_time_dim_to_batch_and_zero_pad": 8.549994527129457e-06, "numpy_to_tensor": 3.1741103157401085e-05, "agent_to_module_mapping": 5.516401870409027e-06}}, "sample": 0.10327035439450709, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.733548444383755e-06, "get_actions": 3.4374266168374376e-05, "remove_single_ts_time_rank_from_batch": 6.522767558866266e-07, "normalize_and_clip_actions": 3.910831327015366e-05, "tensor_to_numpy": 1.5689764988691884e-05, "un_batch_to_individual_items": 1.2721566115390698e-05, "module_to_agent_unmapping": 1.616688549279273e-06}}, "connector_pipeline_timer": 0.0001396272247782848}, "rlmodule_inference_timer": 6.385152893531846e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 29271.0, "vehicle_0": 31964.0, "vehicle_3": 29004.0, "vehicle_1": 29723.0}, "env_step_timer": 0.00010773746794355606, "agent_episode_returns_mean": {"vehicle_2": -192.5535601067543, "vehicle_0": -258.12079439640047, "vehicle_3": -160.71478634595871, "vehicle_1": 9.155721554756166}, "env_reset_timer": 8.668749578646384e-05, "num_episodes": 28.999999999999996, "env_to_module_sum_episodes_length_out": 33.43770138290093, "episode_return_mean": -602.2334198379517, "num_agent_steps_sampled": {"vehicle_2": 1689.0000000000002, "vehicle_0": 1865.9999999999998, "vehicle_3": 1865.9999999999998, "vehicle_1": 1689.0000000000002}, "episode_len_min": 50, "episode_len_mean": 70.66, "module_episode_returns_mean": {"shared_policy": -259.8218021273613}, "episode_return_min": -956.8770153522491, "num_env_steps_sampled_lifetime": 36000.0, "env_to_module_sum_episodes_length_in": 33.43770138290093, "num_module_steps_sampled": {"shared_policy": 7110.0}, "episode_duration_sec_mean": 0.03758907664028811, "episode_len_max": 93, "time_between_sampling": 0.9213709076898267, "connector_pipeline_timer": 0.00022843720435048454, "weights_seq_no": 8.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 377.0, "num_env_steps_sampled_lifetime_throughput": 1879.8775842367609}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026268386440262796, "add_time_dim_to_batch_and_zero_pad": 1.1106810887413372e-05, "numpy_to_tensor": 0.00012208054386994831, "add_one_ts_to_episodes_and_truncate": 0.004830817071975766, "add_states_from_episodes_to_batch": 4.268466593718637e-06, "batch_individual_items": 0.1037389028528912, "general_advantage_estimation": 0.013366439040046665, "add_columns_from_episodes_to_train_batch": 0.03940276548313623, "add_observations_from_episodes_to_batch": 0.00036075686853984085}}, "connector_pipeline_timer": 0.16466316468865444}, "num_module_steps_trained_lifetime": 624384, "num_module_steps_trained": 73728, "num_env_steps_trained_lifetime": 9756000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1152000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1118611.8251639598, "num_module_steps_trained_throughput": 71593.77135016478, "num_module_steps_trained_lifetime_throughput": 71592.51392449072}, "shared_policy": {"vf_loss_unclipped": 1081.2835693359375, "weights_seq_no": 9.0, "mean_kl_loss": 0.01836637780070305, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 73728, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.290258407592773, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.05143028870224953, "gradients_default_optimizer_global_norm": 2.43678879737854, "entropy": 0.7854541540145874, "vf_explained_var": 0.1977546215057373, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 624384, "total_loss": 9.236482620239258, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71594.25169317737}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-33", "timestamp": 1750902693, "time_this_iter_s": 63.48445987701416, "time_total_s": 138.61785221099854, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x102611a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.61785221099854, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.135164835164835, "ram_util_percent": 51.77362637362639}}
{"timers": {"training_iteration": 2.8347236612923155, "restore_env_runners": 9.140878829837818e-05, "training_step": 2.834526049016341, "env_runner_sampling_timer": 1.7865434397662516, "learner_update_timer": 1.0461461162434325, "synch_weights": 0.0007990006711231999, "synch_env_connectors": 0.0008456009909890579}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 195950.0}, "agent_steps": {"vehicle_0": 61.33, "vehicle_3": 61.33, "vehicle_1": 61.36000000000002, "vehicle_2": 61.36000000000002}, "episode_return_max": -87.15121757984161, "env_to_module_connector": {"connector_pipeline_timer": 6.381746958116879e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5890365519845096e-06, "add_states_from_episodes_to_batch": 1.6402899247388974e-06, "add_observations_from_episodes_to_batch": 1.2565722016832014e-05, "batch_individual_items": 8.595823640849606e-06, "add_time_dim_to_batch_and_zero_pad": 2.485812052690594e-06, "numpy_to_tensor": 9.314797589709001e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10783586703919401, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.9990407003458625e-06, "get_actions": 3.734183758912733e-05, "remove_single_ts_time_rank_from_batch": 6.633436595802711e-07, "normalize_and_clip_actions": 4.13517852030235e-05, "tensor_to_numpy": 1.726912536362125e-05, "un_batch_to_individual_items": 1.3326103686679496e-05, "module_to_agent_unmapping": 1.6379334427767665e-06}}, "connector_pipeline_timer": 0.0001485787298580946}, "rlmodule_inference_timer": 6.59921215940479e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 46976.999999999985, "vehicle_0": 51873.000000000015, "vehicle_3": 49023.000000000015, "vehicle_1": 48076.999999999985}, "env_step_timer": 0.00010413915238490852, "agent_episode_returns_mean": {"vehicle_2": -146.19419031471014, "vehicle_0": -186.838270817101, "vehicle_3": -75.70587119370697, "vehicle_1": 69.22091539680957}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 30.0, "env_to_module_sum_episodes_length_out": 30.422431105219083, "episode_return_mean": -339.51741780310863, "num_agent_steps_sampled": {"vehicle_2": 1815.9999999999998, "vehicle_0": 1802.0, "vehicle_3": 1802.0, "vehicle_1": 1815.9999999999998}, "episode_len_min": 53, "episode_len_mean": 66.755, "module_episode_returns_mean": {"shared_policy": -116.90654079228639}, "episode_return_min": -613.7259436845779, "num_env_steps_sampled_lifetime": 57000.0, "env_to_module_sum_episodes_length_in": 30.422431105219083, "num_module_steps_sampled": {"shared_policy": 7236.000000000001}, "episode_duration_sec_mean": 0.036017601288276635, "episode_len_max": 85, "time_between_sampling": 0.6094515869849574, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 9.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 669.0, "num_env_steps_sampled_lifetime_throughput": 1868.5440842260325}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026310652576141845, "add_time_dim_to_batch_and_zero_pad": 1.1085742809007456e-05, "numpy_to_tensor": 0.0001217255684379088, "add_one_ts_to_episodes_and_truncate": 0.00484396473125635, "add_states_from_episodes_to_batch": 4.255781937937524e-06, "batch_individual_items": 0.10307944215434321, "general_advantage_estimation": 0.01338524089964765, "add_columns_from_episodes_to_train_batch": 0.03948458032832306, "add_observations_from_episodes_to_batch": 0.0003619480498691853}}, "connector_pipeline_timer": 0.16412161762174426}, "num_module_steps_trained_lifetime": 699520, "num_module_steps_trained": 75136, "num_env_steps_trained_lifetime": 10930000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1174000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1117228.2962881185, "num_module_steps_trained_throughput": 71504.92996430109, "num_module_steps_trained_lifetime_throughput": 71503.83625378774}, "shared_policy": {"vf_loss_unclipped": 983.371337890625, "weights_seq_no": 10.0, "mean_kl_loss": 0.011870824731886387, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 75136, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.504571914672852, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.1192190870642662, "gradients_default_optimizer_global_norm": 2.3350236415863037, "entropy": 0.8425709009170532, "vf_explained_var": 0.297726035118103, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 699520, "total_loss": 9.618927001953125, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71505.26023645424}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 57000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-35", "timestamp": 1750902695, "time_this_iter_s": 1.8113648891448975, "time_total_s": 140.42921710014343, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef07c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 140.42921710014343, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.85, "ram_util_percent": 51.849999999999994}}
{"timers": {"training_iteration": 2.8237391130094234, "restore_env_runners": 9.055053043887871e-05, "training_step": 2.823541318106142, "env_runner_sampling_timer": 1.7746557724486285, "learner_update_timer": 1.047045470910974, "synch_weights": 0.0007984314944185627, "synch_env_connectors": 0.0008482012310840801}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 202840.99999999994}, "agent_steps": {"vehicle_0": 57.61999999999998, "vehicle_3": 57.61999999999998, "vehicle_1": 64.0, "vehicle_2": 63.92}, "episode_return_max": 295.48564541339874, "env_to_module_connector": {"connector_pipeline_timer": 6.265205159821787e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5347214092342466e-06, "add_states_from_episodes_to_batch": 1.635987391152206e-06, "add_observations_from_episodes_to_batch": 1.227982377918423e-05, "batch_individual_items": 8.300314014083408e-06, "add_time_dim_to_batch_and_zero_pad": 2.5474855833339356e-06, "numpy_to_tensor": 9.273154424535572e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10807875385376553, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.7686072470132195e-06, "get_actions": 3.5215717038352224e-05, "remove_single_ts_time_rank_from_batch": 6.769107726337887e-07, "normalize_and_clip_actions": 3.9256614466009736e-05, "tensor_to_numpy": 1.618924174620525e-05, "un_batch_to_individual_items": 1.2879890553117705e-05, "module_to_agent_unmapping": 1.6218768853078236e-06}}, "connector_pipeline_timer": 0.0001424398704963444}, "rlmodule_inference_timer": 6.246972926349471e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 48789.999999999985, "vehicle_0": 53504.000000000015, "vehicle_3": 50654.000000000015, "vehicle_1": 49892.999999999985}, "env_step_timer": 0.0001056216811002206, "agent_episode_returns_mean": {"vehicle_2": -75.36293226838114, "vehicle_0": -115.26800702452661, "vehicle_3": -3.9366099548339846, "vehicle_1": 103.71368602514265}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 33.806843036713246, "episode_return_mean": -90.85386305570603, "num_agent_steps_sampled": {"vehicle_2": 1813.0, "vehicle_0": 1630.9999999999998, "vehicle_3": 1630.9999999999998, "vehicle_1": 1815.9999999999998}, "episode_len_min": 49, "episode_len_mean": 69.48, "module_episode_returns_mean": {"shared_policy": -32.764698572158814}, "episode_return_min": -396.7286363840103, "num_env_steps_sampled_lifetime": 59000.0, "env_to_module_sum_episodes_length_in": 33.806843036713246, "num_module_steps_sampled": {"shared_policy": 6891.000000000001}, "episode_duration_sec_mean": 0.03708339158096351, "episode_len_max": 106, "time_between_sampling": 0.5346939113689245, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 10.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 697.0000000000001, "num_env_steps_sampled_lifetime_throughput": 1861.4372267520148}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026355279350376896, "add_time_dim_to_batch_and_zero_pad": 1.1071555354490096e-05, "numpy_to_tensor": 0.00012137789278874402, "add_one_ts_to_episodes_and_truncate": 0.004857438003935086, "add_states_from_episodes_to_batch": 4.239064172707888e-06, "batch_individual_items": 0.10240092398285042, "general_advantage_estimation": 0.013409498490626014, "add_columns_from_episodes_to_train_batch": 0.039556935354992905, "add_observations_from_episodes_to_batch": 0.00036380648942867683}}, "connector_pipeline_timer": 0.16355839144550297}, "num_module_steps_trained_lifetime": 771200, "num_module_steps_trained": 71680, "num_env_steps_trained_lifetime": 12050000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1120000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1114954.353622036, "num_module_steps_trained_throughput": 71359.2110886838, "num_module_steps_trained_lifetime_throughput": 71358.19231548818}, "shared_policy": {"vf_loss_unclipped": 501.7265625, "weights_seq_no": 11.0, "mean_kl_loss": 0.01495406124740839, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 71680, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.737076759338379, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.17730613052845, "gradients_default_optimizer_global_norm": 3.5308315753936768, "entropy": 0.7023810744285583, "vf_explained_var": 0.4160333275794983, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 771200, "total_loss": 8.557231903076172, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71359.41913865469}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 59000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-36", "timestamp": 1750902696, "time_this_iter_s": 1.7383179664611816, "time_total_s": 142.16753506660461, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3171c8860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 142.16753506660461, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 13.799999999999999, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 2.8134976468793975, "restore_env_runners": 8.969460511038365e-05, "training_step": 2.813300289505096, "env_runner_sampling_timer": 1.763360991394143, "learner_update_timer": 1.0480952149518683, "synch_weights": 0.0007981292595057497, "synch_env_connectors": 0.0008496788087979033}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 209766.99999999994}, "agent_steps": {"vehicle_0": 52.06, "vehicle_3": 52.06, "vehicle_1": 62.8, "vehicle_2": 62.68}, "episode_return_max": 515.256630063057, "env_to_module_connector": {"connector_pipeline_timer": 6.239997154211543e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5097497751316964e-06, "add_states_from_episodes_to_batch": 1.6535443819005062e-06, "add_observations_from_episodes_to_batch": 1.2342928691527925e-05, "batch_individual_items": 8.298193369668951e-06, "add_time_dim_to_batch_and_zero_pad": 2.462303433662074e-06, "numpy_to_tensor": 9.140375560759551e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10838849948478439, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.790708686735726e-06, "get_actions": 3.4444537373578874e-05, "remove_single_ts_time_rank_from_batch": 6.599785648957673e-07, "normalize_and_clip_actions": 3.9365277683703966e-05, "tensor_to_numpy": 1.608260047162885e-05, "un_batch_to_individual_items": 1.288001581394299e-05, "module_to_agent_unmapping": 1.5983216113745543e-06}}, "connector_pipeline_timer": 0.00014126682245017123}, "rlmodule_inference_timer": 8.921780949105087e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 50663.99999999999, "vehicle_0": 55092.000000000015, "vehicle_3": 52242.000000000015, "vehicle_1": 51768.999999999985}, "env_step_timer": 0.00010424410707977326, "agent_episode_returns_mean": {"vehicle_2": -45.15758645534515, "vehicle_0": -67.50343210220336, "vehicle_3": 28.99461559295655, "vehicle_1": 135.27827282428737}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 32.0, "env_to_module_sum_episodes_length_out": 29.848796630824335, "episode_return_mean": 51.61186978816986, "num_agent_steps_sampled": {"vehicle_2": 1874.0000000000002, "vehicle_0": 1588.0, "vehicle_3": 1588.0, "vehicle_1": 1875.9999999999998}, "episode_len_min": 50, "episode_len_mean": 65.74, "module_episode_returns_mean": {"shared_policy": 19.720752425193787}, "episode_return_min": -219.34156477451324, "num_env_steps_sampled_lifetime": 61000.0, "env_to_module_sum_episodes_length_in": 29.848796630824335, "num_module_steps_sampled": {"shared_policy": 6926.000000000001}, "episode_duration_sec_mean": 0.03693163258038112, "episode_len_max": 106, "time_between_sampling": 0.520231044158004, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 11.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 729.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1858.8865082534787}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002640450155707536, "add_time_dim_to_batch_and_zero_pad": 1.1047089802859064e-05, "numpy_to_tensor": 0.00012104536380448827, "add_one_ts_to_episodes_and_truncate": 0.0048723023738988505, "add_states_from_episodes_to_batch": 4.220013566094315e-06, "batch_individual_items": 0.10173684891299561, "general_advantage_estimation": 0.013422808505744928, "add_columns_from_episodes_to_train_batch": 0.03962085725144631, "add_observations_from_episodes_to_batch": 0.0003652588345842784}}, "connector_pipeline_timer": 0.16299148211106737}, "num_module_steps_trained_lifetime": 843392, "num_module_steps_trained": 72192, "num_env_steps_trained_lifetime": 13178000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1128000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1115007.0527874378, "num_module_steps_trained_throughput": 71362.52803770188, "num_module_steps_trained_lifetime_throughput": 71361.53643229579}, "shared_policy": {"vf_loss_unclipped": 564.4547729492188, "weights_seq_no": 12.0, "mean_kl_loss": 0.010577523149549961, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 72192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.242169380187988, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.10128345340490341, "gradients_default_optimizer_global_norm": 3.0102860927581787, "entropy": 0.7198609113693237, "vf_explained_var": 0.3506687879562378, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 843392, "total_loss": 9.339427947998047, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71362.74973672646}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 61000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-38", "timestamp": 1750902698, "time_this_iter_s": 1.8016080856323242, "time_total_s": 143.96914315223694, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3171c89a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 143.96914315223694, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.200000000000003, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 2.803094366660579, "restore_env_runners": 8.885056902269481e-05, "training_step": 2.8028976099400786, "env_runner_sampling_timer": 1.7516427189802477, "learner_update_timer": 1.0494072994723371, "synch_weights": 0.0007979146268934276, "synch_env_connectors": 0.0008510991107020106}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 216466.99999999994}, "agent_steps": {"vehicle_0": 47.34, "vehicle_3": 47.34, "vehicle_1": 64.46, "vehicle_2": 64.06}, "episode_return_max": 501.19737082719803, "env_to_module_connector": {"connector_pipeline_timer": 6.276560617585464e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5126416791053514e-06, "add_states_from_episodes_to_batch": 1.6273812761123408e-06, "add_observations_from_episodes_to_batch": 1.219583884075525e-05, "batch_individual_items": 8.39052119326864e-06, "add_time_dim_to_batch_and_zero_pad": 2.49106067641923e-06, "numpy_to_tensor": 9.228388124851523e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10859470068709982, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.641103453288508e-06, "get_actions": 3.490019321106838e-05, "remove_single_ts_time_rank_from_batch": 6.80888248011355e-07, "normalize_and_clip_actions": 3.7956538773631395e-05, "tensor_to_numpy": 1.6065970941038635e-05, "un_batch_to_individual_items": 1.2536968056747876e-05, "module_to_agent_unmapping": 1.6184933171885788e-06}}, "connector_pipeline_timer": 0.0001400045732782796}, "rlmodule_inference_timer": 6.114753801608729e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 52607.999999999985, "vehicle_0": 56492.00000000002, "vehicle_3": 53642.00000000002, "vehicle_1": 53724.999999999985}, "env_step_timer": 0.00010336266009301587, "agent_episode_returns_mean": {"vehicle_2": -0.08989185810089281, "vehicle_0": -24.330442093610763, "vehicle_3": 75.23722888231278, "vehicle_1": 167.00039235711097}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 31.000000000000004, "env_to_module_sum_episodes_length_out": 32.88855185447626, "episode_return_mean": 217.81728723525998, "num_agent_steps_sampled": {"vehicle_2": 1944.0000000000002, "vehicle_0": 1400.0, "vehicle_3": 1400.0, "vehicle_1": 1955.9999999999998}, "episode_len_min": 44, "episode_len_mean": 65.74, "module_episode_returns_mean": {"shared_policy": 89.82838721513748}, "episode_return_min": -113.91745257377625, "num_env_steps_sampled_lifetime": 63000.0, "env_to_module_sum_episodes_length_in": 32.88855185447626, "num_module_steps_sampled": {"shared_policy": 6700.0}, "episode_duration_sec_mean": 0.03463639910056372, "episode_len_max": 105, "time_between_sampling": 0.5066734498341493, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 12.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 760.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1882.577050652839}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026450935741338544, "add_time_dim_to_batch_and_zero_pad": 1.1017868868671873e-05, "numpy_to_tensor": 0.00012069491016654583, "add_one_ts_to_episodes_and_truncate": 0.004883645190167017, "add_states_from_episodes_to_batch": 4.203233443550044e-06, "batch_individual_items": 0.10185373625383135, "general_advantage_estimation": 0.013430014580719556, "add_columns_from_episodes_to_train_batch": 0.03966742617892495, "add_observations_from_episodes_to_batch": 0.0003665291561770495}}, "connector_pipeline_timer": 0.1631781418699637}, "num_module_steps_trained_lifetime": 913280, "num_module_steps_trained": 69888, "num_env_steps_trained_lifetime": 14270000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1092000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1112941.8539868612, "num_module_steps_trained_throughput": 71230.2325251397, "num_module_steps_trained_lifetime_throughput": 71229.28132111479}, "shared_policy": {"vf_loss_unclipped": 729.96044921875, "weights_seq_no": 13.0, "mean_kl_loss": 0.009797021746635437, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 69888, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.317692756652832, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.10478135943412781, "gradients_default_optimizer_global_norm": 2.3568859100341797, "entropy": 0.7057515382766724, "vf_explained_var": 0.30738919973373413, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 913280, "total_loss": 9.418355941772461, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71230.44461301606}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 63000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-40", "timestamp": 1750902700, "time_this_iter_s": 1.7751479148864746, "time_total_s": 145.7442910671234, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721a7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 145.7442910671234, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.833333333333332, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 2.792394405493962, "restore_env_runners": 8.80033133555274e-05, "training_step": 2.7921982355006265, "env_runner_sampling_timer": 1.740140331370486, "learner_update_timer": 1.0502049248176055, "synch_weights": 0.0007996009006269137, "synch_env_connectors": 0.0008526951996105772}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 223266.99999999994}, "agent_steps": {"vehicle_0": 47.0, "vehicle_3": 47.0, "vehicle_1": 57.14, "vehicle_2": 56.82}, "episode_return_max": 683.0485582351685, "env_to_module_connector": {"connector_pipeline_timer": 6.261453384193762e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.553911964256803e-06, "add_states_from_episodes_to_batch": 1.6343337803616324e-06, "add_observations_from_episodes_to_batch": 1.2171993992000616e-05, "batch_individual_items": 8.176011121934353e-06, "add_time_dim_to_batch_and_zero_pad": 2.535817486169086e-06, "numpy_to_tensor": 9.29713138270909e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10874723163802755, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.703627829488994e-06, "get_actions": 3.591624754781092e-05, "remove_single_ts_time_rank_from_batch": 6.616699072490458e-07, "normalize_and_clip_actions": 3.83513948117219e-05, "tensor_to_numpy": 1.6228972353649564e-05, "un_batch_to_individual_items": 1.2593823454044863e-05, "module_to_agent_unmapping": 1.6224313782745467e-06}}, "connector_pipeline_timer": 0.00014185951970246044}, "rlmodule_inference_timer": 6.271392395023915e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 54488.999999999985, "vehicle_0": 58004.00000000003, "vehicle_3": 55154.00000000003, "vehicle_1": 55619.999999999985}, "env_step_timer": 0.00010535085381102511, "agent_episode_returns_mean": {"vehicle_2": 13.635414938926699, "vehicle_0": -9.070605874061584, "vehicle_3": 112.41735470294954, "vehicle_1": 156.9510560441017}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 33.0, "env_to_module_sum_episodes_length_out": 32.21643423463833, "episode_return_mean": 273.9332197928429, "num_agent_steps_sampled": {"vehicle_2": 1880.9999999999998, "vehicle_0": 1512.0, "vehicle_3": 1512.0, "vehicle_1": 1895.0}, "episode_len_min": 44, "episode_len_mean": 59.51999999999999, "module_episode_returns_mean": {"shared_policy": 119.69238842248919}, "episode_return_min": 66.45073366165161, "num_env_steps_sampled_lifetime": 65000.0, "env_to_module_sum_episodes_length_in": 32.21643423463833, "num_module_steps_sampled": {"shared_policy": 6800.0}, "episode_duration_sec_mean": 0.03188682178093587, "episode_len_max": 99, "time_between_sampling": 0.49391031067579333, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 13.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 793.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1885.0062407514101}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002648318888443641, "add_time_dim_to_batch_and_zero_pad": 1.0989350144038115e-05, "numpy_to_tensor": 0.00012037088105906325, "add_one_ts_to_episodes_and_truncate": 0.004896260818309893, "add_states_from_episodes_to_batch": 4.182031157129884e-06, "batch_individual_items": 0.1011853447312772, "general_advantage_estimation": 0.01344872152496041, "add_columns_from_episodes_to_train_batch": 0.039727466497131304, "add_observations_from_episodes_to_batch": 0.00036773886462855034}}, "connector_pipeline_timer": 0.16260435587131525}, "num_module_steps_trained_lifetime": 984320, "num_module_steps_trained": 71040, "num_env_steps_trained_lifetime": 15380000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1110000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1110585.7920212909, "num_module_steps_trained_throughput": 71079.33303823364, "num_module_steps_trained_lifetime_throughput": 71078.42667973379}, "shared_policy": {"vf_loss_unclipped": 1076.6199951171875, "weights_seq_no": 14.0, "mean_kl_loss": 0.007703671231865883, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 71040, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.655977249145508, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.02817750722169876, "gradients_default_optimizer_global_norm": 2.351389169692993, "entropy": 0.6602644920349121, "vf_explained_var": 0.21710729598999023, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 984320, "total_loss": 9.623507499694824, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71079.53484586638}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 65000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-42", "timestamp": 1750902702, "time_this_iter_s": 1.735563039779663, "time_total_s": 147.47985410690308, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721bf60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.47985410690308, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.3, "ram_util_percent": 52.150000000000006}}
{"timers": {"training_iteration": 2.781712831029044, "restore_env_runners": 8.716661022303485e-05, "training_step": 2.7815172531456147, "env_runner_sampling_timer": 1.7286166268067542, "learner_update_timer": 1.0510407247394427, "synch_weights": 0.0008020248916557275, "synch_env_connectors": 0.0008580678276224725}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 229625.99999999994}, "agent_steps": {"vehicle_0": 44.12, "vehicle_3": 44.12, "vehicle_1": 68.94, "vehicle_2": 67.06}, "episode_return_max": 818.5179582834244, "env_to_module_connector": {"connector_pipeline_timer": 6.206766954591123e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.500595933166297e-06, "add_states_from_episodes_to_batch": 1.6489767605310248e-06, "add_observations_from_episodes_to_batch": 1.2018179766791367e-05, "batch_individual_items": 8.113962302757812e-06, "add_time_dim_to_batch_and_zero_pad": 2.4480784174737407e-06, "numpy_to_tensor": 9.187400570030445e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10880973108219796, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.551500710486313e-06, "get_actions": 3.513885680557728e-05, "remove_single_ts_time_rank_from_batch": 6.579459646276194e-07, "normalize_and_clip_actions": 3.692326072497199e-05, "tensor_to_numpy": 1.6246869284405285e-05, "un_batch_to_individual_items": 1.2317145750639482e-05, "module_to_agent_unmapping": 1.6064265910792067e-06}}, "connector_pipeline_timer": 0.00013920604491957013}, "rlmodule_inference_timer": 5.955370605427005e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 56389.999999999985, "vehicle_0": 59257.00000000003, "vehicle_3": 56407.00000000003, "vehicle_1": 57571.999999999985}, "env_step_timer": 0.00010151112744267376, "agent_episode_returns_mean": {"vehicle_2": 87.05347358345985, "vehicle_0": 30.071008563041687, "vehicle_3": 109.00760509967805, "vehicle_1": 219.90107802629467}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 28.999999999999996, "env_to_module_sum_episodes_length_out": 34.55782627702817, "episode_return_mean": 446.0331649386883, "num_agent_steps_sampled": {"vehicle_2": 1900.9999999999998, "vehicle_0": 1253.0, "vehicle_3": 1253.0, "vehicle_1": 1952.0}, "episode_len_min": 42, "episode_len_mean": 69.57999999999998, "module_episode_returns_mean": {"shared_policy": 139.50973655819894}, "episode_return_min": 169.147603392601, "num_env_steps_sampled_lifetime": 67000.0, "env_to_module_sum_episodes_length_in": 34.55782627702817, "num_module_steps_sampled": {"shared_policy": 6358.999999999999}, "episode_duration_sec_mean": 0.035953907300136055, "episode_len_max": 111, "time_between_sampling": 0.4813495316489173, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 14.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 822.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1897.4553213735087}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026511861195681998, "add_time_dim_to_batch_and_zero_pad": 1.0996126622941166e-05, "numpy_to_tensor": 0.00011999676223820743, "add_one_ts_to_episodes_and_truncate": 0.004906212800171673, "add_states_from_episodes_to_batch": 4.166050899708325e-06, "batch_individual_items": 0.10051130961397273, "general_advantage_estimation": 0.013455308479661832, "add_columns_from_episodes_to_train_batch": 0.039758599752204256, "add_observations_from_episodes_to_batch": 0.0003685706359718034}}, "connector_pipeline_timer": 0.1619805685625965}, "num_module_steps_trained_lifetime": 1050624, "num_module_steps_trained": 66304, "num_env_steps_trained_lifetime": 16416000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1036000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1111316.7875190778, "num_module_steps_trained_throughput": 71125.9214843527, "num_module_steps_trained_lifetime_throughput": 71125.03111455809}, "shared_policy": {"vf_loss_unclipped": 1142.646728515625, "weights_seq_no": 15.0, "mean_kl_loss": 0.006470422726124525, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 66304, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.46878719329834, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.06339506804943085, "gradients_default_optimizer_global_norm": 1.9844245910644531, "entropy": 0.5588751435279846, "vf_explained_var": 0.22269552946090698, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1050624, "total_loss": 9.40174388885498, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71126.09759759037}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 67000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-43", "timestamp": 1750902703, "time_this_iter_s": 1.7265470027923584, "time_total_s": 149.20640110969543, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16ab4ee80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 149.20640110969543, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.099999999999998, "ram_util_percent": 52.20000000000001}}
{"timers": {"training_iteration": 2.7697625152187064, "restore_env_runners": 8.635244412208041e-05, "training_step": 2.769567538114126, "env_runner_sampling_timer": 1.717160141788648, "learner_update_timer": 1.0505436037420803, "synch_weights": 0.0008031096427292563, "synch_env_connectors": 0.0008620754793378064}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 235665.99999999994}, "agent_steps": {"vehicle_0": 43.66, "vehicle_3": 43.66, "vehicle_1": 77.1, "vehicle_2": 70.7}, "episode_return_max": 871.5635958909988, "env_to_module_connector": {"connector_pipeline_timer": 6.214153324009997e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4609316445347133e-06, "add_states_from_episodes_to_batch": 1.640218538997902e-06, "add_observations_from_episodes_to_batch": 1.2016812843814587e-05, "batch_individual_items": 8.02119112248403e-06, "add_time_dim_to_batch_and_zero_pad": 2.4971165845067944e-06, "numpy_to_tensor": 9.307624770668342e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10875784316042718, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.448569013977814e-06, "get_actions": 3.577733013728504e-05, "remove_single_ts_time_rank_from_batch": 6.943354031934045e-07, "normalize_and_clip_actions": 3.577306392531946e-05, "tensor_to_numpy": 1.634437870242165e-05, "un_batch_to_individual_items": 1.1931914600484264e-05, "module_to_agent_unmapping": 1.6142365609037882e-06}}, "connector_pipeline_timer": 0.00013837222100784218}, "rlmodule_inference_timer": 6.083956218795381e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 58182.999999999985, "vehicle_0": 60405.00000000003, "vehicle_3": 57555.00000000003, "vehicle_1": 59522.999999999985}, "env_step_timer": 0.00010226506758235446, "agent_episode_returns_mean": {"vehicle_2": 102.01496050357818, "vehicle_0": 64.65528394699096, "vehicle_3": 111.16440925121307, "vehicle_1": 235.60716805696487}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 38.75783609326816, "episode_return_mean": 513.4418216919898, "num_agent_steps_sampled": {"vehicle_2": 1793.0, "vehicle_0": 1148.0, "vehicle_3": 1148.0, "vehicle_1": 1950.9999999999998}, "episode_len_min": 42, "episode_len_mean": 77.54, "module_episode_returns_mean": {"shared_policy": 142.0016367816925}, "episode_return_min": 79.79384434223175, "num_env_steps_sampled_lifetime": 69000.0, "env_to_module_sum_episodes_length_in": 38.75783609326816, "num_module_steps_sampled": {"shared_policy": 6040.0}, "episode_duration_sec_mean": 0.03978395480124163, "episode_len_max": 231, "time_between_sampling": 0.46943460504124757, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 15.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 849.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1894.3775154600457}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002651811338405362, "add_time_dim_to_batch_and_zero_pad": 1.097866533345663e-05, "numpy_to_tensor": 0.00011973388462376286, "add_one_ts_to_episodes_and_truncate": 0.0049122460921997855, "add_states_from_episodes_to_batch": 4.150220404039474e-06, "batch_individual_items": 0.09981895609780723, "general_advantage_estimation": 0.01345421247487519, "add_columns_from_episodes_to_train_batch": 0.039771503754676966, "add_observations_from_episodes_to_batch": 0.0003694253396212982}}, "connector_pipeline_timer": 0.16130658162701275}, "num_module_steps_trained_lifetime": 1113600, "num_module_steps_trained": 62976, "num_env_steps_trained_lifetime": 17400000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 984000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1110080.343856252, "num_module_steps_trained_throughput": 71046.5365747013, "num_module_steps_trained_lifetime_throughput": 71045.80864790328}, "shared_policy": {"vf_loss_unclipped": 1509.6534423828125, "weights_seq_no": 16.0, "mean_kl_loss": 0.008415436372160912, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.56708812713623, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.008293592371046543, "gradients_default_optimizer_global_norm": 2.031871795654297, "entropy": 0.6365014314651489, "vf_explained_var": 0.14486825466156006, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1113600, "total_loss": 9.554954528808594, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 71046.72949419603}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 69000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-45", "timestamp": 1750902705, "time_this_iter_s": 1.5886940956115723, "time_total_s": 150.795095205307, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721a520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 150.795095205307, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 15.1, "ram_util_percent": 52.2}}
{"timers": {"training_iteration": 2.759565780486498, "restore_env_runners": 8.554849973289825e-05, "training_step": 2.7593710069029815, "env_runner_sampling_timer": 1.705974809120746, "learner_update_timer": 1.0515277160347238, "synch_weights": 0.0008032014563052579, "synch_env_connectors": 0.0008635805545572677}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 242094.99999999994}, "agent_steps": {"vehicle_0": 42.79999999999999, "vehicle_3": 42.79999999999999, "vehicle_1": 62.92000000000001, "vehicle_2": 61.12}, "episode_return_max": 995.6951342225075, "env_to_module_connector": {"connector_pipeline_timer": 6.356749531116536e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.605117775335065e-06, "add_states_from_episodes_to_batch": 1.6809338037154866e-06, "add_observations_from_episodes_to_batch": 1.2249695176004782e-05, "batch_individual_items": 8.374764037592708e-06, "add_time_dim_to_batch_and_zero_pad": 2.527094683132121e-06, "numpy_to_tensor": 9.449435147078342e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.1087964779438372, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.6095254714763205e-06, "get_actions": 3.596254073438718e-05, "remove_single_ts_time_rank_from_batch": 6.638550981102451e-07, "normalize_and_clip_actions": 3.7342182457396816e-05, "tensor_to_numpy": 1.637478434308951e-05, "un_batch_to_individual_items": 1.2311228270221728e-05, "module_to_agent_unmapping": 1.6385345432923074e-06}}, "connector_pipeline_timer": 0.00014087490211053315}, "rlmodule_inference_timer": 6.236334468585454e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 60075.999999999985, "vehicle_0": 61701.00000000003, "vehicle_3": 58851.00000000003, "vehicle_1": 61466.999999999985}, "env_step_timer": 0.00010381345843935098, "agent_episode_returns_mean": {"vehicle_2": 111.41154399514198, "vehicle_0": 87.6465777182579, "vehicle_3": 122.14959395170212, "vehicle_1": 232.5014255130291}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 31.000000000000004, "env_to_module_sum_episodes_length_out": 35.10634956512385, "episode_return_mean": 553.7091413879394, "num_agent_steps_sampled": {"vehicle_2": 1893.0, "vehicle_0": 1295.9999999999998, "vehicle_3": 1295.9999999999998, "vehicle_1": 1944.0000000000002}, "episode_len_min": 42, "episode_len_mean": 63.78, "module_episode_returns_mean": {"shared_policy": 193.4168252742291}, "episode_return_min": 304.3099558353424, "num_env_steps_sampled_lifetime": 71000.0, "env_to_module_sum_episodes_length_in": 35.10634956512385, "num_module_steps_sampled": {"shared_policy": 6428.999999999999}, "episode_duration_sec_mean": 0.033677259900432556, "episode_len_max": 100, "time_between_sampling": 0.4568160496663897, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 16.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 880.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1898.918305018681}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026550536450235846, "add_time_dim_to_batch_and_zero_pad": 1.096137865686694e-05, "numpy_to_tensor": 0.00011941112577805243, "add_one_ts_to_episodes_and_truncate": 0.004923687381289866, "add_states_from_episodes_to_batch": 4.1353881498742925e-06, "batch_individual_items": 0.09993570736684078, "general_advantage_estimation": 0.013461237850085347, "add_columns_from_episodes_to_train_batch": 0.03980302121715806, "add_observations_from_episodes_to_batch": 0.0003707019162753823}}, "connector_pipeline_timer": 0.16147661998076912}, "num_module_steps_trained_lifetime": 1180672, "num_module_steps_trained": 67072, "num_env_steps_trained_lifetime": 18448000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1048000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1108611.1092961046, "num_module_steps_trained_throughput": 70952.46143794592, "num_module_steps_trained_lifetime_throughput": 70951.78830075252}, "shared_policy": {"vf_loss_unclipped": 1719.58935546875, "weights_seq_no": 17.0, "mean_kl_loss": 0.008097255602478981, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 67072, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.387484550476074, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.013572245836257935, "gradients_default_optimizer_global_norm": 2.369124412536621, "entropy": 0.49032852053642273, "vf_explained_var": 0.17999327182769775, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1180672, "total_loss": 9.371438026428223, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70952.6178478961}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 71000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-47", "timestamp": 1750902707, "time_this_iter_s": 1.7521750926971436, "time_total_s": 152.54727029800415, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3174234c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 152.54727029800415, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 15.4, "ram_util_percent": 52.2}}
{"timers": {"training_iteration": 2.747756435591619, "restore_env_runners": 8.474135474276639e-05, "training_step": 2.7475623076639564, "env_runner_sampling_timer": 1.6947760926895628, "learner_update_timer": 1.0509152784544036, "synch_weights": 0.0008024365317102868, "synch_env_connectors": 0.0008657489090586682}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 248104.99999999994}, "agent_steps": {"vehicle_0": 44.41999999999999, "vehicle_3": 44.69999999999999, "vehicle_1": 72.98, "vehicle_2": 69.32}, "episode_return_max": 1041.7980887889862, "env_to_module_connector": {"connector_pipeline_timer": 6.326120484604581e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5236674587959674e-06, "add_states_from_episodes_to_batch": 1.7224038756247692e-06, "add_observations_from_episodes_to_batch": 1.20541925196791e-05, "batch_individual_items": 8.196304547571168e-06, "add_time_dim_to_batch_and_zero_pad": 2.528326861647184e-06, "numpy_to_tensor": 9.510236028660389e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10881926948869222, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.536135881438875e-06, "get_actions": 3.583171212582466e-05, "remove_single_ts_time_rank_from_batch": 6.777338966456897e-07, "normalize_and_clip_actions": 3.615951561622125e-05, "tensor_to_numpy": 1.634873711668799e-05, "un_batch_to_individual_items": 1.1937009581406253e-05, "module_to_agent_unmapping": 1.6247269239052625e-06}}, "connector_pipeline_timer": 0.0001392977467322031}, "rlmodule_inference_timer": 5.956243493381978e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 61861.999999999985, "vehicle_0": 62865.00000000003, "vehicle_3": 60022.00000000003, "vehicle_1": 63355.999999999985}, "env_step_timer": 0.0001016202950831537, "agent_episode_returns_mean": {"vehicle_2": 175.79044502019883, "vehicle_0": 105.0522889983654, "vehicle_3": 156.00290498018265, "vehicle_1": 287.8832777154445}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 36.97020099077063, "episode_return_mean": 724.728917210102, "num_agent_steps_sampled": {"vehicle_2": 1785.9999999999998, "vehicle_0": 1164.0000000000002, "vehicle_3": 1170.9999999999998, "vehicle_1": 1889.0000000000002}, "episode_len_min": 41, "episode_len_mean": 75.96, "module_episode_returns_mean": {"shared_policy": 271.2390214776993}, "episode_return_min": 338.45479357242584, "num_env_steps_sampled_lifetime": 73000.0, "env_to_module_sum_episodes_length_in": 36.97020099077063, "num_module_steps_sampled": {"shared_policy": 6010.0}, "episode_duration_sec_mean": 0.039513394240057106, "episode_len_max": 101, "time_between_sampling": 0.4462283557398547, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 17.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 907.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1921.976035145187}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026563418586026807, "add_time_dim_to_batch_and_zero_pad": 1.0933434875172738e-05, "numpy_to_tensor": 0.00011910826454004854, "add_one_ts_to_episodes_and_truncate": 0.004927757587492624, "add_states_from_episodes_to_batch": 4.117374303489055e-06, "batch_individual_items": 0.09925562321319602, "general_advantage_estimation": 0.013458748391624767, "add_columns_from_episodes_to_train_batch": 0.03980178642500626, "add_observations_from_episodes_to_batch": 0.0003711328071129099}}, "connector_pipeline_timer": 0.16079741836095654}, "num_module_steps_trained_lifetime": 1243264, "num_module_steps_trained": 62592, "num_env_steps_trained_lifetime": 19426000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 978000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1107298.5287316996, "num_module_steps_trained_throughput": 70868.24389564514, "num_module_steps_trained_lifetime_throughput": 70867.62947166899}, "shared_policy": {"vf_loss_unclipped": 2117.753662109375, "weights_seq_no": 18.0, "mean_kl_loss": 0.0089642945677042, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62592, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.467794418334961, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.0717255100607872, "gradients_default_optimizer_global_norm": 1.6761704683303833, "entropy": 0.42308124899864197, "vf_explained_var": 0.08597308397293091, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1243264, "total_loss": 9.394527435302734, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70868.32395365128}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 73000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-48", "timestamp": 1750902708, "time_this_iter_s": 1.5806970596313477, "time_total_s": 154.1279673576355, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3174222a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.1279673576355, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 14.333333333333334, "ram_util_percent": 52.20000000000001}}
{"timers": {"training_iteration": 2.7354867120657467, "restore_env_runners": 8.394394113950593e-05, "training_step": 2.7352929658373104, "env_runner_sampling_timer": 1.683431546352677, "learner_update_timer": 1.0499868869198954, "synch_weights": 0.0008023538263987832, "synch_env_connectors": 0.0008678105899179614}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 253818.99999999994}, "agent_steps": {"vehicle_0": 42.34000000000001, "vehicle_3": 42.34000000000001, "vehicle_1": 82.18, "vehicle_2": 77.36}, "episode_return_max": 1101.9560079574585, "env_to_module_connector": {"connector_pipeline_timer": 6.184450192983287e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4529717812235626e-06, "add_states_from_episodes_to_batch": 1.6498824567878516e-06, "add_observations_from_episodes_to_batch": 1.1791356331077654e-05, "batch_individual_items": 7.923509294297124e-06, "add_time_dim_to_batch_and_zero_pad": 2.4585661693753203e-06, "numpy_to_tensor": 9.219445156631601e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10870115593323129, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.245265464103235e-06, "get_actions": 3.530238384891918e-05, "remove_single_ts_time_rank_from_batch": 6.589943696154777e-07, "normalize_and_clip_actions": 3.40922455076833e-05, "tensor_to_numpy": 1.602231928510747e-05, "un_batch_to_individual_items": 1.1359804067958738e-05, "module_to_agent_unmapping": 1.5945531872161536e-06}}, "connector_pipeline_timer": 0.00013506295643522938}, "rlmodule_inference_timer": 5.731706103654028e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 63722.999999999985, "vehicle_0": 63803.00000000003, "vehicle_3": 60960.00000000003, "vehicle_1": 65332.999999999985}, "env_step_timer": 0.00010003508113710371, "agent_episode_returns_mean": {"vehicle_2": 207.37421259164813, "vehicle_0": 111.96708273410798, "vehicle_3": 137.097726855278, "vehicle_1": 378.5281064009667}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 23.0, "env_to_module_sum_episodes_length_out": 42.05414958356167, "episode_return_mean": 834.9671275520324, "num_agent_steps_sampled": {"vehicle_2": 1860.9999999999998, "vehicle_0": 937.9999999999999, "vehicle_3": 937.9999999999999, "vehicle_1": 1977.0}, "episode_len_min": 41, "episode_len_mean": 83.22, "module_episode_returns_mean": {"shared_policy": 302.1669951128959}, "episode_return_min": 459.1105101108551, "num_env_steps_sampled_lifetime": 75000.0, "env_to_module_sum_episodes_length_in": 42.05414958356167, "num_module_steps_sampled": {"shared_policy": 5713.999999999999}, "episode_duration_sec_mean": 0.04179501579943462, "episode_len_max": 100, "time_between_sampling": 0.43460955047157085, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 18.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 930.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1945.7523011371684}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026543771900405235, "add_time_dim_to_batch_and_zero_pad": 1.0908680550543272e-05, "numpy_to_tensor": 0.0001187896819171721, "add_one_ts_to_episodes_and_truncate": 0.00492957459159375, "add_states_from_episodes_to_batch": 4.1016205735708365e-06, "batch_individual_items": 0.09857226448101924, "general_advantage_estimation": 0.013459620487759767, "add_columns_from_episodes_to_train_batch": 0.03979071272081075, "add_observations_from_episodes_to_batch": 0.00037148064906531895}}, "connector_pipeline_timer": 0.16010283084734644}, "num_module_steps_trained_lifetime": 1302656, "num_module_steps_trained": 59392, "num_env_steps_trained_lifetime": 20354000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 928000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1105437.9356363453, "num_module_steps_trained_throughput": 70749.00643911152, "num_module_steps_trained_lifetime_throughput": 70748.39914071294}, "shared_policy": {"vf_loss_unclipped": 2452.043212890625, "weights_seq_no": 19.0, "mean_kl_loss": 0.015460086986422539, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 59392, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.668684005737305, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.004067044239491224, "gradients_default_optimizer_global_norm": 1.285186529159546, "entropy": 0.3771223723888397, "vf_explained_var": 0.06290280818939209, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1302656, "total_loss": 9.673617362976074, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70749.09581006588}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 75000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-50", "timestamp": 1750902710, "time_this_iter_s": 1.5228991508483887, "time_total_s": 155.6508665084839, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317421da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.6508665084839, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 15.200000000000001, "ram_util_percent": 52.2}}
{"timers": {"training_iteration": 2.724254653695095, "restore_env_runners": 8.314616175138199e-05, "training_step": 2.724061520338895, "env_runner_sampling_timer": 1.6724778879692017, "learner_update_timer": 1.0497022347106952, "synch_weights": 0.0008056911181655486, "synch_env_connectors": 0.0008705504040505994}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 259940.99999999994}, "agent_steps": {"vehicle_0": 41.42, "vehicle_3": 41.42, "vehicle_1": 71.47999999999999, "vehicle_2": 67.94}, "episode_return_max": 1099.0091997385025, "env_to_module_connector": {"connector_pipeline_timer": 6.440348445752744e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.561340454665799e-06, "add_states_from_episodes_to_batch": 1.705924756486218e-06, "add_observations_from_episodes_to_batch": 1.2306100469277944e-05, "batch_individual_items": 8.370472917498532e-06, "add_time_dim_to_batch_and_zero_pad": 2.544148352875403e-06, "numpy_to_tensor": 9.756945984203114e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.1086579907412681, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.511289365180665e-06, "get_actions": 3.668933156435831e-05, "remove_single_ts_time_rank_from_batch": 6.815095275507839e-07, "normalize_and_clip_actions": 3.628137152185461e-05, "tensor_to_numpy": 1.6577702397714814e-05, "un_batch_to_individual_items": 1.2047987939793697e-05, "module_to_agent_unmapping": 1.658410399563463e-06}}, "connector_pipeline_timer": 0.00014072080937371122}, "rlmodule_inference_timer": 5.9602486355226955e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 65593.99999999999, "vehicle_0": 64944.00000000003, "vehicle_3": 62101.00000000003, "vehicle_1": 67301.99999999999}, "env_step_timer": 0.0001033483805692648, "agent_episode_returns_mean": {"vehicle_2": 175.95603357315065, "vehicle_0": 110.93525015354156, "vehicle_3": 146.54741955518722, "vehicle_1": 319.0126008796692}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 38.2016436603004, "episode_return_mean": 752.4513038516045, "num_agent_steps_sampled": {"vehicle_2": 1870.9999999999998, "vehicle_0": 1140.9999999999998, "vehicle_3": 1140.9999999999998, "vehicle_1": 1969.0000000000002}, "episode_len_min": 41, "episode_len_mean": 71.56, "module_episode_returns_mean": {"shared_policy": 220.77372017145157}, "episode_return_min": 409.3950252532959, "num_env_steps_sampled_lifetime": 77000.0, "env_to_module_sum_episodes_length_in": 38.2016436603004, "num_module_steps_sampled": {"shared_policy": 6122.0}, "episode_duration_sec_mean": 0.037263437619403705, "episode_len_max": 102, "time_between_sampling": 0.4232025603083386, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 19.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 958.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1937.8364259309092}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026540742581559348, "add_time_dim_to_batch_and_zero_pad": 1.0878753690054565e-05, "numpy_to_tensor": 0.00011837720507398055, "add_one_ts_to_episodes_and_truncate": 0.0049389400956824725, "add_states_from_episodes_to_batch": 4.084774371433684e-06, "batch_individual_items": 0.09792015392624392, "general_advantage_estimation": 0.013458902612825568, "add_columns_from_episodes_to_train_batch": 0.039803953923624756, "add_observations_from_episodes_to_batch": 0.0003723012625866276}}, "connector_pipeline_timer": 0.15947181169888278}, "num_module_steps_trained_lifetime": 1366528, "num_module_steps_trained": 63872, "num_env_steps_trained_lifetime": 21352000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 998000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1100934.379585951, "num_module_steps_trained_throughput": 70460.9506760692, "num_module_steps_trained_lifetime_throughput": 70460.42858659572}, "shared_policy": {"vf_loss_unclipped": 2131.511962890625, "weights_seq_no": 20.0, "mean_kl_loss": 0.006218343041837215, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 63872, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.492947578430176, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.02445436269044876, "gradients_default_optimizer_global_norm": 4.426462650299072, "entropy": 0.42541465163230896, "vf_explained_var": 0.09274739027023315, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1366528, "total_loss": 9.466104507446289, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70461.06713607849}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 77000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 20, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-52", "timestamp": 1750902712, "time_this_iter_s": 1.6141390800476074, "time_total_s": 157.2650055885315, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317422160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.2650055885315, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.1, "ram_util_percent": 52.2}}
{"timers": {"training_iteration": 2.713747945068163, "restore_env_runners": 8.237720010045697e-05, "training_step": 2.713554892215512, "env_runner_sampling_timer": 1.661761344919523, "learner_update_timer": 1.0499048098635764, "synch_weights": 0.0008066421270001949, "synch_env_connectors": 0.0008701532300079105}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 266337.99999999994}, "agent_steps": {"vehicle_0": 41.1, "vehicle_3": 41.1, "vehicle_1": 65.76, "vehicle_2": 63.099999999999994}, "episode_return_max": 1099.366871356964, "env_to_module_connector": {"connector_pipeline_timer": 6.397793250338732e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5635860293680006e-06, "add_states_from_episodes_to_batch": 1.6607503699482296e-06, "add_observations_from_episodes_to_batch": 1.2392665009250511e-05, "batch_individual_items": 8.37687144857093e-06, "add_time_dim_to_batch_and_zero_pad": 2.573475510199562e-06, "numpy_to_tensor": 9.589634837238406e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10873362008590848, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.68708741557246e-06, "get_actions": 3.617189187942982e-05, "remove_single_ts_time_rank_from_batch": 6.673815601245302e-07, "normalize_and_clip_actions": 3.806077969733544e-05, "tensor_to_numpy": 1.6556707957917074e-05, "un_batch_to_individual_items": 1.257877656329296e-05, "module_to_agent_unmapping": 1.6393751491265527e-06}}, "connector_pipeline_timer": 0.00014239937175833235}, "rlmodule_inference_timer": 6.402543061784807e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 67483.99999999999, "vehicle_0": 66215.00000000003, "vehicle_3": 63372.00000000003, "vehicle_1": 69266.99999999999}, "env_step_timer": 0.00010370644812484752, "agent_episode_returns_mean": {"vehicle_2": 146.92716019153596, "vehicle_0": 126.11175936698913, "vehicle_3": 149.3349505877495, "vehicle_1": 294.56736743450165}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 31.000000000000004, "env_to_module_sum_episodes_length_out": 33.689731395961985, "episode_return_mean": 716.9412367272375, "num_agent_steps_sampled": {"vehicle_2": 1890.0, "vehicle_0": 1270.9999999999998, "vehicle_3": 1270.9999999999998, "vehicle_1": 1965.0}, "episode_len_min": 41, "episode_len_mean": 65.88, "module_episode_returns_mean": {"shared_policy": 231.3640925192833}, "episode_return_min": 389.12013053894043, "num_env_steps_sampled_lifetime": 79000.0, "env_to_module_sum_episodes_length_in": 33.689731395961985, "num_module_steps_sampled": {"shared_policy": 6397.0}, "episode_duration_sec_mean": 0.03493361253989861, "episode_len_max": 100, "time_between_sampling": 0.41316962992926953, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 20.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 989.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1905.8603686529934}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026577097655764896, "add_time_dim_to_batch_and_zero_pad": 1.0870386155281087e-05, "numpy_to_tensor": 0.00011810843300558287, "add_one_ts_to_episodes_and_truncate": 0.004950799864755999, "add_states_from_episodes_to_batch": 4.066006612493229e-06, "batch_individual_items": 0.0972731165570128, "general_advantage_estimation": 0.013463217756714071, "add_columns_from_episodes_to_train_batch": 0.03983938188443126, "add_observations_from_episodes_to_batch": 0.00037349615993406227}}, "connector_pipeline_timer": 0.15888002816192248}, "num_module_steps_trained_lifetime": 1433344, "num_module_steps_trained": 66816, "num_env_steps_trained_lifetime": 22396000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1044000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1099862.783620653, "num_module_steps_trained_throughput": 70392.71765757646, "num_module_steps_trained_lifetime_throughput": 70392.09949916718}, "shared_policy": {"vf_loss_unclipped": 1839.912841796875, "weights_seq_no": 21.0, "mean_kl_loss": 0.008016599342226982, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 66816, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.455610275268555, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.14994005858898163, "gradients_default_optimizer_global_norm": 7.254634380340576, "entropy": 0.43556827306747437, "vf_explained_var": 0.12386786937713623, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1433344, "total_loss": 9.603599548339844, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70392.94602512395}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 79000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 21, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-53", "timestamp": 1750902713, "time_this_iter_s": 1.676112174987793, "time_total_s": 158.9411177635193, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317422e80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.9411177635193, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 15.066666666666668, "ram_util_percent": 52.26666666666667}}
{"timers": {"training_iteration": 2.702389794367477, "restore_env_runners": 8.160425808486423e-05, "training_step": 2.7021971974633665, "env_runner_sampling_timer": 1.650957335220321, "learner_update_timer": 1.0493463671749514, "synch_weights": 0.000809502795773162, "synch_env_connectors": 0.0008767221177523756}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 271929.99999999994}, "agent_steps": {"vehicle_0": 41.48, "vehicle_3": 41.48, "vehicle_1": 76.04, "vehicle_2": 78.5}, "episode_return_max": 1132.2699892520905, "env_to_module_connector": {"connector_pipeline_timer": 6.298388805488851e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4902404908270722e-06, "add_states_from_episodes_to_batch": 1.679993330394572e-06, "add_observations_from_episodes_to_batch": 1.1791024782226712e-05, "batch_individual_items": 8.128521169712544e-06, "add_time_dim_to_batch_and_zero_pad": 2.512294579914203e-06, "numpy_to_tensor": 9.529502238089792e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10870551805201326, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.20907859068506e-06, "get_actions": 3.604326060439165e-05, "remove_single_ts_time_rank_from_batch": 6.700611513369385e-07, "normalize_and_clip_actions": 3.3702593864182314e-05, "tensor_to_numpy": 1.6415091672823796e-05, "un_batch_to_individual_items": 1.143427774462562e-05, "module_to_agent_unmapping": 1.6605217978551609e-06}}, "connector_pipeline_timer": 0.00013615067580837053}, "rlmodule_inference_timer": 5.841873881628385e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 69366.99999999999, "vehicle_0": 67159.00000000003, "vehicle_3": 64316.00000000003, "vehicle_1": 71087.99999999999}, "env_step_timer": 0.000100538077992327, "agent_episode_returns_mean": {"vehicle_2": 171.94910000681878, "vehicle_0": 109.57782460927963, "vehicle_3": 144.59538781523702, "vehicle_1": 333.999239604473}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 24.0, "env_to_module_sum_episodes_length_out": 48.227823251962704, "episode_return_mean": 760.121551463604, "num_agent_steps_sampled": {"vehicle_2": 1883.0, "vehicle_0": 944.0, "vehicle_3": 944.0, "vehicle_1": 1820.9999999999998}, "episode_len_min": 42, "episode_len_mean": 82.24, "module_episode_returns_mean": {"shared_policy": 287.66471809268}, "episode_return_min": 449.003778219223, "num_env_steps_sampled_lifetime": 81000.0, "env_to_module_sum_episodes_length_in": 48.227823251962704, "num_module_steps_sampled": {"shared_policy": 5592.0}, "episode_duration_sec_mean": 0.04199567819974618, "episode_len_max": 255, "time_between_sampling": 0.40402389314999265, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 21.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1013.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1952.983995897048}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026570701678793975, "add_time_dim_to_batch_and_zero_pad": 1.0833352295217387e-05, "numpy_to_tensor": 0.00011776609865934066, "add_one_ts_to_episodes_and_truncate": 0.0049518010361408946, "add_states_from_episodes_to_batch": 4.0465965626571285e-06, "batch_individual_items": 0.09738800205144914, "general_advantage_estimation": 0.013444769749111912, "add_columns_from_episodes_to_train_batch": 0.03982150515553011, "add_observations_from_episodes_to_batch": 0.0003739332883828085}}, "connector_pipeline_timer": 0.15895806413030913}, "num_module_steps_trained_lifetime": 1491456, "num_module_steps_trained": 58112, "num_env_steps_trained_lifetime": 23304000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 908000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1102096.9859620016, "num_module_steps_trained_throughput": 70535.68426516169, "num_module_steps_trained_lifetime_throughput": 70535.08019712579}, "shared_policy": {"vf_loss_unclipped": 2013.95361328125, "weights_seq_no": 22.0, "mean_kl_loss": 0.01777779310941696, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 58112, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.243145942687988, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.08749393373727798, "gradients_default_optimizer_global_norm": 2.0774905681610107, "entropy": 0.41324812173843384, "vf_explained_var": 0.06597095727920532, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1491456, "total_loss": 9.331840515136719, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70535.91635352133}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 81000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 22, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-55", "timestamp": 1750902715, "time_this_iter_s": 1.5801646709442139, "time_total_s": 160.5212824344635, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317422a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.5212824344635, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.700000000000003, "ram_util_percent": 52.25}}
{"timers": {"training_iteration": 2.6913141497638318, "restore_env_runners": 8.083613547017964e-05, "training_step": 2.6911216992387423, "env_runner_sampling_timer": 1.6403034576981503, "learner_update_timer": 1.0489226776731715, "synch_weights": 0.0008090506778017465, "synch_env_connectors": 0.000880189066564676}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 277944.99999999994}, "agent_steps": {"vehicle_0": 41.62, "vehicle_3": 41.62, "vehicle_1": 73.98, "vehicle_2": 70.1}, "episode_return_max": 1146.0249366760254, "env_to_module_connector": {"connector_pipeline_timer": 6.378631010422481e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5292999732367282e-06, "add_states_from_episodes_to_batch": 1.6603624683522904e-06, "add_observations_from_episodes_to_batch": 1.2226495623574878e-05, "batch_individual_items": 8.47144429769898e-06, "add_time_dim_to_batch_and_zero_pad": 2.532728529442885e-06, "numpy_to_tensor": 9.627895261821285e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10864168087497346, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.458407687248212e-06, "get_actions": 3.647794038492645e-05, "remove_single_ts_time_rank_from_batch": 6.702550093526569e-07, "normalize_and_clip_actions": 3.586890762304503e-05, "tensor_to_numpy": 1.6398749827787786e-05, "un_batch_to_individual_items": 1.199127603802111e-05, "module_to_agent_unmapping": 1.6503198212212642e-06}}, "connector_pipeline_timer": 0.00013954707813036292}, "rlmodule_inference_timer": 5.9680846068585436e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 71232.99999999999, "vehicle_0": 68247.00000000003, "vehicle_3": 65404.00000000003, "vehicle_1": 73060.99999999999}, "env_step_timer": 0.00010151154849787011, "agent_episode_returns_mean": {"vehicle_2": 171.2347397208214, "vehicle_0": 120.51326538085941, "vehicle_3": 146.48479250788688, "vehicle_1": 313.829304986}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 39.08030505045316, "episode_return_mean": 752.06210288167, "num_agent_steps_sampled": {"vehicle_2": 1865.9999999999998, "vehicle_0": 1088.0, "vehicle_3": 1088.0, "vehicle_1": 1973.0}, "episode_len_min": 41, "episode_len_mean": 73.98, "module_episode_returns_mean": {"shared_policy": 250.1317714869976}, "episode_return_min": 416.82469403743744, "num_env_steps_sampled_lifetime": 83000.0, "env_to_module_sum_episodes_length_in": 39.08030505045316, "num_module_steps_sampled": {"shared_policy": 6015.0}, "episode_duration_sec_mean": 0.03836294921988156, "episode_len_max": 109, "time_between_sampling": 0.3945710779283907, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 22.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1040.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1943.1197411898172}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002658790716183034, "add_time_dim_to_batch_and_zero_pad": 1.08683488071815e-05, "numpy_to_tensor": 0.00011744759766354314, "add_one_ts_to_episodes_and_truncate": 0.004958498435783856, "add_states_from_episodes_to_batch": 4.031970578420721e-06, "batch_individual_items": 0.09674507911086662, "general_advantage_estimation": 0.013447402881647908, "add_columns_from_episodes_to_train_batch": 0.03982853844400489, "add_observations_from_episodes_to_batch": 0.0003746802054625005}}, "connector_pipeline_timer": 0.15833317348897036}, "num_module_steps_trained_lifetime": 1554176, "num_module_steps_trained": 62720, "num_env_steps_trained_lifetime": 24284000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 980000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1099800.669554904, "num_module_steps_trained_throughput": 70388.98251868275, "num_module_steps_trained_lifetime_throughput": 70388.27607221807}, "shared_policy": {"vf_loss_unclipped": 2181.61279296875, "weights_seq_no": 23.0, "mean_kl_loss": 0.016452567651867867, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62720, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.484110832214355, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.07008259743452072, "gradients_default_optimizer_global_norm": 2.48105525970459, "entropy": 0.4380483031272888, "vf_explained_var": 0.059945762157440186, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1554176, "total_loss": 9.414584159851074, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70389.28372843516}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 83000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 23, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-56", "timestamp": 1750902716, "time_this_iter_s": 1.5972938537597656, "time_total_s": 162.11857628822327, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317423ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.11857628822327, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 22.1, "ram_util_percent": 52.2}}
{"timers": {"training_iteration": 2.6801172236862274, "restore_env_runners": 8.007443410406184e-05, "training_step": 2.6799252926663137, "env_runner_sampling_timer": 1.6296843897911564, "learner_update_timer": 1.048343205486411, "synch_weights": 0.0008088543409994997, "synch_env_connectors": 0.0008844117659062916}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 283894.99999999994}, "agent_steps": {"vehicle_0": 40.78, "vehicle_3": 40.78, "vehicle_1": 74.68, "vehicle_2": 72.62}, "episode_return_max": 1173.7834980487823, "env_to_module_connector": {"connector_pipeline_timer": 6.281314444706952e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5040454972579743e-06, "add_states_from_episodes_to_batch": 1.6541940390181964e-06, "add_observations_from_episodes_to_batch": 1.2068014262383582e-05, "batch_individual_items": 8.087245231418021e-06, "add_time_dim_to_batch_and_zero_pad": 2.510713388677268e-06, "numpy_to_tensor": 9.319447571339826e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10862221707123036, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.389427315286688e-06, "get_actions": 3.540020886270047e-05, "remove_single_ts_time_rank_from_batch": 6.648526710617376e-07, "normalize_and_clip_actions": 3.535729688535843e-05, "tensor_to_numpy": 1.6235323771507336e-05, "un_batch_to_individual_items": 1.1796331333071011e-05, "module_to_agent_unmapping": 1.6194731239194072e-06}}, "connector_pipeline_timer": 0.00013722920723626759}, "rlmodule_inference_timer": 5.7925634369797135e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 73115.99999999999, "vehicle_0": 69311.00000000003, "vehicle_3": 66468.00000000003, "vehicle_1": 74999.99999999999}, "env_step_timer": 0.00010131970618892623, "agent_episode_returns_mean": {"vehicle_2": 147.50931304216383, "vehicle_0": 150.191466679573, "vehicle_3": 150.40594569206237, "vehicle_1": 326.5472484731675}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 26.000000000000004, "env_to_module_sum_episodes_length_out": 39.43366295320682, "episode_return_mean": 774.653973124027, "num_agent_steps_sampled": {"vehicle_2": 1883.0, "vehicle_0": 1064.0, "vehicle_3": 1064.0, "vehicle_1": 1939.0000000000002}, "episode_len_min": 40, "episode_len_mean": 76.11999999999999, "module_episode_returns_mean": {"shared_policy": 331.4929648971558}, "episode_return_min": 414.3832643032074, "num_env_steps_sampled_lifetime": 85000.0, "env_to_module_sum_episodes_length_in": 39.43366295320682, "num_module_steps_sampled": {"shared_policy": 5950.0}, "episode_duration_sec_mean": 0.039099494980182496, "episode_len_max": 132, "time_between_sampling": 0.3856445918268091, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 23.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1066.0, "num_env_steps_sampled_lifetime_throughput": 1950.4180714085974}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002659360728997366, "add_time_dim_to_batch_and_zero_pad": 1.085466538765037e-05, "numpy_to_tensor": 0.00011716145171937462, "add_one_ts_to_episodes_and_truncate": 0.004962936371438375, "add_states_from_episodes_to_batch": 4.020810873486029e-06, "batch_individual_items": 0.0961013866497358, "general_advantage_estimation": 0.013439866762858183, "add_columns_from_episodes_to_train_batch": 0.039832584309571525, "add_observations_from_episodes_to_batch": 0.0003753454933916917}}, "connector_pipeline_timer": 0.15769063341404002}, "num_module_steps_trained_lifetime": 1616128, "num_module_steps_trained": 61952, "num_env_steps_trained_lifetime": 25252000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 968000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1098994.6794350715, "num_module_steps_trained_throughput": 70337.94909280755, "num_module_steps_trained_lifetime_throughput": 70337.3237552176}, "shared_policy": {"vf_loss_unclipped": 2877.844970703125, "weights_seq_no": 24.0, "mean_kl_loss": 0.008729164488613605, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 61952, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.622632026672363, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.07513147592544556, "gradients_default_optimizer_global_norm": 3.7593233585357666, "entropy": 0.3400496244430542, "vf_explained_var": 0.0066849589347839355, "curr_kl_coeff": 0.30000001192092896, "num_module_steps_trained_lifetime": 1616128, "total_loss": 9.546719551086426, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70338.09446125392}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 85000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 24, "trial_id": "c13e0_00000", "date": "2025-06-25_18-51-58", "timestamp": 1750902718, "time_this_iter_s": 1.5737478733062744, "time_total_s": 163.69232416152954, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 163.69232416152954, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 15.2, "ram_util_percent": 52.2}}
{"timers": {"training_iteration": 2.669066297279351, "restore_env_runners": 7.932952975456746e-05, "training_step": 2.6688746189096086, "env_runner_sampling_timer": 1.6192254208932422, "learner_update_timer": 1.0477478980215444, "synch_weights": 0.0008094087076233184, "synch_env_connectors": 0.0008867851482430657}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 289896.9999999999}, "agent_steps": {"vehicle_0": 41.46, "vehicle_3": 41.46, "vehicle_1": 69.48, "vehicle_2": 66.31999999999998}, "episode_return_max": 1170.3436371088028, "env_to_module_connector": {"connector_pipeline_timer": 6.281638111461543e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5031511986924425e-06, "add_states_from_episodes_to_batch": 1.6489625897735737e-06, "add_observations_from_episodes_to_batch": 1.204331765318294e-05, "batch_individual_items": 8.21151759703989e-06, "add_time_dim_to_batch_and_zero_pad": 2.495783902588025e-06, "numpy_to_tensor": 9.460913303800269e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.562501660780981e-06, "add_observations_from_episodes_to_batch": 3.866650513373315e-05, "batch_individual_items": 2.3208998754853383e-05, "add_time_dim_to_batch_and_zero_pad": 7.957994967000559e-06, "numpy_to_tensor": 2.7083002350991592e-05, "agent_to_module_mapping": 5.166501068742946e-06}}, "sample": 0.10857704732636368, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.489702920716552e-06, "get_actions": 3.5737991154974996e-05, "remove_single_ts_time_rank_from_batch": 6.651293475589345e-07, "normalize_and_clip_actions": 3.5869413477570865e-05, "tensor_to_numpy": 1.6261304599878532e-05, "un_batch_to_individual_items": 1.196326639311412e-05, "module_to_agent_unmapping": 1.6224064990131117e-06}}, "connector_pipeline_timer": 0.0001385358759438834}, "rlmodule_inference_timer": 5.924757454072776e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 74983.99999999997, "vehicle_0": 70395.00000000003, "vehicle_3": 67552.00000000003, "vehicle_1": 76966.0}, "env_step_timer": 0.00010111518697546594, "agent_episode_returns_mean": {"vehicle_2": 170.91020579099654, "vehicle_0": 135.84831999301912, "vehicle_3": 151.8839326667786, "vehicle_1": 308.85478294253346}, "env_reset_timer": 8.127049659378827e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 37.82595817080677, "episode_return_mean": 767.4972399151325, "num_agent_steps_sampled": {"vehicle_2": 1868.0, "vehicle_0": 1084.0, "vehicle_3": 1084.0, "vehicle_1": 1965.9999999999998}, "episode_len_min": 41, "episode_len_mean": 69.7, "module_episode_returns_mean": {"shared_policy": 268.8263782835007}, "episode_return_min": 484.81179052591324, "num_env_steps_sampled_lifetime": 87000.0, "env_to_module_sum_episodes_length_in": 37.82595817080677, "num_module_steps_sampled": {"shared_policy": 6002.0}, "episode_duration_sec_mean": 0.03621379492047709, "episode_len_max": 102, "time_between_sampling": 0.3770204241776002, "connector_pipeline_timer": 0.00022802050443715416, "weights_seq_no": 24.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1093.0, "num_env_steps_sampled_lifetime_throughput": 1942.5433342361246}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026603104616730244, "add_time_dim_to_batch_and_zero_pad": 1.0826958697403708e-05, "numpy_to_tensor": 0.00011685441719932273, "add_one_ts_to_episodes_and_truncate": 0.0049674682577331925, "add_states_from_episodes_to_batch": 4.003522758831607e-06, "batch_individual_items": 0.0954685698632547, "general_advantage_estimation": 0.01343805226521684, "add_columns_from_episodes_to_train_batch": 0.03984092596646799, "add_observations_from_episodes_to_batch": 0.00037622494844373244}}, "connector_pipeline_timer": 0.15706951874988467}, "num_module_steps_trained_lifetime": 1678592, "num_module_steps_trained": 62464, "num_env_steps_trained_lifetime": 26228000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 976000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1099460.5075346697, "num_module_steps_trained_throughput": 70367.74344857465, "num_module_steps_trained_lifetime_throughput": 70367.11340366263}, "shared_policy": {"vf_loss_unclipped": 2111.23193359375, "weights_seq_no": 25.0, "mean_kl_loss": 0.03651494160294533, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62464, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.683746337890625, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.000984237645752728, "gradients_default_optimizer_global_norm": 8.037917137145996, "entropy": 0.3925652503967285, "vf_explained_var": 0.1641131043434143, "curr_kl_coeff": 0.45000001788139343, "num_module_steps_trained_lifetime": 1678592, "total_loss": 9.69175910949707, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70367.87175437463}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 87000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 25, "trial_id": "c13e0_00000", "date": "2025-06-25_18-52-00", "timestamp": 1750902720, "time_this_iter_s": 1.5772430896759033, "time_total_s": 165.26956725120544, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317423240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165.26956725120544, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 14.1, "ram_util_percent": 52.20000000000001}}
{"timers": {"training_iteration": 3.2815305618065427, "restore_env_runners": 7.857748448008133e-05, "training_step": 3.2813393685505456, "env_runner_sampling_timer": 2.232273784184346, "learner_update_timer": 1.0471609486213358, "synch_weights": 0.0008098508705720027, "synch_env_connectors": 0.0008885618767944756}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 295790.9999999999}, "agent_steps": {"vehicle_0": 41.04, "vehicle_3": 41.04, "vehicle_1": 79.36000000000001, "vehicle_2": 75.02}, "episode_return_max": 1195.852144241333, "env_to_module_connector": {"connector_pipeline_timer": 5.995075772005149e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.3890627141204733e-06, "add_states_from_episodes_to_batch": 1.5979354018846401e-06, "add_observations_from_episodes_to_batch": 1.1516719174758936e-05, "batch_individual_items": 7.732789270610279e-06, "add_time_dim_to_batch_and_zero_pad": 2.3803655544624735e-06, "numpy_to_tensor": 8.80088034995761e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5453042073640974e-06, "add_observations_from_episodes_to_batch": 4.3199706124141815e-05, "batch_individual_items": 2.1408999600680545e-05, "add_time_dim_to_batch_and_zero_pad": 7.3243958468083296e-06, "numpy_to_tensor": 2.231660109828226e-05, "agent_to_module_mapping": 4.833300044992938e-06}}, "sample": 0.1101187749375709, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.2281952904716346e-06, "get_actions": 3.473143410951939e-05, "remove_single_ts_time_rank_from_batch": 6.23691533557642e-07, "normalize_and_clip_actions": 3.420842749407295e-05, "tensor_to_numpy": 1.561316431053321e-05, "un_batch_to_individual_items": 1.1502498420327545e-05, "module_to_agent_unmapping": 1.5454437211545451e-06}}, "connector_pipeline_timer": 0.00013339040503123966}, "rlmodule_inference_timer": 5.5942924164290045e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 76841.99999999997, "vehicle_0": 71433.00000000003, "vehicle_3": 68590.00000000003, "vehicle_1": 78926.0}, "env_step_timer": 9.681258937655789e-05, "agent_episode_returns_mean": {"vehicle_2": 213.816075963974, "vehicle_0": 125.47659598350525, "vehicle_3": 160.98392555236816, "vehicle_1": 378.1623191976547}, "env_reset_timer": 7.568689761683345e-05, "num_episodes": 26.000000000000004, "env_to_module_sum_episodes_length_out": 36.99316658147885, "episode_return_mean": 878.4389167737961, "num_agent_steps_sampled": {"vehicle_2": 1858.0, "vehicle_0": 1038.0, "vehicle_3": 1038.0, "vehicle_1": 1960.0}, "episode_len_min": 41, "episode_len_mean": 79.84, "module_episode_returns_mean": {"shared_policy": 300.9160148859024}, "episode_return_min": 470.52937960624695, "num_env_steps_sampled_lifetime": 89000.0, "env_to_module_sum_episodes_length_in": 36.99316658147885, "num_module_steps_sampled": {"shared_policy": 5893.999999999999}, "episode_duration_sec_mean": 0.03972826415949385, "episode_len_max": 106, "time_between_sampling": 0.5928540060591614, "connector_pipeline_timer": 0.00022527050386997872, "weights_seq_no": 25.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1119.0, "num_env_steps_sampled_lifetime_throughput": 1976.1327796758076}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026592869470574375, "add_time_dim_to_batch_and_zero_pad": 1.0806189121861654e-05, "numpy_to_tensor": 0.00011652712303017934, "add_one_ts_to_episodes_and_truncate": 0.004971366905161608, "add_states_from_episodes_to_batch": 3.9901475130565725e-06, "batch_individual_items": 0.09482875249457356, "general_advantage_estimation": 0.013429759662562771, "add_columns_from_episodes_to_train_batch": 0.03982711878674252, "add_observations_from_episodes_to_batch": 0.00037665186895408337}}, "connector_pipeline_timer": 0.15640973148242834}, "num_module_steps_trained_lifetime": 1740032, "num_module_steps_trained": 61440, "num_env_steps_trained_lifetime": 27188000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 960000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1098391.1543789236, "num_module_steps_trained_throughput": 70298.67305109127, "num_module_steps_trained_lifetime_throughput": 70298.25456934983}, "shared_policy": {"vf_loss_unclipped": 2357.351318359375, "weights_seq_no": 26.0, "mean_kl_loss": 0.002940196543931961, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 61440, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.663228988647461, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.11105138808488846, "gradients_default_optimizer_global_norm": 3.007357597351074, "entropy": 0.32160890102386475, "vf_explained_var": 0.14758020639419556, "curr_kl_coeff": 0.22500000894069672, "num_module_steps_trained_lifetime": 1740032, "total_loss": 9.550283432006836, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70298.55840362454}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 89000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 26, "trial_id": "c13e0_00000", "date": "2025-06-25_18-53-04", "timestamp": 1750902784, "time_this_iter_s": 63.917155027389526, "time_total_s": 229.18672227859497, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317423740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 229.18672227859497, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 10.11098901098901, "ram_util_percent": 52.343956043956034}}
{"timers": {"training_iteration": 3.263742660348469, "restore_env_runners": 0.00011738253961863413, "training_step": 3.2635123461150193, "env_runner_sampling_timer": 2.215558551762551, "learner_update_timer": 1.0460473133051746, "synch_weights": 0.0008094402818722748, "synch_env_connectors": 0.0008865754180248145}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 299180.99999999994}, "agent_steps": {"vehicle_0": 40.80499999999999, "vehicle_3": 40.80499999999999, "vehicle_1": 74.035, "vehicle_2": 73.245}, "episode_return_max": 1158.9371259212494, "env_to_module_connector": {"connector_pipeline_timer": 6.215138100104768e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.441295575346337e-06, "add_states_from_episodes_to_batch": 1.6502782986959106e-06, "add_observations_from_episodes_to_batch": 1.179624646693454e-05, "batch_individual_items": 8.013777173938478e-06, "add_time_dim_to_batch_and_zero_pad": 2.658026757589315e-06, "numpy_to_tensor": 9.376725900803071e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7080026231706142e-06, "add_observations_from_episodes_to_batch": 4.5750002755085006e-05, "batch_individual_items": 2.4187498638639227e-05, "add_time_dim_to_batch_and_zero_pad": 8.854000043356791e-06, "numpy_to_tensor": 2.608299837447703e-05, "agent_to_module_mapping": 5.354002496460453e-06}}, "sample": 0.10829002667554347, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.259817556097199e-06, "get_actions": 3.829946804214331e-05, "remove_single_ts_time_rank_from_batch": 6.643359395678009e-07, "normalize_and_clip_actions": 3.4884106334440575e-05, "tensor_to_numpy": 1.787103139764155e-05, "un_batch_to_individual_items": 1.1765287623366405e-05, "module_to_agent_unmapping": 1.6393367164685946e-06}}, "connector_pipeline_timer": 0.00014163080941479757}, "rlmodule_inference_timer": 5.954787578167409e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 88795.0, "vehicle_0": 59363.000000000015, "vehicle_3": 59363.000000000015, "vehicle_1": 91660.0}, "env_step_timer": 9.539181494785832e-05, "agent_episode_returns_mean": {"vehicle_2": 177.85622059941295, "vehicle_0": 125.69903311014176, "vehicle_3": 151.9340410029888, "vehicle_1": 353.5770370480418}, "env_reset_timer": 8.90829978743568e-05, "num_episodes": 24.0, "env_to_module_sum_episodes_length_out": 47.33353726443007, "episode_return_mean": 809.0663311359286, "num_agent_steps_sampled": {"vehicle_2": 1874.0000000000002, "vehicle_0": 992.9999999999999, "vehicle_3": 992.9999999999999, "vehicle_1": 1838.0}, "episode_len_min": 41, "episode_len_mean": 77.395, "module_episode_returns_mean": {"shared_policy": 221.3188369858265}, "episode_return_min": 206.31352698802948, "num_env_steps_sampled_lifetime": 95000.0, "env_to_module_sum_episodes_length_in": 47.33353726443007, "num_module_steps_sampled": {"shared_policy": 5698.0}, "episode_duration_sec_mean": 0.03838748354111885, "episode_len_max": 214, "time_between_sampling": 0.38701432054712354, "connector_pipeline_timer": 0.00023977050295798108, "weights_seq_no": 26.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1344.0000000000002, "num_env_steps_sampled_lifetime_throughput": 2008.2309880943067}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002658084077596656, "add_time_dim_to_batch_and_zero_pad": 1.0795207204427313e-05, "numpy_to_tensor": 0.0001161910217485793, "add_one_ts_to_episodes_and_truncate": 0.004971150736113773, "add_states_from_episodes_to_batch": 3.975246082769189e-06, "batch_individual_items": 0.09417418454963195, "general_advantage_estimation": 0.013415197485949291, "add_columns_from_episodes_to_train_batch": 0.039813019268814046, "add_observations_from_episodes_to_batch": 0.00037712118024791475}}, "connector_pipeline_timer": 0.15572433041760572}, "num_module_steps_trained_lifetime": 1799296, "num_module_steps_trained": 59264, "num_env_steps_trained_lifetime": 28114000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 926000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1098062.1798258482, "num_module_steps_trained_throughput": 70277.8316023612, "num_module_steps_trained_lifetime_throughput": 70277.29059247012}, "shared_policy": {"vf_loss_unclipped": 2543.697265625, "weights_seq_no": 27.0, "mean_kl_loss": 0.011076296679675579, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 59264, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.887968063354492, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.035408858209848404, "gradients_default_optimizer_global_norm": 2.8019826412200928, "entropy": 0.4694440960884094, "vf_explained_var": 0.05536079406738281, "curr_kl_coeff": 0.22500000894069672, "num_module_steps_trained_lifetime": 1799296, "total_loss": 9.921175003051758, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70277.96890528058}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 95000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 27, "trial_id": "c13e0_00000", "date": "2025-06-25_18-53-05", "timestamp": 1750902785, "time_this_iter_s": 1.5050129890441895, "time_total_s": 230.69173526763916, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317423e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 230.69173526763916, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 16.15, "ram_util_percent": 52.8}}
{"timers": {"training_iteration": 3.2462545229149877, "restore_env_runners": 0.00011624954420447427, "training_step": 3.246024961813889, "env_runner_sampling_timer": 2.1990901145749597, "learner_update_timer": 1.0450250755821027, "synch_weights": 0.0008105504590364586, "synch_env_connectors": 0.0008892050838844307}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 304829.0}, "agent_steps": {"vehicle_0": 40.6, "vehicle_3": 40.6, "vehicle_1": 77.52, "vehicle_2": 84.43999999999998}, "episode_return_max": 1195.2788426876068, "env_to_module_connector": {"connector_pipeline_timer": 6.236247209612995e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.451309524479019e-06, "add_states_from_episodes_to_batch": 1.676951174464246e-06, "add_observations_from_episodes_to_batch": 1.1787312182199185e-05, "batch_individual_items": 7.987519752662113e-06, "add_time_dim_to_batch_and_zero_pad": 2.670598148778791e-06, "numpy_to_tensor": 9.426903151086672e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7080026231706142e-06, "add_observations_from_episodes_to_batch": 4.5750002755085006e-05, "batch_individual_items": 2.4187498638639227e-05, "add_time_dim_to_batch_and_zero_pad": 8.854000043356791e-06, "numpy_to_tensor": 2.608299837447703e-05, "agent_to_module_mapping": 5.354002496460453e-06}}, "sample": 0.10806502165981195, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.275572338807711e-06, "get_actions": 3.475723688886508e-05, "remove_single_ts_time_rank_from_batch": 6.505218417929263e-07, "normalize_and_clip_actions": 3.4363990776573465e-05, "tensor_to_numpy": 1.612587650143013e-05, "un_batch_to_individual_items": 1.1586896367821904e-05, "module_to_agent_unmapping": 1.6143980470974441e-06}}, "connector_pipeline_timer": 0.00013509046657568}, "rlmodule_inference_timer": 5.6962571934233854e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 90672.99999999999, "vehicle_0": 60334.00000000003, "vehicle_3": 60334.00000000003, "vehicle_1": 93487.99999999999}, "env_step_timer": 9.76357550215218e-05, "agent_episode_returns_mean": {"vehicle_2": 120.02669551134107, "vehicle_0": 139.81103253364566, "vehicle_3": 157.499513566494, "vehicle_1": 349.97625584363936}, "env_reset_timer": 8.90829978743568e-05, "num_episodes": 25.0, "env_to_module_sum_episodes_length_out": 44.03218835013977, "episode_return_mean": 767.3134973216057, "num_agent_steps_sampled": {"vehicle_2": 1878.0, "vehicle_0": 971.0, "vehicle_3": 971.0, "vehicle_1": 1828.0}, "episode_len_min": 41, "episode_len_mean": 88.41999999999999, "module_episode_returns_mean": {"shared_policy": 202.91996006011962}, "episode_return_min": -213.56558620929718, "num_env_steps_sampled_lifetime": 97000.0, "env_to_module_sum_episodes_length_in": 44.03218835013977, "num_module_steps_sampled": {"shared_policy": 5648.0}, "episode_duration_sec_mean": 0.04391020177979953, "episode_len_max": 241, "time_between_sampling": 0.3415956179998686, "connector_pipeline_timer": 0.00023977050295798108, "weights_seq_no": 27.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1369.0, "num_env_steps_sampled_lifetime_throughput": 1980.3374452277358}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002657056576840231, "add_time_dim_to_batch_and_zero_pad": 1.077725509009168e-05, "numpy_to_tensor": 0.00011595620153564565, "add_one_ts_to_episodes_and_truncate": 0.004971136308710331, "add_states_from_episodes_to_batch": 3.957993574988869e-06, "batch_individual_items": 0.09352591687416571, "general_advantage_estimation": 0.013401733431078795, "add_columns_from_episodes_to_train_batch": 0.039802677826138895, "add_observations_from_episodes_to_batch": 0.00037754205842753356}}, "connector_pipeline_timer": 0.15505052086341625}, "num_module_steps_trained_lifetime": 1858176, "num_module_steps_trained": 58880, "num_env_steps_trained_lifetime": 29034000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 920000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1098366.1487744697, "num_module_steps_trained_throughput": 70297.04168379957, "num_module_steps_trained_lifetime_throughput": 70296.61344503821}, "shared_policy": {"vf_loss_unclipped": 2700.296630859375, "weights_seq_no": 28.0, "mean_kl_loss": 0.004086678847670555, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 58880, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.702573776245117, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.017008638009428978, "gradients_default_optimizer_global_norm": 5.788727283477783, "entropy": 0.37490010261535645, "vf_explained_var": -0.10211622714996338, "curr_kl_coeff": 0.11250000447034836, "num_module_steps_trained_lifetime": 1858176, "total_loss": 9.716753005981445, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70297.12963346831}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 97000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 28, "trial_id": "c13e0_00000", "date": "2025-06-25_18-53-07", "timestamp": 1750902787, "time_this_iter_s": 1.5168728828430176, "time_total_s": 232.20860815048218, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317421ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 232.20860815048218, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 14.649999999999999, "ram_util_percent": 52.8}}
{"timers": {"training_iteration": 3.230505299765869, "restore_env_runners": 0.00011513537872880513, "training_step": 3.2302767230257654, "env_runner_sampling_timer": 2.1833961580192045, "learner_update_timer": 1.0449665685762874, "synch_weights": 0.000811561624417357, "synch_env_connectors": 0.0008895013630502765}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 311044.99999999994}, "agent_steps": {"vehicle_0": 41.24, "vehicle_3": 41.24, "vehicle_1": 66.69999999999999, "vehicle_2": 63.94}, "episode_return_max": 1195.2788426876068, "env_to_module_connector": {"connector_pipeline_timer": 6.256014672268955e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4935418378439108e-06, "add_states_from_episodes_to_batch": 1.659437027816908e-06, "add_observations_from_episodes_to_batch": 1.2090602886584906e-05, "batch_individual_items": 8.123850128771704e-06, "add_time_dim_to_batch_and_zero_pad": 2.625614412973318e-06, "numpy_to_tensor": 9.257358269361457e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7080026231706142e-06, "add_observations_from_episodes_to_batch": 4.5750002755085006e-05, "batch_individual_items": 2.4187498638639227e-05, "add_time_dim_to_batch_and_zero_pad": 8.854000043356791e-06, "numpy_to_tensor": 2.608299837447703e-05, "agent_to_module_mapping": 5.354002496460453e-06}}, "sample": 0.10823229723883585, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.555619303688059e-06, "get_actions": 3.4759019971619584e-05, "remove_single_ts_time_rank_from_batch": 6.454084434536393e-07, "normalize_and_clip_actions": 3.617740883897522e-05, "tensor_to_numpy": 1.6222538497196783e-05, "un_batch_to_individual_items": 1.2195421053915982e-05, "module_to_agent_unmapping": 1.6039769873370078e-06}}, "connector_pipeline_timer": 0.00013789779832834535}, "rlmodule_inference_timer": 9.11412554894367e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 92555.99999999999, "vehicle_0": 61516.000000000044, "vehicle_3": 61516.000000000044, "vehicle_1": 95456.99999999999}, "env_step_timer": 9.9363412581728e-05, "agent_episode_returns_mean": {"vehicle_2": 153.32217233657838, "vehicle_0": 127.5542390465736, "vehicle_3": 146.64620064258574, "vehicle_1": 304.11257067441943}, "env_reset_timer": 8.90829978743568e-05, "num_episodes": 28.999999999999996, "env_to_module_sum_episodes_length_out": 35.36114079343686, "episode_return_mean": 731.6351831007004, "num_agent_steps_sampled": {"vehicle_2": 1883.0, "vehicle_0": 1182.0, "vehicle_3": 1182.0, "vehicle_1": 1969.0000000000002}, "episode_len_min": 41, "episode_len_mean": 66.76, "module_episode_returns_mean": {"shared_policy": 237.93359413862228}, "episode_return_min": 463.18909668922424, "num_env_steps_sampled_lifetime": 99000.0, "env_to_module_sum_episodes_length_in": 35.36114079343686, "num_module_steps_sampled": {"shared_policy": 6216.000000000001}, "episode_duration_sec_mean": 0.03614343831955922, "episode_len_max": 99, "time_between_sampling": 0.3348578581382069, "connector_pipeline_timer": 0.00023977050295798108, "weights_seq_no": 28.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1397.9999999999998, "num_env_steps_sampled_lifetime_throughput": 1961.848405638479}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002658402681077481, "add_time_dim_to_batch_and_zero_pad": 1.0775732547875345e-05, "numpy_to_tensor": 0.00011567246953033451, "add_one_ts_to_episodes_and_truncate": 0.004978713695581617, "add_states_from_episodes_to_batch": 3.942583642837537e-06, "batch_individual_items": 0.09291738562546129, "general_advantage_estimation": 0.013402243176776418, "add_columns_from_episodes_to_train_batch": 0.0398186202078769, "add_observations_from_episodes_to_batch": 0.0003788074778125552}}, "connector_pipeline_timer": 0.15446759065481358}, "num_module_steps_trained_lifetime": 1923072, "num_module_steps_trained": 64896, "num_env_steps_trained_lifetime": 30048000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1014000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1097178.6770068405, "num_module_steps_trained_throughput": 70221.01787413919, "num_module_steps_trained_lifetime_throughput": 70220.52318358427}, "shared_policy": {"vf_loss_unclipped": 2173.583251953125, "weights_seq_no": 29.0, "mean_kl_loss": 0.010453575290739536, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 64896, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.393949508666992, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.1581551432609558, "gradients_default_optimizer_global_norm": 5.990966320037842, "entropy": 0.3343222737312317, "vf_explained_var": 0.06351906061172485, "curr_kl_coeff": 0.11250000447034836, "num_module_steps_trained_lifetime": 1923072, "total_loss": 9.233627319335938, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70221.25117677287}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 99000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 29, "trial_id": "c13e0_00000", "date": "2025-06-25_18-53-08", "timestamp": 1750902788, "time_this_iter_s": 1.6740422248840332, "time_total_s": 233.8826503753662, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31747b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 233.8826503753662, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 14.149999999999999, "ram_util_percent": 52.8}}
{"timers": {"training_iteration": 3.2147125034381676, "restore_env_runners": 0.00011402527496457661, "training_step": 3.214484868295451, "env_runner_sampling_timer": 2.1672977651890366, "learner_update_timer": 1.0452685703905324, "synch_weights": 0.0008133101681202118, "synch_env_connectors": 0.0008975467594067745}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 317034.9999999999}, "agent_steps": {"vehicle_0": 40.580000000000005, "vehicle_3": 40.580000000000005, "vehicle_1": 72.64, "vehicle_2": 68.02}, "episode_return_max": 1200.775228857994, "env_to_module_connector": {"connector_pipeline_timer": 6.401383477609178e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5576899650429547e-06, "add_states_from_episodes_to_batch": 1.6960781499282066e-06, "add_observations_from_episodes_to_batch": 1.2382290290511085e-05, "batch_individual_items": 8.191269332503335e-06, "add_time_dim_to_batch_and_zero_pad": 2.690640579177786e-06, "numpy_to_tensor": 9.573924921997486e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7080026231706142e-06, "add_observations_from_episodes_to_batch": 4.5750002755085006e-05, "batch_individual_items": 2.4187498638639227e-05, "add_time_dim_to_batch_and_zero_pad": 8.854000043356791e-06, "numpy_to_tensor": 2.608299837447703e-05, "agent_to_module_mapping": 5.354002496460453e-06}}, "sample": 0.10821125081659044, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.418658941718213e-06, "get_actions": 3.5787861922294064e-05, "remove_single_ts_time_rank_from_batch": 6.506149450235646e-07, "normalize_and_clip_actions": 3.530517284769983e-05, "tensor_to_numpy": 1.65511436217552e-05, "un_batch_to_individual_items": 1.204850613495959e-05, "module_to_agent_unmapping": 1.6371305920302274e-06}}, "connector_pipeline_timer": 0.00013867627650156238}, "rlmodule_inference_timer": 5.626095251197757e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 94404.99999999999, "vehicle_0": 62600.000000000044, "vehicle_3": 62600.000000000044, "vehicle_1": 97429.99999999999}, "env_step_timer": 0.00010082298264348167, "agent_episode_returns_mean": {"vehicle_2": 202.2562245202064, "vehicle_0": 145.31623349428176, "vehicle_3": 145.33492450475694, "vehicle_1": 360.4797565865517}, "env_reset_timer": 8.90829978743568e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 39.66680062846401, "episode_return_mean": 853.3871383237839, "num_agent_steps_sampled": {"vehicle_2": 1849.0000000000002, "vehicle_0": 1084.0, "vehicle_3": 1084.0, "vehicle_1": 1973.0}, "episode_len_min": 41, "episode_len_mean": 72.66, "module_episode_returns_mean": {"shared_policy": 253.43906669616695}, "episode_return_min": 451.36882996559143, "num_env_steps_sampled_lifetime": 101000.0, "env_to_module_sum_episodes_length_in": 39.66680062846401, "num_module_steps_sampled": {"shared_policy": 5990.0}, "episode_duration_sec_mean": 0.03690819492039736, "episode_len_max": 99, "time_between_sampling": 0.32922226862518766, "connector_pipeline_timer": 0.00023977050295798108, "weights_seq_no": 29.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1424.9999999999998, "num_env_steps_sampled_lifetime_throughput": 1944.153019612214}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002659294484259615, "add_time_dim_to_batch_and_zero_pad": 1.0765055196180867e-05, "numpy_to_tensor": 0.00011539366479114158, "add_one_ts_to_episodes_and_truncate": 0.004985370308625544, "add_states_from_episodes_to_batch": 3.930237756495934e-06, "batch_individual_items": 0.09308787384922092, "general_advantage_estimation": 0.01339756365501285, "add_columns_from_episodes_to_train_batch": 0.03981889650581387, "add_observations_from_episodes_to_batch": 0.00037970898305317817}}, "connector_pipeline_timer": 0.1546412497482341}, "num_module_steps_trained_lifetime": 1985536, "num_module_steps_trained": 62464, "num_env_steps_trained_lifetime": 31024000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 976000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1096433.5378258037, "num_module_steps_trained_throughput": 70173.12988346195, "num_module_steps_trained_lifetime_throughput": 70172.73422304777}, "shared_policy": {"vf_loss_unclipped": 2587.8134765625, "weights_seq_no": 30.0, "mean_kl_loss": 0.005209167953580618, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62464, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.564702987670898, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.021959783509373665, "gradients_default_optimizer_global_norm": 5.995635986328125, "entropy": 0.21259436011314392, "vf_explained_var": 0.039850831031799316, "curr_kl_coeff": 0.11250000447034836, "num_module_steps_trained_lifetime": 1985536, "total_loss": 9.541202545166016, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70173.18436408421}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 101000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 30, "trial_id": "c13e0_00000", "date": "2025-06-25_18-53-10", "timestamp": 1750902790, "time_this_iter_s": 1.6534101963043213, "time_total_s": 235.53606057167053, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31747a480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 235.53606057167053, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 13.333333333333334, "ram_util_percent": 52.79999999999999}}
{"timers": {"training_iteration": 3.8127280009037787, "restore_env_runners": 0.00011294335218469182, "training_step": 3.8125010483625044, "env_runner_sampling_timer": 2.7657632387870965, "learner_update_timer": 1.0448307730165969, "synch_weights": 0.0008126999764574612, "synch_env_connectors": 0.000900190041807957}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 323030.9999999999}, "agent_steps": {"vehicle_0": 40.54, "vehicle_3": 40.54, "vehicle_1": 70.66000000000001, "vehicle_2": 69.50000000000001}, "episode_return_max": 1190.4403574466705, "env_to_module_connector": {"connector_pipeline_timer": 6.290301141231912e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.491838288797252e-06, "add_states_from_episodes_to_batch": 1.6768685570503599e-06, "add_observations_from_episodes_to_batch": 1.202629694687973e-05, "batch_individual_items": 8.167662096701258e-06, "add_time_dim_to_batch_and_zero_pad": 2.617174211533605e-06, "numpy_to_tensor": 9.336616636746146e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6746030673384665e-06, "add_observations_from_episodes_to_batch": 4.54666034784168e-05, "batch_individual_items": 2.354179887333885e-05, "add_time_dim_to_batch_and_zero_pad": 8.516399248037487e-06, "numpy_to_tensor": 2.509139885660261e-05, "agent_to_module_mapping": 5.23320195497945e-06}}, "sample": 0.10833858309297595, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.485113852169772e-06, "get_actions": 3.502898207120362e-05, "remove_single_ts_time_rank_from_batch": 6.41927672961084e-07, "normalize_and_clip_actions": 3.594505116794547e-05, "tensor_to_numpy": 1.6365635785170215e-05, "un_batch_to_individual_items": 1.2098673214340569e-05, "module_to_agent_unmapping": 1.6182365723727137e-06}}, "connector_pipeline_timer": 0.00013796606068690052}, "rlmodule_inference_timer": 5.646337151359934e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 96279.99999999999, "vehicle_0": 63702.000000000044, "vehicle_3": 63702.000000000044, "vehicle_1": 99347.0}, "env_step_timer": 9.887284775367752e-05, "agent_episode_returns_mean": {"vehicle_2": 140.42519029140473, "vehicle_0": 141.41550570487976, "vehicle_3": 148.7325286197662, "vehicle_1": 334.135599950552}, "env_reset_timer": 8.612459787400439e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 36.93009570256938, "episode_return_mean": 764.7088231360913, "num_agent_steps_sampled": {"vehicle_2": 1875.0, "vehicle_0": 1102.0, "vehicle_3": 1102.0, "vehicle_1": 1917.0}, "episode_len_min": 41, "episode_len_mean": 72.84, "module_episode_returns_mean": {"shared_policy": 248.9351425933838}, "episode_return_min": 408.59759271144867, "num_env_steps_sampled_lifetime": 103000.0, "env_to_module_sum_episodes_length_in": 36.93009570256938, "num_module_steps_sampled": {"shared_policy": 5996.000000000001}, "episode_duration_sec_mean": 0.03710914412120474, "episode_len_max": 136, "time_between_sampling": 0.43883575557846327, "connector_pipeline_timer": 0.00023673300311202183, "weights_seq_no": 30.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1452.9999999999998, "num_env_steps_sampled_lifetime_throughput": 1939.0353848205102}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026592565394210283, "add_time_dim_to_batch_and_zero_pad": 1.0789494634293805e-05, "numpy_to_tensor": 0.00011510222808960926, "add_one_ts_to_episodes_and_truncate": 0.004993623275578994, "add_states_from_episodes_to_batch": 3.9200953797804894e-06, "batch_individual_items": 0.09247633720073481, "general_advantage_estimation": 0.013398258848474323, "add_columns_from_episodes_to_train_batch": 0.0398328308707805, "add_observations_from_episodes_to_batch": 0.00038055272323398625}}, "connector_pipeline_timer": 0.1540524801607497}, "num_module_steps_trained_lifetime": 2048128, "num_module_steps_trained": 62592, "num_env_steps_trained_lifetime": 32002000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 978000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1095145.846618058, "num_module_steps_trained_throughput": 70090.67944520977, "num_module_steps_trained_lifetime_throughput": 70090.26684888285}, "shared_policy": {"vf_loss_unclipped": 2075.6884765625, "weights_seq_no": 31.0, "mean_kl_loss": 0.009211034514009953, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62592, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.365958213806152, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.057008832693099976, "gradients_default_optimizer_global_norm": 1.8842400312423706, "entropy": 0.3713277578353882, "vf_explained_var": 0.09173792600631714, "curr_kl_coeff": 0.11250000447034836, "num_module_steps_trained_lifetime": 2048128, "total_loss": 9.420289993286133, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70090.7407764566}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 103000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 31, "trial_id": "c13e0_00000", "date": "2025-06-25_18-54-13", "timestamp": 1750902853, "time_this_iter_s": 63.018126249313354, "time_total_s": 298.5541868209839, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31747a340>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 298.5541868209839, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 10.60112359550562, "ram_util_percent": 52.410112359550574}}
{"timers": {"training_iteration": 3.790344596314753, "restore_env_runners": 0.0009309747587003565, "training_step": 3.7892990512188915, "env_runner_sampling_timer": 2.7438037047292565, "learner_update_timer": 1.043587800696437, "synch_weights": 0.0008118913067193511, "synch_env_connectors": 0.0008975510613474873}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 373958.0}, "agent_steps": {"vehicle_0": 40.17428571428571, "vehicle_3": 40.17428571428571, "vehicle_1": 77.50857142857143, "vehicle_2": 74.28857142857143}, "episode_return_max": 1207.4549918174744, "env_to_module_connector": {"connector_pipeline_timer": 6.317229724605588e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.474752094033334e-06, "add_states_from_episodes_to_batch": 1.6840712211120654e-06, "add_observations_from_episodes_to_batch": 1.1875098731534581e-05, "batch_individual_items": 8.101340189610313e-06, "add_time_dim_to_batch_and_zero_pad": 2.5898093189361454e-06, "numpy_to_tensor": 9.791165652260682e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9165024645626545e-06, "add_observations_from_episodes_to_batch": 3.987450327258557e-05, "batch_individual_items": 2.2208500013221055e-05, "add_time_dim_to_batch_and_zero_pad": 7.811999239493161e-06, "numpy_to_tensor": 2.3312499251915142e-05, "agent_to_module_mapping": 5.3960029617883265e-06}}, "sample": 0.10690301908747832, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.214448904301284e-06, "get_actions": 3.968687358711834e-05, "remove_single_ts_time_rank_from_batch": 6.558899666420581e-07, "normalize_and_clip_actions": 3.451242922040944e-05, "tensor_to_numpy": 1.774741021480292e-05, "un_batch_to_individual_items": 1.1446910117546417e-05, "module_to_agent_unmapping": 1.6247409253138416e-06}}, "connector_pipeline_timer": 0.00014240756238194737}, "rlmodule_inference_timer": 6.0226904838558676e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 112991.00000000003, "vehicle_0": 72550.0, "vehicle_3": 72550.0, "vehicle_1": 115867.0}, "env_step_timer": 9.632186671025351e-05, "agent_episode_returns_mean": {"vehicle_2": 224.60329577139447, "vehicle_0": 158.15223212037768, "vehicle_3": 162.64800688130515, "vehicle_1": 383.5198688002995}, "env_reset_timer": 8.645799971418455e-05, "num_episodes": 23.0, "env_to_module_sum_episodes_length_out": 50.23338333529553, "episode_return_mean": 928.923401702813, "num_agent_steps_sampled": {"vehicle_2": 1852.0, "vehicle_0": 946.0, "vehicle_3": 946.0, "vehicle_1": 1848.0}, "episode_len_min": 41, "episode_len_mean": 80.08857142857143, "module_episode_returns_mean": {"shared_policy": 305.44851571287427}, "episode_return_min": 556.1290786266327, "num_env_steps_sampled_lifetime": 121000.0, "env_to_module_sum_episodes_length_in": 50.23338333529553, "num_module_steps_sampled": {"shared_policy": 5592.0}, "episode_duration_sec_mean": 0.04050089239013947, "episode_len_max": 228, "time_between_sampling": 0.6560409149256707, "connector_pipeline_timer": 0.00023562500427942723, "weights_seq_no": 31.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1677.0, "num_env_steps_sampled_lifetime_throughput": 2005.3654914015215}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026577223040198618, "add_time_dim_to_batch_and_zero_pad": 1.0762019683307218e-05, "numpy_to_tensor": 0.0001148516258633901, "add_one_ts_to_episodes_and_truncate": 0.0049931224628286695, "add_states_from_episodes_to_batch": 3.907554407795966e-06, "batch_individual_items": 0.09184897924871509, "general_advantage_estimation": 0.013389089179956223, "add_columns_from_episodes_to_train_batch": 0.03980243881211335, "add_observations_from_episodes_to_batch": 0.0003806521960503359}}, "connector_pipeline_timer": 0.153382504529137}, "num_module_steps_trained_lifetime": 2106240, "num_module_steps_trained": 58112, "num_env_steps_trained_lifetime": 32910000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 908000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1094720.4542940313, "num_module_steps_trained_throughput": 70063.31005440607, "num_module_steps_trained_lifetime_throughput": 70063.07289873232}, "shared_policy": {"vf_loss_unclipped": 2844.151123046875, "weights_seq_no": 32.0, "mean_kl_loss": 0.004474756307899952, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 58112, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.528068542480469, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.014899984002113342, "gradients_default_optimizer_global_norm": 4.451356887817383, "entropy": 0.21891793608665466, "vf_explained_var": 0.10042595863342285, "curr_kl_coeff": 0.05625000223517418, "num_module_steps_trained_lifetime": 2106240, "total_loss": 9.541282653808594, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70063.33699613319}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 121000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 32, "trial_id": "c13e0_00000", "date": "2025-06-25_18-54-15", "timestamp": 1750902855, "time_this_iter_s": 1.576686143875122, "time_total_s": 300.130872964859, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317478f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 300.130872964859, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 52.29999999999999}}
{"timers": {"training_iteration": 3.7692958245115906, "restore_env_runners": 0.0009217179311175895, "training_step": 3.7682592611267123, "env_runner_sampling_timer": 2.7221489914319656, "learner_update_timer": 1.04420073852944, "synch_weights": 0.0008115611436604883, "synch_env_connectors": 0.0008997188807093241}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 380112.0}, "agent_steps": {"vehicle_0": 41.28, "vehicle_3": 41.44, "vehicle_1": 67.22, "vehicle_2": 63.11999999999999}, "episode_return_max": 1188.3789831399918, "env_to_module_connector": {"connector_pipeline_timer": 6.25023369183808e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4756867373047022e-06, "add_states_from_episodes_to_batch": 1.6682037587894231e-06, "add_observations_from_episodes_to_batch": 1.2141496431991534e-05, "batch_individual_items": 8.124835078363165e-06, "add_time_dim_to_batch_and_zero_pad": 2.5856206255774614e-06, "numpy_to_tensor": 9.329462474831602e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9165024645626545e-06, "add_observations_from_episodes_to_batch": 3.987450327258557e-05, "batch_individual_items": 2.2208500013221055e-05, "add_time_dim_to_batch_and_zero_pad": 7.811999239493161e-06, "numpy_to_tensor": 2.3312499251915142e-05, "agent_to_module_mapping": 5.3960029617883265e-06}}, "sample": 0.10690682092417492, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.567360138460625e-06, "get_actions": 3.59195051266485e-05, "remove_single_ts_time_rank_from_batch": 6.437077028562286e-07, "normalize_and_clip_actions": 3.6544452195076984e-05, "tensor_to_numpy": 1.6272219538617933e-05, "un_batch_to_individual_items": 1.2247263585338646e-05, "module_to_agent_unmapping": 1.6689040826183565e-06}}, "connector_pipeline_timer": 0.00013965900800803793}, "rlmodule_inference_timer": 5.9467778477528715e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 114782.0, "vehicle_0": 73772.00000000001, "vehicle_3": 73780.00000000001, "vehicle_1": 117777.99999999997}, "env_step_timer": 0.00010062027553662684, "agent_episode_returns_mean": {"vehicle_2": 198.07331050157543, "vehicle_0": 156.05197437405587, "vehicle_3": 165.2870163321495, "vehicle_1": 332.8565042567253}, "env_reset_timer": 8.645799971418455e-05, "num_episodes": 30.0, "env_to_module_sum_episodes_length_out": 35.87463746947306, "episode_return_mean": 852.268805435896, "num_agent_steps_sampled": {"vehicle_2": 1790.9999999999998, "vehicle_0": 1222.0, "vehicle_3": 1230.0, "vehicle_1": 1910.9999999999998}, "episode_len_min": 40, "episode_len_mean": 68.41999999999999, "module_episode_returns_mean": {"shared_policy": 283.28862463355074}, "episode_return_min": 518.0726432800293, "num_env_steps_sampled_lifetime": 123000.0, "env_to_module_sum_episodes_length_in": 35.87463746947306, "num_module_steps_sampled": {"shared_policy": 6153.999999999999}, "episode_duration_sec_mean": 0.035106189159996574, "episode_len_max": 99, "time_between_sampling": 0.5716245523251395, "connector_pipeline_timer": 0.00023562500427942723, "weights_seq_no": 32.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1706.9999999999995, "num_env_steps_sampled_lifetime_throughput": 1970.1536948380651}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026595400810245015, "add_time_dim_to_batch_and_zero_pad": 1.0822319420502905e-05, "numpy_to_tensor": 0.00011466477961650383, "add_one_ts_to_episodes_and_truncate": 0.005002467068190311, "add_states_from_episodes_to_batch": 3.893898876834679e-06, "batch_individual_items": 0.09205357487619548, "general_advantage_estimation": 0.013390327038200466, "add_columns_from_episodes_to_train_batch": 0.03981630734401167, "add_observations_from_episodes_to_batch": 0.0003818227541149606}}, "connector_pipeline_timer": 0.15361371614384478}, "num_module_steps_trained_lifetime": 2170496, "num_module_steps_trained": 64256, "num_env_steps_trained_lifetime": 33914000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1004000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1093800.4072021283, "num_module_steps_trained_throughput": 70004.10432860337, "num_module_steps_trained_lifetime_throughput": 70004.04500542584}, "shared_policy": {"vf_loss_unclipped": 1986.698974609375, "weights_seq_no": 33.0, "mean_kl_loss": 0.021871495991945267, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 64256, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.940274238586426, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.03658546134829521, "gradients_default_optimizer_global_norm": 4.779052734375, "entropy": 0.21213309466838837, "vf_explained_var": 0.18575072288513184, "curr_kl_coeff": 0.08437500149011612, "num_module_steps_trained_lifetime": 2170496, "total_loss": 8.975969314575195, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70004.05098820761}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 123000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 33, "trial_id": "c13e0_00000", "date": "2025-06-25_18-54-16", "timestamp": 1750902856, "time_this_iter_s": 1.6876111030578613, "time_total_s": 301.81848406791687, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x102611a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 301.81848406791687, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 14.8, "ram_util_percent": 52.3}}
{"timers": {"training_iteration": 3.7479968858465136, "restore_env_runners": 0.0009125457517852679, "training_step": 3.7469695310154423, "env_runner_sampling_timer": 2.7012368198476686, "learner_update_timer": 1.0438215861441422, "synch_weights": 0.0008104838721963794, "synch_env_connectors": 0.0009016354419134719}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 386137.00000000006}, "agent_steps": {"vehicle_0": 41.4, "vehicle_3": 41.56, "vehicle_1": 64.84, "vehicle_2": 63.94}, "episode_return_max": 1195.4789493083954, "env_to_module_connector": {"connector_pipeline_timer": 6.254969728607301e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4820729997720226e-06, "add_states_from_episodes_to_batch": 1.6625370834105411e-06, "add_observations_from_episodes_to_batch": 1.2011286462685574e-05, "batch_individual_items": 8.13748322288057e-06, "add_time_dim_to_batch_and_zero_pad": 2.5639292512199423e-06, "numpy_to_tensor": 9.343615476628916e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9165024645626545e-06, "add_observations_from_episodes_to_batch": 3.987450327258557e-05, "batch_individual_items": 2.2208500013221055e-05, "add_time_dim_to_batch_and_zero_pad": 7.811999239493161e-06, "numpy_to_tensor": 2.3312499251915142e-05, "agent_to_module_mapping": 5.3960029617883265e-06}}, "sample": 0.10715905168215409, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.495430477723891e-06, "get_actions": 3.6184586526616864e-05, "remove_single_ts_time_rank_from_batch": 6.394280759993609e-07, "normalize_and_clip_actions": 3.626954002970234e-05, "tensor_to_numpy": 1.6307916430618876e-05, "un_batch_to_individual_items": 1.2258673168258322e-05, "module_to_agent_unmapping": 1.6093076238844176e-06}}, "connector_pipeline_timer": 0.00013952026940434187}, "rlmodule_inference_timer": 9.73493346104539e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 116664.0, "vehicle_0": 74922.00000000001, "vehicle_3": 74930.00000000001, "vehicle_1": 119621.0}, "env_step_timer": 9.914678256364796e-05, "agent_episode_returns_mean": {"vehicle_2": 170.67639662265776, "vehicle_0": 147.4470515871048, "vehicle_3": 166.13630726575852, "vehicle_1": 310.6575940227509}, "env_reset_timer": 8.645799971418455e-05, "num_episodes": 28.999999999999996, "env_to_module_sum_episodes_length_out": 37.061500342140484, "episode_return_mean": 794.9173471140862, "num_agent_steps_sampled": {"vehicle_2": 1882.0, "vehicle_0": 1150.0, "vehicle_3": 1150.0, "vehicle_1": 1843.0}, "episode_len_min": 40, "episode_len_mean": 68.58, "module_episode_returns_mean": {"shared_policy": 256.47362538099287}, "episode_return_min": 339.55819392204285, "num_env_steps_sampled_lifetime": 125000.0, "env_to_module_sum_episodes_length_in": 37.061500342140484, "num_module_steps_sampled": {"shared_policy": 6025.0}, "episode_duration_sec_mean": 0.03731508417942678, "episode_len_max": 232, "time_between_sampling": 0.555107368250647, "connector_pipeline_timer": 0.00023562500427942723, "weights_seq_no": 33.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1736.0, "num_env_steps_sampled_lifetime_throughput": 1936.7989830935478}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002661988010210313, "add_time_dim_to_batch_and_zero_pad": 1.0815346269669568e-05, "numpy_to_tensor": 0.00011438479186824338, "add_one_ts_to_episodes_and_truncate": 0.005010246567500276, "add_states_from_episodes_to_batch": 3.881209869668054e-06, "batch_individual_items": 0.0914558887174447, "general_advantage_estimation": 0.013384514187857832, "add_columns_from_episodes_to_train_batch": 0.03982113636051994, "add_observations_from_episodes_to_batch": 0.0003827495265430727}}, "connector_pipeline_timer": 0.15302520856244772}, "num_module_steps_trained_lifetime": 2233472, "num_module_steps_trained": 62976, "num_env_steps_trained_lifetime": 34898000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 984000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1093877.579196609, "num_module_steps_trained_throughput": 70008.65794248431, "num_module_steps_trained_lifetime_throughput": 70008.67942904991}, "shared_policy": {"vf_loss_unclipped": 2373.088134765625, "weights_seq_no": 34.0, "mean_kl_loss": 0.00822142418473959, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.393495559692383, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.14331233501434326, "gradients_default_optimizer_global_norm": 6.426766395568848, "entropy": 0.42037221789360046, "vf_explained_var": 0.06637954711914062, "curr_kl_coeff": 0.08437500149011612, "num_module_steps_trained_lifetime": 2233472, "total_loss": 9.533296585083008, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 70008.52820801965}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 125000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 34, "trial_id": "c13e0_00000", "date": "2025-06-25_18-54-18", "timestamp": 1750902858, "time_this_iter_s": 1.6412019729614258, "time_total_s": 303.4596860408783, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3174798a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 303.4596860408783, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 14.45, "ram_util_percent": 52.3}}
{"timers": {"training_iteration": 4.344341398657993, "restore_env_runners": 0.0009034636242684779, "training_step": 4.343322775285274, "env_runner_sampling_timer": 3.2977293070691522, "learner_update_timer": 1.0436779594527084, "synch_weights": 0.0008124036134438832, "synch_env_connectors": 0.0009002874175665297}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 392001.0}, "agent_steps": {"vehicle_0": 40.26, "vehicle_3": 40.26, "vehicle_1": 65.12, "vehicle_2": 67.20000000000002}, "episode_return_max": 1205.8151817321777, "env_to_module_connector": {"connector_pipeline_timer": 6.182146323600204e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4467421876441445e-06, "add_states_from_episodes_to_batch": 1.7235855756226793e-06, "add_observations_from_episodes_to_batch": 1.1643361565425161e-05, "batch_individual_items": 7.89167176018691e-06, "add_time_dim_to_batch_and_zero_pad": 2.5895649985784642e-06, "numpy_to_tensor": 9.365645234940306e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0667015127837655e-06, "add_observations_from_episodes_to_batch": 3.809110203292221e-05, "batch_individual_items": 2.2708300093654543e-05, "add_time_dim_to_batch_and_zero_pad": 8.070400508586317e-06, "numpy_to_tensor": 2.4187498638639227e-05, "agent_to_module_mapping": 5.6544042308814825e-06}}, "sample": 0.10656887508009379, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.179288524986472e-06, "get_actions": 3.60654416796657e-05, "remove_single_ts_time_rank_from_batch": 6.525005990241051e-07, "normalize_and_clip_actions": 3.393535341312466e-05, "tensor_to_numpy": 1.619704669671522e-05, "un_batch_to_individual_items": 1.1499918216833462e-05, "module_to_agent_unmapping": 1.5961894302149152e-06}}, "connector_pipeline_timer": 0.00013575605204504455}, "rlmodule_inference_timer": 5.7084979115613007e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 118549.0, "vehicle_0": 75992.00000000001, "vehicle_3": 76000.00000000001, "vehicle_1": 121460.0}, "env_step_timer": 9.804038940201508e-05, "agent_episode_returns_mean": {"vehicle_2": 148.76670080184937, "vehicle_0": 152.841855840683, "vehicle_3": 159.77945290565495, "vehicle_1": 297.11138097286226}, "env_reset_timer": 9.132480045082048e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 45.96181904743887, "episode_return_mean": 758.4993905115127, "num_agent_steps_sampled": {"vehicle_2": 1885.0, "vehicle_0": 1070.0, "vehicle_3": 1070.0, "vehicle_1": 1839.0000000000002}, "episode_len_min": 40, "episode_len_mean": 70.32, "module_episode_returns_mean": {"shared_policy": 294.2272595071792}, "episode_return_min": 339.55819392204285, "num_env_steps_sampled_lifetime": 127000.0, "env_to_module_sum_episodes_length_in": 45.96181904743887, "num_module_steps_sampled": {"shared_policy": 5863.999999999999}, "episode_duration_sec_mean": 0.03609384264025721, "episode_len_max": 232, "time_between_sampling": 0.5214445265157859, "connector_pipeline_timer": 0.00024004180449992406, "weights_seq_no": 34.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1764.0, "num_env_steps_sampled_lifetime_throughput": 2000.7955898374232}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002662637300131129, "add_time_dim_to_batch_and_zero_pad": 1.0796772796408024e-05, "numpy_to_tensor": 0.00011416135389742751, "add_one_ts_to_episodes_and_truncate": 0.0050155011818073325, "add_states_from_episodes_to_batch": 3.864897724018746e-06, "batch_individual_items": 0.09085705233028799, "general_advantage_estimation": 0.013382489046003416, "add_columns_from_episodes_to_train_batch": 0.03981422291691059, "add_observations_from_episodes_to_batch": 0.0003833516212491927}}, "connector_pipeline_timer": 0.15242299314683458}, "num_module_steps_trained_lifetime": 2294656, "num_module_steps_trained": 61184, "num_env_steps_trained_lifetime": 35854000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 956000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1091674.9639820114, "num_module_steps_trained_throughput": 69868.03241850599, "num_module_steps_trained_lifetime_throughput": 69867.87255067349}, "shared_policy": {"vf_loss_unclipped": 2365.8193359375, "weights_seq_no": 35.0, "mean_kl_loss": 0.02551984414458275, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 61184, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.925064086914062, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.10468599200248718, "gradients_default_optimizer_global_norm": 12.177766799926758, "entropy": 0.28705865144729614, "vf_explained_var": 0.13203150033950806, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2294656, "total_loss": 8.819661140441895, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69868.04692155028}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 127000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 35, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-21", "timestamp": 1750902921, "time_this_iter_s": 63.38455772399902, "time_total_s": 366.8442437648773, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317478860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 366.8442437648773, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.072222222222223, "ram_util_percent": 52.68}}
{"timers": {"training_iteration": 4.340051085091421, "restore_env_runners": 0.01807683981801736, "training_step": 4.321858376282454, "env_runner_sampling_timer": 3.2760105498384853, "learner_update_timer": 1.0439258765281771, "synch_weights": 0.0008148874972853268, "synch_env_connectors": 0.000902473293458823}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 398192.0}, "agent_steps": {"vehicle_0": 40.31999999999999, "vehicle_3": 40.31999999999999, "vehicle_1": 64.78, "vehicle_2": 61.74}, "episode_return_max": 1192.0619535446167, "env_to_module_connector": {"connector_pipeline_timer": 6.115677418889693e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4432550882260067e-06, "add_states_from_episodes_to_batch": 1.6584107472457037e-06, "add_observations_from_episodes_to_batch": 1.1869563155904396e-05, "batch_individual_items": 7.895204071131013e-06, "add_time_dim_to_batch_and_zero_pad": 2.5758148859011737e-06, "numpy_to_tensor": 9.068015580918692e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.292000085115433e-06, "add_observations_from_episodes_to_batch": 3.5416000173427165e-05, "batch_individual_items": 2.3458000214304775e-05, "add_time_dim_to_batch_and_zero_pad": 8.458002412226051e-06, "numpy_to_tensor": 2.5499997718725353e-05, "agent_to_module_mapping": 6.042006134521215e-06}}, "sample": 0.10577976723388922, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.31631103907359e-06, "get_actions": 3.6199253493585996e-05, "remove_single_ts_time_rank_from_batch": 6.365262572499208e-07, "normalize_and_clip_actions": 3.5939745427887205e-05, "tensor_to_numpy": 1.578534537652082e-05, "un_batch_to_individual_items": 1.2102987952971477e-05, "module_to_agent_unmapping": 1.558324591262124e-06}}, "connector_pipeline_timer": 0.0001376651099497557}, "rlmodule_inference_timer": 6.130459658461601e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 120419.00000000003, "vehicle_0": 77168.00000000001, "vehicle_3": 77176.00000000001, "vehicle_1": 123428.99999999997}, "env_step_timer": 9.864043621021428e-05, "agent_episode_returns_mean": {"vehicle_2": 145.28301105976104, "vehicle_0": 152.66486491203307, "vehicle_3": 160.04957970619205, "vehicle_1": 307.7072406899929}, "env_reset_timer": 9.862500155577436e-05, "num_episodes": 30.0, "env_to_module_sum_episodes_length_out": 35.477520418122424, "episode_return_mean": 765.7046961486336, "num_agent_steps_sampled": {"vehicle_2": 1870.0, "vehicle_0": 1175.9999999999998, "vehicle_3": 1175.9999999999998, "vehicle_1": 1969.0000000000002}, "episode_len_min": 41, "episode_len_mean": 64.82, "module_episode_returns_mean": {"shared_policy": 257.62632407188414}, "episode_return_min": 471.89606976509094, "num_env_steps_sampled_lifetime": 129000.0, "env_to_module_sum_episodes_length_in": 35.477520418122424, "num_module_steps_sampled": {"shared_policy": 6191.000000000001}, "episode_duration_sec_mean": 0.03309530596015975, "episode_len_max": 99, "time_between_sampling": 0.6301670367576687, "connector_pipeline_timer": 0.0002466670048306696, "weights_seq_no": 35.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 1793.9999999999995, "num_env_steps_sampled_lifetime_throughput": 1983.7942494969723}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002665783427186242, "add_time_dim_to_batch_and_zero_pad": 1.0782135086433445e-05, "numpy_to_tensor": 0.00011386641036764904, "add_one_ts_to_episodes_and_truncate": 0.005023625750033005, "add_states_from_episodes_to_batch": 3.854168706171889e-06, "batch_individual_items": 0.09029346638699108, "general_advantage_estimation": 0.013387014995531943, "add_columns_from_episodes_to_train_batch": 0.039830081937769865, "add_observations_from_episodes_to_batch": 0.00038441352509777587}}, "connector_pipeline_timer": 0.15189115279535376}, "num_module_steps_trained_lifetime": 2359296, "num_module_steps_trained": 64640, "num_env_steps_trained_lifetime": 36864000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1010000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1093482.0209142005, "num_module_steps_trained_throughput": 69983.53268263026, "num_module_steps_trained_lifetime_throughput": 69983.41406253619}, "shared_policy": {"vf_loss_unclipped": 2445.52099609375, "weights_seq_no": 36.0, "mean_kl_loss": 0.01567385345697403, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 64640, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.153209686279297, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.1540151685476303, "gradients_default_optimizer_global_norm": 6.738742828369141, "entropy": 0.02838774584233761, "vf_explained_var": -0.04192030429840088, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2359296, "total_loss": 9.000893592834473, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69983.5197059647}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 129000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 36, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-25", "timestamp": 1750902925, "time_this_iter_s": 3.917310953140259, "time_total_s": 370.7615547180176, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317421a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 370.7615547180176, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 15.433333333333332, "ram_util_percent": 52.31666666666666}}
{"timers": {"training_iteration": 4.312645335490546, "restore_env_runners": 0.017937403499837034, "training_step": 4.2945917362696715, "env_runner_sampling_timer": 3.2489438160001183, "learner_update_timer": 1.0437198723528798, "synch_weights": 0.00081713028234713, "synch_env_connectors": 0.0009029893905936892}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 113931.00000000003}, "agent_steps": {"vehicle_0": 40.370000000000005, "vehicle_3": 40.370000000000005, "vehicle_1": 73.1, "vehicle_2": 74.63}, "episode_return_max": 1186.4215178489685, "env_to_module_connector": {"connector_pipeline_timer": 6.183873537905678e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.453107786980478e-06, "add_states_from_episodes_to_batch": 1.6634311219321464e-06, "add_observations_from_episodes_to_batch": 1.1664635554066261e-05, "batch_individual_items": 7.938419616659403e-06, "add_time_dim_to_batch_and_zero_pad": 2.5618027692420405e-06, "numpy_to_tensor": 9.381514464524423e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10632227878469394, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.238892191148199e-06, "get_actions": 3.889671648682889e-05, "remove_single_ts_time_rank_from_batch": 6.357204991431319e-07, "normalize_and_clip_actions": 3.510065535989109e-05, "tensor_to_numpy": 1.7121618800714483e-05, "un_batch_to_individual_items": 1.1694705189394833e-05, "module_to_agent_unmapping": 1.5865234687589953e-06}}, "connector_pipeline_timer": 0.00014106006706223254}, "rlmodule_inference_timer": 6.131480849453936e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 35383.0, "vehicle_0": 21600.0, "vehicle_3": 21640.0, "vehicle_1": 35308.0}, "env_step_timer": 9.533914948537844e-05, "agent_episode_returns_mean": {"vehicle_2": 177.4034955084324, "vehicle_0": 151.4998360311985, "vehicle_3": 157.88659149885177, "vehicle_1": 352.53296007215977}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 23.999999999999996, "env_to_module_sum_episodes_length_out": 42.08844044620959, "episode_return_mean": 839.322883492112, "num_agent_steps_sampled": {"vehicle_2": 1848.0, "vehicle_0": 991.0, "vehicle_3": 991.0, "vehicle_1": 1837.0}, "episode_len_min": 40, "episode_len_mean": 79.36000000000001, "module_episode_returns_mean": {"shared_policy": 275.76015023708345}, "episode_return_min": 68.14964997768402, "num_env_steps_sampled_lifetime": 38000.0, "env_to_module_sum_episodes_length_in": 42.08844044620959, "num_module_steps_sampled": {"shared_policy": 5667.0}, "episode_duration_sec_mean": 0.039794092209886, "episode_len_max": 235, "time_between_sampling": 0.3346759965220711, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 36.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 535.0, "num_env_steps_sampled_lifetime_throughput": 1985.8823245192161}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026655939329162633, "add_time_dim_to_batch_and_zero_pad": 1.0795973785923077e-05, "numpy_to_tensor": 0.0001135952463211837, "add_one_ts_to_episodes_and_truncate": 0.005023721152482408, "add_states_from_episodes_to_batch": 3.841877000711893e-06, "batch_individual_items": 0.09046106339309619, "general_advantage_estimation": 0.013370999015597641, "add_columns_from_episodes_to_train_batch": 0.03980814861838581, "add_observations_from_episodes_to_batch": 0.00038446063986354793}}, "connector_pipeline_timer": 0.15201986834741968}, "num_module_steps_trained_lifetime": 2418304, "num_module_steps_trained": 59008, "num_env_steps_trained_lifetime": 37786000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 922000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1092071.8183298004, "num_module_steps_trained_throughput": 69893.17627615365, "num_module_steps_trained_lifetime_throughput": 69893.08170396285}, "shared_policy": {"vf_loss_unclipped": 2213.00341796875, "weights_seq_no": 37.0, "mean_kl_loss": 0.012489394284784794, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 59008, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.304203033447266, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.05005921423435211, "gradients_default_optimizer_global_norm": 23.53887367248535, "entropy": 0.09582676738500595, "vf_explained_var": 0.1989040970802307, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2418304, "total_loss": 9.354883193969727, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69893.05114362063}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 38000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 37, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-27", "timestamp": 1750902927, "time_this_iter_s": 1.6018469333648682, "time_total_s": 372.36340165138245, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3171c8ae0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 372.36340165138245, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 21.450000000000003, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 4.285429378385639, "restore_env_runners": 0.01775807821484607, "training_step": 4.26755492515694, "env_runner_sampling_timer": 3.2226674699201143, "learner_update_timer": 1.0429577057093276, "synch_weights": 0.0008165706394903006, "synch_env_connectors": 0.00090664241674764}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 119715.00000000003}, "agent_steps": {"vehicle_0": 40.42, "vehicle_3": 40.42, "vehicle_1": 81.60000000000001, "vehicle_2": 75.61999999999999}, "episode_return_max": 1186.4215178489685, "env_to_module_connector": {"connector_pipeline_timer": 6.17389061881364e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4231649320597804e-06, "add_states_from_episodes_to_batch": 1.63976463752112e-06, "add_observations_from_episodes_to_batch": 1.2072731334658308e-05, "batch_individual_items": 7.95578380827867e-06, "add_time_dim_to_batch_and_zero_pad": 2.5728973773596456e-06, "numpy_to_tensor": 9.325177424615028e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10632464748762131, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.211582939516323e-06, "get_actions": 3.6654768310540425e-05, "remove_single_ts_time_rank_from_batch": 6.393543996677588e-07, "normalize_and_clip_actions": 3.438288876991771e-05, "tensor_to_numpy": 1.625751793687599e-05, "un_batch_to_individual_items": 1.1505771944357451e-05, "module_to_agent_unmapping": 1.5944347689651672e-06}}, "connector_pipeline_timer": 0.00013659823007965054}, "rlmodule_inference_timer": 9.028945026114918e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 37208.0, "vehicle_0": 22593.999999999996, "vehicle_3": 22633.999999999996, "vehicle_1": 37278.99999999999}, "env_step_timer": 9.724116483162621e-05, "agent_episode_returns_mean": {"vehicle_2": 225.18013709545136, "vehicle_0": 149.12304708957672, "vehicle_3": 155.6972275495529, "vehicle_1": 390.4968482315541}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 26.000000000000004, "env_to_module_sum_episodes_length_out": 41.08407650839488, "episode_return_mean": 920.4972604238985, "num_agent_steps_sampled": {"vehicle_2": 1825.0, "vehicle_0": 994.0, "vehicle_3": 994.0, "vehicle_1": 1970.9999999999998}, "episode_len_min": 40, "episode_len_mean": 81.7, "module_episode_returns_mean": {"shared_policy": 258.4431109905243}, "episode_return_min": 513.4077491760254, "num_env_steps_sampled_lifetime": 40000.0, "env_to_module_sum_episodes_length_in": 41.08407650839488, "num_module_steps_sampled": {"shared_policy": 5783.999999999999}, "episode_duration_sec_mean": 0.042043952378444376, "episode_len_max": 100, "time_between_sampling": 0.2979039031551015, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 37.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 561.0, "num_env_steps_sampled_lifetime_throughput": 1986.6318154097162}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026655288236078238, "add_time_dim_to_batch_and_zero_pad": 1.0779684056323672e-05, "numpy_to_tensor": 0.00011341679387289166, "add_one_ts_to_episodes_and_truncate": 0.0050278651909685034, "add_states_from_episodes_to_batch": 3.828868275759515e-06, "batch_individual_items": 0.08986406650913906, "general_advantage_estimation": 0.013361103605443299, "add_columns_from_episodes_to_train_batch": 0.039795257132217376, "add_observations_from_episodes_to_batch": 0.0003849856134480891}}, "connector_pipeline_timer": 0.15140390591400774}, "num_module_steps_trained_lifetime": 2478592, "num_module_steps_trained": 60288, "num_env_steps_trained_lifetime": 38728000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 942000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1091405.7085789843, "num_module_steps_trained_throughput": 69850.49604520595, "num_module_steps_trained_lifetime_throughput": 69850.42362311829}, "shared_policy": {"vf_loss_unclipped": 1987.900390625, "weights_seq_no": 38.0, "mean_kl_loss": 0.008711724542081356, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 60288, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.41702651977539, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.06660231947898865, "gradients_default_optimizer_global_norm": 4.493899822235107, "entropy": 0.10789822787046432, "vf_explained_var": 0.2318456768989563, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2478592, "total_loss": 9.350447654724121, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69850.36641182094}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 38, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-28", "timestamp": 1750902928, "time_this_iter_s": 1.593087911605835, "time_total_s": 373.9564895629883, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x3174225c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 373.9564895629883, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.65, "ram_util_percent": 52.650000000000006}}
{"timers": {"training_iteration": 4.258684511691761, "restore_env_runners": 0.017580549092724267, "training_step": 4.240987407995348, "env_runner_sampling_timer": 3.1961998214709295, "learner_update_timer": 1.042852137402265, "synch_weights": 0.0008199470130510863, "synch_env_connectors": 0.0009078526525395088}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 125831.00000000003}, "agent_steps": {"vehicle_0": 40.14, "vehicle_3": 40.14, "vehicle_1": 68.55999999999999, "vehicle_2": 64.66000000000003}, "episode_return_max": 1203.9994180202484, "env_to_module_connector": {"connector_pipeline_timer": 6.174946453128033e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4592872627063857e-06, "add_states_from_episodes_to_batch": 1.6399921527585537e-06, "add_observations_from_episodes_to_batch": 1.1980044264719977e-05, "batch_individual_items": 8.057120751939825e-06, "add_time_dim_to_batch_and_zero_pad": 2.537661065652029e-06, "numpy_to_tensor": 9.309718190564786e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10651796663297515, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.333569228276497e-06, "get_actions": 3.5868366065464775e-05, "remove_single_ts_time_rank_from_batch": 6.319494426040122e-07, "normalize_and_clip_actions": 3.583916518206035e-05, "tensor_to_numpy": 1.6260988474366267e-05, "un_batch_to_individual_items": 1.2099585292819126e-05, "module_to_agent_unmapping": 1.5978519034770283e-06}}, "connector_pipeline_timer": 0.00013777145720446994}, "rlmodule_inference_timer": 6.411793684914741e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 39067.0, "vehicle_0": 23742.999999999996, "vehicle_3": 23782.999999999996, "vehicle_1": 39237.99999999999}, "env_step_timer": 0.00010034418468737217, "agent_episode_returns_mean": {"vehicle_2": 183.29181578159333, "vehicle_0": 161.51931435585024, "vehicle_3": 163.19201345443724, "vehicle_1": 327.1720068669319}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 35.131344309558685, "episode_return_mean": 835.1751495814324, "num_agent_steps_sampled": {"vehicle_2": 1859.0000000000002, "vehicle_0": 1149.0000000000002, "vehicle_3": 1149.0000000000002, "vehicle_1": 1959.0000000000002}, "episode_len_min": 40, "episode_len_mean": 68.84, "module_episode_returns_mean": {"shared_policy": 285.88502195835116}, "episode_return_min": 512.2444766759872, "num_env_steps_sampled_lifetime": 42000.0, "env_to_module_sum_episodes_length_in": 35.131344309558685, "num_module_steps_sampled": {"shared_policy": 6116.000000000001}, "episode_duration_sec_mean": 0.03607551428125588, "episode_len_max": 112, "time_between_sampling": 0.2935719549000007, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 38.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 589.0, "num_env_steps_sampled_lifetime_throughput": 1971.6269599650186}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026669797853279267, "add_time_dim_to_batch_and_zero_pad": 1.0753137179601835e-05, "numpy_to_tensor": 0.00011311846589872857, "add_one_ts_to_episodes_and_truncate": 0.00503439861906051, "add_states_from_episodes_to_batch": 3.8134896190204276e-06, "batch_individual_items": 0.08928527418405235, "general_advantage_estimation": 0.013360435069374668, "add_columns_from_episodes_to_train_batch": 0.039810233730874375, "add_observations_from_episodes_to_batch": 0.00038605992730256173}}, "connector_pipeline_timer": 0.150847424354873}, "num_module_steps_trained_lifetime": 2542336, "num_module_steps_trained": 63744, "num_env_steps_trained_lifetime": 39724000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 996000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1091112.902942266, "num_module_steps_trained_throughput": 69831.33885958884, "num_module_steps_trained_lifetime_throughput": 69831.41598988573}, "shared_policy": {"vf_loss_unclipped": 2006.12646484375, "weights_seq_no": 39.0, "mean_kl_loss": 0.006782974116504192, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 63744, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.811841011047363, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.1517922282218933, "gradients_default_optimizer_global_norm": 8.644461631774902, "entropy": 0.2231946736574173, "vf_explained_var": 0.25532615184783936, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2542336, "total_loss": 8.962259292602539, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69831.06438306988}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 42000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 39, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-30", "timestamp": 1750902930, "time_this_iter_s": 1.6132781505584717, "time_total_s": 375.56976771354675, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef27a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 375.56976771354675, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.7, "ram_util_percent": 53.166666666666664}}
{"timers": {"training_iteration": 4.231508649914813, "restore_env_runners": 0.017404793601813948, "training_step": 4.21398689516538, "env_runner_sampling_timer": 3.1699294149261856, "learner_update_timer": 1.0421193751983053, "synch_weights": 0.0008194725428800396, "synch_env_connectors": 0.0009118916260710921}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 131667.00000000003}, "agent_steps": {"vehicle_0": 43.4, "vehicle_3": 43.86, "vehicle_1": 68.66, "vehicle_2": 65.46}, "episode_return_max": 1205.5992336273193, "env_to_module_connector": {"connector_pipeline_timer": 6.157680074457905e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4651007067928556e-06, "add_states_from_episodes_to_batch": 1.6590391229989813e-06, "add_observations_from_episodes_to_batch": 1.1786248409977884e-05, "batch_individual_items": 7.937782057750245e-06, "add_time_dim_to_batch_and_zero_pad": 2.539654529711791e-06, "numpy_to_tensor": 9.253579243862652e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10651206433050882, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.341908557906095e-06, "get_actions": 3.514227229620582e-05, "remove_single_ts_time_rank_from_batch": 6.303226774367168e-07, "normalize_and_clip_actions": 3.5011933637903e-05, "tensor_to_numpy": 1.599771165220983e-05, "un_batch_to_individual_items": 1.1705871842193443e-05, "module_to_agent_unmapping": 1.5979178798997524e-06}}, "connector_pipeline_timer": 0.00013553482182126965}, "rlmodule_inference_timer": 5.808186357349987e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 40806.0, "vehicle_0": 24864.0, "vehicle_3": 24920.0, "vehicle_1": 41076.99999999999}, "env_step_timer": 9.890449935592689e-05, "agent_episode_returns_mean": {"vehicle_2": 173.17750913143158, "vehicle_0": 154.92439190864567, "vehicle_3": 183.71720260620114, "vehicle_1": 321.83706292629245}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 26.000000000000004, "env_to_module_sum_episodes_length_out": 39.55244942392726, "episode_return_mean": 833.6561665153504, "num_agent_steps_sampled": {"vehicle_2": 1739.0000000000002, "vehicle_0": 1121.0, "vehicle_3": 1137.0, "vehicle_1": 1839.0000000000002}, "episode_len_min": 40, "episode_len_mean": 72.96000000000001, "module_episode_returns_mean": {"shared_policy": 312.4221232318878}, "episode_return_min": 462.15327966213226, "num_env_steps_sampled_lifetime": 44000.0, "env_to_module_sum_episodes_length_in": 39.55244942392726, "num_module_steps_sampled": {"shared_policy": 5836.000000000001}, "episode_duration_sec_mean": 0.036825614760164174, "episode_len_max": 112, "time_between_sampling": 0.2898415040694977, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 39.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 615.0, "num_env_steps_sampled_lifetime_throughput": 1985.4949342219224}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026664762374289056, "add_time_dim_to_batch_and_zero_pad": 1.0725195834677118e-05, "numpy_to_tensor": 0.0001128539512557078, "add_one_ts_to_episodes_and_truncate": 0.005044243382864172, "add_states_from_episodes_to_batch": 3.7995247264287794e-06, "batch_individual_items": 0.08871317936219252, "general_advantage_estimation": 0.013348309468687565, "add_columns_from_episodes_to_train_batch": 0.03980259181358719, "add_observations_from_episodes_to_batch": 0.00038680474799243587}}, "connector_pipeline_timer": 0.15026448969138165}, "num_module_steps_trained_lifetime": 2603136, "num_module_steps_trained": 60800, "num_env_steps_trained_lifetime": 40674000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 950000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1091078.013639227, "num_module_steps_trained_throughput": 69829.24292745208, "num_module_steps_trained_lifetime_throughput": 69829.26593929117}, "shared_policy": {"vf_loss_unclipped": 1773.7734375, "weights_seq_no": 40.0, "mean_kl_loss": 0.006225126329809427, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 60800, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.952188491821289, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.14033940434455872, "gradients_default_optimizer_global_norm": 9.007935523986816, "entropy": 0.07717867195606232, "vf_explained_var": 0.37127232551574707, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2603136, "total_loss": 8.811864852905273, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69829.44358571828}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 44000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 40, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-32", "timestamp": 1750902932, "time_this_iter_s": 1.543712854385376, "time_total_s": 377.11348056793213, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317421620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 377.11348056793213, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 14.2, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 4.205195000075673, "restore_env_runners": 0.017230801505787357, "training_step": 4.187846793713761, "env_runner_sampling_timer": 3.143948332856879, "learner_update_timer": 1.041955646866322, "synch_weights": 0.000821151987515234, "synch_env_connectors": 0.0009160481297980029}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 137692.00000000003}, "agent_steps": {"vehicle_0": 40.22, "vehicle_3": 40.22, "vehicle_1": 72.64, "vehicle_2": 68.16}, "episode_return_max": 1176.1929214000702, "env_to_module_connector": {"connector_pipeline_timer": 6.218263551131924e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4966767580429585e-06, "add_states_from_episodes_to_batch": 1.6653094910044624e-06, "add_observations_from_episodes_to_batch": 1.197606460695717e-05, "batch_individual_items": 8.089025264738003e-06, "add_time_dim_to_batch_and_zero_pad": 2.5844422110952274e-06, "numpy_to_tensor": 9.469928278891434e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10647437256130761, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.340466015886472e-06, "get_actions": 3.625049915624493e-05, "remove_single_ts_time_rank_from_batch": 6.37257142733956e-07, "normalize_and_clip_actions": 3.557226159813718e-05, "tensor_to_numpy": 1.6322080284376573e-05, "un_batch_to_individual_items": 1.1856120893922787e-05, "module_to_agent_unmapping": 1.6044992226163691e-06}}, "connector_pipeline_timer": 0.00013781667103297143}, "rlmodule_inference_timer": 5.930566722657447e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 42634.0, "vehicle_0": 25985.0, "vehicle_3": 26041.0, "vehicle_1": 43031.99999999999}, "env_step_timer": 0.0001001690550873477, "agent_episode_returns_mean": {"vehicle_2": 188.90449497699737, "vehicle_0": 156.6363603878021, "vehicle_3": 158.3543905878067, "vehicle_1": 351.6463942360878}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 37.692555394421106, "episode_return_mean": 855.5416403031351, "num_agent_steps_sampled": {"vehicle_2": 1828.0, "vehicle_0": 1121.0, "vehicle_3": 1121.0, "vehicle_1": 1955.0}, "episode_len_min": 40, "episode_len_mean": 72.92, "module_episode_returns_mean": {"shared_policy": 304.4614108037949}, "episode_return_min": 415.88199615478516, "num_env_steps_sampled_lifetime": 46000.0, "env_to_module_sum_episodes_length_in": 37.692555394421106, "num_module_steps_sampled": {"shared_policy": 6025.0}, "episode_duration_sec_mean": 0.03700717332059867, "episode_len_max": 108, "time_between_sampling": 0.2858532645972886, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 40.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 643.0, "num_env_steps_sampled_lifetime_throughput": 1975.8793628844924}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026685148050083307, "add_time_dim_to_batch_and_zero_pad": 1.0753783894959444e-05, "numpy_to_tensor": 0.00011259124174981069, "add_one_ts_to_episodes_and_truncate": 0.0050495176190664915, "add_states_from_episodes_to_batch": 3.7869394514596566e-06, "batch_individual_items": 0.08815238423853902, "general_advantage_estimation": 0.013339845123968838, "add_columns_from_episodes_to_train_batch": 0.03981647089545216, "add_observations_from_episodes_to_batch": 0.00038757336045426393}}, "connector_pipeline_timer": 0.14971649229443393}, "num_module_steps_trained_lifetime": 2665984, "num_module_steps_trained": 62848, "num_env_steps_trained_lifetime": 41656000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 982000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1090842.2699609762, "num_module_steps_trained_throughput": 69813.98543640989, "num_module_steps_trained_lifetime_throughput": 69814.10269490801}, "shared_policy": {"vf_loss_unclipped": 1492.7130126953125, "weights_seq_no": 41.0, "mean_kl_loss": 0.008922995068132877, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62848, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.932377815246582, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.09332260489463806, "gradients_default_optimizer_global_norm": 3.6340267658233643, "entropy": 0.194780632853508, "vf_explained_var": 0.417156457901001, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2665984, "total_loss": 9.024882316589355, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69814.13262139216}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 46000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 41, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-33", "timestamp": 1750902933, "time_this_iter_s": 1.6025419235229492, "time_total_s": 378.7160224914551, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 378.7160224914551, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.35, "ram_util_percent": 53.05}}
{"timers": {"training_iteration": 4.179714758414895, "restore_env_runners": 0.01705878391072317, "training_step": 4.162538140356621, "env_runner_sampling_timer": 3.119148380778349, "learner_update_timer": 1.041444639567654, "synch_weights": 0.0008211721376391586, "synch_env_connectors": 0.0009204122284902124}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 143652.00000000003}, "agent_steps": {"vehicle_0": 41.1, "vehicle_3": 41.3, "vehicle_1": 69.48, "vehicle_2": 64.82}, "episode_return_max": 1183.673133611679, "env_to_module_connector": {"connector_pipeline_timer": 6.261668268867166e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.511752230194465e-06, "add_states_from_episodes_to_batch": 1.691425994469763e-06, "add_observations_from_episodes_to_batch": 1.1934893693717169e-05, "batch_individual_items": 8.20192224366825e-06, "add_time_dim_to_batch_and_zero_pad": 2.6006560052998792e-06, "numpy_to_tensor": 9.508248627629482e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10656296516134359, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.420707006807011e-06, "get_actions": 3.6547081758793455e-05, "remove_single_ts_time_rank_from_batch": 6.434841329445881e-07, "normalize_and_clip_actions": 3.594320195572181e-05, "tensor_to_numpy": 1.63754854284662e-05, "un_batch_to_individual_items": 1.2002914299963803e-05, "module_to_agent_unmapping": 1.6333788733023618e-06}}, "connector_pipeline_timer": 0.00013903008887363602}, "rlmodule_inference_timer": 6.072773807654163e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 44428.0, "vehicle_0": 27098.0, "vehicle_3": 27164.0, "vehicle_1": 44962.0}, "env_step_timer": 0.0001003212834845277, "agent_episode_returns_mean": {"vehicle_2": 207.2061113882065, "vehicle_0": 159.4817820739746, "vehicle_3": 166.96567090034486, "vehicle_1": 331.19274673461916}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 36.44023091391701, "episode_return_mean": 864.8463130807879, "num_agent_steps_sampled": {"vehicle_2": 1794.0000000000002, "vehicle_0": 1113.0, "vehicle_3": 1123.0, "vehicle_1": 1930.0}, "episode_len_min": 40, "episode_len_mean": 70.6, "module_episode_returns_mean": {"shared_policy": 320.4071442079544}, "episode_return_min": 561.2745554447174, "num_env_steps_sampled_lifetime": 48000.0, "env_to_module_sum_episodes_length_in": 36.44023091391701, "num_module_steps_sampled": {"shared_policy": 5960.0}, "episode_duration_sec_mean": 0.03659941411999171, "episode_len_max": 99, "time_between_sampling": 0.28243953365692887, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 41.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 671.0, "num_env_steps_sampled_lifetime_throughput": 1968.6070986813438}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026691200669566335, "add_time_dim_to_batch_and_zero_pad": 1.0741666020064448e-05, "numpy_to_tensor": 0.0001123240793228969, "add_one_ts_to_episodes_and_truncate": 0.005052423692918779, "add_states_from_episodes_to_batch": 3.7715700827520087e-06, "batch_individual_items": 0.08758604956614993, "general_advantage_estimation": 0.013333576672693533, "add_columns_from_episodes_to_train_batch": 0.03982725285649285, "add_observations_from_episodes_to_batch": 0.00038817637682889226}}, "connector_pipeline_timer": 0.14915782195153074}, "num_module_steps_trained_lifetime": 2728064, "num_module_steps_trained": 62080, "num_env_steps_trained_lifetime": 42626000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 970000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1089144.491830093, "num_module_steps_trained_throughput": 69705.84283764337, "num_module_steps_trained_lifetime_throughput": 69705.64035270525}, "shared_policy": {"vf_loss_unclipped": 2157.189208984375, "weights_seq_no": 42.0, "mean_kl_loss": 0.017074910923838615, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62080, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.141570091247559, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.22637492418289185, "gradients_default_optimizer_global_norm": 5.371436595916748, "entropy": -0.09418225288391113, "vf_explained_var": 0.29907655715942383, "curr_kl_coeff": 0.12656250596046448, "num_module_steps_trained_lifetime": 2728064, "total_loss": 8.91829776763916, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69706.01130824996}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 48000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 42, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-35", "timestamp": 1750902935, "time_this_iter_s": 1.6594569683074951, "time_total_s": 380.3754794597626, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317479940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 380.3754794597626, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 15.799999999999999, "ram_util_percent": 53.06666666666666}}
{"timers": {"training_iteration": 4.153872454170751, "restore_env_runners": 0.01688823898164873, "training_step": 4.136865828113078, "env_runner_sampling_timer": 3.093759617800526, "learner_update_timer": 1.041157835671988, "synch_weights": 0.0008211716662140402, "synch_env_connectors": 0.0009239164462055551}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 149647.00000000003}, "agent_steps": {"vehicle_0": 40.17999999999999, "vehicle_3": 40.17999999999999, "vehicle_1": 70.76, "vehicle_2": 67.1}, "episode_return_max": 1183.673133611679, "env_to_module_connector": {"connector_pipeline_timer": 6.288505735124492e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5123365462021663e-06, "add_states_from_episodes_to_batch": 1.6695966905203437e-06, "add_observations_from_episodes_to_batch": 1.2045408149493885e-05, "batch_individual_items": 8.25728966770016e-06, "add_time_dim_to_batch_and_zero_pad": 2.5988884038401197e-06, "numpy_to_tensor": 9.502615729071995e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10663819123494174, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.4834846267915345e-06, "get_actions": 3.646986780065995e-05, "remove_single_ts_time_rank_from_batch": 6.443323213089707e-07, "normalize_and_clip_actions": 3.7003636484027326e-05, "tensor_to_numpy": 1.6413967597218505e-05, "un_batch_to_individual_items": 1.2224354258945333e-05, "module_to_agent_unmapping": 1.6407035003457453e-06}}, "connector_pipeline_timer": 0.0001405948220586841}, "rlmodule_inference_timer": 6.0559139589659324e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 46280.0, "vehicle_0": 28195.0, "vehicle_3": 28261.0, "vehicle_1": 46911.0}, "env_step_timer": 0.00010050266786919839, "agent_episode_returns_mean": {"vehicle_2": 183.7504957985878, "vehicle_0": 162.10399127960207, "vehicle_3": 164.43643521785737, "vehicle_1": 333.94129554748525}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 28.0, "env_to_module_sum_episodes_length_out": 35.437248494581446, "episode_return_mean": 844.2322177290916, "num_agent_steps_sampled": {"vehicle_2": 1852.0, "vehicle_0": 1097.0, "vehicle_3": 1097.0, "vehicle_1": 1949.0000000000002}, "episode_len_min": 40, "episode_len_mean": 71.48, "module_episode_returns_mean": {"shared_policy": 230.86124679803848}, "episode_return_min": 271.41235542297363, "num_env_steps_sampled_lifetime": 50000.0, "env_to_module_sum_episodes_length_in": 35.437248494581446, "num_module_steps_sampled": {"shared_policy": 5995.0}, "episode_duration_sec_mean": 0.036749701580411055, "episode_len_max": 111, "time_between_sampling": 0.279600469448434, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 42.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 699.0, "num_env_steps_sampled_lifetime_throughput": 1929.9640636679503}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026692680362371754, "add_time_dim_to_batch_and_zero_pad": 1.0718419311014929e-05, "numpy_to_tensor": 0.00011205333854542126, "add_one_ts_to_episodes_and_truncate": 0.005060468625985781, "add_states_from_episodes_to_batch": 3.7576044172495538e-06, "batch_individual_items": 0.08704129907045849, "general_advantage_estimation": 0.01332767382594709, "add_columns_from_episodes_to_train_batch": 0.039830079907904214, "add_observations_from_episodes_to_batch": 0.00038968461306632167}}, "connector_pipeline_timer": 0.14861871289198084}, "num_module_steps_trained_lifetime": 2790656, "num_module_steps_trained": 62592, "num_env_steps_trained_lifetime": 43604000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 978000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1087708.3604747849, "num_module_steps_trained_throughput": 69614.14536830361, "num_module_steps_trained_lifetime_throughput": 69613.90024026872}, "shared_policy": {"vf_loss_unclipped": 1957.474365234375, "weights_seq_no": 43.0, "mean_kl_loss": 0.026681046932935715, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62592, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.125503540039062, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.1095513179898262, "gradients_default_optimizer_global_norm": 22.383567810058594, "entropy": -0.06803476810455322, "vf_explained_var": 0.25040584802627563, "curr_kl_coeff": 0.18984375894069672, "num_module_steps_trained_lifetime": 2790656, "total_loss": 8.02000904083252, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69614.26792965712}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 50000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 43, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-37", "timestamp": 1750902937, "time_this_iter_s": 1.597870111465454, "time_total_s": 381.973349571228, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef14e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 381.973349571228, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 14.8, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 4.128424168379004, "restore_env_runners": 0.01671940034187434, "training_step": 4.111586159421936, "env_runner_sampling_timer": 3.068652215372528, "learner_update_timer": 1.0409825614852255, "synch_weights": 0.0008213178694936725, "synch_env_connectors": 0.0009278485317004399}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 155679.00000000003}, "agent_steps": {"vehicle_0": 40.05999999999999, "vehicle_3": 40.05999999999999, "vehicle_1": 67.26, "vehicle_2": 63.04}, "episode_return_max": 1189.8313493728638, "env_to_module_connector": {"connector_pipeline_timer": 6.208561592766927e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4800441512455707e-06, "add_states_from_episodes_to_batch": 1.6732994757977215e-06, "add_observations_from_episodes_to_batch": 1.1955101196359093e-05, "batch_individual_items": 8.032669356536165e-06, "add_time_dim_to_batch_and_zero_pad": 2.5463997722955094e-06, "numpy_to_tensor": 9.221779206808926e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7295030779205263e-06, "add_observations_from_episodes_to_batch": 3.204149834346026e-05, "batch_individual_items": 2.1853997168364003e-05, "add_time_dim_to_batch_and_zero_pad": 7.624999852851033e-06, "numpy_to_tensor": 2.1895997633691877e-05, "agent_to_module_mapping": 5.375004548113793e-06}}, "sample": 0.10668410264078458, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.454608935374139e-06, "get_actions": 3.545855626053076e-05, "remove_single_ts_time_rank_from_batch": 6.316125968089727e-07, "normalize_and_clip_actions": 3.539621924565939e-05, "tensor_to_numpy": 1.6094097422651017e-05, "un_batch_to_individual_items": 1.1870115314609048e-05, "module_to_agent_unmapping": 1.59356088820556e-06}}, "connector_pipeline_timer": 0.0001368539489942044}, "rlmodule_inference_timer": 5.770430357395741e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 48112.0, "vehicle_0": 29310.0, "vehicle_3": 29376.0, "vehicle_1": 48881.0}, "env_step_timer": 9.82359460741591e-05, "agent_episode_returns_mean": {"vehicle_2": 205.08085406064987, "vehicle_0": 168.5943024969101, "vehicle_3": 167.0240749359131, "vehicle_1": 321.22095485687254}, "env_reset_timer": 8.650000017951243e-05, "num_episodes": 28.999999999999996, "env_to_module_sum_episodes_length_out": 37.3644395496568, "episode_return_mean": 861.920184299946, "num_agent_steps_sampled": {"vehicle_2": 1832.0, "vehicle_0": 1115.0, "vehicle_3": 1115.0, "vehicle_1": 1970.0}, "episode_len_min": 40, "episode_len_mean": 67.42000000000002, "module_episode_returns_mean": {"shared_policy": 278.10359834432603}, "episode_return_min": 425.22179782390594, "num_env_steps_sampled_lifetime": 52000.0, "env_to_module_sum_episodes_length_in": 37.3644395496568, "num_module_steps_sampled": {"shared_policy": 6032.0}, "episode_duration_sec_mean": 0.03466543243979686, "episode_len_max": 105, "time_between_sampling": 0.2763783245799977, "connector_pipeline_timer": 0.0002191045023209881, "weights_seq_no": 43.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 728.0, "num_env_steps_sampled_lifetime_throughput": 1953.0078335825215}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026698507659044914, "add_time_dim_to_batch_and_zero_pad": 1.069040517650259e-05, "numpy_to_tensor": 0.00011185613516790292, "add_one_ts_to_episodes_and_truncate": 0.005068081439698593, "add_states_from_episodes_to_batch": 3.7441983766756144e-06, "batch_individual_items": 0.08649421649975053, "general_advantage_estimation": 0.01332850041767081, "add_columns_from_episodes_to_train_batch": 0.03984256202883265, "add_observations_from_episodes_to_batch": 0.0003907169269946225}}, "connector_pipeline_timer": 0.14809323076309508}, "num_module_steps_trained_lifetime": 2853632, "num_module_steps_trained": 62976, "num_env_steps_trained_lifetime": 44588000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 984000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1086734.9258170773, "num_module_steps_trained_throughput": 69551.93538089757, "num_module_steps_trained_lifetime_throughput": 69551.6215478936}, "shared_policy": {"vf_loss_unclipped": 1519.293212890625, "weights_seq_no": 44.0, "mean_kl_loss": 0.017223916947841644, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.590097427368164, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.017399420961737633, "gradients_default_optimizer_global_norm": 26.126073837280273, "entropy": 0.05555025488138199, "vf_explained_var": 0.4121132493019104, "curr_kl_coeff": 0.18984375894069672, "num_module_steps_trained_lifetime": 2853632, "total_loss": 8.610211372375488, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69552.0837917537}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 52000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 44, "trial_id": "c13e0_00000", "date": "2025-06-25_18-55-38", "timestamp": 1750902938, "time_this_iter_s": 1.6114540100097656, "time_total_s": 383.5848035812378, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317423b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 383.5848035812378, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 14.399999999999999, "ram_util_percent": 53.1}}
{"timers": {"training_iteration": 4.721944953775215, "restore_env_runners": 0.01655224966845666, "training_step": 4.705273579077777, "env_runner_sampling_timer": 3.6621566573888504, "learner_update_timer": 1.0411594742003942, "synch_weights": 0.0008250071908445708, "synch_env_connectors": 0.000930666716344901}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 161595.00000000003}, "agent_steps": {"vehicle_0": 40.14, "vehicle_3": 40.14, "vehicle_1": 74.8, "vehicle_2": 70.2}, "episode_return_max": 1189.8313493728638, "env_to_module_connector": {"connector_pipeline_timer": 5.9760691563081944e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.3613109246211098e-06, "add_states_from_episodes_to_batch": 1.6106395568763805e-06, "add_observations_from_episodes_to_batch": 1.1411382071075237e-05, "batch_individual_items": 7.776742569217416e-06, "add_time_dim_to_batch_and_zero_pad": 2.4422336088933996e-06, "numpy_to_tensor": 8.981295180651781e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3920048736035822e-06, "add_observations_from_episodes_to_batch": 3.001679724548012e-05, "batch_individual_items": 2.089159534079954e-05, "add_time_dim_to_batch_and_zero_pad": 7.125198317226023e-06, "numpy_to_tensor": 1.973359758267179e-05, "agent_to_module_mapping": 4.97480359626934e-06}}, "sample": 0.10688529643856706, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.066169952349837e-06, "get_actions": 3.463833527510123e-05, "remove_single_ts_time_rank_from_batch": 6.14426378931311e-07, "normalize_and_clip_actions": 3.3296454870687145e-05, "tensor_to_numpy": 1.5631201217858412e-05, "un_batch_to_individual_items": 1.1238037036759617e-05, "module_to_agent_unmapping": 1.5447113241829136e-06}}, "connector_pipeline_timer": 0.0001315091399839852}, "rlmodule_inference_timer": 5.563076673474696e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 49968.0, "vehicle_0": 30360.0, "vehicle_3": 30426.0, "vehicle_1": 50841.0}, "env_step_timer": 9.682894533009857e-05, "agent_episode_returns_mean": {"vehicle_2": 184.78630474090576, "vehicle_0": 159.6551130056381, "vehicle_3": 163.06295629024507, "vehicle_1": 362.92148626089096}, "env_reset_timer": 7.922499935375527e-05, "num_episodes": 26.000000000000004, "env_to_module_sum_episodes_length_out": 41.336390246324164, "episode_return_mean": 870.4258602976801, "num_agent_steps_sampled": {"vehicle_2": 1855.9999999999998, "vehicle_0": 1050.0, "vehicle_3": 1050.0, "vehicle_1": 1960.0}, "episode_len_min": 40, "episode_len_mean": 75.08, "module_episode_returns_mean": {"shared_policy": 387.72471346855156}, "episode_return_min": -199.62596476078033, "num_env_steps_sampled_lifetime": 54000.0, "env_to_module_sum_episodes_length_in": 41.336390246324164, "num_module_steps_sampled": {"shared_policy": 5916.000000000001}, "episode_duration_sec_mean": 0.037373275041609304, "episode_len_max": 113, "time_between_sampling": 0.45667982543865027, "connector_pipeline_timer": 0.0002025670008151792, "weights_seq_no": 44.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 754.0, "num_env_steps_sampled_lifetime_throughput": 2039.372308749915}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026708714282024275, "add_time_dim_to_batch_and_zero_pad": 1.0681831180799531e-05, "numpy_to_tensor": 0.00011158007382859185, "add_one_ts_to_episodes_and_truncate": 0.005067672295271851, "add_states_from_episodes_to_batch": 3.728846418504248e-06, "batch_individual_items": 0.08671692058476943, "general_advantage_estimation": 0.01331961499351188, "add_columns_from_episodes_to_train_batch": 0.039831866828587546, "add_observations_from_episodes_to_batch": 0.0003917297577168019}}, "connector_pipeline_timer": 0.1482970997054764}, "num_module_steps_trained_lifetime": 2915200, "num_module_steps_trained": 61568, "num_env_steps_trained_lifetime": 45550000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 962000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1087551.8367323757, "num_module_steps_trained_throughput": 69604.00053413417, "num_module_steps_trained_lifetime_throughput": 69603.75003341635}, "shared_policy": {"vf_loss_unclipped": 1298.74462890625, "weights_seq_no": 45.0, "mean_kl_loss": 0.004453883972018957, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 61568, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.82302474975586, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.10997480899095535, "gradients_default_optimizer_global_norm": 15.104501724243164, "entropy": 0.02587992139160633, "vf_explained_var": 0.48196375370025635, "curr_kl_coeff": 0.09492187947034836, "num_module_steps_trained_lifetime": 2915200, "total_loss": 8.713637351989746, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69604.07856519135}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 45, "trial_id": "c13e0_00000", "date": "2025-06-25_18-56-42", "timestamp": 1750903002, "time_this_iter_s": 63.48252511024475, "time_total_s": 447.06732869148254, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 447.06732869148254, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 13.476666666666668, "ram_util_percent": 52.86111111111109}}
{"timers": {"training_iteration": 4.6912210759074835, "restore_env_runners": 0.01643162759180663, "training_step": 4.674670126617002, "env_runner_sampling_timer": 3.6313499324749197, "learner_update_timer": 1.0413585873783766, "synch_weights": 0.0008264417089040716, "synch_env_connectors": 0.0009303521391878109}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 163697.00000000003}, "agent_steps": {"vehicle_0": 40.10444444444445, "vehicle_3": 40.10444444444445, "vehicle_1": 59.51111111111111, "vehicle_2": 57.571111111111115}, "episode_return_max": 1179.8906662464142, "env_to_module_connector": {"connector_pipeline_timer": 6.118403885236938e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4386972555046766e-06, "add_states_from_episodes_to_batch": 1.6198680432351674e-06, "add_observations_from_episodes_to_batch": 1.1764408258493424e-05, "batch_individual_items": 8.008444912035717e-06, "add_time_dim_to_batch_and_zero_pad": 2.4896706136609136e-06, "numpy_to_tensor": 9.197321825185001e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1460040190722793e-06, "add_observations_from_episodes_to_batch": 2.9020997317275026e-05, "batch_individual_items": 2.0291998225729913e-05, "add_time_dim_to_batch_and_zero_pad": 6.374997610691935e-06, "numpy_to_tensor": 1.8562495824880898e-05, "agent_to_module_mapping": 4.8125002649612725e-06}}, "sample": 0.10702663142811757, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.4061061900924295e-06, "get_actions": 3.7403594567635476e-05, "remove_single_ts_time_rank_from_batch": 6.313927347147142e-07, "normalize_and_clip_actions": 3.6871298449281334e-05, "tensor_to_numpy": 1.6709211442702755e-05, "un_batch_to_individual_items": 1.1992528965419196e-05, "module_to_agent_unmapping": 1.5662438840688177e-06}}, "connector_pipeline_timer": 0.000140981624131313}, "rlmodule_inference_timer": 6.159191933085858e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 49135.0, "vehicle_0": 31127.0, "vehicle_3": 31257.0, "vehicle_1": 52178.000000000015}, "env_step_timer": 9.64015943495146e-05, "agent_episode_returns_mean": {"vehicle_2": 133.42332244263756, "vehicle_0": 164.71970333894092, "vehicle_3": 157.3186979638206, "vehicle_1": 261.59806388616556}, "env_reset_timer": 8.081250052782707e-05, "num_episodes": 32.0, "env_to_module_sum_episodes_length_out": 34.045718882675835, "episode_return_mean": 717.0597878901162, "num_agent_steps_sampled": {"vehicle_2": 1869.0000000000002, "vehicle_0": 1265.0, "vehicle_3": 1265.0, "vehicle_1": 1958.0}, "episode_len_min": 40, "episode_len_mean": 60.035555555555554, "module_episode_returns_mean": {"shared_policy": 301.1857694583469}, "episode_return_min": -199.62596476078033, "num_env_steps_sampled_lifetime": 54000.0, "env_to_module_sum_episodes_length_in": 34.045718882675835, "num_module_steps_sampled": {"shared_policy": 6357.0}, "episode_duration_sec_mean": 0.030637868508007763, "episode_len_max": 113, "time_between_sampling": 0.367288757018651, "connector_pipeline_timer": 0.0001919999995152466, "weights_seq_no": 45.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 767.0000000000002, "num_env_steps_sampled_lifetime_throughput": 2056.9591452310383}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002671375623983502, "add_time_dim_to_batch_and_zero_pad": 1.0661682839178894e-05, "numpy_to_tensor": 0.00011134594307497071, "add_one_ts_to_episodes_and_truncate": 0.005078167662382469, "add_states_from_episodes_to_batch": 3.7153079896442705e-06, "batch_individual_items": 0.08618327179887558, "general_advantage_estimation": 0.013322515923534598, "add_columns_from_episodes_to_train_batch": 0.03986885316029346, "add_observations_from_episodes_to_batch": 0.0003923716301141612}}, "connector_pipeline_timer": 0.1478140891184665}, "num_module_steps_trained_lifetime": 2981632, "num_module_steps_trained": 66432, "num_env_steps_trained_lifetime": 46588000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1038000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1087835.196611626, "num_module_steps_trained_throughput": 69622.03695690319, "num_module_steps_trained_lifetime_throughput": 69621.82570756412}, "shared_policy": {"vf_loss_unclipped": 1042.777587890625, "weights_seq_no": 46.0, "mean_kl_loss": 0.009982195682823658, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 66432, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.008123397827148, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.13571518659591675, "gradients_default_optimizer_global_norm": 7.942671775817871, "entropy": 0.18072791397571564, "vf_explained_var": 0.49530619382858276, "curr_kl_coeff": 0.09492187947034836, "num_module_steps_trained_lifetime": 2981632, "total_loss": 7.871548652648926, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69622.10252988}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 54000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 46, "trial_id": "c13e0_00000", "date": "2025-06-25_18-56-43", "timestamp": 1750903003, "time_this_iter_s": 1.6514198780059814, "time_total_s": 448.7187485694885, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721b2e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 448.7187485694885, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 23.25, "ram_util_percent": 52.9}}
{"timers": {"training_iteration": 4.660936265148406, "restore_env_runners": 0.016267354235889413, "training_step": 4.644549466190815, "env_runner_sampling_timer": 3.60128073940018, "learner_update_timer": 1.0413036306745977, "synch_weights": 0.0008264872917906396, "synch_env_connectors": 0.0009288490377854404}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 169877.00000000003}, "agent_steps": {"vehicle_0": 40.06, "vehicle_3": 40.06, "vehicle_1": 68.12, "vehicle_2": 64.0}, "episode_return_max": 1216.6338272094727, "env_to_module_connector": {"connector_pipeline_timer": 6.376457271810651e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.5144799555403325e-06, "add_states_from_episodes_to_batch": 1.720021421989887e-06, "add_observations_from_episodes_to_batch": 1.2285327033479255e-05, "batch_individual_items": 8.37387666063502e-06, "add_time_dim_to_batch_and_zero_pad": 2.574860820680577e-06, "numpy_to_tensor": 9.8344998719711e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1460040190722793e-06, "add_observations_from_episodes_to_batch": 2.9020997317275026e-05, "batch_individual_items": 2.0291998225729913e-05, "add_time_dim_to_batch_and_zero_pad": 6.374997610691935e-06, "numpy_to_tensor": 1.8562495824880898e-05, "agent_to_module_mapping": 4.8125002649612725e-06}}, "sample": 0.10725241641035085, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.520935676989217e-06, "get_actions": 3.6874055783313786e-05, "remove_single_ts_time_rank_from_batch": 6.566228876207338e-07, "normalize_and_clip_actions": 3.737368718390111e-05, "tensor_to_numpy": 1.6727324215445606e-05, "un_batch_to_individual_items": 1.2243157468370906e-05, "module_to_agent_unmapping": 1.6369730538326191e-06}}, "connector_pipeline_timer": 0.0001422545307359605}, "rlmodule_inference_timer": 5.9133987888190743e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 50986.0, "vehicle_0": 32311.999999999993, "vehicle_3": 32441.999999999993, "vehicle_1": 54137.00000000003}, "env_step_timer": 0.00010311295364935986, "agent_episode_returns_mean": {"vehicle_2": 191.96486062526708, "vehicle_0": 168.72567453861237, "vehicle_3": 163.56043546676636, "vehicle_1": 321.81361738681795}, "env_reset_timer": 8.081250052782707e-05, "num_episodes": 30.0, "env_to_module_sum_episodes_length_out": 35.17295800498893, "episode_return_mean": 846.064586262703, "num_agent_steps_sampled": {"vehicle_2": 1850.9999999999998, "vehicle_0": 1185.0, "vehicle_3": 1185.0, "vehicle_1": 1959.0000000000002}, "episode_len_min": 40, "episode_len_mean": 68.36, "module_episode_returns_mean": {"shared_policy": 286.2064937400818}, "episode_return_min": -40.246142864227295, "num_env_steps_sampled_lifetime": 56000.0, "env_to_module_sum_episodes_length_in": 35.17295800498893, "num_module_steps_sampled": {"shared_policy": 6180.0}, "episode_duration_sec_mean": 0.03704409337966354, "episode_len_max": 109, "time_between_sampling": 0.3259864801702487, "connector_pipeline_timer": 0.0001919999995152466, "weights_seq_no": 46.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 797.0000000000002, "num_env_steps_sampled_lifetime_throughput": 2003.896610535955}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026732485377578595, "add_time_dim_to_batch_and_zero_pad": 1.063839602539125e-05, "numpy_to_tensor": 0.00011110456362571196, "add_one_ts_to_episodes_and_truncate": 0.005085526815764513, "add_states_from_episodes_to_batch": 3.6989848850035925e-06, "batch_individual_items": 0.0856527657508711, "general_advantage_estimation": 0.013329376184288443, "add_columns_from_episodes_to_train_batch": 0.03988404045867193, "add_observations_from_episodes_to_batch": 0.0003933174938199449}}, "connector_pipeline_timer": 0.14731487239733096}, "num_module_steps_trained_lifetime": 3046144, "num_module_steps_trained": 64512, "num_env_steps_trained_lifetime": 47596000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 1008000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1086557.864774582, "num_module_steps_trained_throughput": 69540.11731221415, "num_module_steps_trained_lifetime_throughput": 69539.98521465056}, "shared_policy": {"vf_loss_unclipped": 2045.5657958984375, "weights_seq_no": 47.0, "mean_kl_loss": 0.014704824425280094, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 64512, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.9429731369018555, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.11645670235157013, "gradients_default_optimizer_global_norm": 22.605365753173828, "entropy": 0.02566363662481308, "vf_explained_var": 0.3829392194747925, "curr_kl_coeff": 0.09492187947034836, "num_module_steps_trained_lifetime": 3046144, "total_loss": 7.827655792236328, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69539.98405437522}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 56000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 47, "trial_id": "c13e0_00000", "date": "2025-06-25_18-56-45", "timestamp": 1750903005, "time_this_iter_s": 1.6651830673217773, "time_total_s": 450.3839316368103, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x317423600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 450.3839316368103, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.166666666666668, "ram_util_percent": 52.9}}
{"timers": {"training_iteration": 4.630739608326929, "restore_env_runners": 0.016104721523585303, "training_step": 4.614515321118887, "env_runner_sampling_timer": 3.571487532836187, "learner_update_timer": 1.0410577322778816, "synch_weights": 0.0008295257588702725, "synch_env_connectors": 0.0009323317973746312}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 175941.00000000003}, "agent_steps": {"vehicle_0": 40.18, "vehicle_3": 40.18, "vehicle_1": 68.66000000000001, "vehicle_2": 64.94}, "episode_return_max": 1188.6047220230103, "env_to_module_connector": {"connector_pipeline_timer": 6.184870855579049e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4616567756101793e-06, "add_states_from_episodes_to_batch": 1.6605385474972716e-06, "add_observations_from_episodes_to_batch": 1.1951312369536527e-05, "batch_individual_items": 8.178152424853486e-06, "add_time_dim_to_batch_and_zero_pad": 2.4946211981475996e-06, "numpy_to_tensor": 9.212556932498807e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1460040190722793e-06, "add_observations_from_episodes_to_batch": 2.9020997317275026e-05, "batch_individual_items": 2.0291998225729913e-05, "add_time_dim_to_batch_and_zero_pad": 6.374997610691935e-06, "numpy_to_tensor": 1.8562495824880898e-05, "agent_to_module_mapping": 4.8125002649612725e-06}}, "sample": 0.10757665108412236, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.423557992115145e-06, "get_actions": 3.4925135140970715e-05, "remove_single_ts_time_rank_from_batch": 6.280675959056235e-07, "normalize_and_clip_actions": 3.6030573525177544e-05, "tensor_to_numpy": 1.5928503722806963e-05, "un_batch_to_individual_items": 1.1904480955609897e-05, "module_to_agent_unmapping": 1.5995895517379785e-06}}, "connector_pipeline_timer": 0.0001366206167674597}, "rlmodule_inference_timer": 7.802804574496484e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 52839.0, "vehicle_0": 33434.99999999999, "vehicle_3": 33564.99999999999, "vehicle_1": 56102.00000000003}, "env_step_timer": 9.89496915618287e-05, "agent_episode_returns_mean": {"vehicle_2": 164.3623841047287, "vehicle_0": 162.73081672668457, "vehicle_3": 156.54526568889614, "vehicle_1": 329.0007639503479}, "env_reset_timer": 8.081250052782707e-05, "num_episodes": 28.999999999999996, "env_to_module_sum_episodes_length_out": 34.54643518982988, "episode_return_mean": 812.6392300128936, "num_agent_steps_sampled": {"vehicle_2": 1853.0, "vehicle_0": 1123.0, "vehicle_3": 1123.0, "vehicle_1": 1965.0}, "episode_len_min": 40, "episode_len_mean": 68.9, "module_episode_returns_mean": {"shared_policy": 263.6954489707947}, "episode_return_min": 225.82083356380463, "num_env_steps_sampled_lifetime": 58000.0, "env_to_module_sum_episodes_length_in": 34.54643518982988, "num_module_steps_sampled": {"shared_policy": 6063.999999999999}, "episode_duration_sec_mean": 0.0369790083602129, "episode_len_max": 105, "time_between_sampling": 0.32086644344005, "connector_pipeline_timer": 0.0001919999995152466, "weights_seq_no": 47.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 826.0000000000003, "num_env_steps_sampled_lifetime_throughput": 1981.5418009291152}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002675259392388358, "add_time_dim_to_batch_and_zero_pad": 1.0654512052038285e-05, "numpy_to_tensor": 0.00011088976797454437, "add_one_ts_to_episodes_and_truncate": 0.0050932548776352095, "add_states_from_episodes_to_batch": 3.6857450714786217e-06, "batch_individual_items": 0.08512574601339487, "general_advantage_estimation": 0.01333511742247481, "add_columns_from_episodes_to_train_batch": 0.03989244380409967, "add_observations_from_episodes_to_batch": 0.00039432806890919616}}, "connector_pipeline_timer": 0.14681205658328605}, "num_module_steps_trained_lifetime": 3109504, "num_module_steps_trained": 63360, "num_env_steps_trained_lifetime": 48586000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 990000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1086589.515506365, "num_module_steps_trained_throughput": 69542.11137283835, "num_module_steps_trained_lifetime_throughput": 69542.0208309648}, "shared_policy": {"vf_loss_unclipped": 1702.4906005859375, "weights_seq_no": 48.0, "mean_kl_loss": 0.017364706844091415, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 63360, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 8.242183685302734, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": 0.02220550738275051, "gradients_default_optimizer_global_norm": 8.406011581420898, "entropy": 0.017683563753962517, "vf_explained_var": 0.2900694012641907, "curr_kl_coeff": 0.09492187947034836, "num_module_steps_trained_lifetime": 3109504, "total_loss": 8.265860557556152, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69541.95700767722}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 48, "trial_id": "c13e0_00000", "date": "2025-06-25_18-56-47", "timestamp": 1750903007, "time_this_iter_s": 1.6434459686279297, "time_total_s": 452.02737760543823, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721be20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 452.02737760543823, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 52.9}}
{"timers": {"training_iteration": 4.599958208073691, "restore_env_runners": 0.015943734308297, "training_step": 4.583894385407686, "env_runner_sampling_timer": 3.541491860847802, "learner_update_timer": 1.0404267216250704, "synch_weights": 0.0008326255012465474, "synch_env_connectors": 0.0009345113994250983}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 181806.00000000003}, "agent_steps": {"vehicle_0": 40.07999999999999, "vehicle_3": 40.07999999999999, "vehicle_1": 75.12, "vehicle_2": 69.66}, "episode_return_max": 1217.266816020012, "env_to_module_connector": {"connector_pipeline_timer": 6.186682339704818e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.453359192884488e-06, "add_states_from_episodes_to_batch": 1.646499633980716e-06, "add_observations_from_episodes_to_batch": 1.1870598207592753e-05, "batch_individual_items": 8.029171642841222e-06, "add_time_dim_to_batch_and_zero_pad": 2.5223850601165905e-06, "numpy_to_tensor": 9.338243692021736e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1460040190722793e-06, "add_observations_from_episodes_to_batch": 2.9020997317275026e-05, "batch_individual_items": 2.0291998225729913e-05, "add_time_dim_to_batch_and_zero_pad": 6.374997610691935e-06, "numpy_to_tensor": 1.8562495824880898e-05, "agent_to_module_mapping": 4.8125002649612725e-06}}, "sample": 0.10752916739137812, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.305956178062518e-06, "get_actions": 3.544705911633698e-05, "remove_single_ts_time_rank_from_batch": 6.287729219763527e-07, "normalize_and_clip_actions": 3.4759707615982543e-05, "tensor_to_numpy": 1.6047352465391387e-05, "un_batch_to_individual_items": 1.1653871972448258e-05, "module_to_agent_unmapping": 1.5866999315229654e-06}}, "connector_pipeline_timer": 0.0001356829566791604}, "rlmodule_inference_timer": 5.893424871607791e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 54664.0, "vehicle_0": 34468.99999999999, "vehicle_3": 34598.99999999999, "vehicle_1": 58074.00000000003}, "env_step_timer": 9.829735101461825e-05, "agent_episode_returns_mean": {"vehicle_2": 217.1273844885826, "vehicle_0": 168.98776796817782, "vehicle_3": 156.79805258750915, "vehicle_1": 377.5676767873764}, "env_reset_timer": 8.081250052782707e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 37.076404589760166, "episode_return_mean": 920.4808813357354, "num_agent_steps_sampled": {"vehicle_2": 1825.0, "vehicle_0": 1034.0, "vehicle_3": 1034.0, "vehicle_1": 1972.0}, "episode_len_min": 40, "episode_len_mean": 75.14, "module_episode_returns_mean": {"shared_policy": 313.9223983335495}, "episode_return_min": 379.2146394252777, "num_env_steps_sampled_lifetime": 60000.0, "env_to_module_sum_episodes_length_in": 37.076404589760166, "num_module_steps_sampled": {"shared_policy": 5865.0}, "episode_duration_sec_mean": 0.03803258746076608, "episode_len_max": 99, "time_between_sampling": 0.31575460546711154, "connector_pipeline_timer": 0.0001919999995152466, "weights_seq_no": 48.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 853.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1983.7006198448116}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.0026754026284793115, "add_time_dim_to_batch_and_zero_pad": 1.0640056908051218e-05, "numpy_to_tensor": 0.00011068878029300348, "add_one_ts_to_episodes_and_truncate": 0.00509543899880998, "add_states_from_episodes_to_batch": 3.672217615055834e-06, "batch_individual_items": 0.08460130480327806, "general_advantage_estimation": 0.01332427624825112, "add_columns_from_episodes_to_train_batch": 0.03989283645603623, "add_observations_from_episodes_to_batch": 0.0003948972882379856}}, "connector_pipeline_timer": 0.14627924809749016}, "num_module_steps_trained_lifetime": 3170688, "num_module_steps_trained": 61184, "num_env_steps_trained_lifetime": 49542000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 956000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1086875.0951861753, "num_module_steps_trained_throughput": 69560.33648909147, "num_module_steps_trained_lifetime_throughput": 69560.26097959095}, "shared_policy": {"vf_loss_unclipped": 1635.2554931640625, "weights_seq_no": 49.0, "mean_kl_loss": 0.0076081412844359875, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 61184, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.475297927856445, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.10855623334646225, "gradients_default_optimizer_global_norm": 19.804494857788086, "entropy": -0.2657301723957062, "vf_explained_var": 0.2546312212944031, "curr_kl_coeff": 0.09492187947034836, "num_module_steps_trained_lifetime": 3170688, "total_loss": 7.370120525360107, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69560.19706859066}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 60000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 49, "trial_id": "c13e0_00000", "date": "2025-06-25_18-56-48", "timestamp": 1750903008, "time_this_iter_s": 1.5547871589660645, "time_total_s": 453.5821647644043, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x31721b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 453.5821647644043, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.15, "ram_util_percent": 52.9}}
{"timers": {"training_iteration": 4.570657310582964, "restore_env_runners": 0.015784351545155235, "training_step": 4.554752683643622, "env_runner_sampling_timer": 3.511866176399362, "learner_update_timer": 1.0409052356587853, "synch_weights": 0.0008356817462493976, "synch_env_connectors": 0.000936528375366421}, "env_runners": {"num_module_steps_sampled_lifetime": {"shared_policy": 187839.00000000003}, "agent_steps": {"vehicle_0": 40.12, "vehicle_3": 40.12, "vehicle_1": 68.53999999999998, "vehicle_2": 64.16}, "episode_return_max": 1216.5269417762756, "env_to_module_connector": {"connector_pipeline_timer": 6.225455870648122e-05, "timers": {"connectors": {"agent_to_module_mapping": 2.4790130069701783e-06, "add_states_from_episodes_to_batch": 1.6567228996761423e-06, "add_observations_from_episodes_to_batch": 1.1895288282233187e-05, "batch_individual_items": 8.104472065294797e-06, "add_time_dim_to_batch_and_zero_pad": 2.508553651621921e-06, "numpy_to_tensor": 9.439862126119715e-06}}}, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1460040190722793e-06, "add_observations_from_episodes_to_batch": 2.9020997317275026e-05, "batch_individual_items": 2.0291998225729913e-05, "add_time_dim_to_batch_and_zero_pad": 6.374997610691935e-06, "numpy_to_tensor": 1.8562495824880898e-05, "agent_to_module_mapping": 4.8125002649612725e-06}}, "sample": 0.10747764851993954, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 5.306881626680902e-06, "get_actions": 3.565080490416911e-05, "remove_single_ts_time_rank_from_batch": 6.318630681098785e-07, "normalize_and_clip_actions": 3.5333442301990574e-05, "tensor_to_numpy": 1.6229700737893905e-05, "un_batch_to_individual_items": 1.1867434932298615e-05, "module_to_agent_unmapping": 1.5904858371496155e-06}}, "connector_pipeline_timer": 0.00013717054388181422}, "rlmodule_inference_timer": 5.9545451571113225e-05, "num_agent_steps_sampled_lifetime": {"vehicle_2": 56517.0, "vehicle_0": 35572.99999999999, "vehicle_3": 35702.99999999999, "vehicle_1": 60046.00000000003}, "env_step_timer": 9.914450530149026e-05, "agent_episode_returns_mean": {"vehicle_2": 194.25297716140747, "vehicle_0": 167.90312484264373, "vehicle_3": 163.52783061981197, "vehicle_1": 334.1392178452015}, "env_reset_timer": 8.081250052782707e-05, "num_episodes": 27.0, "env_to_module_sum_episodes_length_out": 36.66727734772461, "episode_return_mean": 859.8231509125233, "num_agent_steps_sampled": {"vehicle_2": 1853.0, "vehicle_0": 1104.0, "vehicle_3": 1104.0, "vehicle_1": 1972.0}, "episode_len_min": 40, "episode_len_mean": 68.58000000000001, "module_episode_returns_mean": {"shared_policy": 242.771485042572}, "episode_return_min": 291.0514144897461, "num_env_steps_sampled_lifetime": 62000.0, "env_to_module_sum_episodes_length_in": 36.66727734772461, "num_module_steps_sampled": {"shared_policy": 6033.0}, "episode_duration_sec_mean": 0.0350944708593306, "episode_len_max": 99, "time_between_sampling": 0.31045371460009535, "connector_pipeline_timer": 0.0001919999995152466, "weights_seq_no": 49.0, "num_env_steps_sampled": 2000.0, "num_episodes_lifetime": 880.0000000000002, "num_env_steps_sampled_lifetime_throughput": 1997.13934481953}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"agent_to_module_mapping": 0.002676296932191255, "add_time_dim_to_batch_and_zero_pad": 1.0615326343845174e-05, "numpy_to_tensor": 0.00011043648252465144, "add_one_ts_to_episodes_and_truncate": 0.005100555438781816, "add_states_from_episodes_to_batch": 3.6609154520219484e-06, "batch_individual_items": 0.08484681967524332, "general_advantage_estimation": 0.013327948485735002, "add_columns_from_episodes_to_train_batch": 0.039895593921477825, "add_observations_from_episodes_to_batch": 0.00039551540535551525}}, "connector_pipeline_timer": 0.14653701978647002}, "num_module_steps_trained_lifetime": 3233664, "num_module_steps_trained": 62976, "num_env_steps_trained_lifetime": 50526000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 984000, "learner_connector_sum_episodes_length_out": 2000.0, "learner_connector_sum_episodes_length_in": 2000.0, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime_throughput": 1086687.2207088065, "num_module_steps_trained_throughput": 69548.22988512447, "num_module_steps_trained_lifetime_throughput": 69548.17506007418}, "shared_policy": {"vf_loss_unclipped": 1335.6038818359375, "weights_seq_no": 50.0, "mean_kl_loss": 0.028395792469382286, "module_train_batch_size_mean": 128.0, "num_module_steps_trained": 62976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 6.960192680358887, "default_optimizer_learning_rate": 0.0003, "curr_entropy_coeff": 0.01, "policy_loss": -0.059591010212898254, "gradients_default_optimizer_global_norm": 35.222923278808594, "entropy": -0.14237365126609802, "vf_explained_var": 0.47246265411376953, "curr_kl_coeff": 0.14238281548023224, "num_module_steps_trained_lifetime": 3233664, "total_loss": 6.904721260070801, "num_trainable_parameters": 149763, "num_module_steps_trained_lifetime_throughput": 69548.10382345843}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 62000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 50, "trial_id": "c13e0_00000", "date": "2025-06-25_18-56-50", "timestamp": 1750903010, "time_this_iter_s": 1.6724848747253418, "time_total_s": 455.25464963912964, "pid": 28682, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 4, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16aef19e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 455.25464963912964, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.85, "ram_util_percent": 52.9}}
