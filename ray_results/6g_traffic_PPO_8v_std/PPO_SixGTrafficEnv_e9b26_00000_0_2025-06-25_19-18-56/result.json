{"timers": {"training_iteration": 2.2819212089962093, "restore_env_runners": 9.540999599266797e-06, "training_step": 2.2818215000006603, "env_runner_sampling_timer": 0.8233259580010781, "learner_update_timer": 1.456414207998023, "synch_weights": 0.0009552499977871776}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -751.7469919865783, "vehicle_7": -1046.8564448790116, "vehicle_3": -960.1169263828884, "vehicle_0": -860.6977384307166, "vehicle_2": -750.2865219820628, "vehicle_4": -1414.615322925828, "vehicle_6": -1169.0357433503323, "vehicle_5": -1417.916334341873}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.67633329360003e-06, "get_actions": 4.5680719694163636e-05, "un_batch_to_individual_items": 1.5517818576775036e-05, "normalize_and_clip_actions": 4.77951065648428e-05, "tensor_to_numpy": 2.2326772403637042e-05, "module_to_agent_unmapping": 1.712665105069236e-06, "remove_single_ts_time_rank_from_batch": 6.621779722004098e-07}}, "connector_pipeline_timer": 0.000172475912295824}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.7480551437077566e-06, "add_states_from_episodes_to_batch": 1.6718853104360431e-06, "batch_individual_items": 9.26553939679349e-06, "add_observations_from_episodes_to_batch": 1.6129198161100936e-05, "numpy_to_tensor": 1.0436120460305615e-05, "add_time_dim_to_batch_and_zero_pad": 2.638482439673872e-06}}, "connector_pipeline_timer": 6.981591633491876e-05}, "num_agent_steps_sampled": {"vehicle_6": 1324.0000000000002, "vehicle_2": 861.0, "vehicle_5": 1454.0000000000002, "vehicle_1": 949.0, "vehicle_7": 1024.0, "vehicle_0": 877.9999999999999, "vehicle_3": 985.0, "vehicle_4": 1395.9999999999998}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 3006.9999999999995, "vehicle_4": 4573.0, "vehicle_2": 2656.0, "vehicle_6": 4026.9999999999995, "vehicle_5": 4583.0, "vehicle_1": 2744.0, "vehicle_7": 3249.0, "vehicle_0": 2749.0}, "timers": {"connectors": {"numpy_to_tensor": 3.6041499697603285e-05, "add_time_dim_to_batch_and_zero_pad": 7.958500646054745e-06, "agent_to_module_mapping": 6.437505362555385e-06, "add_states_from_episodes_to_batch": 3.4170043363701552e-06, "batch_individual_items": 2.633300027810037e-05, "add_observations_from_episodes_to_batch": 3.952149927499704e-05}}, "agent_steps": {"vehicle_7": 105.90909090909093, "vehicle_0": 89.09090909090911, "vehicle_3": 98.81818181818184, "vehicle_4": 151.22727272727278, "vehicle_6": 127.68181818181819, "vehicle_2": 83.59090909090907, "vehicle_5": 157.2727272727273, "vehicle_1": 83.59090909090907}, "weights_seq_no": 0.0, "episode_return_mean": -8371.272054796866, "env_step_timer": 0.00019560498147091018, "num_env_steps_sampled_lifetime": 6000.0, "episode_len_max": 282, "num_module_steps_sampled_lifetime": {"shared_policy": 27588.0}, "episode_len_min": 109, "episode_len_mean": 202.22727272727272, "env_to_module_sum_episodes_length_out": 90.13527941535325, "env_to_module_sum_episodes_length_in": 90.13527941535325, "episode_duration_sec_mean": 0.14155538636325884, "rlmodule_inference_timer": 6.609425239682002e-05, "module_episode_returns_mean": {"shared_policy": -6368.134555914186}, "env_reset_timer": 0.0001351040009467397, "episode_return_max": -7020.169086694717, "connector_pipeline_timer": 0.00024304199541802518, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 8871.0}, "num_episodes": 8.0, "time_between_sampling": 0.026832492495649247, "episode_return_min": -10661.968068301678, "sample": 0.1553009728823894, "num_episodes_lifetime": 22.0, "num_env_steps_sampled_lifetime_throughput": 1778.262788738294}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05869125000026543, "add_one_ts_to_episodes_and_truncate": 0.006027208000887185, "numpy_to_tensor": 0.00011879100202349946, "add_time_dim_to_batch_and_zero_pad": 1.2625001545529813e-05, "agent_to_module_mapping": 0.003611125001043547, "add_states_from_episodes_to_batch": 4.1249950299970806e-06, "general_advantage_estimation": 0.018662208996829577, "batch_individual_items": 0.11974349999945844, "add_observations_from_episodes_to_batch": 0.00035083299735561013}}, "connector_pipeline_timer": 0.20742450000398094}, "learner_connector_sum_episodes_length_out": 2000, "num_env_steps_trained_lifetime": 1416000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000, "num_module_steps_trained_lifetime": 90624, "num_module_steps_trained": 90624, "num_trainable_parameters": 149763, "num_env_steps_trained": 1416000, "num_env_steps_trained_lifetime_throughput": 1136314.5166908756, "num_module_steps_trained_throughput": 72738.08797037149, "num_module_steps_trained_lifetime_throughput": 72731.7580456851}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 19243.201171875, "gradients_default_optimizer_global_norm": 0.530285656452179, "num_module_steps_trained_lifetime": 90624, "num_module_steps_trained": 90624, "curr_entropy_coeff": 0.01, "entropy": 1.3255705833435059, "weights_seq_no": 1.0, "total_loss": 10.058732032775879, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.01759626716375351, "vf_explained_var": 0.0013689398765563965, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06846913695335388, "default_optimizer_learning_rate": 0.0003, "vf_loss": 10.0, "num_module_steps_trained_lifetime_throughput": 72737.6808808685}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "e9b26_00000", "date": "2025-06-25_19-19-02", "timestamp": 1750904342, "time_this_iter_s": 2.2839291095733643, "time_total_s": 2.2839291095733643, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x150caac00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.2839291095733643, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.975000000000001, "ram_util_percent": 53.3}}
{"timers": {"training_iteration": 2.28099288898622, "restore_env_runners": 9.51224959862884e-06, "training_step": 2.2808923762507036, "env_runner_sampling_timer": 0.823955465921099, "learner_update_timer": 1.454855247588057, "synch_weights": 0.0009538279077969492, "synch_env_connectors": 0.0008294170038425364}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -986.0311010217666, "vehicle_7": -978.9307797312737, "vehicle_3": -883.2947537302972, "vehicle_0": -1025.7355266809464, "vehicle_2": -823.9657874464989, "vehicle_4": -1341.6896580076218, "vehicle_6": -1157.0254973340034, "vehicle_5": -1182.104277946949}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.691136665035441e-06, "get_actions": 3.658666763243362e-05, "un_batch_to_individual_items": 1.5225512720052784e-05, "normalize_and_clip_actions": 4.619633991729363e-05, "tensor_to_numpy": 1.6281576507992233e-05, "module_to_agent_unmapping": 1.6640889735607208e-06, "remove_single_ts_time_rank_from_batch": 6.592308599886346e-07}}, "connector_pipeline_timer": 0.0001542804223047054}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.932047371472055e-06, "add_states_from_episodes_to_batch": 1.7122519125651126e-06, "batch_individual_items": 9.385655481997743e-06, "add_observations_from_episodes_to_batch": 1.57923135742353e-05, "numpy_to_tensor": 9.953001654979697e-06, "add_time_dim_to_batch_and_zero_pad": 2.6429297378775654e-06}}, "connector_pipeline_timer": 6.977088847247164e-05}, "num_agent_steps_sampled": {"vehicle_6": 883.0, "vehicle_2": 901.0, "vehicle_5": 1090.0, "vehicle_1": 1228.0, "vehicle_7": 927.9999999999999, "vehicle_0": 989.0, "vehicle_3": 935.0, "vehicle_4": 1284.0000000000002}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 3941.9999999999995, "vehicle_4": 5857.0, "vehicle_2": 3557.0, "vehicle_6": 4910.0, "vehicle_5": 5673.0, "vehicle_1": 3972.0, "vehicle_7": 4177.0, "vehicle_0": 3738.0}, "timers": {"connectors": {"numpy_to_tensor": 3.6041499697603285e-05, "add_time_dim_to_batch_and_zero_pad": 7.958500646054745e-06, "agent_to_module_mapping": 6.437505362555385e-06, "add_states_from_episodes_to_batch": 3.4170043363701552e-06, "batch_individual_items": 2.633300027810037e-05, "add_observations_from_episodes_to_batch": 3.952149927499704e-05}}, "agent_steps": {"vehicle_7": 106.42000000000002, "vehicle_0": 109.56000000000002, "vehicle_3": 106.13999999999999, "vehicle_4": 149.28, "vehicle_6": 132.24, "vehicle_2": 97.14, "vehicle_5": 135.6, "vehicle_1": 117.14}, "weights_seq_no": 1.0, "episode_return_mean": -8378.77737518549, "env_step_timer": 0.0002035250731962178, "num_env_steps_sampled_lifetime": 8000.0, "episode_len_max": 291, "num_module_steps_sampled_lifetime": {"shared_policy": 35826.0}, "episode_len_min": 109, "episode_len_mean": 223.14000000000004, "env_to_module_sum_episodes_length_out": 84.81959625013137, "env_to_module_sum_episodes_length_in": 84.81959625013137, "episode_duration_sec_mean": 0.16776935811984, "rlmodule_inference_timer": 6.0329844453693615e-05, "module_episode_returns_mean": {"shared_policy": -7377.030180168153}, "env_reset_timer": 0.0001351040009467397, "episode_return_max": -6231.082110881805, "connector_pipeline_timer": 0.00024304199541802518, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 8238.0}, "num_episodes": 8.0, "time_between_sampling": 0.040723510285691496, "episode_return_min": -10661.968068301678, "sample": 0.15542142212281154, "num_episodes_lifetime": 30.0, "num_env_steps_sampled_lifetime_throughput": 1654.3242548790613}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05868191208021017, "add_one_ts_to_episodes_and_truncate": 0.006053218420856865, "numpy_to_tensor": 0.0001185489220370073, "add_time_dim_to_batch_and_zero_pad": 1.2614591541932896e-05, "agent_to_module_mapping": 0.003612020841028425, "add_states_from_episodes_to_batch": 4.1129151213681325e-06, "general_advantage_estimation": 0.0186226489868568, "batch_individual_items": 0.11897192708951479, "add_observations_from_episodes_to_batch": 0.00035104925736959556}}, "connector_pipeline_timer": 0.20663029250390538}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 2730000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 174720, "num_module_steps_trained": 84096, "num_trainable_parameters": 149763, "num_env_steps_trained": 1314000, "num_env_steps_trained_lifetime_throughput": 1136093.0534623466, "num_module_steps_trained_throughput": 72723.15735524711, "num_module_steps_trained_lifetime_throughput": 72717.16972226057}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 12099.013671875, "gradients_default_optimizer_global_norm": 0.32932761311531067, "num_module_steps_trained_lifetime": 174720, "num_module_steps_trained": 84096, "curr_entropy_coeff": 0.01, "entropy": 1.276725172996521, "weights_seq_no": 2.0, "total_loss": 9.5737943649292, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.014403649605810642, "vf_explained_var": 0.001243889331817627, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.2697118818759918, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.853391647338867, "num_module_steps_trained_lifetime_throughput": 72722.71562868315}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "e9b26_00000", "date": "2025-06-25_19-19-04", "timestamp": 1750904344, "time_this_iter_s": 2.1911258697509766, "time_total_s": 4.475054979324341, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x150ca9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.475054979324341, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.066666666666666, "ram_util_percent": 53.29999999999999}}
{"timers": {"training_iteration": 2.281476461766335, "restore_env_runners": 9.465047141566174e-06, "training_step": 2.2813752695681497, "env_runner_sampling_timer": 0.823909094181892, "learner_update_timer": 1.455382610952165, "synch_weights": 0.0009523908787785331, "synch_env_connectors": 0.0008298024137911853}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -1037.002612929344, "vehicle_7": -1019.3573451972006, "vehicle_3": -793.2401642870904, "vehicle_0": -924.1953508567811, "vehicle_2": -769.2653041005135, "vehicle_4": -1074.566241042614, "vehicle_6": -833.3110121202467, "vehicle_5": -1086.2233841276168}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.066885892519603e-06, "get_actions": 3.692416224839461e-05, "un_batch_to_individual_items": 1.604673221619354e-05, "normalize_and_clip_actions": 4.96335637242753e-05, "tensor_to_numpy": 1.639488342556291e-05, "module_to_agent_unmapping": 1.6714657446345427e-06, "remove_single_ts_time_rank_from_batch": 6.431754326564878e-07}}, "connector_pipeline_timer": 0.00015889999806117626}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.8139745226355523e-06, "add_states_from_episodes_to_batch": 1.6624739912629243e-06, "batch_individual_items": 9.570905851394041e-06, "add_observations_from_episodes_to_batch": 1.620514529527719e-05, "numpy_to_tensor": 9.794551848382507e-06, "add_time_dim_to_batch_and_zero_pad": 2.5637801723712422e-06}}, "connector_pipeline_timer": 6.917896064494878e-05}, "num_agent_steps_sampled": {"vehicle_6": 1123.0, "vehicle_2": 1091.0, "vehicle_5": 1540.9999999999998, "vehicle_1": 1257.0, "vehicle_7": 1335.0, "vehicle_0": 1030.0, "vehicle_3": 864.0, "vehicle_4": 1275.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 4806.0, "vehicle_4": 7132.0, "vehicle_2": 4648.0, "vehicle_6": 6033.0, "vehicle_5": 7214.0, "vehicle_1": 5229.0, "vehicle_7": 5512.0, "vehicle_0": 4768.0}, "timers": {"connectors": {"numpy_to_tensor": 3.6041499697603285e-05, "add_time_dim_to_batch_and_zero_pad": 7.958500646054745e-06, "agent_to_module_mapping": 6.437505362555385e-06, "add_states_from_episodes_to_batch": 3.4170043363701552e-06, "batch_individual_items": 2.633300027810037e-05, "add_observations_from_episodes_to_batch": 3.952149927499704e-05}}, "agent_steps": {"vehicle_7": 127.69999999999999, "vehicle_0": 111.56000000000003, "vehicle_3": 101.43999999999997, "vehicle_4": 130.54, "vehicle_6": 108.02, "vehicle_2": 104.2, "vehicle_5": 149.11999999999998, "vehicle_1": 140.49999999999997}, "weights_seq_no": 2.0, "episode_return_mean": -7537.161404285431, "env_step_timer": 0.00020415043302388403, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 305, "num_module_steps_sampled_lifetime": {"shared_policy": 45342.0}, "episode_len_min": 111, "episode_len_mean": 225.9, "env_to_module_sum_episodes_length_out": 80.90001817883609, "env_to_module_sum_episodes_length_in": 80.90001817883609, "episode_duration_sec_mean": 0.1626471924201178, "rlmodule_inference_timer": 6.193963299221561e-05, "module_episode_returns_mean": {"shared_policy": -6153.181710247994}, "env_reset_timer": 0.0001351040009467397, "episode_return_max": -5435.466965675354, "connector_pipeline_timer": 0.00024304199541802518, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 9516.0}, "num_episodes": 10.0, "time_between_sampling": 0.05253100721680487, "episode_return_min": -10147.725042462349, "sample": 0.1550290744175575, "num_episodes_lifetime": 40.0, "num_env_steps_sampled_lifetime_throughput": 1580.5775477232578}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05872806254941388, "add_one_ts_to_episodes_and_truncate": 0.0060558537366232484, "numpy_to_tensor": 0.00011818760280002608, "add_time_dim_to_batch_and_zero_pad": 1.259886563202599e-05, "agent_to_module_mapping": 0.003615656462620973, "add_states_from_episodes_to_batch": 4.09928596127429e-06, "general_advantage_estimation": 0.018636124157009906, "batch_individual_items": 0.1182661653185838, "add_observations_from_episodes_to_batch": 0.0003515045947606268}}, "connector_pipeline_timer": 0.2059896024888185}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 4250000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 272000, "num_module_steps_trained": 97280, "num_trainable_parameters": 149763, "num_env_steps_trained": 1520000, "num_env_steps_trained_lifetime_throughput": 1135117.4979917584, "num_module_steps_trained_throughput": 72660.35572578217, "num_module_steps_trained_lifetime_throughput": 72654.4695983331}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 10612.2099609375, "gradients_default_optimizer_global_norm": 0.44531771540641785, "num_module_steps_trained_lifetime": 272000, "num_module_steps_trained": 97280, "curr_entropy_coeff": 0.01, "entropy": 1.2158331871032715, "weights_seq_no": 3.0, "total_loss": 9.837141036987305, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.015646640211343765, "vf_explained_var": -0.0029764175415039062, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04059455916285515, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.886765480041504, "num_module_steps_trained_lifetime_throughput": 72660.22149582695}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "e9b26_00000", "date": "2025-06-25_19-19-07", "timestamp": 1750904347, "time_this_iter_s": 2.3313980102539062, "time_total_s": 6.806452989578247, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x150ca96c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.806452989578247, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.766666666666666, "ram_util_percent": 53.29999999999999}}
{"timers": {"training_iteration": 2.281823588818696, "restore_env_runners": 9.416646658522949e-06, "training_step": 2.2817217410324875, "env_runner_sampling_timer": 0.8238049549100723, "learner_update_timer": 1.4558323227526588, "synch_weights": 0.0009511494700479962, "synch_env_connectors": 0.0008303531396566541}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -743.6232208287715, "vehicle_7": -1104.674282028675, "vehicle_3": -686.4881780982017, "vehicle_0": -818.983469222784, "vehicle_2": -735.0666836321352, "vehicle_4": -990.08038677454, "vehicle_6": -785.5237249946592, "vehicle_5": -998.7299388623237}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.076327500009981e-06, "get_actions": 3.645141041359109e-05, "un_batch_to_individual_items": 1.5989087378134143e-05, "normalize_and_clip_actions": 4.942616346712498e-05, "tensor_to_numpy": 1.6161510548282944e-05, "module_to_agent_unmapping": 1.6411287386734038e-06, "remove_single_ts_time_rank_from_batch": 6.349242490751749e-07}}, "connector_pipeline_timer": 0.0001577435144890169}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.823417293949763e-06, "add_states_from_episodes_to_batch": 1.6657576868496094e-06, "batch_individual_items": 9.329233514719092e-06, "add_observations_from_episodes_to_batch": 1.5849611013225486e-05, "numpy_to_tensor": 9.728680910248523e-06, "add_time_dim_to_batch_and_zero_pad": 2.5729964259583613e-06}}, "connector_pipeline_timer": 6.81745791252093e-05}, "num_agent_steps_sampled": {"vehicle_6": 1148.0, "vehicle_2": 817.0000000000001, "vehicle_5": 1355.0, "vehicle_1": 755.0, "vehicle_7": 1720.0, "vehicle_0": 1079.0, "vehicle_3": 961.0, "vehicle_4": 1260.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 5767.0, "vehicle_4": 8392.0, "vehicle_2": 5465.0, "vehicle_6": 7181.0, "vehicle_5": 8569.0, "vehicle_1": 5984.0, "vehicle_7": 7231.999999999999, "vehicle_0": 5847.0}, "timers": {"connectors": {"numpy_to_tensor": 3.6041499697603285e-05, "add_time_dim_to_batch_and_zero_pad": 7.958500646054745e-06, "agent_to_module_mapping": 6.437505362555385e-06, "add_states_from_episodes_to_batch": 3.4170043363701552e-06, "batch_individual_items": 2.633300027810037e-05, "add_observations_from_episodes_to_batch": 3.952149927499704e-05}}, "agent_steps": {"vehicle_7": 159.05999999999997, "vehicle_0": 112.13999999999999, "vehicle_3": 97.36, "vehicle_4": 140.04, "vehicle_6": 122.72, "vehicle_2": 108.68000000000004, "vehicle_5": 156.54, "vehicle_1": 111.28}, "weights_seq_no": 3.0, "episode_return_mean": -6863.16990233779, "env_step_timer": 0.00020463674317014132, "num_env_steps_sampled_lifetime": 12000.0, "episode_len_max": 302, "num_module_steps_sampled_lifetime": {"shared_policy": 54437.0}, "episode_len_min": 97, "episode_len_mean": 215.44, "env_to_module_sum_episodes_length_out": 82.80995732270226, "env_to_module_sum_episodes_length_in": 82.80995732270226, "episode_duration_sec_mean": 0.15607870347797875, "rlmodule_inference_timer": 6.06267527263667e-05, "module_episode_returns_mean": {"shared_policy": -5475.461260017157}, "env_reset_timer": 0.0001351040009467397, "episode_return_max": -4233.421532988548, "connector_pipeline_timer": 0.00024304199541802518, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 9095.0}, "num_episodes": 9.0, "time_between_sampling": 0.06550809441419794, "episode_return_min": -9682.851849079132, "sample": 0.15485826548957354, "num_episodes_lifetime": 49.0, "num_env_steps_sampled_lifetime_throughput": 1547.662881612637}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05873031150387618, "add_one_ts_to_episodes_and_truncate": 0.0060578951992763174, "numpy_to_tensor": 0.00011788238675055619, "add_time_dim_to_batch_and_zero_pad": 1.2556626958583365e-05, "agent_to_module_mapping": 0.003618191568046539, "add_states_from_episodes_to_batch": 4.080793127468496e-06, "general_advantage_estimation": 0.018625363335410382, "batch_individual_items": 0.11831910324542967, "add_observations_from_episodes_to_batch": 0.0003518553888574752}}, "connector_pipeline_timer": 0.20603753605395278}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 5702000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 364928, "num_module_steps_trained": 92928, "num_trainable_parameters": 149763, "num_env_steps_trained": 1452000, "num_env_steps_trained_lifetime_throughput": 1134387.8655240661, "num_module_steps_trained_throughput": 72612.91419373191, "num_module_steps_trained_lifetime_throughput": 72607.36249582058}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 8173.63623046875, "gradients_default_optimizer_global_norm": 0.3727436661720276, "num_module_steps_trained_lifetime": 364928, "num_module_steps_trained": 92928, "curr_entropy_coeff": 0.01, "entropy": 1.1714835166931152, "weights_seq_no": 4.0, "total_loss": 9.79556941986084, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.015324665233492851, "vf_explained_var": 0.002863943576812744, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0057327039539813995, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.798486709594727, "num_module_steps_trained_lifetime_throughput": 72612.74407764766}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "e9b26_00000", "date": "2025-06-25_19-19-09", "timestamp": 1750904349, "time_this_iter_s": 2.3182919025421143, "time_total_s": 9.124744892120361, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x150caa7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.124744892120361, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.075000000000001, "ram_util_percent": 53.3}}
{"timers": {"training_iteration": 2.281430872510502, "restore_env_runners": 9.364150183270758e-06, "training_step": 2.2813285202922033, "env_runner_sampling_timer": 0.8233502782709519, "learner_update_timer": 1.4558916436851577, "synch_weights": 0.0009511079753520285, "synch_env_connectors": 0.0008314525283009715}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -417.75375059127805, "vehicle_7": -1074.093258163929, "vehicle_3": -729.2497341537475, "vehicle_0": -656.0395176911353, "vehicle_2": -444.8285820674896, "vehicle_4": -928.4852289843559, "vehicle_6": -726.4072118592261, "vehicle_5": -812.7728404569629}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.451560409932989e-06, "get_actions": 3.668105371401824e-05, "un_batch_to_individual_items": 1.4568595450886686e-05, "normalize_and_clip_actions": 4.448166974908151e-05, "tensor_to_numpy": 1.6506132991568442e-05, "module_to_agent_unmapping": 1.678516942121271e-06, "remove_single_ts_time_rank_from_batch": 6.531433749697182e-07}}, "connector_pipeline_timer": 0.00015219860002954486}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.7089272545279256e-06, "add_states_from_episodes_to_batch": 1.699448471290379e-06, "batch_individual_items": 9.048137637141507e-06, "add_observations_from_episodes_to_batch": 1.607935930701528e-05, "numpy_to_tensor": 9.907435651164962e-06, "add_time_dim_to_batch_and_zero_pad": 2.6145826595265193e-06}}, "connector_pipeline_timer": 6.882663018764287e-05}, "num_agent_steps_sampled": {"vehicle_6": 1312.0, "vehicle_2": 742.9999999999999, "vehicle_5": 1193.0, "vehicle_1": 992.9999999999999, "vehicle_7": 1535.0, "vehicle_0": 849.0, "vehicle_3": 1328.0, "vehicle_4": 1415.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 7095.000000000001, "vehicle_4": 9807.0, "vehicle_2": 6208.0, "vehicle_6": 8493.000000000002, "vehicle_5": 9762.0, "vehicle_1": 6977.0, "vehicle_7": 8767.0, "vehicle_0": 6695.999999999999}, "timers": {"connectors": {"numpy_to_tensor": 3.6041499697603285e-05, "add_time_dim_to_batch_and_zero_pad": 7.958500646054745e-06, "agent_to_module_mapping": 6.437505362555385e-06, "add_states_from_episodes_to_batch": 3.4170043363701552e-06, "batch_individual_items": 2.633300027810037e-05, "add_observations_from_episodes_to_batch": 3.952149927499704e-05}}, "agent_steps": {"vehicle_7": 187.02, "vehicle_0": 105.54, "vehicle_3": 121.6, "vehicle_4": 156.6, "vehicle_6": 132.58, "vehicle_2": 87.36, "vehicle_5": 147.67999999999998, "vehicle_1": 87.9}, "weights_seq_no": 4.0, "episode_return_mean": -5789.630101327895, "env_step_timer": 0.00018642938491061206, "num_env_steps_sampled_lifetime": 14000.0, "episode_len_max": 302, "num_module_steps_sampled_lifetime": {"shared_policy": 63804.999999999985}, "episode_len_min": 97, "episode_len_mean": 216.12, "env_to_module_sum_episodes_length_out": 100.7841375845777, "env_to_module_sum_episodes_length_in": 100.7841375845777, "episode_duration_sec_mean": 0.15520820737874602, "rlmodule_inference_timer": 5.933952558137104e-05, "module_episode_returns_mean": {"shared_policy": -4685.973465061189}, "env_reset_timer": 0.0001351040009467397, "episode_return_max": -3275.9064635038376, "connector_pipeline_timer": 0.00024304199541802518, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 9367.999999999998}, "num_episodes": 9.0, "time_between_sampling": 0.07767043568421285, "episode_return_min": -7614.622564315796, "sample": 0.1545134297304413, "num_episodes_lifetime": 57.99999999999999, "num_env_steps_sampled_lifetime_throughput": 1631.6749654745263}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05875633005879013, "add_one_ts_to_episodes_and_truncate": 0.006058901667254933, "numpy_to_tensor": 0.00011762106288442899, "add_time_dim_to_batch_and_zero_pad": 1.2538970707411791e-05, "agent_to_module_mapping": 0.0036234000723037434, "add_states_from_episodes_to_batch": 4.062485149241183e-06, "general_advantage_estimation": 0.01862561678205396, "batch_individual_items": 0.1176103442929845, "add_observations_from_episodes_to_batch": 0.00035218891501335347}}, "connector_pipeline_timer": 0.20536053902340567}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 7196000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 460544, "num_module_steps_trained": 95616, "num_trainable_parameters": 149763, "num_env_steps_trained": 1494000, "num_env_steps_trained_lifetime_throughput": 1134430.4311140843, "num_module_steps_trained_throughput": 72615.04727307572, "num_module_steps_trained_lifetime_throughput": 72609.74560183124}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 6038.89794921875, "gradients_default_optimizer_global_norm": 0.6150193214416504, "num_module_steps_trained_lifetime": 460544, "num_module_steps_trained": 95616, "curr_entropy_coeff": 0.01, "entropy": 1.1407568454742432, "weights_seq_no": 5.0, "total_loss": 9.705702781677246, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.012645980343222618, "vf_explained_var": -0.010577082633972168, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0013124439865350723, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.713269233703613, "num_module_steps_trained_lifetime_throughput": 72614.92286208911}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "e9b26_00000", "date": "2025-06-25_19-19-11", "timestamp": 1750904351, "time_this_iter_s": 2.244743824005127, "time_total_s": 11.369488716125488, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49dbc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.369488716125488, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 14.666666666666666, "ram_util_percent": 53.29999999999999}}
{"timers": {"training_iteration": 2.901828236285435, "restore_env_runners": 9.315088692018881e-06, "training_step": 2.901725415089305, "env_runner_sampling_timer": 1.4429222692382262, "learner_update_timer": 1.4567138959983335, "synch_weights": 0.0009502056455933999, "synch_env_connectors": 0.0008323700829919882}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -396.6669079971314, "vehicle_7": -872.07642547369, "vehicle_3": -709.5996962213517, "vehicle_0": -522.3755828547478, "vehicle_2": -346.9054427886009, "vehicle_4": -677.2509934186935, "vehicle_6": -614.9941296172142, "vehicle_5": -495.27017464399336}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.514659139786145e-06, "get_actions": 3.519358972497281e-05, "un_batch_to_individual_items": 1.4730324780752737e-05, "normalize_and_clip_actions": 4.542482055960354e-05, "tensor_to_numpy": 1.5657546371169166e-05, "module_to_agent_unmapping": 1.6221246210592992e-06, "remove_single_ts_time_rank_from_batch": 6.349859268971747e-07}}, "connector_pipeline_timer": 0.0001497380812586539}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.6688977571944243e-06, "add_states_from_episodes_to_batch": 1.6328133828482469e-06, "batch_individual_items": 9.030724683099719e-06, "add_observations_from_episodes_to_batch": 1.558866131571775e-05, "numpy_to_tensor": 9.367142407049325e-06, "add_time_dim_to_batch_and_zero_pad": 2.5284990683220187e-06}}, "connector_pipeline_timer": 6.678285930217001e-05}, "num_agent_steps_sampled": {"vehicle_6": 1435.0, "vehicle_2": 752.9999999999999, "vehicle_5": 1235.9999999999998, "vehicle_1": 899.0, "vehicle_7": 1450.0, "vehicle_0": 899.0, "vehicle_3": 1101.0, "vehicle_4": 1365.9999999999998}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 8196.0, "vehicle_4": 11173.0, "vehicle_2": 6961.000000000001, "vehicle_6": 9928.000000000002, "vehicle_5": 10998.0, "vehicle_1": 7876.0, "vehicle_7": 10217.000000000002, "vehicle_0": 7594.999999999999}, "timers": {"connectors": {"numpy_to_tensor": 3.8016398320905864e-05, "add_time_dim_to_batch_and_zero_pad": 7.83340074121952e-06, "agent_to_module_mapping": 6.400005077011883e-06, "add_states_from_episodes_to_batch": 3.4422046155668795e-06, "batch_individual_items": 2.70577991614118e-05, "add_observations_from_episodes_to_batch": 3.978399909101427e-05}}, "agent_steps": {"vehicle_7": 157.64, "vehicle_0": 98.57999999999997, "vehicle_3": 141.02, "vehicle_4": 140.18, "vehicle_6": 145.78, "vehicle_2": 78.06, "vehicle_5": 124.00000000000001, "vehicle_1": 107.33999999999997}, "weights_seq_no": 5.0, "episode_return_mean": -4635.139336621762, "env_step_timer": 0.00017747917963405597, "num_env_steps_sampled_lifetime": 16000.0, "episode_len_max": 281, "num_module_steps_sampled_lifetime": {"shared_policy": 72944.0}, "episode_len_min": 139, "episode_len_mean": 217.48, "env_to_module_sum_episodes_length_out": 83.37130451396497, "env_to_module_sum_episodes_length_in": 83.37130451396497, "episode_duration_sec_mean": 0.15160609006081358, "rlmodule_inference_timer": 5.9651068057214156e-05, "module_episode_returns_mean": {"shared_policy": -3499.153768334388}, "env_reset_timer": 0.0001380415982566774, "episode_return_max": -2790.4226175546646, "connector_pipeline_timer": 0.00024386699515162037, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 9139.0}, "num_episodes": 11.0, "time_between_sampling": 0.3809058971601284, "episode_return_min": -6706.779105424881, "sample": 0.16148722776995034, "num_episodes_lifetime": 69.0, "num_env_steps_sampled_lifetime_throughput": 1624.1051499852686}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05875833300825744, "add_one_ts_to_episodes_and_truncate": 0.006062827240631313, "numpy_to_tensor": 0.00011744068223349474, "add_time_dim_to_batch_and_zero_pad": 1.2515251011982856e-05, "agent_to_module_mapping": 0.003626541491600202, "add_states_from_episodes_to_batch": 4.045610333073837e-06, "general_advantage_estimation": 0.018619981444230188, "batch_individual_items": 0.11767163044007833, "add_observations_from_episodes_to_batch": 0.0003529216058438448}}, "connector_pipeline_timer": 0.2054249011331883}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 8658000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 554112, "num_module_steps_trained": 93568, "num_trainable_parameters": 149763, "num_env_steps_trained": 1462000, "num_env_steps_trained_lifetime_throughput": 1132893.9982115552, "num_module_steps_trained_throughput": 72516.16326729409, "num_module_steps_trained_lifetime_throughput": 72511.11167586186}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3379.35693359375, "gradients_default_optimizer_global_norm": 0.8217560052871704, "num_module_steps_trained_lifetime": 554112, "num_module_steps_trained": 93568, "curr_entropy_coeff": 0.01, "entropy": 1.0788662433624268, "weights_seq_no": 6.0, "total_loss": 9.485834121704102, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.20000000298023224, "mean_kl_loss": 0.015513554215431213, "vf_explained_var": 0.005926012992858887, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.16911056637763977, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.662631034851074, "num_module_steps_trained_lifetime_throughput": 72516.03852048649}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "e9b26_00000", "date": "2025-06-25_19-20-16", "timestamp": 1750904416, "time_this_iter_s": 64.32258009910583, "time_total_s": 75.69206881523132, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f4744a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.69206881523132, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 8.724175824175823, "ram_util_percent": 53.29010989010989}}
{"timers": {"training_iteration": 2.896751862262565, "restore_env_runners": 4.9509017851353835e-05, "training_step": 2.8966081626083837, "env_runner_sampling_timer": 1.4364760223758624, "learner_update_timer": 1.4580374741183877, "synch_weights": 0.0009497873391112632, "synch_env_connectors": 0.000831186802146421}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -333.12832978725424, "vehicle_7": -550.5118407278061, "vehicle_3": -418.15468152952184, "vehicle_0": -363.08259523057933, "vehicle_2": -315.3722963109017, "vehicle_4": -468.91152667379384, "vehicle_6": -425.7974197192192, "vehicle_5": -285.91178263378146}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.2149898976514594e-06, "get_actions": 4.004072770709393e-05, "un_batch_to_individual_items": 1.6520472022488266e-05, "normalize_and_clip_actions": 5.201930323212189e-05, "tensor_to_numpy": 1.73052090801196e-05, "module_to_agent_unmapping": 1.7296837655385423e-06, "remove_single_ts_time_rank_from_batch": 6.478213438519812e-07}}, "connector_pipeline_timer": 0.00016617709396748258}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.8308467730475387e-06, "add_states_from_episodes_to_batch": 1.6899938259298315e-06, "batch_individual_items": 9.728397795892462e-06, "add_observations_from_episodes_to_batch": 1.652144186556498e-05, "numpy_to_tensor": 9.908858586135476e-06, "add_time_dim_to_batch_and_zero_pad": 2.5972775238127904e-06}}, "connector_pipeline_timer": 7.090461950889692e-05}, "num_agent_steps_sampled": {"vehicle_6": 1397.0, "vehicle_2": 1040.0, "vehicle_5": 1274.0000000000002, "vehicle_1": 981.0, "vehicle_7": 1610.0, "vehicle_0": 1153.0, "vehicle_3": 1123.0, "vehicle_4": 1344.0000000000002}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 20212.000000000004, "vehicle_4": 26054.000000000007, "vehicle_2": 17015.0, "vehicle_6": 24749.000000000007, "vehicle_5": 24794.000000000007, "vehicle_1": 20352.999999999996, "vehicle_7": 25530.0, "vehicle_0": 18107.999999999996}, "timers": {"connectors": {"numpy_to_tensor": 3.1479001336265355e-05, "add_time_dim_to_batch_and_zero_pad": 7.500002539018169e-06, "agent_to_module_mapping": 5.958001565886661e-06, "add_states_from_episodes_to_batch": 3.417000698391348e-06, "batch_individual_items": 2.516650056350045e-05, "add_observations_from_episodes_to_batch": 3.754199860850349e-05}}, "agent_steps": {"vehicle_7": 135.78000000000003, "vehicle_0": 98.16000000000003, "vehicle_3": 104.664, "vehicle_4": 128.84, "vehicle_6": 131.312, "vehicle_2": 92.45999999999998, "vehicle_5": 115.12800000000003, "vehicle_1": 97.87200000000001}, "weights_seq_no": 6.0, "episode_return_mean": -3160.8704731192593, "env_step_timer": 0.00018690161389834078, "num_env_steps_sampled_lifetime": 39000.0, "episode_len_max": 281, "num_module_steps_sampled_lifetime": {"shared_policy": 176815.0}, "episode_len_min": 102, "episode_len_mean": 185.01200000000006, "env_to_module_sum_episodes_length_out": 69.70387292630384, "env_to_module_sum_episodes_length_in": 69.70387292630384, "episode_duration_sec_mean": 0.12698683431895916, "rlmodule_inference_timer": 6.480837449236593e-05, "module_episode_returns_mean": {"shared_policy": -1574.7644358530047}, "env_reset_timer": 0.00012995849829167128, "episode_return_max": -1786.8581453561783, "connector_pipeline_timer": 0.0002256044972455129, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 9922.000000000002}, "num_episodes": 11.0, "time_between_sampling": 0.3700784714270988, "episode_return_min": -5011.757517337799, "sample": 0.16170818843070867, "num_episodes_lifetime": 181.0, "num_env_steps_sampled_lifetime_throughput": 1564.2654106814955}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.058838706758179135, "add_one_ts_to_episodes_and_truncate": 0.006074148548239917, "numpy_to_tensor": 0.0001171687754438399, "add_time_dim_to_batch_and_zero_pad": 1.248218855115592e-05, "agent_to_module_mapping": 0.0036333389866561225, "add_states_from_episodes_to_batch": 4.03556424011073e-06, "general_advantage_estimation": 0.018649297049774218, "batch_individual_items": 0.11702483788567786, "add_observations_from_episodes_to_batch": 0.00035403530981557087}}, "connector_pipeline_timer": 0.204905850031836}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 10248000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 655872, "num_module_steps_trained": 101760, "num_trainable_parameters": 149763, "num_env_steps_trained": 1590000, "num_env_steps_trained_lifetime_throughput": 1131199.2000620023, "num_module_steps_trained_throughput": 72407.02459526231, "num_module_steps_trained_lifetime_throughput": 72402.2595276508}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2614.98046875, "gradients_default_optimizer_global_norm": 1.0308258533477783, "num_module_steps_trained_lifetime": 655872, "num_module_steps_trained": 101760, "curr_entropy_coeff": 0.01, "entropy": 1.074138879776001, "weights_seq_no": 7.0, "total_loss": 9.163473129272461, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.023414451628923416, "vf_explained_var": -0.0014121532440185547, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.03613653406500816, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.13339614868164, "num_module_steps_trained_lifetime_throughput": 72406.85550135895}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 39000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "e9b26_00000", "date": "2025-06-25_19-20-18", "timestamp": 1750904418, "time_this_iter_s": 2.396332025527954, "time_total_s": 78.08840084075928, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49f740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.08840084075928, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.524999999999999, "ram_util_percent": 53.275000000000006}}
{"timers": {"training_iteration": 2.88893563530997, "restore_env_runners": 4.9057677642176504e-05, "training_step": 2.8887916822322994, "env_runner_sampling_timer": 1.4299908363221052, "learner_update_timer": 1.4567039189572213, "synch_weights": 0.0009494211357328714, "synch_env_connectors": 0.000833011184109455}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -113.98152339458464, "vehicle_7": -324.8473450183868, "vehicle_3": -278.16904121398926, "vehicle_0": -372.908886487484, "vehicle_2": -226.34715071439746, "vehicle_4": -331.7648017060756, "vehicle_6": -323.1580015707016, "vehicle_5": -129.85352991580964}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.114243088236338e-06, "get_actions": 3.792883607147166e-05, "un_batch_to_individual_items": 1.381920841074724e-05, "normalize_and_clip_actions": 4.141213672557941e-05, "tensor_to_numpy": 1.678331646074167e-05, "module_to_agent_unmapping": 1.68356666259344e-06, "remove_single_ts_time_rank_from_batch": 6.608023839663419e-07}}, "connector_pipeline_timer": 0.0001493245283852548}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.66497859225315e-06, "add_states_from_episodes_to_batch": 1.700000511750777e-06, "batch_individual_items": 8.79197408988555e-06, "add_observations_from_episodes_to_batch": 1.5535623114787974e-05, "numpy_to_tensor": 9.968608286574314e-06, "add_time_dim_to_batch_and_zero_pad": 2.6334197100559438e-06}}, "connector_pipeline_timer": 6.808690839569585e-05}, "num_agent_steps_sampled": {"vehicle_6": 1235.0, "vehicle_2": 1030.0, "vehicle_5": 935.0, "vehicle_1": 949.0, "vehicle_7": 1188.0, "vehicle_0": 897.0000000000001, "vehicle_3": 895.0, "vehicle_4": 1340.9999999999998}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 21107.000000000004, "vehicle_4": 27395.000000000007, "vehicle_2": 18045.0, "vehicle_6": 25984.00000000001, "vehicle_5": 25729.000000000007, "vehicle_1": 21301.999999999993, "vehicle_7": 26718.0, "vehicle_0": 19004.999999999993}, "timers": {"connectors": {"numpy_to_tensor": 3.1479001336265355e-05, "add_time_dim_to_batch_and_zero_pad": 7.500002539018169e-06, "agent_to_module_mapping": 5.958001565886661e-06, "add_states_from_episodes_to_batch": 3.417000698391348e-06, "batch_individual_items": 2.516650056350045e-05, "add_observations_from_episodes_to_batch": 3.754199860850349e-05}}, "agent_steps": {"vehicle_7": 129.84, "vehicle_0": 97.28, "vehicle_3": 94.58, "vehicle_4": 119.22, "vehicle_6": 123.56, "vehicle_2": 88.14000000000001, "vehicle_5": 100.38, "vehicle_1": 75.1}, "weights_seq_no": 7.0, "episode_return_mean": -2101.0302824532987, "env_step_timer": 0.0001677474572122102, "num_env_steps_sampled_lifetime": 41000.0, "episode_len_max": 267, "num_module_steps_sampled_lifetime": {"shared_policy": 185285.0}, "episode_len_min": 102, "episode_len_mean": 179.58, "env_to_module_sum_episodes_length_out": 94.02501095046874, "env_to_module_sum_episodes_length_in": 94.02501095046874, "episode_duration_sec_mean": 0.12642244046000997, "rlmodule_inference_timer": 8.502565671210906e-05, "module_episode_returns_mean": {"shared_policy": -1439.9664230036735}, "env_reset_timer": 0.00012995849829167128, "episode_return_max": -1330.1490559577942, "connector_pipeline_timer": 0.0002256044972455129, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 8470.0}, "num_episodes": 9.0, "time_between_sampling": 0.33384413968036075, "episode_return_min": -3042.4837827682495, "sample": 0.1608804452188149, "num_episodes_lifetime": 190.0, "num_env_steps_sampled_lifetime_throughput": 1679.6922460736012}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05880592553057892, "add_one_ts_to_episodes_and_truncate": 0.006072693312719105, "numpy_to_tensor": 0.0001168725076264757, "add_time_dim_to_batch_and_zero_pad": 1.2456116617220245e-05, "agent_to_module_mapping": 0.0036318560167687545, "add_states_from_episodes_to_batch": 4.021458652070921e-06, "general_advantage_estimation": 0.018615598249266126, "batch_individual_items": 0.116282659506801, "add_observations_from_episodes_to_batch": 0.00035465495674329194}}, "connector_pipeline_timer": 0.20409365653147293}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 11604000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 742656, "num_module_steps_trained": 86784, "num_trainable_parameters": 149763, "num_env_steps_trained": 1356000, "num_env_steps_trained_lifetime_throughput": 1132589.7105815194, "num_module_steps_trained_throughput": 72495.30333760726, "num_module_steps_trained_lifetime_throughput": 72490.80717301664}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1391.05859375, "gradients_default_optimizer_global_norm": 0.7566065192222595, "num_module_steps_trained_lifetime": 742656, "num_module_steps_trained": 86784, "curr_entropy_coeff": 0.01, "entropy": 0.9651144742965698, "weights_seq_no": 8.0, "total_loss": 9.560598373413086, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.01457243412733078, "vf_explained_var": 0.012543797492980957, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.06971018016338348, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.635588645935059, "num_module_steps_trained_lifetime_throughput": 72495.12671862433}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 41000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "e9b26_00000", "date": "2025-06-25_19-20-20", "timestamp": 1750904420, "time_this_iter_s": 2.1172287464141846, "time_total_s": 80.20562958717346, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49f240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.20562958717346, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 14.666666666666666, "ram_util_percent": 53.26666666666667}}
{"timers": {"training_iteration": 3.504061150616908, "restore_env_runners": 4.8607100879296165e-05, "training_step": 3.50391727791, "env_runner_sampling_timer": 2.045892897538896, "learner_update_timer": 1.455927421017704, "synch_weights": 0.0009472915143584416, "synch_env_connectors": 0.0008337594122766333}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -80.91515221595765, "vehicle_7": -197.2812306213379, "vehicle_3": -184.18562432527546, "vehicle_0": -233.3181749129296, "vehicle_2": -193.1498825359345, "vehicle_4": -274.95201115608216, "vehicle_6": -109.91413940668107, "vehicle_5": 28.47192224502563}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.052092197166687e-06, "get_actions": 3.668420794704852e-05, "un_batch_to_individual_items": 1.3795179423832795e-05, "normalize_and_clip_actions": 4.142978102174978e-05, "tensor_to_numpy": 1.636356808066427e-05, "module_to_agent_unmapping": 1.6941010704766643e-06, "remove_single_ts_time_rank_from_batch": 6.472255864919819e-07}}, "connector_pipeline_timer": 0.00014691891157894498}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.5840635769695376e-06, "add_states_from_episodes_to_batch": 1.7015880548904904e-06, "batch_individual_items": 8.564593265993463e-06, "add_observations_from_episodes_to_batch": 1.5173338446806044e-05, "numpy_to_tensor": 9.708303463486039e-06, "add_time_dim_to_batch_and_zero_pad": 2.540790641822826e-06}}, "connector_pipeline_timer": 6.639091646397228e-05}, "num_agent_steps_sampled": {"vehicle_6": 1210.0, "vehicle_2": 881.0, "vehicle_5": 977.9999999999999, "vehicle_1": 1235.9999999999998, "vehicle_7": 1319.0000000000002, "vehicle_0": 1041.0, "vehicle_3": 967.0000000000001, "vehicle_4": 1079.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 22074.000000000004, "vehicle_4": 28474.000000000015, "vehicle_2": 18926.0, "vehicle_6": 27194.00000000001, "vehicle_5": 26707.000000000007, "vehicle_1": 22537.999999999996, "vehicle_7": 28037.0, "vehicle_0": 20045.999999999993}, "timers": {"connectors": {"numpy_to_tensor": 2.676660369616002e-05, "add_time_dim_to_batch_and_zero_pad": 7.350003579631448e-06, "agent_to_module_mapping": 5.707799573428929e-06, "add_states_from_episodes_to_batch": 3.3917982364073397e-06, "batch_individual_items": 2.3741801851429045e-05, "add_observations_from_episodes_to_batch": 3.6091798392590135e-05}}, "agent_steps": {"vehicle_7": 122.11999999999998, "vehicle_0": 102.54, "vehicle_3": 98.08000000000004, "vehicle_4": 119.46, "vehicle_6": 122.38, "vehicle_2": 107.06, "vehicle_5": 98.58, "vehicle_1": 126.2}, "weights_seq_no": 8.0, "episode_return_mean": -1245.2442984652519, "env_step_timer": 0.00016235685410643695, "num_env_steps_sampled_lifetime": 43000.0, "episode_len_max": 286, "num_module_steps_sampled_lifetime": {"shared_policy": 193996.0}, "episode_len_min": 124, "episode_len_mean": 199.06, "env_to_module_sum_episodes_length_out": 95.591942727875, "env_to_module_sum_episodes_length_in": 95.591942727875, "episode_duration_sec_mean": 0.1351817093003774, "rlmodule_inference_timer": 5.7248472285581464e-05, "module_episode_returns_mean": {"shared_policy": -841.78091545105}, "env_reset_timer": 0.00012393359938869252, "episode_return_max": -414.20273673534393, "connector_pipeline_timer": 0.00021431699860841036, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 8711.0}, "num_episodes": 10.0, "time_between_sampling": 0.45691164145684227, "episode_return_min": -2351.707543492317, "sample": 0.15803419359311446, "num_episodes_lifetime": 200.00000000000006, "num_env_steps_sampled_lifetime_throughput": 1746.1143011239271}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0587816629453037, "add_one_ts_to_episodes_and_truncate": 0.006071990549607735, "numpy_to_tensor": 0.00011654378254354267, "add_time_dim_to_batch_and_zero_pad": 1.2424475396066409e-05, "agent_to_module_mapping": 0.00363015829654343, "add_states_from_episodes_to_batch": 4.00457405984221e-06, "general_advantage_estimation": 0.01859188143671773, "batch_individual_items": 0.11554809582172372, "add_observations_from_episodes_to_batch": 0.00035484007717947623}}, "connector_pipeline_timer": 0.20330771079621526}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 12996000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 831744, "num_module_steps_trained": 89088, "num_trainable_parameters": 149763, "num_env_steps_trained": 1392000, "num_env_steps_trained_lifetime_throughput": 1131735.8612114822, "num_module_steps_trained_throughput": 72440.1636862238, "num_module_steps_trained_lifetime_throughput": 72435.86838062978}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1449.8695068359375, "gradients_default_optimizer_global_norm": 1.5215245485305786, "num_module_steps_trained_lifetime": 831744, "num_module_steps_trained": 89088, "curr_entropy_coeff": 0.01, "entropy": 0.901491105556488, "weights_seq_no": 9.0, "total_loss": 9.367982864379883, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.011692572385072708, "vf_explained_var": 0.016541600227355957, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0024371729232370853, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.371053695678711, "num_module_steps_trained_lifetime_throughput": 72440.04992916384}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 43000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "e9b26_00000", "date": "2025-06-25_19-21-25", "timestamp": 1750904485, "time_this_iter_s": 64.40294218063354, "time_total_s": 144.608571767807, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49f880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.608571767807, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.14835164835165, "ram_util_percent": 53.22747252747253}}
{"timers": {"training_iteration": 3.491859096610738, "restore_env_runners": 8.473768987021184e-05, "training_step": 3.4916782430409166, "env_runner_sampling_timer": 2.033164805233523, "learner_update_timer": 1.4564134247275256, "synch_weights": 0.0009469023491886545, "synch_env_connectors": 0.0008333226481774397}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": -94.29686245298386, "vehicle_7": -135.06104990100863, "vehicle_3": -146.31649066495893, "vehicle_0": -202.43597681331633, "vehicle_2": -68.43272321939469, "vehicle_4": -166.33088978910445, "vehicle_6": -20.381694201469422, "vehicle_5": 116.38600602531434}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.890324548945407e-06, "get_actions": 3.933445177842459e-05, "un_batch_to_individual_items": 1.5590273574694092e-05, "normalize_and_clip_actions": 4.845608098545663e-05, "tensor_to_numpy": 1.7568790395168835e-05, "module_to_agent_unmapping": 1.7296980165714969e-06, "remove_single_ts_time_rank_from_batch": 6.557109894294257e-07}}, "connector_pipeline_timer": 0.00016141477309727646}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.7525728801911995e-06, "add_states_from_episodes_to_batch": 1.7190109643104553e-06, "batch_individual_items": 9.144147159839208e-06, "add_observations_from_episodes_to_batch": 1.6010981139890318e-05, "numpy_to_tensor": 9.797098652707097e-06, "add_time_dim_to_batch_and_zero_pad": 2.678072876857282e-06}}, "connector_pipeline_timer": 6.90620647566942e-05}, "num_agent_steps_sampled": {"vehicle_6": 1173.0, "vehicle_2": 992.9999999999999, "vehicle_5": 1083.0, "vehicle_1": 1005.0, "vehicle_7": 1595.0, "vehicle_0": 1167.0, "vehicle_3": 1110.0, "vehicle_4": 1364.0000000000002}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 12974.0, "vehicle_4": 15881.0, "vehicle_2": 12949.0, "vehicle_6": 15136.0, "vehicle_5": 12597.999999999996, "vehicle_1": 13777.000000000004, "vehicle_7": 15812.000000000004, "vehicle_0": 13256.0}, "timers": {"connectors": {"numpy_to_tensor": 2.4500004656147212e-05, "add_time_dim_to_batch_and_zero_pad": 6.854003004264085e-06, "agent_to_module_mapping": 5.457997758639976e-06, "add_states_from_episodes_to_batch": 3.2084972190205008e-06, "batch_individual_items": 2.2125503164716065e-05, "add_observations_from_episodes_to_batch": 3.412499791011214e-05}}, "agent_steps": {"vehicle_7": 124.572, "vehicle_0": 106.40799999999999, "vehicle_3": 105.556, "vehicle_4": 124.0, "vehicle_6": 120.30799999999999, "vehicle_2": 94.74799999999999, "vehicle_5": 98.68400000000001, "vehicle_1": 128.456}, "weights_seq_no": 9.0, "episode_return_mean": -716.8696814155578, "env_step_timer": 0.00016611770058218978, "num_env_steps_sampled_lifetime": 24000.0, "episode_len_max": 273, "num_module_steps_sampled_lifetime": {"shared_policy": 112383.0}, "episode_len_min": 102, "episode_len_mean": 200.19600000000003, "env_to_module_sum_episodes_length_out": 85.3905624356889, "env_to_module_sum_episodes_length_in": 85.3905624356889, "episode_duration_sec_mean": 0.13376868388615548, "rlmodule_inference_timer": 6.362459043559897e-05, "module_episode_returns_mean": {"shared_policy": -620.7442960858345}, "env_reset_timer": 0.00011772899961215444, "episode_return_max": 127.03772270679474, "connector_pipeline_timer": 0.00020256249990779907, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 9490.0}, "num_episodes": 10.0, "time_between_sampling": 0.35131792972417836, "episode_return_min": -1595.4357371330261, "sample": 0.14667236305255515, "num_episodes_lifetime": 119.0, "num_env_steps_sampled_lifetime_throughput": 1796.3251413727376}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.058811169235857365, "add_one_ts_to_episodes_and_truncate": 0.006071378144069325, "numpy_to_tensor": 0.0001162508446678717, "add_time_dim_to_batch_and_zero_pad": 1.2398560698167712e-05, "agent_to_module_mapping": 0.003633655043540646, "add_states_from_episodes_to_batch": 3.9886883547804125e-06, "general_advantage_estimation": 0.018585325952376358, "batch_individual_items": 0.11486317486353716, "add_observations_from_episodes_to_batch": 0.0003549375064095964}}, "connector_pipeline_timer": 0.20264749160824913}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 14512000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 928768, "num_module_steps_trained": 97024, "num_trainable_parameters": 149763, "num_env_steps_trained": 1516000, "num_env_steps_trained_lifetime_throughput": 1130681.8207014184, "num_module_steps_trained_throughput": 72372.1514624393, "num_module_steps_trained_lifetime_throughput": 72368.12545198304}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 769.26123046875, "gradients_default_optimizer_global_norm": 2.231863260269165, "num_module_steps_trained_lifetime": 928768, "num_module_steps_trained": 97024, "curr_entropy_coeff": 0.01, "entropy": 0.8093026876449585, "weights_seq_no": 10.0, "total_loss": 9.129659652709961, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.018690062686800957, "vf_explained_var": 0.013689160346984863, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.21249252557754517, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.34463882446289, "num_module_steps_trained_lifetime_throughput": 72371.98041109246}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "e9b26_00000", "date": "2025-06-25_19-21-27", "timestamp": 1750904487, "time_this_iter_s": 2.2860512733459473, "time_total_s": 146.89462304115295, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49e660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.89462304115295, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 14.233333333333334, "ram_util_percent": 53.20000000000001}}
{"timers": {"training_iteration": 3.4817870673046456, "restore_env_runners": 8.39403129884365e-05, "training_step": 3.4816062697804613, "env_runner_sampling_timer": 2.02146335384113, "learner_update_timer": 1.4580384321502158, "synch_weights": 0.0009465433256521669, "synch_env_connectors": 0.0008343644217043964}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 54.044800012111665, "vehicle_7": -57.65847143650055, "vehicle_3": 26.03809098005295, "vehicle_0": -83.59426268815994, "vehicle_2": 74.73571966171264, "vehicle_4": -3.7828404450416575, "vehicle_6": 114.9689033961296, "vehicle_5": 185.70900751590733}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.296415294607132e-06, "get_actions": 3.5968717267236564e-05, "un_batch_to_individual_items": 1.6557500470869287e-05, "normalize_and_clip_actions": 5.086303210215935e-05, "tensor_to_numpy": 1.6094700697215215e-05, "module_to_agent_unmapping": 1.6196787097766499e-06, "remove_single_ts_time_rank_from_batch": 6.321335893618105e-07}}, "connector_pipeline_timer": 0.000159279006088734}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.7668024065677446e-06, "add_states_from_episodes_to_batch": 1.662284880701111e-06, "batch_individual_items": 9.166191225453947e-06, "add_observations_from_episodes_to_batch": 1.6559172736523563e-05, "numpy_to_tensor": 9.56832019975024e-06, "add_time_dim_to_batch_and_zero_pad": 2.5696826487818892e-06}}, "connector_pipeline_timer": 6.846787915336361e-05}, "num_agent_steps_sampled": {"vehicle_6": 1237.0, "vehicle_2": 1170.0, "vehicle_5": 1265.0, "vehicle_1": 1247.0, "vehicle_7": 1333.0, "vehicle_0": 1438.0, "vehicle_3": 1127.0, "vehicle_4": 1403.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 14101.0, "vehicle_4": 17284.0, "vehicle_2": 14119.0, "vehicle_6": 16373.0, "vehicle_5": 13862.999999999996, "vehicle_1": 15024.000000000005, "vehicle_7": 17145.000000000004, "vehicle_0": 14694.0}, "timers": {"connectors": {"numpy_to_tensor": 2.4500004656147212e-05, "add_time_dim_to_batch_and_zero_pad": 6.854003004264085e-06, "agent_to_module_mapping": 5.457997758639976e-06, "add_states_from_episodes_to_batch": 3.2084972190205008e-06, "batch_individual_items": 2.2125503164716065e-05, "add_observations_from_episodes_to_batch": 3.412499791011214e-05}}, "agent_steps": {"vehicle_7": 122.98, "vehicle_0": 104.9, "vehicle_3": 84.92, "vehicle_4": 109.64000000000001, "vehicle_6": 96.88, "vehicle_2": 89.12, "vehicle_5": 100.66, "vehicle_1": 95.92000000000002}, "weights_seq_no": 10.0, "episode_return_mean": 310.4609466338158, "env_step_timer": 0.00017016346242894665, "num_env_steps_sampled_lifetime": 26000.0, "episode_len_max": 247, "num_module_steps_sampled_lifetime": {"shared_policy": 122602.99999999999}, "episode_len_min": 102, "episode_len_mean": 161.16000000000003, "env_to_module_sum_episodes_length_out": 70.64842863761689, "env_to_module_sum_episodes_length_in": 70.64842863761689, "episode_duration_sec_mean": 0.11148599987864148, "rlmodule_inference_timer": 6.247532588346698e-05, "module_episode_returns_mean": {"shared_policy": -29.76704310655594}, "env_reset_timer": 0.00011772899961215444, "episode_return_max": 1229.398473739624, "connector_pipeline_timer": 0.00020256249990779907, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 10220.0}, "num_episodes": 14.0, "time_between_sampling": 0.31765252077646855, "episode_return_min": -1077.515729546547, "sample": 0.14677677532307834, "num_episodes_lifetime": 133.0, "num_env_steps_sampled_lifetime_throughput": 1730.6837307245096}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05890143796349372, "add_one_ts_to_episodes_and_truncate": 0.0060854156126233655, "numpy_to_tensor": 0.00011603541626445392, "add_time_dim_to_batch_and_zero_pad": 1.2388325084219742e-05, "agent_to_module_mapping": 0.0036398364031473185, "add_states_from_episodes_to_batch": 3.973381475042723e-06, "general_advantage_estimation": 0.018619428532855108, "batch_individual_items": 0.11420734436490401, "add_observations_from_episodes_to_batch": 0.000356207711335499}}, "connector_pipeline_timer": 0.20213648044213206}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 16148000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 1033472, "num_module_steps_trained": 104704, "num_trainable_parameters": 149763, "num_env_steps_trained": 1636000, "num_env_steps_trained_lifetime_throughput": 1130159.879175598, "num_module_steps_trained_throughput": 72338.14077091524, "num_module_steps_trained_lifetime_throughput": 72334.38936636188}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1005.70556640625, "gradients_default_optimizer_global_norm": 1.5044398307800293, "num_module_steps_trained_lifetime": 1033472, "num_module_steps_trained": 104704, "curr_entropy_coeff": 0.01, "entropy": 0.8596733808517456, "weights_seq_no": 11.0, "total_loss": 9.56143569946289, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.015760935842990875, "vf_explained_var": -0.0061492919921875, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.11935360729694366, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.445950508117676, "num_module_steps_trained_lifetime_throughput": 72338.00218544618}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "e9b26_00000", "date": "2025-06-25_19-21-30", "timestamp": 1750904490, "time_this_iter_s": 2.4869139194488525, "time_total_s": 149.3815369606018, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16a813880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 149.3815369606018, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 15.100000000000001, "ram_util_percent": 53.275000000000006}}
{"timers": {"training_iteration": 3.474167710381644, "restore_env_runners": 8.314632987843953e-05, "training_step": 3.473987199582687, "env_runner_sampling_timer": 2.0095137332227377, "learner_update_timer": 1.4623649390787214, "synch_weights": 0.000944708722400573, "synch_env_connectors": 0.0008362357774894154}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 84.77206412792204, "vehicle_7": 43.700024452209476, "vehicle_3": 98.91091547966003, "vehicle_0": 26.574798699617386, "vehicle_2": 130.54458658337592, "vehicle_4": 157.17052161455157, "vehicle_6": 189.47868662118913, "vehicle_5": 208.95847806096074}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 8.127545902097698e-06, "get_actions": 3.656613657191956e-05, "un_batch_to_individual_items": 1.8715957433055515e-05, "normalize_and_clip_actions": 5.8934316217712566e-05, "tensor_to_numpy": 1.6470298259792264e-05, "module_to_agent_unmapping": 1.6479552404128197e-06, "remove_single_ts_time_rank_from_batch": 6.452797793627202e-07}}, "connector_pipeline_timer": 0.00017183221501406175}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.9501513287852057e-06, "add_states_from_episodes_to_batch": 1.6746372487336991e-06, "batch_individual_items": 9.935161526333244e-06, "add_observations_from_episodes_to_batch": 1.7677036566956813e-05, "numpy_to_tensor": 9.59225036588613e-06, "add_time_dim_to_batch_and_zero_pad": 2.5852911196504986e-06}}, "connector_pipeline_timer": 7.101020323696182e-05}, "num_agent_steps_sampled": {"vehicle_6": 1474.0000000000002, "vehicle_2": 1339.0000000000002, "vehicle_5": 1480.0, "vehicle_1": 1400.0, "vehicle_7": 1664.0000000000002, "vehicle_0": 1248.0, "vehicle_3": 1320.9999999999998, "vehicle_4": 1500.9999999999998}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 15422.0, "vehicle_4": 18785.0, "vehicle_2": 15458.0, "vehicle_6": 17847.0, "vehicle_5": 15342.999999999996, "vehicle_1": 16424.000000000004, "vehicle_7": 18809.000000000004, "vehicle_0": 15942.0}, "timers": {"connectors": {"numpy_to_tensor": 2.4500004656147212e-05, "add_time_dim_to_batch_and_zero_pad": 6.854003004264085e-06, "agent_to_module_mapping": 5.457997758639976e-06, "add_states_from_episodes_to_batch": 3.2084972190205008e-06, "batch_individual_items": 2.2125503164716065e-05, "add_observations_from_episodes_to_batch": 3.412499791011214e-05}}, "agent_steps": {"vehicle_7": 108.72, "vehicle_0": 91.72, "vehicle_3": 88.24, "vehicle_4": 104.64, "vehicle_6": 95.44, "vehicle_2": 86.93999999999997, "vehicle_5": 95.64, "vehicle_1": 88.25999999999998}, "weights_seq_no": 11.0, "episode_return_mean": 940.1100753366948, "env_step_timer": 0.00019281689979910654, "num_env_steps_sampled_lifetime": 28000.0, "episode_len_max": 243, "num_module_steps_sampled_lifetime": {"shared_policy": 134030.0}, "episode_len_min": 96, "episode_len_mean": 135.07999999999998, "env_to_module_sum_episodes_length_out": 54.26687823966738, "env_to_module_sum_episodes_length_in": 54.26687823966738, "episode_duration_sec_mean": 0.0957749409196549, "rlmodule_inference_timer": 6.340223960737616e-05, "module_episode_returns_mean": {"shared_policy": 198.31141703844062}, "env_reset_timer": 0.00011772899961215444, "episode_return_max": 1573.3601395487785, "connector_pipeline_timer": 0.00020256249990779907, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 11427.000000000002}, "num_episodes": 15.0, "time_between_sampling": 0.3189522724846415, "episode_return_min": -150.74777495861053, "sample": 0.14689000435517574, "num_episodes_lifetime": 148.0, "num_env_steps_sampled_lifetime_throughput": 1594.9085265581643}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05905703691388424, "add_one_ts_to_episodes_and_truncate": 0.006111731456539666, "numpy_to_tensor": 0.00011658798208593863, "add_time_dim_to_batch_and_zero_pad": 1.2371111810335618e-05, "agent_to_module_mapping": 0.0036533917891012793, "add_states_from_episodes_to_batch": 3.960727683138645e-06, "general_advantage_estimation": 0.01868078508752136, "batch_individual_items": 0.11443884801123522, "add_observations_from_episodes_to_batch": 0.00035877396420954885}}, "connector_pipeline_timer": 0.20262722980773268}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 17982000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 1150848, "num_module_steps_trained": 117376, "num_trainable_parameters": 149763, "num_env_steps_trained": 1834000, "num_env_steps_trained_lifetime_throughput": 1129640.117597799, "num_module_steps_trained_throughput": 72304.60384436038, "num_module_steps_trained_lifetime_throughput": 72301.01078554576}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1313.1767578125, "gradients_default_optimizer_global_norm": 2.3915786743164062, "num_module_steps_trained_lifetime": 1150848, "num_module_steps_trained": 117376, "curr_entropy_coeff": 0.01, "entropy": 0.7396329641342163, "weights_seq_no": 12.0, "total_loss": 9.301905632019043, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.015186085365712643, "vf_explained_var": -0.018890976905822754, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07629596441984177, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.381041526794434, "num_module_steps_trained_lifetime_throughput": 72304.5950717647}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "e9b26_00000", "date": "2025-06-25_19-21-32", "timestamp": 1750904492, "time_this_iter_s": 2.7219722270965576, "time_total_s": 152.10350918769836, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 152.10350918769836, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.675, "ram_util_percent": 53.3}}
{"timers": {"training_iteration": 3.4638567428578018, "restore_env_runners": 8.236444655554886e-05, "training_step": 3.4636762867568236, "env_runner_sampling_timer": 1.99761205339053, "learner_update_timer": 1.4639493909378745, "synch_weights": 0.0009464349651620349, "synch_env_connectors": 0.0008376334196716897}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 128.14619156122205, "vehicle_7": 147.00221057653428, "vehicle_3": 88.79168331384659, "vehicle_0": 99.97397327661513, "vehicle_2": 220.3965408194065, "vehicle_4": 219.78574876546855, "vehicle_6": 237.44735961198813, "vehicle_5": 231.1887325978279}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 6.822872768914731e-06, "get_actions": 3.6309934371122664e-05, "un_batch_to_individual_items": 1.563092573969002e-05, "normalize_and_clip_actions": 4.787822834496936e-05, "tensor_to_numpy": 1.628211228818442e-05, "module_to_agent_unmapping": 1.632319684351117e-06, "remove_single_ts_time_rank_from_batch": 6.32573168026344e-07}}, "connector_pipeline_timer": 0.00015535285403793595}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.698718393285453e-06, "add_states_from_episodes_to_batch": 1.6589311331803893e-06, "batch_individual_items": 9.04642652576618e-06, "add_observations_from_episodes_to_batch": 1.6444319457639385e-05, "numpy_to_tensor": 9.579926224816717e-06, "add_time_dim_to_batch_and_zero_pad": 2.603101898837931e-06}}, "connector_pipeline_timer": 6.824329885288802e-05}, "num_agent_steps_sampled": {"vehicle_6": 1195.0, "vehicle_2": 1250.9999999999998, "vehicle_5": 1205.9999999999998, "vehicle_1": 1307.0, "vehicle_7": 1565.9999999999998, "vehicle_0": 1290.9999999999998, "vehicle_3": 1165.9999999999998, "vehicle_4": 1185.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 16588.0, "vehicle_4": 19970.0, "vehicle_2": 16709.0, "vehicle_6": 19042.0, "vehicle_5": 16548.999999999996, "vehicle_1": 17731.000000000004, "vehicle_7": 20375.000000000004, "vehicle_0": 17233.0}, "timers": {"connectors": {"numpy_to_tensor": 2.4500004656147212e-05, "add_time_dim_to_batch_and_zero_pad": 6.854003004264085e-06, "agent_to_module_mapping": 5.457997758639976e-06, "add_states_from_episodes_to_batch": 3.2084972190205008e-06, "batch_individual_items": 2.2125503164716065e-05, "add_observations_from_episodes_to_batch": 3.412499791011214e-05}}, "agent_steps": {"vehicle_7": 108.26, "vehicle_0": 96.0, "vehicle_3": 88.26, "vehicle_4": 91.69999999999999, "vehicle_6": 91.92, "vehicle_2": 99.44, "vehicle_5": 93.8, "vehicle_1": 99.92}, "weights_seq_no": 12.0, "episode_return_mean": 1372.7324408495426, "env_step_timer": 0.00015739058230029775, "num_env_steps_sampled_lifetime": 30000.0, "episode_len_max": 263, "num_module_steps_sampled_lifetime": {"shared_policy": 144197.0}, "episode_len_min": 94, "episode_len_mean": 141.51999999999998, "env_to_module_sum_episodes_length_out": 77.96816200981812, "env_to_module_sum_episodes_length_in": 77.96816200981812, "episode_duration_sec_mean": 0.09846166264032946, "rlmodule_inference_timer": 5.943954089889976e-05, "module_episode_returns_mean": {"shared_policy": 375.3603877949714}, "env_reset_timer": 0.00011772899961215444, "episode_return_max": 1920.4883700609207, "connector_pipeline_timer": 0.00020256249990779907, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 10167.000000000002}, "num_episodes": 13.0, "time_between_sampling": 0.3228680341679082, "episode_return_min": 435.7182687520981, "sample": 0.1468108079800605, "num_episodes_lifetime": 161.0, "num_env_steps_sampled_lifetime_throughput": 1710.1605631160533}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05913670571474, "add_one_ts_to_episodes_and_truncate": 0.006128370392004048, "numpy_to_tensor": 0.00011633127224086384, "add_time_dim_to_batch_and_zero_pad": 1.2328650656073663e-05, "agent_to_module_mapping": 0.003659154951209383, "add_states_from_episodes_to_batch": 3.942370349836513e-06, "general_advantage_estimation": 0.01871443098658082, "batch_individual_items": 0.1138202353711195, "add_observations_from_episodes_to_batch": 0.00036021830457482113}}, "connector_pipeline_timer": 0.20214468459961185}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 19612000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 1255168, "num_module_steps_trained": 104320, "num_trainable_parameters": 149763, "num_env_steps_trained": 1630000, "num_env_steps_trained_lifetime_throughput": 1128747.5703335847, "num_module_steps_trained_throughput": 72247.16832265009, "num_module_steps_trained_lifetime_throughput": 72243.72533790441}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1527.297119140625, "gradients_default_optimizer_global_norm": 2.0393872261047363, "num_module_steps_trained_lifetime": 1255168, "num_module_steps_trained": 104320, "curr_entropy_coeff": 0.01, "entropy": 0.7015854120254517, "weights_seq_no": 13.0, "total_loss": 9.403120994567871, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.30000001192092896, "mean_kl_loss": 0.017181091010570526, "vf_explained_var": -0.012824654579162598, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03845330327749252, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.443435668945312, "num_module_steps_trained_lifetime_throughput": 72247.21255233603}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "e9b26_00000", "date": "2025-06-25_19-21-35", "timestamp": 1750904495, "time_this_iter_s": 2.4451630115509033, "time_total_s": 154.54867219924927, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16a813ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 154.54867219924927, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 14.200000000000001, "ram_util_percent": 53.29999999999999}}
{"timers": {"training_iteration": 3.457159730019221, "restore_env_runners": 8.15808021035348e-05, "training_step": 3.4569796063892455, "env_runner_sampling_timer": 1.986006237436573, "learner_update_timer": 1.468853222858441, "synch_weights": 0.0009455506155046684, "synch_env_connectors": 0.0008386495854714385}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 224.74664162635804, "vehicle_7": 195.18809380292893, "vehicle_3": 198.7807637500763, "vehicle_0": 140.80160442471504, "vehicle_2": 213.15596599936487, "vehicle_4": 259.3289146566391, "vehicle_6": 241.26972426176076, "vehicle_5": 266.6918853569031}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 8.013794459067991e-06, "get_actions": 3.5789185644199204e-05, "un_batch_to_individual_items": 1.8432807635294385e-05, "normalize_and_clip_actions": 5.7673293341907393e-05, "tensor_to_numpy": 1.6210249610651717e-05, "module_to_agent_unmapping": 1.6378601885254287e-06, "remove_single_ts_time_rank_from_batch": 6.796101450023478e-07}}, "connector_pipeline_timer": 0.00016895860917902765}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.9365632975517167e-06, "add_states_from_episodes_to_batch": 1.6840417524097176e-06, "batch_individual_items": 9.888226404231931e-06, "add_observations_from_episodes_to_batch": 1.73576102850873e-05, "numpy_to_tensor": 9.651798109677684e-06, "add_time_dim_to_batch_and_zero_pad": 2.6026465130038776e-06}}, "connector_pipeline_timer": 7.061410610973649e-05}, "num_agent_steps_sampled": {"vehicle_6": 1467.0, "vehicle_2": 1380.0, "vehicle_5": 1515.0, "vehicle_1": 1675.0, "vehicle_7": 1555.9999999999998, "vehicle_0": 1292.0, "vehicle_3": 1395.9999999999998, "vehicle_4": 1420.9999999999998}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 17984.0, "vehicle_4": 21391.0, "vehicle_2": 18089.0, "vehicle_6": 20509.0, "vehicle_5": 18063.999999999996, "vehicle_1": 19406.000000000004, "vehicle_7": 21931.000000000004, "vehicle_0": 18525.0}, "timers": {"connectors": {"numpy_to_tensor": 2.4500004656147212e-05, "add_time_dim_to_batch_and_zero_pad": 6.854003004264085e-06, "agent_to_module_mapping": 5.457997758639976e-06, "add_states_from_episodes_to_batch": 3.2084972190205008e-06, "batch_individual_items": 2.2125503164716065e-05, "add_observations_from_episodes_to_batch": 3.412499791011214e-05}}, "agent_steps": {"vehicle_7": 102.05999999999999, "vehicle_0": 84.53999999999998, "vehicle_3": 86.67999999999998, "vehicle_4": 89.78, "vehicle_6": 92.28000000000002, "vehicle_2": 86.5, "vehicle_5": 94.69999999999999, "vehicle_1": 106.84}, "weights_seq_no": 13.0, "episode_return_mean": 1739.963594098091, "env_step_timer": 0.00018616932154143126, "num_env_steps_sampled_lifetime": 32000.0, "episode_len_max": 253, "num_module_steps_sampled_lifetime": {"shared_policy": 155899.0}, "episode_len_min": 96, "episode_len_mean": 129.68, "env_to_module_sum_episodes_length_out": 57.2728027074492, "env_to_module_sum_episodes_length_in": 57.2728027074492, "episode_duration_sec_mean": 0.09366791259933961, "rlmodule_inference_timer": 6.547420440868235e-05, "module_episode_returns_mean": {"shared_policy": 795.6947511148453}, "env_reset_timer": 0.00011772899961215444, "episode_return_max": 2089.4943365454674, "connector_pipeline_timer": 0.00020256249990779907, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 11702.000000000002}, "num_episodes": 16.0, "time_between_sampling": 0.32394803103786296, "episode_return_min": 1119.2133677005768, "sample": 0.14696311085641384, "num_episodes_lifetime": 177.0, "num_env_steps_sampled_lifetime_throughput": 1664.930844546607}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.059319451577636594, "add_one_ts_to_episodes_and_truncate": 0.0061539562680567065, "numpy_to_tensor": 0.00011606837950037256, "add_time_dim_to_batch_and_zero_pad": 1.2308704138949716e-05, "agent_to_module_mapping": 0.0036715159016984674, "add_states_from_episodes_to_batch": 3.92502663111203e-06, "general_advantage_estimation": 0.018788353766674412, "batch_individual_items": 0.11406329843739477, "add_observations_from_episodes_to_batch": 0.0003626286215454409}}, "connector_pipeline_timer": 0.20268377733362422}, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime": 21492000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 2000.0, "num_module_steps_trained_lifetime": 1375488, "num_module_steps_trained": 120320, "num_trainable_parameters": 149763, "num_env_steps_trained": 1880000, "num_env_steps_trained_lifetime_throughput": 1128140.6742982974, "num_module_steps_trained_throughput": 72207.86526570686, "num_module_steps_trained_lifetime_throughput": 72204.62957432213}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1650.21435546875, "gradients_default_optimizer_global_norm": 0.9288018345832825, "num_module_steps_trained_lifetime": 1375488, "num_module_steps_trained": 120320, "curr_entropy_coeff": 0.01, "entropy": 0.64812171459198, "weights_seq_no": 14.0, "total_loss": 9.773151397705078, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.004331066273152828, "vf_explained_var": -0.027724623680114746, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0621073916554451, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.716225624084473, "num_module_steps_trained_lifetime_throughput": 72207.90436133104}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "e9b26_00000", "date": "2025-06-25_19-21-37", "timestamp": 1750904497, "time_this_iter_s": 2.7964282035827637, "time_total_s": 157.34510040283203, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x150ca9a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.34510040283203, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.35, "ram_util_percent": 53.3}}
{"timers": {"training_iteration": 4.664573010629028, "restore_env_runners": 8.081083407066032e-05, "training_step": 4.664393221995361, "env_runner_sampling_timer": 3.1939113379722075, "learner_update_timer": 1.4683605897997924, "synch_weights": 0.0009441142793313295, "synch_env_connectors": 0.0008400880895595176}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 223.80950838625432, "vehicle_7": 264.8122058644891, "vehicle_3": 241.70822107076646, "vehicle_0": 148.18447533905507, "vehicle_2": 200.91207676023245, "vehicle_4": 251.18780648589134, "vehicle_6": 279.22728157937524, "vehicle_5": 284.9106097048521}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.2698457380057166e-06, "get_actions": 3.675356068045552e-05, "un_batch_to_individual_items": 1.6589036212880174e-05, "normalize_and_clip_actions": 5.14827109938035e-05, "tensor_to_numpy": 1.633117191829369e-05, "module_to_agent_unmapping": 1.624696626661671e-06, "remove_single_ts_time_rank_from_batch": 6.460946930722846e-07}}, "connector_pipeline_timer": 0.0001608516921305729}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.801213617697224e-06, "add_states_from_episodes_to_batch": 1.653696428675407e-06, "batch_individual_items": 9.30087277348823e-06, "add_observations_from_episodes_to_batch": 1.652077136822402e-05, "numpy_to_tensor": 9.711122075456191e-06, "add_time_dim_to_batch_and_zero_pad": 2.5595770971113343e-06}}, "connector_pipeline_timer": 6.864430556014533e-05}, "num_agent_steps_sampled": {"vehicle_6": 1086.0, "vehicle_2": 1024.0, "vehicle_5": 1016.0, "vehicle_1": 1138.0, "vehicle_7": 1167.0, "vehicle_0": 806.0, "vehicle_3": 1014.0, "vehicle_4": 975.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 18998.0, "vehicle_4": 22366.0, "vehicle_2": 19113.0, "vehicle_6": 21595.0, "vehicle_5": 19079.999999999996, "vehicle_1": 20544.000000000004, "vehicle_7": 23098.000000000004, "vehicle_0": 19331.0}, "timers": {"connectors": {"numpy_to_tensor": 2.406250496278517e-05, "add_time_dim_to_batch_and_zero_pad": 7.05200363881886e-06, "agent_to_module_mapping": 5.499498001881875e-06, "add_states_from_episodes_to_batch": 3.291746907052584e-06, "batch_individual_items": 2.2458752937382087e-05, "add_observations_from_episodes_to_batch": 3.462499807938002e-05}}, "agent_steps": {"vehicle_7": 105.605, "vehicle_0": 77.425, "vehicle_3": 95.775, "vehicle_4": 86.95, "vehicle_6": 98.09, "vehicle_2": 87.83, "vehicle_5": 92.69, "vehicle_1": 97.23}, "weights_seq_no": 14.0, "episode_return_mean": 1894.7521812808513, "env_step_timer": 0.00017688713997555613, "num_env_steps_sampled_lifetime": 33600.0, "episode_len_max": 239, "num_module_steps_sampled_lifetime": {"shared_policy": 164125.0}, "episode_len_min": 96, "episode_len_mean": 141.12, "env_to_module_sum_episodes_length_out": 69.88707028855484, "env_to_module_sum_episodes_length_in": 69.88707028855484, "episode_duration_sec_mean": 0.10014984899637057, "rlmodule_inference_timer": 6.082024802656767e-05, "module_episode_returns_mean": {"shared_policy": 1125.897604613304}, "env_reset_timer": 0.00011882299986609723, "episode_return_max": 2517.1192075014114, "connector_pipeline_timer": 0.00020467724971240386, "num_env_steps_sampled": 1600.0, "num_module_steps_sampled": {"shared_policy": 8226.0}, "num_episodes": 12.0, "time_between_sampling": 0.6728701753204616, "episode_return_min": 1283.899440407753, "sample": 0.15012021096747385, "num_episodes_lifetime": 189.0, "num_env_steps_sampled_lifetime_throughput": 1666.706355728276}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05930759873182774, "add_one_ts_to_episodes_and_truncate": 0.0061648787853644665, "numpy_to_tensor": 0.00011693436567747937, "add_time_dim_to_batch_and_zero_pad": 1.2276037096301927e-05, "agent_to_module_mapping": 0.0036730299126312557, "add_states_from_episodes_to_batch": 3.909526400125975e-06, "general_advantage_estimation": 0.01875086230903912, "batch_individual_items": 0.11337442170298855, "add_observations_from_episodes_to_batch": 0.0003637802453286521}}, "connector_pipeline_timer": 0.20195966081031902}, "learner_connector_sum_episodes_length_out": 1996.0, "num_env_steps_trained_lifetime": 22548000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 1996.0, "num_module_steps_trained_lifetime": 1459968, "num_module_steps_trained": 84480, "num_trainable_parameters": 149763, "num_env_steps_trained": 1056000, "num_env_steps_trained_lifetime_throughput": 1114446.3737137474, "num_module_steps_trained_throughput": 72014.30434781489, "num_module_steps_trained_lifetime_throughput": 72011.288404208}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1815.904541015625, "gradients_default_optimizer_global_norm": 2.0032737255096436, "num_module_steps_trained_lifetime": 1459968, "num_module_steps_trained": 84480, "curr_entropy_coeff": 0.01, "entropy": 0.619455873966217, "weights_seq_no": 15.0, "total_loss": 9.657487869262695, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.013277435675263405, "vf_explained_var": 0.01235586404800415, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.12549075484275818, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.787182807922363, "num_module_steps_trained_lifetime_throughput": 72014.26382993684}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 33600.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 2}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "e9b26_00000", "date": "2025-06-25_19-23-43", "timestamp": 1750904623, "time_this_iter_s": 125.3045060634613, "time_total_s": 282.64960646629333, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16a831f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 282.64960646629333, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 8.968539325842697, "ram_util_percent": 53.12022471910113}}
{"timers": {"training_iteration": 4.6446596463527685, "restore_env_runners": 0.00014632022575265937, "training_step": 4.644412373525435, "env_runner_sampling_timer": 3.170622950012497, "learner_update_timer": 1.4716598897417572, "synch_weights": 0.0009452118865314456, "synch_env_connectors": 0.011888389708654856}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 310.8069895770815, "vehicle_7": 303.41196998755146, "vehicle_3": 263.1022604942321, "vehicle_0": 193.10793318748478, "vehicle_2": 237.81322006649438, "vehicle_4": 255.85117168161608, "vehicle_6": 260.7368397553762, "vehicle_5": 283.32558520105147}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.95741285168553e-06, "get_actions": 4.6161651425016306e-05, "un_batch_to_individual_items": 1.907580593099762e-05, "normalize_and_clip_actions": 6.038684926311965e-05, "tensor_to_numpy": 1.9567784654411714e-05, "module_to_agent_unmapping": 1.909290930693567e-06, "remove_single_ts_time_rank_from_batch": 6.618069457788685e-07}}, "connector_pipeline_timer": 0.00018804657567021737}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.9664887465309354e-06, "add_states_from_episodes_to_batch": 1.6752152284309117e-06, "batch_individual_items": 1.0244472281169517e-05, "add_observations_from_episodes_to_batch": 1.779739325778043e-05, "numpy_to_tensor": 1.0061714401566884e-05, "add_time_dim_to_batch_and_zero_pad": 2.7753949601252623e-06}}, "connector_pipeline_timer": 7.282805702607288e-05}, "num_agent_steps_sampled": {"vehicle_6": 1447.0, "vehicle_2": 1495.0, "vehicle_5": 1502.0, "vehicle_1": 1828.0, "vehicle_7": 1415.9999999999998, "vehicle_0": 1200.9999999999998, "vehicle_3": 1254.0000000000002, "vehicle_4": 1329.0000000000002}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 3880.0, "vehicle_4": 4155.0, "vehicle_2": 4803.000000000001, "vehicle_6": 4546.0, "vehicle_5": 4753.999999999999, "vehicle_1": 5331.000000000001, "vehicle_7": 4426.999999999999, "vehicle_0": 3714.0}, "timers": {"connectors": {"numpy_to_tensor": 3.7604502722388133e-05, "add_time_dim_to_batch_and_zero_pad": 9.854000381892547e-06, "agent_to_module_mapping": 8.958497346611694e-06, "add_states_from_episodes_to_batch": 5.187499482417479e-06, "batch_individual_items": 3.620799907366743e-05, "add_observations_from_episodes_to_batch": 5.647950092679821e-05}}, "agent_steps": {"vehicle_7": 89.24444444444445, "vehicle_0": 75.17777777777776, "vehicle_3": 78.6222222222222, "vehicle_4": 83.2888888888889, "vehicle_6": 91.0, "vehicle_2": 96.86666666666666, "vehicle_5": 95.64444444444446, "vehicle_1": 108.08888888888893}, "weights_seq_no": 15.0, "episode_return_mean": 2108.1559729814535, "env_step_timer": 0.0001851837200881088, "num_env_steps_sampled_lifetime": 6000.0, "episode_len_max": 239, "num_module_steps_sampled_lifetime": {"shared_policy": 35610.0}, "episode_len_min": 92, "episode_len_mean": 122.04444444444448, "env_to_module_sum_episodes_length_out": 62.70024925577273, "env_to_module_sum_episodes_length_in": 62.70024925577273, "episode_duration_sec_mean": 0.0909623370885836, "rlmodule_inference_timer": 7.164689957835332e-05, "module_episode_returns_mean": {"shared_policy": 631.9196658902699}, "env_reset_timer": 0.00018050000289804302, "episode_return_max": 2868.693992972374, "connector_pipeline_timer": 0.000328041503962595, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 11472.000000000002}, "num_episodes": 15.0, "time_between_sampling": 0.009460547849235676, "episode_return_min": 1615.0118399858475, "sample": 0.167911391588184, "num_episodes_lifetime": 45.0, "num_env_steps_sampled_lifetime_throughput": 1593.324324330872}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0594818777444985, "add_one_ts_to_episodes_and_truncate": 0.0061887391675322185, "numpy_to_tensor": 0.0001166129420394185, "add_time_dim_to_batch_and_zero_pad": 1.2253696727465975e-05, "agent_to_module_mapping": 0.003686123363519127, "add_states_from_episodes_to_batch": 3.894601139723271e-06, "general_advantage_estimation": 0.018810952435941632, "batch_individual_items": 0.11281050498596182, "add_observations_from_episodes_to_batch": 0.0003658691028950837}}, "connector_pipeline_timer": 0.20166804503218033}, "learner_connector_sum_episodes_length_out": 1996.04, "num_env_steps_trained_lifetime": 24390000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 1996.04, "num_module_steps_trained_lifetime": 1577856, "num_module_steps_trained": 117888, "num_trainable_parameters": 149763, "num_env_steps_trained": 1842000, "num_env_steps_trained_lifetime_throughput": 1116621.9406672986, "num_module_steps_trained_throughput": 72119.81408244415, "num_module_steps_trained_lifetime_throughput": 72116.84224593545}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2096.635986328125, "gradients_default_optimizer_global_norm": 2.1503591537475586, "num_module_steps_trained_lifetime": 1577856, "num_module_steps_trained": 117888, "curr_entropy_coeff": 0.01, "entropy": 0.5542065501213074, "weights_seq_no": 16.0, "total_loss": 9.651522636413574, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.011384834535419941, "vf_explained_var": -0.004074811935424805, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.028194166719913483, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.627161979675293, "num_module_steps_trained_lifetime_throughput": 72120.02879999965}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "e9b26_00000", "date": "2025-06-25_19-23-46", "timestamp": 1750904626, "time_this_iter_s": 2.6753032207489014, "time_total_s": 285.32490968704224, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16a832980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 285.32490968704224, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.875, "ram_util_percent": 52.375}}
{"timers": {"training_iteration": 5.254855611979224, "restore_env_runners": 0.00014490743351227114, "training_step": 5.2546092752101385, "env_runner_sampling_timer": 3.7755587471723464, "learner_update_timer": 1.4769146066743106, "synch_weights": 0.0009446918476113564, "synch_env_connectors": 0.011778361641587763}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 311.1037391710281, "vehicle_7": 324.9881932020187, "vehicle_3": 221.7906423318386, "vehicle_0": 159.55327479362487, "vehicle_2": 265.66168930649764, "vehicle_4": 299.0500900411606, "vehicle_6": 296.8999837470055, "vehicle_5": 299.0717136502266}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.563504218119439e-06, "get_actions": 3.4310913894244266e-05, "un_batch_to_individual_items": 1.7437242021922867e-05, "normalize_and_clip_actions": 5.462470446654296e-05, "tensor_to_numpy": 1.5226612638018149e-05, "module_to_agent_unmapping": 1.5414246399101681e-06, "remove_single_ts_time_rank_from_batch": 6.061415394158423e-07}}, "connector_pipeline_timer": 0.000160139437081483}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.7684915952181554e-06, "add_states_from_episodes_to_batch": 1.5515095091275362e-06, "batch_individual_items": 9.154110996206315e-06, "add_observations_from_episodes_to_batch": 1.6614636603264753e-05, "numpy_to_tensor": 8.775363060204577e-06, "add_time_dim_to_batch_and_zero_pad": 2.515905628579409e-06}}, "connector_pipeline_timer": 6.613554716369783e-05}, "num_agent_steps_sampled": {"vehicle_6": 1605.0, "vehicle_2": 1555.9999999999998, "vehicle_5": 1620.9999999999998, "vehicle_1": 1664.0000000000002, "vehicle_7": 1887.0, "vehicle_0": 1090.0, "vehicle_3": 1074.0, "vehicle_4": 1537.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 4954.0, "vehicle_4": 5692.0, "vehicle_2": 6359.0, "vehicle_6": 6151.0, "vehicle_5": 6375.0, "vehicle_1": 6995.0, "vehicle_7": 6314.0, "vehicle_0": 4804.0}, "timers": {"connectors": {"numpy_to_tensor": 3.516700235195458e-05, "add_time_dim_to_batch_and_zero_pad": 9.916999260894954e-06, "agent_to_module_mapping": 9.12499672267586e-06, "add_states_from_episodes_to_batch": 5.1249953685328364e-06, "batch_individual_items": 3.8374993891920894e-05, "add_observations_from_episodes_to_batch": 5.791700095869597e-05}}, "agent_steps": {"vehicle_7": 105.09999999999998, "vehicle_0": 62.5, "vehicle_3": 62.7, "vehicle_4": 89.36, "vehicle_6": 90.30000000000001, "vehicle_2": 88.7, "vehicle_5": 91.46, "vehicle_1": 107.64}, "weights_seq_no": 16.0, "episode_return_mean": 2178.1193281888964, "env_step_timer": 0.00017943447720483868, "num_env_steps_sampled_lifetime": 8000.0, "episode_len_max": 255, "num_module_steps_sampled_lifetime": {"shared_policy": 47644.0}, "episode_len_min": 90, "episode_len_mean": 121.62000000000002, "env_to_module_sum_episodes_length_out": 56.438481006699746, "env_to_module_sum_episodes_length_in": 56.438481006699746, "episode_duration_sec_mean": 0.08678191094077192, "rlmodule_inference_timer": 8.281086919800738e-05, "module_episode_returns_mean": {"shared_policy": 617.0043450713158}, "env_reset_timer": 0.00017654200200922787, "episode_return_max": 2868.693992972374, "connector_pipeline_timer": 0.00033733300369931385, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 12034.0}, "num_episodes": 18.0, "time_between_sampling": 0.5658606695898897, "episode_return_min": 1468.1997110843658, "sample": 0.16311222195412434, "num_episodes_lifetime": 63.0, "num_env_steps_sampled_lifetime_throughput": 1610.807105920761}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05966898313705888, "add_one_ts_to_episodes_and_truncate": 0.006220815105857302, "numpy_to_tensor": 0.00011638306261765528, "add_time_dim_to_batch_and_zero_pad": 1.2231999730591871e-05, "agent_to_module_mapping": 0.0037008437898930413, "add_states_from_episodes_to_batch": 3.878155081373411e-06, "general_advantage_estimation": 0.018881228741602633, "batch_individual_items": 0.11308981660614696, "add_observations_from_episodes_to_batch": 0.00036882291186734356}}, "connector_pipeline_timer": 0.2022535487518134}, "learner_connector_sum_episodes_length_out": 1996.0796, "num_env_steps_trained_lifetime": 26326000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 1996.0796, "num_module_steps_trained_lifetime": 1701760, "num_module_steps_trained": 123904, "num_trainable_parameters": 149763, "num_env_steps_trained": 1936000, "num_env_steps_trained_lifetime_throughput": 1116697.2341947872, "num_module_steps_trained_throughput": 72091.84270177042, "num_module_steps_trained_lifetime_throughput": 72089.01514995871}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2415.853515625, "gradients_default_optimizer_global_norm": 1.851398229598999, "num_module_steps_trained_lifetime": 1701760, "num_module_steps_trained": 123904, "curr_entropy_coeff": 0.01, "entropy": 0.5787377953529358, "weights_seq_no": 17.0, "total_loss": 9.865159034729004, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.010821045376360416, "vf_explained_var": -0.02021324634552002, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.0044982112012803555, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.873822212219238, "num_module_steps_trained_lifetime_throughput": 72092.06521531018}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "e9b26_00000", "date": "2025-06-25_19-24-51", "timestamp": 1750904691, "time_this_iter_s": 65.66561985015869, "time_total_s": 350.9905295372009, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x101089da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 350.9905295372009, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 15.164516129032258, "ram_util_percent": 52.79032258064513}}
{"timers": {"training_iteration": 6.418901656269385, "restore_env_runners": 0.00017889210919469454, "training_step": 6.418620683708028, "env_runner_sampling_timer": 4.948098163450621, "learner_update_timer": 1.4683933893575847, "synch_weights": 0.0009432665991359869, "synch_env_connectors": 0.011667634275132326}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 319.2051436674595, "vehicle_7": 332.8408714520931, "vehicle_3": 217.3794086909294, "vehicle_0": 162.09917697668075, "vehicle_2": 260.6527971041203, "vehicle_4": 278.21356368541717, "vehicle_6": 294.16833046197894, "vehicle_5": 300.0131493330002}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.91096434829377e-06, "get_actions": 4.3548180935026514e-05, "un_batch_to_individual_items": 1.827169757022672e-05, "normalize_and_clip_actions": 5.9146877800326126e-05, "tensor_to_numpy": 1.8784924184053513e-05, "module_to_agent_unmapping": 1.786475848230208e-06, "remove_single_ts_time_rank_from_batch": 6.445695936411846e-07}}, "connector_pipeline_timer": 0.00018062162743644485}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.942582700014217e-06, "add_states_from_episodes_to_batch": 1.6140603909888794e-06, "batch_individual_items": 1.0092583355423049e-05, "add_observations_from_episodes_to_batch": 1.7358694191733308e-05, "numpy_to_tensor": 9.648022007269718e-06, "add_time_dim_to_batch_and_zero_pad": 2.6054370800647763e-06}}, "connector_pipeline_timer": 7.05607781498906e-05}, "num_agent_steps_sampled": {"vehicle_6": 527.0, "vehicle_2": 530.0, "vehicle_5": 538.0, "vehicle_1": 561.0, "vehicle_7": 554.0, "vehicle_0": 233.0, "vehicle_3": 233.0, "vehicle_4": 492.0}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 3536.0, "vehicle_4": 4833.0, "vehicle_2": 5050.0, "vehicle_6": 5012.0, "vehicle_5": 5124.0, "vehicle_1": 5885.0, "vehicle_7": 5670.0, "vehicle_0": 3526.0}, "timers": {"connectors": {"numpy_to_tensor": 3.023633568470056e-05, "add_time_dim_to_batch_and_zero_pad": 9.56966687226668e-06, "agent_to_module_mapping": 8.166665793396533e-06, "add_states_from_episodes_to_batch": 4.4166639175576465e-06, "batch_individual_items": 3.347232753488546e-05, "add_observations_from_episodes_to_batch": 5.109733319841325e-05}}, "agent_steps": {"vehicle_7": 102.79, "vehicle_0": 62.81, "vehicle_3": 62.67, "vehicle_4": 86.81000000000002, "vehicle_6": 90.33, "vehicle_2": 88.53, "vehicle_5": 91.63, "vehicle_1": 107.59}, "weights_seq_no": 17.0, "episode_return_mean": 2164.572443922758, "env_step_timer": 0.00018758437261689323, "num_env_steps_sampled_lifetime": 6800.0, "episode_len_max": 255, "num_module_steps_sampled_lifetime": {"shared_policy": 38636.0}, "episode_len_min": 90, "episode_len_mean": 121.45, "env_to_module_sum_episodes_length_out": 52.96291742931228, "env_to_module_sum_episodes_length_in": 52.96291742931228, "episode_duration_sec_mean": 0.08568217935091525, "rlmodule_inference_timer": 7.213845571084644e-05, "module_episode_returns_mean": {"shared_policy": 603.5677432525158}, "env_reset_timer": 0.0001598196686245501, "episode_return_max": 2868.693992972374, "connector_pipeline_timer": 0.00029511066774527234, "num_env_steps_sampled": 600.0, "num_module_steps_sampled": {"shared_policy": 3668.0}, "num_episodes": 4.0, "time_between_sampling": 0.6136969032906701, "episode_return_min": 1468.1997110843658, "sample": 0.1596341779847926, "num_episodes_lifetime": 54.0, "num_env_steps_sampled_lifetime_throughput": 1616.5127139883514}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05930843996571515, "add_one_ts_to_episodes_and_truncate": 0.00619135987474087, "numpy_to_tensor": 0.00011603090202520557, "add_time_dim_to_batch_and_zero_pad": 1.222259975783461e-05, "agent_to_module_mapping": 0.0036801161919850518, "add_states_from_episodes_to_batch": 3.865203543887909e-06, "general_advantage_estimation": 0.018769986044180408, "batch_individual_items": 0.11214810094004753, "add_observations_from_episodes_to_batch": 0.00036741218277389965}}, "connector_pipeline_timer": 0.20078735909434103}, "learner_connector_sum_episodes_length_out": 1982.118804, "num_env_steps_trained_lifetime": 26503000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 1982.118804, "num_module_steps_trained_lifetime": 1739520, "num_module_steps_trained": 37760, "num_trainable_parameters": 149763, "num_env_steps_trained": 177000, "num_env_steps_trained_lifetime_throughput": 1076076.3508040614, "num_module_steps_trained_throughput": 71732.85964800778, "num_module_steps_trained_lifetime_throughput": 71730.21142141611}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2732.828857421875, "gradients_default_optimizer_global_norm": 1.6751282215118408, "num_module_steps_trained_lifetime": 1739520, "num_module_steps_trained": 37760, "curr_entropy_coeff": 0.01, "entropy": 0.40534594655036926, "weights_seq_no": 18.0, "total_loss": 9.745099067687988, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.017669297754764557, "vf_explained_var": 0.035925984382629395, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.033477768301963806, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.779979705810547, "num_module_steps_trained_lifetime_throughput": 71733.03397957793}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6800.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "e9b26_00000", "date": "2025-06-25_19-26-54", "timestamp": 1750904814, "time_this_iter_s": 122.90981793403625, "time_total_s": 473.9003474712372, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16a811080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 473.9003474712372, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.016666666666664, "ram_util_percent": 52.45459770114942}}
{"timers": {"training_iteration": 6.383172585546695, "restore_env_runners": 0.0002455177680487133, "training_step": 6.382823145200955, "env_runner_sampling_timer": 4.907108500566135, "learner_update_timer": 1.4735799254639597, "synch_weights": 0.0009421760131811545, "synch_env_connectors": 0.024050329592395732}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 339.1995341645348, "vehicle_7": 369.0007200611962, "vehicle_3": 266.02206638389174, "vehicle_0": 165.08339539633852, "vehicle_2": 244.4001184225083, "vehicle_4": 272.3704695542653, "vehicle_6": 300.8787168502808, "vehicle_5": 297.3655019071366}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 8.615582545336061e-06, "get_actions": 4.558361143175453e-05, "un_batch_to_individual_items": 1.9741101672708433e-05, "normalize_and_clip_actions": 6.452504957944123e-05, "tensor_to_numpy": 1.9254739824218478e-05, "module_to_agent_unmapping": 1.8306376685086718e-06, "remove_single_ts_time_rank_from_batch": 6.398458219347919e-07}}, "connector_pipeline_timer": 0.00019202086614014606}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 3.0709797899681474e-06, "add_states_from_episodes_to_batch": 1.6703482251933078e-06, "batch_individual_items": 1.0417279107508791e-05, "add_observations_from_episodes_to_batch": 1.825278509010601e-05, "numpy_to_tensor": 1.0014900850340575e-05, "add_time_dim_to_batch_and_zero_pad": 2.6883534044367343e-06}}, "connector_pipeline_timer": 7.327060167454933e-05}, "num_agent_steps_sampled": {"vehicle_6": 1665.0, "vehicle_2": 1517.0, "vehicle_5": 1685.9999999999998, "vehicle_1": 1762.0, "vehicle_7": 1640.9999999999998, "vehicle_0": 1365.0, "vehicle_3": 1425.0, "vehicle_4": 1505.9999999999998}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 3954.0, "vehicle_4": 4489.0, "vehicle_2": 4346.0, "vehicle_6": 4863.999999999999, "vehicle_5": 4916.000000000001, "vehicle_1": 5383.999999999999, "vehicle_7": 4873.999999999999, "vehicle_0": 3730.0}, "timers": {"connectors": {"numpy_to_tensor": 2.9374499717960134e-05, "add_time_dim_to_batch_and_zero_pad": 9.87499879556708e-06, "agent_to_module_mapping": 8.791997970547522e-06, "add_states_from_episodes_to_batch": 5.104502633912489e-06, "batch_individual_items": 3.204200038453564e-05, "add_observations_from_episodes_to_batch": 5.4749998525949195e-05}}, "agent_steps": {"vehicle_7": 91.08888888888889, "vehicle_0": 65.79999999999998, "vehicle_3": 69.66666666666667, "vehicle_4": 83.55555555555554, "vehicle_6": 90.08888888888889, "vehicle_2": 80.55555555555556, "vehicle_5": 91.06666666666666, "vehicle_1": 99.37777777777775}, "weights_seq_no": 18.0, "episode_return_mean": 2254.320519688394, "env_step_timer": 0.00019986095473323862, "num_env_steps_sampled_lifetime": 6000.0, "episode_len_max": 202, "num_module_steps_sampled_lifetime": {"shared_policy": 36556.99999999999}, "episode_len_min": 90, "episode_len_mean": 110.97777777777773, "env_to_module_sum_episodes_length_out": 59.787915727811914, "env_to_module_sum_episodes_length_in": 59.787915727811914, "episode_duration_sec_mean": 0.08284606766683283, "rlmodule_inference_timer": 7.27182010701484e-05, "module_episode_returns_mean": {"shared_policy": 1297.1968340661788}, "env_reset_timer": 0.00018270900181960315, "episode_return_max": 2895.50308907032, "connector_pipeline_timer": 0.0003092500010097865, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 12567.000000000002}, "num_episodes": 17.0, "time_between_sampling": 0.01893422802089492, "episode_return_min": 1451.096090912819, "sample": 0.15104934670188713, "num_episodes_lifetime": 45.0, "num_env_steps_sampled_lifetime_throughput": 1574.843066830777}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.05952039598607648, "add_one_ts_to_episodes_and_truncate": 0.006214664615948197, "numpy_to_tensor": 0.00011584100296974689, "add_time_dim_to_batch_and_zero_pad": 1.2188293812721315e-05, "agent_to_module_mapping": 0.0036968521100859612, "add_states_from_episodes_to_batch": 3.851141480321076e-06, "general_advantage_estimation": 0.01885724201376607, "batch_individual_items": 0.11165659618063094, "add_observations_from_episodes_to_batch": 0.0003689422309571446}}, "connector_pipeline_timer": 0.20063572259335755}, "learner_connector_sum_episodes_length_out": 1982.29761596, "num_env_steps_trained_lifetime": 28517000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 1982.29761596, "num_module_steps_trained_lifetime": 1868416, "num_module_steps_trained": 128896, "num_trainable_parameters": 149763, "num_env_steps_trained": 2014000, "num_env_steps_trained_lifetime_throughput": 1078087.1998179993, "num_module_steps_trained_throughput": 71718.27644125557, "num_module_steps_trained_lifetime_throughput": 71715.78481620163}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2430.474365234375, "gradients_default_optimizer_global_norm": 1.3281018733978271, "num_module_steps_trained_lifetime": 1868416, "num_module_steps_trained": 128896, "curr_entropy_coeff": 0.01, "entropy": 0.46300193667411804, "weights_seq_no": 19.0, "total_loss": 9.841493606567383, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.013741095550358295, "vf_explained_var": 0.06913918256759644, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.07473188638687134, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.769330024719238, "num_module_steps_trained_lifetime_throughput": 71718.42198228008}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "e9b26_00000", "date": "2025-06-25_19-26-57", "timestamp": 1750904817, "time_this_iter_s": 2.848313093185425, "time_total_s": 476.7486605644226, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x15f49e200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 476.7486605644226, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.3, "ram_util_percent": 52.574999999999996}}
{"timers": {"training_iteration": 6.346056275531236, "restore_env_runners": 0.00024310759041984006, "training_step": 6.345708784998977, "env_runner_sampling_timer": 4.86681146306052, "learner_update_timer": 1.476758099129316, "synch_weights": 0.0009403855030225442, "synch_env_connectors": 0.023820405876519988}, "env_runners": {"agent_episode_returns_mean": {"vehicle_1": 374.6537068653106, "vehicle_7": 354.53325262546537, "vehicle_3": 299.9845202231407, "vehicle_0": 210.66583354473113, "vehicle_2": 257.4096127343178, "vehicle_4": 254.17362559795384, "vehicle_6": 315.68710305452345, "vehicle_5": 316.21946053981776}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 7.83842118051403e-06, "get_actions": 3.561748127668802e-05, "un_batch_to_individual_items": 1.7726172253922178e-05, "normalize_and_clip_actions": 5.59098323148395e-05, "tensor_to_numpy": 1.6008369282542743e-05, "module_to_agent_unmapping": 1.6047885137068486e-06, "remove_single_ts_time_rank_from_batch": 6.188617284006475e-07}}, "connector_pipeline_timer": 0.0001653152834109239}, "env_to_module_connector": {"timers": {"connectors": {"agent_to_module_mapping": 2.8807964597726224e-06, "add_states_from_episodes_to_batch": 1.6246423830064692e-06, "batch_individual_items": 9.666602190961025e-06, "add_observations_from_episodes_to_batch": 1.70194649022933e-05, "numpy_to_tensor": 9.624130013227197e-06, "add_time_dim_to_batch_and_zero_pad": 2.6228107011737716e-06}}, "connector_pipeline_timer": 6.92686119015378e-05}, "num_agent_steps_sampled": {"vehicle_6": 1388.0, "vehicle_2": 1235.0, "vehicle_5": 1343.0, "vehicle_1": 1792.0, "vehicle_7": 1414.0000000000002, "vehicle_0": 1051.0, "vehicle_3": 1118.0, "vehicle_4": 1254.0000000000002}, "num_agent_steps_sampled_lifetime": {"vehicle_3": 5072.0, "vehicle_4": 5743.0, "vehicle_2": 5581.0, "vehicle_6": 6252.0, "vehicle_5": 6259.000000000001, "vehicle_1": 7175.999999999998, "vehicle_7": 6288.0, "vehicle_0": 4781.0}, "timers": {"connectors": {"numpy_to_tensor": 2.9374499717960134e-05, "add_time_dim_to_batch_and_zero_pad": 9.87499879556708e-06, "agent_to_module_mapping": 8.791997970547522e-06, "add_states_from_episodes_to_batch": 5.104502633912489e-06, "batch_individual_items": 3.204200038453564e-05, "add_observations_from_episodes_to_batch": 5.4749998525949195e-05}}, "agent_steps": {"vehicle_7": 88.7, "vehicle_0": 75.76, "vehicle_3": 79.61999999999998, "vehicle_4": 79.7, "vehicle_6": 92.69999999999999, "vehicle_2": 83.81999999999998, "vehicle_5": 90.48, "vehicle_1": 110.1}, "weights_seq_no": 19.0, "episode_return_mean": 2383.3271081662183, "env_step_timer": 0.000190346030975522, "num_env_steps_sampled_lifetime": 8000.0, "episode_len_max": 209, "num_module_steps_sampled_lifetime": {"shared_policy": 47151.99999999999}, "episode_len_min": 90, "episode_len_mean": 122.8, "env_to_module_sum_episodes_length_out": 52.148128761037206, "env_to_module_sum_episodes_length_in": 52.148128761037206, "episode_duration_sec_mean": 0.09302560178140994, "rlmodule_inference_timer": 0.0001596502710369855, "module_episode_returns_mean": {"shared_policy": 1173.6300105190276}, "env_reset_timer": 0.00018270900181960315, "episode_return_max": 2986.9779636859894, "connector_pipeline_timer": 0.0003092500010097865, "num_env_steps_sampled": 2000.0, "num_module_steps_sampled": {"shared_policy": 10595.0}, "num_episodes": 16.0, "time_between_sampling": 0.03833315243251345, "episode_return_min": 1737.8061361312866, "sample": 0.1514770246230125, "num_episodes_lifetime": 61.0, "num_env_steps_sampled_lifetime_throughput": 1501.2494388543994}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.059630178276200076, "add_one_ts_to_episodes_and_truncate": 0.006238432969806564, "numpy_to_tensor": 0.00011563801297696604, "add_time_dim_to_batch_and_zero_pad": 1.2158910924098555e-05, "agent_to_module_mapping": 0.0037061281789607875, "add_states_from_episodes_to_batch": 3.838050078634538e-06, "general_advantage_estimation": 0.018894077513634956, "batch_individual_items": 0.1118537702187933, "add_observations_from_episodes_to_batch": 0.0003718015585999174}}, "connector_pipeline_timer": 0.20101463077739953}, "learner_connector_sum_episodes_length_out": 1982.4746398004, "num_env_steps_trained_lifetime": 30223000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 1982.4746398004, "num_module_steps_trained_lifetime": 1977600, "num_module_steps_trained": 109184, "num_trainable_parameters": 149763, "num_env_steps_trained": 1706000, "num_env_steps_trained_lifetime_throughput": 1080252.8405430526, "num_module_steps_trained_throughput": 71720.80705993318, "num_module_steps_trained_lifetime_throughput": 71718.43960155448}, "shared_policy": {"module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2603.642333984375, "gradients_default_optimizer_global_norm": 2.8717434406280518, "num_module_steps_trained_lifetime": 1977600, "num_module_steps_trained": 109184, "curr_entropy_coeff": 0.01, "entropy": 0.44314250349998474, "weights_seq_no": 20.0, "total_loss": 9.742758750915527, "num_trainable_parameters": 149763, "curr_kl_coeff": 0.15000000596046448, "mean_kl_loss": 0.00805572234094143, "vf_explained_var": 0.010496318340301514, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.15872567892074585, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.904707908630371, "num_module_steps_trained_lifetime_throughput": 71721.11086322043}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "e9b26_00000", "date": "2025-06-25_19-27-00", "timestamp": 1750904820, "time_this_iter_s": 2.6736719608306885, "time_total_s": 479.4223325252533, "pid": 29895, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 8, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x16a810e00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 479.4223325252533, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.125, "ram_util_percent": 52.6}}
