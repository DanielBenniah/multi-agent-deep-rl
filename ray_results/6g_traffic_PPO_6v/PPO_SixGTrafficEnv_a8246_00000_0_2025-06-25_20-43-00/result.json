{"timers": {"training_iteration": 1.899468915995385, "restore_env_runners": 1.2458003766369075e-05, "training_step": 1.8993462919970625, "env_runner_sampling_timer": 0.7166847089974908, "learner_update_timer": 1.1807477499969536, "synch_weights": 0.0008970420021796599}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7833000785903985e-05, "add_time_dim_to_batch_and_zero_pad": 1.2603995855897665e-05, "add_observations_from_episodes_to_batch": 4.581250323099084e-05, "add_states_from_episodes_to_batch": 3.875000402331352e-06, "agent_to_module_mapping": 6.041496817488223e-06, "numpy_to_tensor": 3.970849866163917e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0415610220278853e-05, "batch_individual_items": 8.884505418848326e-06, "add_time_dim_to_batch_and_zero_pad": 2.730671871211966e-06, "add_observations_from_episodes_to_batch": 1.3957858603801039e-05, "add_states_from_episodes_to_batch": 1.690333639749403e-06, "agent_to_module_mapping": 2.661859014959375e-06}}, "connector_pipeline_timer": 6.778796243349269e-05}, "env_reset_timer": 0.00011464599811006337, "agent_episode_returns_mean": {"vehicle_1": -923.3201591400872, "vehicle_5": -1198.6343180508838, "vehicle_3": -728.0182642312277, "vehicle_2": -987.5849194186076, "vehicle_4": -1967.8502821752004, "vehicle_0": -994.7592333214621}, "sample": 0.12423324439182122, "rlmodule_inference_timer": 9.914214695836011e-05, "agent_steps": {"vehicle_5": 139.99999999999997, "vehicle_3": 87.80952380952382, "vehicle_2": 101.47619047619048, "vehicle_0": 114.28571428571426, "vehicle_4": 212.8095238095238, "vehicle_1": 97.33333333333333}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 232.57142857142858, "env_step_timer": 0.0001446790648158528, "connector_pipeline_timer": 0.00031256250440492295, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.4780099947694863e-05, "tensor_to_numpy": 1.904817253582374e-05, "module_to_agent_unmapping": 1.6296042501622045e-06, "normalize_and_clip_actions": 4.140512377970238e-05, "remove_single_ts_time_rank_from_batch": 6.44330054401767e-07, "un_batch_to_individual_items": 1.330966234433294e-05, "listify_data_for_vector_env": 5.954640959273466e-06}}, "connector_pipeline_timer": 0.0001580508959451084}, "num_agent_steps_sampled": {"vehicle_5": 1255.9999999999998, "vehicle_3": 861.0, "vehicle_2": 1061.0, "vehicle_4": 1909.0000000000002, "vehicle_0": 997.0000000000001, "vehicle_1": 895.0}, "env_to_module_sum_episodes_length_in": 80.2161948387205, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3151.9999999999995, "vehicle_2": 2868.0000000000005, "vehicle_4": 5563.999999999999, "vehicle_1": 2781.0, "vehicle_5": 3788.0000000000005, "vehicle_3": 2488.0000000000005}, "episode_return_mean": -6800.167181423733, "num_env_steps_sampled_lifetime": 6000.0, "time_between_sampling": 0.007217497689611968, "episode_return_min": -8687.598957061768, "episode_len_max": 281, "num_module_steps_sampled_lifetime": {"shared_policy": 20640.999999999996}, "module_episode_returns_mean": {"shared_policy": -5121.428670156571}, "episode_len_min": 186, "weights_seq_no": 0.0, "episode_duration_sec_mean": 0.1393871545227566, "num_module_steps_sampled": {"shared_policy": 6978.999999999999}, "num_episodes_lifetime": 21.0, "episode_return_max": -5553.021695613861, "env_to_module_sum_episodes_length_out": 80.2161948387205, "num_episodes": 8.0, "num_env_steps_sampled_lifetime_throughput": 1803.2726540524304}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004797415997018106, "agent_to_module_mapping": 0.0030088749990682118, "general_advantage_estimation": 0.016003167002054397, "add_time_dim_to_batch_and_zero_pad": 1.208300091093406e-05, "add_columns_from_episodes_to_train_batch": 0.04412137500185054, "add_states_from_episodes_to_batch": 3.916000423487276e-06, "numpy_to_tensor": 0.00023870900622569025, "batch_individual_items": 0.11155266700370703, "add_observations_from_episodes_to_batch": 0.0002827499993145466}}, "connector_pipeline_timer": 0.1802062500064494}, "learner_connector_sum_episodes_length_in": 2000, "num_env_steps_trained": 1112000, "num_module_steps_trained_lifetime": 71168, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 1112000, "num_module_steps_trained": 71168, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 2000, "num_env_steps_trained_lifetime_throughput": 1112520.3632510717, "num_module_steps_trained_throughput": 71198.31689874288, "num_module_steps_trained_lifetime_throughput": 71199.24885458719}, "shared_policy": {"gradients_default_optimizer_global_norm": 0.565852701663971, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.555388450622559, "total_loss": 9.249356269836426, "num_module_steps_trained": 71168, "num_trainable_parameters": 149763, "entropy": 1.308295488357544, "vf_loss_unclipped": 15089.05078125, "weights_seq_no": 1.0, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.001341700553894043, "policy_loss": -0.29646700620651245, "mean_kl_loss": 0.017588939517736435, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 71168, "num_module_steps_trained_lifetime_throughput": 71201.18623427002}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "a8246_00000", "date": "2025-06-25_20-43-06", "timestamp": 1750909386, "time_this_iter_s": 1.9014768600463867, "time_total_s": 1.9014768600463867, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a6f20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.9014768600463867, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.6, "ram_util_percent": 53.5}}
{"timers": {"training_iteration": 1.8982011814254656, "restore_env_runners": 1.2407173708197662e-05, "training_step": 1.8980781669970748, "env_runner_sampling_timer": 0.7164181102375005, "learner_update_timer": 1.1797442499969475, "synch_weights": 0.0008962715821689926, "synch_env_connectors": 0.0008515840017935261}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7833000785903985e-05, "add_time_dim_to_batch_and_zero_pad": 1.2603995855897665e-05, "add_observations_from_episodes_to_batch": 4.581250323099084e-05, "add_states_from_episodes_to_batch": 3.875000402331352e-06, "agent_to_module_mapping": 6.041496817488223e-06, "numpy_to_tensor": 3.970849866163917e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.108956264964125e-06, "batch_individual_items": 8.151674962896445e-06, "add_time_dim_to_batch_and_zero_pad": 2.5429008651422235e-06, "add_observations_from_episodes_to_batch": 1.3263238604231311e-05, "add_states_from_episodes_to_batch": 1.6216896816745898e-06, "agent_to_module_mapping": 2.4610212364169488e-06}}, "connector_pipeline_timer": 6.273568962907611e-05}, "env_reset_timer": 0.00011464599811006337, "agent_episode_returns_mean": {"vehicle_1": -819.1875086447596, "vehicle_5": -1171.1138022270798, "vehicle_3": -759.2930167287589, "vehicle_2": -1020.4616694718598, "vehicle_4": -1532.5872167304165, "vehicle_0": -829.5340506908298}, "sample": 0.12455599649610216, "rlmodule_inference_timer": 5.923059934789792e-05, "agent_steps": {"vehicle_5": 140.9875, "vehicle_3": 98.775, "vehicle_2": 108.5425, "vehicle_0": 96.15499999999999, "vehicle_4": 177.1075, "vehicle_1": 88.9625}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 200.395, "env_step_timer": 0.00014592384465198437, "connector_pipeline_timer": 0.00031256250440492295, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5243702470917117e-05, "tensor_to_numpy": 1.5865502370389352e-05, "module_to_agent_unmapping": 1.5656125560998988e-06, "normalize_and_clip_actions": 3.7887305821497715e-05, "remove_single_ts_time_rank_from_batch": 6.226921315342382e-07, "un_batch_to_individual_items": 1.2636458870289677e-05, "listify_data_for_vector_env": 5.67821622538394e-06}}, "connector_pipeline_timer": 0.0001395883796174172}, "num_agent_steps_sampled": {"vehicle_5": 1385.0, "vehicle_3": 1006.0, "vehicle_2": 997.9999999999999, "vehicle_4": 1595.9999999999998, "vehicle_0": 957.9999999999999, "vehicle_1": 887.9999999999999}, "env_to_module_sum_episodes_length_in": 76.65196097671173, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4110.0, "vehicle_2": 3866.0, "vehicle_4": 7160.0, "vehicle_1": 3669.0, "vehicle_5": 5173.0, "vehicle_3": 3494.000000000001}, "episode_return_mean": -6132.177258580923, "num_env_steps_sampled_lifetime": 8000.0, "time_between_sampling": 0.019256333785330364, "episode_return_min": -8687.598957061768, "episode_len_max": 297, "num_module_steps_sampled_lifetime": {"shared_policy": 27471.999999999996}, "module_episode_returns_mean": {"shared_policy": -4708.504270189106}, "episode_len_min": 92, "weights_seq_no": 1.0, "episode_duration_sec_mean": 0.1259809623200999, "num_module_steps_sampled": {"shared_policy": 6831.000000000001}, "num_episodes_lifetime": 31.0, "episode_return_max": -3845.250259280205, "env_to_module_sum_episodes_length_out": 76.65196097671173, "num_episodes": 10.0, "num_env_steps_sampled_lifetime_throughput": 1898.965261153957}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004796195167073165, "agent_to_module_mapping": 0.0030080016591091407, "general_advantage_estimation": 0.015993290332044125, "add_time_dim_to_batch_and_zero_pad": 1.2058010906912386e-05, "add_columns_from_episodes_to_train_batch": 0.044127935001888545, "add_states_from_episodes_to_batch": 3.910170416929759e-06, "numpy_to_tensor": 0.00023717357616988012, "batch_individual_items": 0.11077049783372786, "add_observations_from_episodes_to_batch": 0.00028314207927905956}}, "connector_pipeline_timer": 0.17941674542635155}, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained": 1094000, "num_module_steps_trained_lifetime": 141184, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 2206000, "num_module_steps_trained": 70016, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime_throughput": 1115046.7685487259, "num_module_steps_trained_throughput": 71360.02478974548, "num_module_steps_trained_lifetime_throughput": 71360.93416767198}, "shared_policy": {"gradients_default_optimizer_global_norm": 0.4882100522518158, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.921260833740234, "total_loss": 10.045586585998535, "num_module_steps_trained": 70016, "num_trainable_parameters": 149763, "entropy": 1.2288520336151123, "vf_loss_unclipped": 14284.46875, "weights_seq_no": 2.0, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.00794684886932373, "policy_loss": 0.13288374245166779, "mean_kl_loss": 0.018655255436897278, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 141184, "num_module_steps_trained_lifetime_throughput": 71362.64467369685}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "a8246_00000", "date": "2025-06-25_20-43-08", "timestamp": 1750909388, "time_this_iter_s": 1.7748830318450928, "time_total_s": 3.6763598918914795, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a5e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.6763598918914795, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.466666666666667, "ram_util_percent": 53.5}}
{"timers": {"training_iteration": 1.8968396654512303, "restore_env_runners": 1.2326021971966839e-05, "training_step": 1.896716369497071, "env_runner_sampling_timer": 0.7160350337251707, "learner_update_timer": 1.178765586666982, "synch_weights": 0.0008947734463232337, "synch_env_connectors": 0.0008529469117638655}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7833000785903985e-05, "add_time_dim_to_batch_and_zero_pad": 1.2603995855897665e-05, "add_observations_from_episodes_to_batch": 4.581250323099084e-05, "add_states_from_episodes_to_batch": 3.875000402331352e-06, "agent_to_module_mapping": 6.041496817488223e-06, "numpy_to_tensor": 3.970849866163917e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.801080535637329e-06, "batch_individual_items": 8.389116315423527e-06, "add_time_dim_to_batch_and_zero_pad": 2.6964500085212495e-06, "add_observations_from_episodes_to_batch": 1.3664926256800731e-05, "add_states_from_episodes_to_batch": 1.6837664968221318e-06, "agent_to_module_mapping": 2.544113057577159e-06}}, "connector_pipeline_timer": 6.528338535687955e-05}, "env_reset_timer": 0.00011464599811006337, "agent_episode_returns_mean": {"vehicle_1": -562.7994615101815, "vehicle_5": -937.9240878653528, "vehicle_3": -637.9503317975998, "vehicle_2": -734.39996263504, "vehicle_4": -1276.2349191045762, "vehicle_0": -616.0489075493813}, "sample": 0.12460231599629798, "rlmodule_inference_timer": 5.819622655894274e-05, "agent_steps": {"vehicle_5": 126.48, "vehicle_3": 94.36000000000001, "vehicle_2": 84.99999999999999, "vehicle_0": 87.0, "vehicle_4": 155.17999999999998, "vehicle_1": 80.66}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 177.44, "env_step_timer": 0.00014704752524727233, "connector_pipeline_timer": 0.00031256250440492295, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.704075956688831e-05, "tensor_to_numpy": 1.6562115852904508e-05, "module_to_agent_unmapping": 1.612266664543315e-06, "normalize_and_clip_actions": 3.929380083542894e-05, "remove_single_ts_time_rank_from_batch": 6.378340619933191e-07, "un_batch_to_individual_items": 1.3027138544104841e-05, "listify_data_for_vector_env": 5.816953311624799e-06}}, "connector_pipeline_timer": 0.00014468639969650692}, "num_agent_steps_sampled": {"vehicle_5": 1525.9999999999998, "vehicle_3": 1000.0, "vehicle_2": 829.0, "vehicle_4": 1792.0, "vehicle_0": 907.0, "vehicle_1": 829.0}, "env_to_module_sum_episodes_length_in": 79.42427692233395, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5017.0, "vehicle_2": 4695.0, "vehicle_4": 8952.0, "vehicle_1": 4498.0, "vehicle_5": 6699.0, "vehicle_3": 4494.000000000001}, "episode_return_mean": -4765.357666802407, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.02960753004698048, "episode_return_min": -6322.608247756958, "episode_len_max": 274, "num_module_steps_sampled_lifetime": {"shared_policy": 34355.0}, "module_episode_returns_mean": {"shared_policy": -3144.8421566104894}, "episode_len_min": 85, "weights_seq_no": 2.0, "episode_duration_sec_mean": 0.10740355069719953, "num_module_steps_sampled": {"shared_policy": 6883.0}, "num_episodes_lifetime": 43.0, "episode_return_max": -3420.219805955887, "env_to_module_sum_episodes_length_out": 79.42427692233395, "num_episodes": 12.0, "num_env_steps_sampled_lifetime_throughput": 1844.5991243992846}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004797651965461409, "agent_to_module_mapping": 0.0030084633125028633, "general_advantage_estimation": 0.015990135758707037, "add_time_dim_to_batch_and_zero_pad": 1.203160082513932e-05, "add_columns_from_episodes_to_train_batch": 0.0441372798219134, "add_states_from_episodes_to_batch": 3.896488653117557e-06, "numpy_to_tensor": 0.0002357672604484833, "batch_individual_items": 0.11000593077545345, "add_observations_from_episodes_to_batch": 0.00028401106850215}}, "connector_pipeline_timer": 0.17865890630209832}, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained": 1104000, "num_module_steps_trained_lifetime": 211840, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 3310000, "num_module_steps_trained": 70656, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime_throughput": 1116743.1992691818, "num_module_steps_trained_throughput": 71468.3643065118, "num_module_steps_trained_lifetime_throughput": 71469.34782958444}, "shared_policy": {"gradients_default_optimizer_global_norm": 0.5152460336685181, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.701520919799805, "total_loss": 9.56457805633545, "num_module_steps_trained": 70656, "num_trainable_parameters": 149763, "entropy": 1.1332939863204956, "vf_loss_unclipped": 9263.4228515625, "weights_seq_no": 3.0, "curr_kl_coeff": 0.20000000298023224, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.0015436410903930664, "policy_loss": -0.12953954935073853, "mean_kl_loss": 0.019645879045128822, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 211840, "num_module_steps_trained_lifetime_throughput": 71470.78656238956}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "a8246_00000", "date": "2025-06-25_20-43-09", "timestamp": 1750909389, "time_this_iter_s": 1.7640469074249268, "time_total_s": 5.440406799316406, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.440406799316406, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 15.8, "ram_util_percent": 53.5}}
{"timers": {"training_iteration": 2.516799417966742, "restore_env_runners": 1.224735173088993e-05, "training_step": 2.516675627462099, "env_runner_sampling_timer": 1.3362347737979212, "learner_update_timer": 1.1785243774702754, "synch_weights": 0.000893310291842703, "synch_env_connectors": 0.0008527574426319916}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.935819939011708e-05, "add_time_dim_to_batch_and_zero_pad": 1.2616594904102386e-05, "add_observations_from_episodes_to_batch": 4.537480417639017e-05, "add_states_from_episodes_to_batch": 3.500001912470907e-06, "agent_to_module_mapping": 5.74179575778544e-06, "numpy_to_tensor": 4.185859870631245e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.242235198333283e-06, "batch_individual_items": 8.143580635813354e-06, "add_time_dim_to_batch_and_zero_pad": 2.527917580131655e-06, "add_observations_from_episodes_to_batch": 1.3120183708305234e-05, "add_states_from_episodes_to_batch": 1.6334881715452718e-06, "agent_to_module_mapping": 2.4949812362642048e-06}}, "connector_pipeline_timer": 6.30134006564252e-05}, "env_reset_timer": 0.00011910879838978871, "agent_episode_returns_mean": {"vehicle_1": -392.884789390564, "vehicle_5": -917.6994436860084, "vehicle_3": -488.5965475845336, "vehicle_2": -566.8331586241723, "vehicle_4": -1107.8933220791816, "vehicle_0": -503.93646801948546}, "sample": 0.12455505266355327, "rlmodule_inference_timer": 5.747024426622364e-05, "agent_steps": {"vehicle_5": 153.96, "vehicle_3": 81.6, "vehicle_2": 75.14, "vehicle_0": 85.95999999999998, "vehicle_4": 167.84, "vehicle_1": 75.14}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 193.10000000000002, "env_step_timer": 0.00014378525433087077, "connector_pipeline_timer": 0.0003275748051237315, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.512425611207158e-05, "tensor_to_numpy": 1.5808955821692534e-05, "module_to_agent_unmapping": 1.5513509687916384e-06, "normalize_and_clip_actions": 3.7861004705243704e-05, "remove_single_ts_time_rank_from_batch": 6.165939133468261e-07, "un_batch_to_individual_items": 1.2556527067785563e-05, "listify_data_for_vector_env": 5.682159540020998e-06}}, "connector_pipeline_timer": 0.0001391683095767597}, "num_agent_steps_sampled": {"vehicle_5": 1565.9999999999998, "vehicle_3": 895.0, "vehicle_2": 872.9999999999999, "vehicle_4": 1667.0, "vehicle_0": 997.0000000000001, "vehicle_1": 777.9999999999999}, "env_to_module_sum_episodes_length_in": 72.77154721787826, "num_agent_steps_sampled_lifetime": {"vehicle_0": 6014.0, "vehicle_2": 5568.0, "vehicle_4": 10619.0, "vehicle_1": 5276.0, "vehicle_5": 8265.000000000002, "vehicle_3": 5389.000000000001}, "episode_return_mean": -3977.8437412095077, "num_env_steps_sampled_lifetime": 12000.0, "time_between_sampling": 0.33992411826699154, "episode_return_min": -6039.525482773781, "episode_len_max": 285, "num_module_steps_sampled_lifetime": {"shared_policy": 41131.0}, "module_episode_returns_mean": {"shared_policy": -2508.6695405220985}, "episode_len_min": 85, "weights_seq_no": 3.0, "episode_duration_sec_mean": 0.1163009684807912, "num_module_steps_sampled": {"shared_policy": 6776.000000000001}, "num_episodes_lifetime": 52.99999999999999, "episode_return_max": -2899.919890999794, "env_to_module_sum_episodes_length_out": 72.77154721787826, "num_episodes": 10.0, "num_env_steps_sampled_lifetime_throughput": 1807.4575471748885}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004798487525792304, "agent_to_module_mapping": 0.003006382849322159, "general_advantage_estimation": 0.015982588571178936, "add_time_dim_to_batch_and_zero_pad": 1.2007534822187151e-05, "add_columns_from_episodes_to_train_batch": 0.04413836785371208, "add_states_from_episodes_to_batch": 3.882943779703054e-06, "numpy_to_tensor": 0.00023427875780624162, "batch_individual_items": 0.11001278813773158, "add_observations_from_episodes_to_batch": 0.00028455512779405396}}, "connector_pipeline_timer": 0.17865626848911323}, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained": 1086000, "num_module_steps_trained_lifetime": 281344, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 4396000, "num_module_steps_trained": 69504, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime_throughput": 1116264.215696637, "num_module_steps_trained_throughput": 71437.6911142609, "num_module_steps_trained_lifetime_throughput": 71438.7032107798}, "shared_policy": {"gradients_default_optimizer_global_norm": 0.6672579646110535, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.64296817779541, "total_loss": 9.595433235168457, "num_module_steps_trained": 69504, "num_trainable_parameters": 149763, "entropy": 1.0699403285980225, "vf_loss_unclipped": 6817.92822265625, "weights_seq_no": 4.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.0007512569427490234, "policy_loss": -0.0411880761384964, "mean_kl_loss": 0.02176857367157936, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 281344, "num_module_steps_trained_lifetime_throughput": 71439.87116120932}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "a8246_00000", "date": "2025-06-25_20-44-13", "timestamp": 1750909453, "time_this_iter_s": 63.89517307281494, "time_total_s": 69.33557987213135, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678ae0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.33557987213135, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.2010989010989, "ram_util_percent": 52.845054945054954}}
{"timers": {"training_iteration": 2.511140395037108, "restore_env_runners": 0.0008488961282466337, "training_step": 2.5101793970274664, "env_runner_sampling_timer": 1.329674634809956, "learner_update_timer": 1.1785798741155842, "synch_weights": 0.0008978709389358243, "synch_env_connectors": 0.0008523219482303248}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.8624999686144292e-05, "add_time_dim_to_batch_and_zero_pad": 1.0541494702920318e-05, "add_observations_from_episodes_to_batch": 4.297900159144774e-05, "add_states_from_episodes_to_batch": 3.6670026020146906e-06, "agent_to_module_mapping": 5.958496331004426e-06, "numpy_to_tensor": 3.4875498386099914e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.777722629444383e-06, "batch_individual_items": 8.905596683518603e-06, "add_time_dim_to_batch_and_zero_pad": 2.5870717882565133e-06, "add_observations_from_episodes_to_batch": 1.3889033478778562e-05, "add_states_from_episodes_to_batch": 1.6717039400466405e-06, "agent_to_module_mapping": 2.691195403718386e-06}}, "connector_pipeline_timer": 6.619467845170085e-05}, "env_reset_timer": 0.000122875499073416, "agent_episode_returns_mean": {"vehicle_1": -339.20070063972474, "vehicle_5": -477.379800916195, "vehicle_3": -489.8105790114402, "vehicle_2": -613.0468169460296, "vehicle_4": -761.6679314813614, "vehicle_0": -510.10447305870053}, "sample": 0.12895224634466765, "rlmodule_inference_timer": 6.229149186866909e-05, "agent_steps": {"vehicle_5": 124.46800000000002, "vehicle_3": 94.34400000000001, "vehicle_2": 87.476, "vehicle_0": 100.692, "vehicle_4": 139.28800000000004, "vehicle_1": 72.21600000000001}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 170.12399999999997, "env_step_timer": 0.00015060111753430135, "connector_pipeline_timer": 0.0002941665043181274, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0133704838555593e-05, "tensor_to_numpy": 1.7720381946100093e-05, "module_to_agent_unmapping": 1.6588846331405244e-06, "normalize_and_clip_actions": 4.272250268954505e-05, "remove_single_ts_time_rank_from_batch": 6.477108851711709e-07, "un_batch_to_individual_items": 1.3846275543721818e-05, "listify_data_for_vector_env": 6.113538578371767e-06}}, "connector_pipeline_timer": 0.0001542840138808909}, "num_agent_steps_sampled": {"vehicle_5": 1474.0000000000002, "vehicle_3": 1235.0, "vehicle_2": 956.0, "vehicle_4": 1645.0, "vehicle_0": 1230.9999999999998, "vehicle_1": 919.0}, "env_to_module_sum_episodes_length_in": 71.89983365737855, "num_agent_steps_sampled_lifetime": {"vehicle_0": 14970.0, "vehicle_2": 14275.0, "vehicle_4": 24634.000000000007, "vehicle_1": 12317.999999999996, "vehicle_5": 21313.0, "vehicle_3": 14355.0}, "episode_return_mean": -3191.210303636552, "num_env_steps_sampled_lifetime": 29000.0, "time_between_sampling": 0.35047158364416364, "episode_return_min": -4969.39416706562, "episode_len_max": 257, "num_module_steps_sampled_lifetime": {"shared_policy": 101865.0}, "module_episode_returns_mean": {"shared_policy": -2439.770341292381}, "episode_len_min": 106, "weights_seq_no": 4.0, "episode_duration_sec_mean": 0.10264802702388261, "num_module_steps_sampled": {"shared_policy": 7460.0}, "num_episodes_lifetime": 149.00000000000003, "episode_return_max": -1777.894830584526, "env_to_module_sum_episodes_length_out": 71.89983365737855, "num_episodes": 11.0, "num_env_steps_sampled_lifetime_throughput": 1823.6443182299563}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0047985784905570286, "agent_to_module_mapping": 0.003006573600807583, "general_advantage_estimation": 0.01597346101542947, "add_time_dim_to_batch_and_zero_pad": 1.198620949830074e-05, "add_columns_from_episodes_to_train_batch": 0.044185561675175206, "add_states_from_episodes_to_batch": 3.865364358194855e-06, "numpy_to_tensor": 0.00023280222020311263, "batch_individual_items": 0.10927182941635559, "add_observations_from_episodes_to_batch": 0.00028521041647338235}}, "connector_pipeline_timer": 0.17795206997421925}, "learner_connector_sum_episodes_length_in": 2000.0, "num_env_steps_trained": 1192000, "num_module_steps_trained_lifetime": 357632, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 5588000, "num_module_steps_trained": 76288, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 2000.0, "num_env_steps_trained_lifetime_throughput": 1116153.9533800026, "num_module_steps_trained_throughput": 71430.70636713167, "num_module_steps_trained_lifetime_throughput": 71431.69965915859}, "shared_policy": {"gradients_default_optimizer_global_norm": 0.4924820363521576, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.738079071044922, "total_loss": 9.801328659057617, "num_module_steps_trained": 76288, "num_trainable_parameters": 149763, "entropy": 1.0250213146209717, "vf_loss_unclipped": 5888.1181640625, "weights_seq_no": 5.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.009139537811279297, "policy_loss": 0.07003259658813477, "mean_kl_loss": 0.011557938531041145, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 357632, "num_module_steps_trained_lifetime_throughput": 71432.72224560054}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 29000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "a8246_00000", "date": "2025-06-25_20-44-15", "timestamp": 1750909455, "time_this_iter_s": 1.9531528949737549, "time_total_s": 71.2887327671051, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a5e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.2887327671051, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.6, "ram_util_percent": 53.03333333333333}}
{"timers": {"training_iteration": 3.719602416926741, "restore_env_runners": 0.000840449246955712, "training_step": 3.7186494551371774, "env_runner_sampling_timer": 2.5399470442918295, "learner_update_timer": 1.1767782649544194, "synch_weights": 0.0008970676495537853, "synch_env_connectors": 0.0008540795587041946}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.037499845959246e-05, "add_time_dim_to_batch_and_zero_pad": 1.2624994269572198e-05, "add_observations_from_episodes_to_batch": 4.508300480665639e-05, "add_states_from_episodes_to_batch": 3.25000291923061e-06, "agent_to_module_mapping": 5.541995051316917e-06, "numpy_to_tensor": 4.3291998736094683e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.001805240407625e-06, "batch_individual_items": 8.134983926176686e-06, "add_time_dim_to_batch_and_zero_pad": 2.4312365730329827e-06, "add_observations_from_episodes_to_batch": 1.3363393995161389e-05, "add_states_from_episodes_to_batch": 1.5901681221621526e-06, "agent_to_module_mapping": 2.5006940192641685e-06}}, "connector_pipeline_timer": 6.2312780094646e-05}, "env_reset_timer": 0.00012208399857627228, "agent_episode_returns_mean": {"vehicle_1": -194.07287018358707, "vehicle_5": -408.09256690084936, "vehicle_3": -425.3228695219755, "vehicle_2": -451.87656362771986, "vehicle_4": -737.0922621238232, "vehicle_0": -373.5237830621004}, "sample": 0.1245945293588335, "rlmodule_inference_timer": 5.858736906962118e-05, "agent_steps": {"vehicle_5": 137.02, "vehicle_3": 100.78, "vehicle_2": 79.25, "vehicle_0": 88.455, "vehicle_4": 144.615, "vehicle_1": 81.17}, "num_env_steps_sampled": 1600.0, "episode_len_mean": 176.055, "env_step_timer": 0.00014521527237961574, "connector_pipeline_timer": 0.0003375830056029372, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.4464002962382456e-05, "tensor_to_numpy": 1.563451843988946e-05, "module_to_agent_unmapping": 1.5620439498659856e-06, "normalize_and_clip_actions": 3.990268816843692e-05, "remove_single_ts_time_rank_from_batch": 6.064147373172912e-07, "un_batch_to_individual_items": 1.3092000155404311e-05, "listify_data_for_vector_env": 5.9153204891983675e-06}}, "connector_pipeline_timer": 0.00014081312756623497}, "num_agent_steps_sampled": {"vehicle_5": 1315.0, "vehicle_3": 781.0, "vehicle_2": 760.0, "vehicle_4": 1299.0, "vehicle_0": 781.0, "vehicle_1": 803.0}, "env_to_module_sum_episodes_length_in": 60.54365165714418, "num_agent_steps_sampled_lifetime": {"vehicle_0": 15751.0, "vehicle_2": 15035.0, "vehicle_4": 25933.000000000007, "vehicle_1": 13120.999999999996, "vehicle_5": 22628.0, "vehicle_3": 15136.0}, "episode_return_mean": -2589.980921142101, "num_env_steps_sampled_lifetime": 30600.0, "time_between_sampling": 1.1148239700389369, "episode_return_min": -4969.39416706562, "episode_len_max": 283, "num_module_steps_sampled_lifetime": {"shared_policy": 107604.0}, "module_episode_returns_mean": {"shared_policy": -1991.551061118841}, "episode_len_min": 111, "weights_seq_no": 5.0, "episode_duration_sec_mean": 0.10484660562153295, "num_module_steps_sampled": {"shared_policy": 5739.0}, "num_episodes_lifetime": 159.00000000000003, "episode_return_max": -1139.500946879387, "env_to_module_sum_episodes_length_out": 60.54365165714418, "num_episodes": 10.0, "num_env_steps_sampled_lifetime_throughput": 1808.572157664372}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0047992035456733235, "agent_to_module_mapping": 0.0030023178647332065, "general_advantage_estimation": 0.01594558765524964, "add_time_dim_to_batch_and_zero_pad": 1.1977597450074782e-05, "add_columns_from_episodes_to_train_batch": 0.044136240228446734, "add_states_from_episodes_to_batch": 3.851710686696512e-06, "numpy_to_tensor": 0.00023144294802890475, "batch_individual_items": 0.10848151278220225, "add_observations_from_episodes_to_batch": 0.00028529540233882136}}, "connector_pipeline_timer": 0.1770794442744844}, "learner_connector_sum_episodes_length_in": 1996.0, "num_env_steps_trained": 736000, "num_module_steps_trained_lifetime": 416512, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 6324000, "num_module_steps_trained": 58880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.0, "num_env_steps_trained_lifetime_throughput": 1101896.640935343, "num_module_steps_trained_throughput": 71183.48004744542, "num_module_steps_trained_lifetime_throughput": 71184.44747798306}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.0228463411331177, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.312543869018555, "total_loss": 9.295783996582031, "num_module_steps_trained": 58880, "num_trainable_parameters": 149763, "entropy": 0.9688959717750549, "vf_loss_unclipped": 3246.2216796875, "weights_seq_no": 6.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.006993532180786133, "policy_loss": -0.010764827951788902, "mean_kl_loss": 0.012311653234064579, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 416512, "num_module_steps_trained_lifetime_throughput": 71185.28313014787}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30600.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 1}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "a8246_00000", "date": "2025-06-25_20-46-20", "timestamp": 1750909580, "time_this_iter_s": 124.46294093132019, "time_total_s": 195.7516736984253, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6785e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.7516736984253, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.107909604519774, "ram_util_percent": 53.054237288135596}}
{"timers": {"training_iteration": 3.7019530598374684, "restore_env_runners": 0.0013840718344613873, "training_step": 3.7004549251657872, "env_runner_sampling_timer": 2.521388902178886, "learner_update_timer": 1.1771409535548594, "synch_weights": 0.0008955886430978464, "synch_env_connectors": 0.011880855843139804}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.550000110408291e-05, "add_time_dim_to_batch_and_zero_pad": 1.1791500583058223e-05, "add_observations_from_episodes_to_batch": 5.566649997490458e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "agent_to_module_mapping": 9.395498636877164e-06, "numpy_to_tensor": 3.9041999116307124e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0113139058818303e-05, "batch_individual_items": 9.228150563832234e-06, "add_time_dim_to_batch_and_zero_pad": 2.6839592871967106e-06, "add_observations_from_episodes_to_batch": 1.443831804868622e-05, "add_states_from_episodes_to_batch": 1.706699872135489e-06, "agent_to_module_mapping": 2.7473930009976597e-06}}, "connector_pipeline_timer": 6.821398146557623e-05}, "env_reset_timer": 0.00016193799820030108, "agent_episode_returns_mean": {"vehicle_1": -111.59301940600078, "vehicle_5": -114.11370861891544, "vehicle_3": -162.68979481494787, "vehicle_2": -415.12655179789573, "vehicle_4": -542.267481175336, "vehicle_0": -233.7827601396676}, "sample": 0.12895623827130023, "rlmodule_inference_timer": 6.559435047065743e-05, "agent_steps": {"vehicle_5": 115.12121212121212, "vehicle_3": 77.45454545454544, "vehicle_2": 76.03030303030305, "vehicle_0": 71.0909090909091, "vehicle_4": 128.9090909090909, "vehicle_1": 79.66666666666667}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 155.5151515151515, "env_step_timer": 0.0001430644717205727, "connector_pipeline_timer": 0.0003466044981905725, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.5504156769728374e-05, "tensor_to_numpy": 1.998017227763197e-05, "module_to_agent_unmapping": 1.7244037641865625e-06, "normalize_and_clip_actions": 4.4504897152977335e-05, "remove_single_ts_time_rank_from_batch": 6.673034772262617e-07, "un_batch_to_individual_items": 1.4238894940133222e-05, "listify_data_for_vector_env": 6.3341188646578124e-06}}, "connector_pipeline_timer": 0.0001655484757361338}, "num_agent_steps_sampled": {"vehicle_5": 1515.0, "vehicle_3": 1090.0, "vehicle_2": 1075.0, "vehicle_4": 1737.0, "vehicle_0": 1020.0, "vehicle_1": 1115.0}, "env_to_module_sum_episodes_length_in": 71.51082113246046, "num_agent_steps_sampled_lifetime": {"vehicle_0": 2811.9999999999995, "vehicle_2": 3056.0, "vehicle_4": 4998.999999999999, "vehicle_1": 3176.0, "vehicle_5": 4514.0, "vehicle_3": 3021.999999999999}, "episode_return_mean": -1579.5733166752436, "num_env_steps_sampled_lifetime": 6000.0, "time_between_sampling": 0.012385975993081551, "episode_return_min": -3674.627983689308, "episode_len_max": 283, "num_module_steps_sampled_lifetime": {"shared_policy": 21579.000000000004}, "module_episode_returns_mean": {"shared_policy": -786.9571756883101}, "episode_len_min": 111, "weights_seq_no": 6.0, "episode_duration_sec_mean": 0.09365524003078463, "num_module_steps_sampled": {"shared_policy": 7552.0}, "num_episodes_lifetime": 33.0, "episode_return_max": -754.8036931753159, "env_to_module_sum_episodes_length_out": 71.51082113246046, "num_episodes": 12.0, "num_env_steps_sampled_lifetime_throughput": 1850.149272219107}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004802586510255706, "agent_to_module_mapping": 0.003003129266042592, "general_advantage_estimation": 0.015945905938680643, "add_time_dim_to_batch_and_zero_pad": 1.1942821467969785e-05, "add_columns_from_episodes_to_train_batch": 0.044189291986219466, "add_states_from_episodes_to_batch": 3.8415335802559435e-06, "numpy_to_tensor": 0.00023001226851128366, "batch_individual_items": 0.1077604155743525, "add_observations_from_episodes_to_batch": 0.00028581702828918486}}, "connector_pipeline_timer": 0.1764142302517837}, "learner_connector_sum_episodes_length_in": 1996.04, "num_env_steps_trained": 1210000, "num_module_steps_trained_lifetime": 493952, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 7534000, "num_module_steps_trained": 77440, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.04, "num_env_steps_trained_lifetime_throughput": 1100667.067984003, "num_module_steps_trained_throughput": 71071.77549020725, "num_module_steps_trained_lifetime_throughput": 71072.62917069912}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.5455507040023804, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.424776077270508, "total_loss": 9.518260955810547, "num_module_steps_trained": 77440, "num_trainable_parameters": 149763, "entropy": 0.9740979075431824, "vf_loss_unclipped": 3187.267333984375, "weights_seq_no": 7.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.04042011499404907, "policy_loss": 0.09942381829023361, "mean_kl_loss": 0.012675484642386436, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 493952, "num_module_steps_trained_lifetime_throughput": 71073.68786101505}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "a8246_00000", "date": "2025-06-25_20-46-22", "timestamp": 1750909582, "time_this_iter_s": 1.957261085510254, "time_total_s": 197.70893478393555, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 197.70893478393555, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.466666666666667, "ram_util_percent": 53.1}}
{"timers": {"training_iteration": 3.6836361692390676, "restore_env_runners": 0.0013702769461368725, "training_step": 3.682151674254149, "env_runner_sampling_timer": 2.50339294190713, "learner_update_timer": 1.1768312731892796, "synch_weights": 0.0008950898466740091, "synch_env_connectors": 0.011774902694731299}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.550000110408291e-05, "add_time_dim_to_batch_and_zero_pad": 1.1791500583058223e-05, "add_observations_from_episodes_to_batch": 5.566649997490458e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "agent_to_module_mapping": 9.395498636877164e-06, "numpy_to_tensor": 3.9041999116307124e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.582094995531924e-06, "batch_individual_items": 8.342527918108164e-06, "add_time_dim_to_batch_and_zero_pad": 2.602843776669269e-06, "add_observations_from_episodes_to_batch": 1.3691468422554576e-05, "add_states_from_episodes_to_batch": 1.6614513080024082e-06, "agent_to_module_mapping": 2.594289688735187e-06}}, "connector_pipeline_timer": 6.473263053625075e-05}, "env_reset_timer": 0.00016193799820030108, "agent_episode_returns_mean": {"vehicle_1": -86.72976821899412, "vehicle_5": -0.934440612792971, "vehicle_3": -264.0568035054207, "vehicle_2": -398.36758621931074, "vehicle_4": -430.1951593852043, "vehicle_0": -269.2344901204109}, "sample": 0.12890585644225863, "rlmodule_inference_timer": 0.00015548450578070538, "agent_steps": {"vehicle_5": 109.0, "vehicle_3": 100.26, "vehicle_2": 71.48000000000002, "vehicle_0": 91.84, "vehicle_4": 129.16, "vehicle_1": 72.28000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 152.32, "env_step_timer": 0.00013826035277502243, "connector_pipeline_timer": 0.0003466044981905725, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6435147744088616e-05, "tensor_to_numpy": 1.6271676391662065e-05, "module_to_agent_unmapping": 1.5937006005112055e-06, "normalize_and_clip_actions": 3.735759762797418e-05, "remove_single_ts_time_rank_from_batch": 6.339917941533202e-07, "un_batch_to_individual_items": 1.2555888808273658e-05, "listify_data_for_vector_env": 5.64637594229875e-06}}, "connector_pipeline_timer": 0.000140942697442394}, "num_agent_steps_sampled": {"vehicle_5": 1472.0, "vehicle_3": 1259.0000000000002, "vehicle_2": 777.9999999999999, "vehicle_4": 1573.0, "vehicle_0": 1165.9999999999998, "vehicle_1": 777.9999999999999}, "env_to_module_sum_episodes_length_in": 78.65405131952863, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3978.0, "vehicle_2": 3834.0, "vehicle_4": 6571.999999999999, "vehicle_1": 3954.0, "vehicle_5": 5986.0, "vehicle_3": 4280.999999999999}, "episode_return_mean": -1449.51824259758, "num_env_steps_sampled_lifetime": 8000.0, "time_between_sampling": 0.02432214363823456, "episode_return_min": -2957.048098564148, "episode_len_max": 295, "num_module_steps_sampled_lifetime": {"shared_policy": 28605.0}, "module_episode_returns_mean": {"shared_policy": -573.5067665576935}, "episode_len_min": 109, "weights_seq_no": 7.0, "episode_duration_sec_mean": 0.09097659913910322, "num_module_steps_sampled": {"shared_policy": 7026.000000000001}, "num_episodes_lifetime": 46.0, "episode_return_max": -513.9498834609985, "env_to_module_sum_episodes_length_out": 78.65405131952863, "num_episodes": 13.0, "num_env_steps_sampled_lifetime_throughput": 1859.2150546819958}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0048071564751372056, "agent_to_module_mapping": 0.0030034088033525693, "general_advantage_estimation": 0.015942439379297613, "add_time_dim_to_batch_and_zero_pad": 1.1953813265573226e-05, "add_columns_from_episodes_to_train_batch": 0.04421121989633025, "add_states_from_episodes_to_batch": 3.826868207018873e-06, "numpy_to_tensor": 0.000228575065813583, "batch_individual_items": 0.1070363122486331, "add_observations_from_episodes_to_batch": 0.00028701802802983116}}, "connector_pipeline_timer": 0.1757125083692507}, "learner_connector_sum_episodes_length_in": 1996.0796, "num_env_steps_trained": 1130000, "num_module_steps_trained_lifetime": 566272, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 8664000, "num_module_steps_trained": 72320, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.0796, "num_env_steps_trained_lifetime_throughput": 1099895.37827554, "num_module_steps_trained_throughput": 70990.92108088938, "num_module_steps_trained_lifetime_throughput": 70991.74846425687}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.3763959407806396, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.696925163269043, "total_loss": 9.559694290161133, "num_module_steps_trained": 72320, "num_trainable_parameters": 149763, "entropy": 0.8444628715515137, "vf_loss_unclipped": 1743.61083984375, "weights_seq_no": 8.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.055906057357788086, "policy_loss": -0.13226929306983948, "mean_kl_loss": 0.011610045097768307, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 566272, "num_module_steps_trained_lifetime_throughput": 70992.75357826707}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "a8246_00000", "date": "2025-06-25_20-46-24", "timestamp": 1750909584, "time_this_iter_s": 1.872586965560913, "time_total_s": 199.58152174949646, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b105080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.58152174949646, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.65, "ram_util_percent": 53.1}}
{"timers": {"training_iteration": 3.6659100062967354, "restore_env_runners": 0.0013566133366797388, "training_step": 3.6644388821016496, "env_runner_sampling_timer": 2.485013780408031, "learner_update_timer": 1.1774930979573646, "synch_weights": 0.0008969143682216662, "synch_env_connectors": 0.011669362417760693}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.550000110408291e-05, "add_time_dim_to_batch_and_zero_pad": 1.1791500583058223e-05, "add_observations_from_episodes_to_batch": 5.566649997490458e-05, "add_states_from_episodes_to_batch": 5.749996489612386e-06, "agent_to_module_mapping": 9.395498636877164e-06, "numpy_to_tensor": 3.9041999116307124e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.344429917093886e-06, "batch_individual_items": 8.311717218084979e-06, "add_time_dim_to_batch_and_zero_pad": 2.5584106733144085e-06, "add_observations_from_episodes_to_batch": 1.353507189208333e-05, "add_states_from_episodes_to_batch": 1.6431114628670535e-06, "agent_to_module_mapping": 2.5701140240946837e-06}}, "connector_pipeline_timer": 6.366766441757952e-05}, "env_reset_timer": 0.00016193799820030108, "agent_episode_returns_mean": {"vehicle_1": -11.705801279544831, "vehicle_5": 59.402141749858856, "vehicle_3": -187.4733357262611, "vehicle_2": -301.37279192209246, "vehicle_4": -314.44573641300195, "vehicle_0": -235.6363611674309}, "sample": 0.1288363800844429, "rlmodule_inference_timer": 6.0007200177890306e-05, "agent_steps": {"vehicle_5": 121.32, "vehicle_3": 99.02, "vehicle_2": 67.44, "vehicle_0": 93.86, "vehicle_4": 129.3, "vehicle_1": 75.66}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 167.08000000000004, "env_step_timer": 0.0001388445727707564, "connector_pipeline_timer": 0.0003466044981905725, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.605451202755522e-05, "tensor_to_numpy": 1.620528709818048e-05, "module_to_agent_unmapping": 1.5937793922766288e-06, "normalize_and_clip_actions": 3.984384496908986e-05, "remove_single_ts_time_rank_from_batch": 6.294380682612066e-07, "un_batch_to_individual_items": 1.3268935412326225e-05, "listify_data_for_vector_env": 5.943259847748884e-06}}, "connector_pipeline_timer": 0.00014399044407961592}, "num_agent_steps_sampled": {"vehicle_5": 1488.0, "vehicle_3": 1110.0, "vehicle_2": 931.0, "vehicle_4": 1533.0, "vehicle_0": 1103.0, "vehicle_1": 1068.0}, "env_to_module_sum_episodes_length_in": 68.06832952371765, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5081.0, "vehicle_2": 4765.0, "vehicle_4": 8105.0, "vehicle_1": 5022.0, "vehicle_5": 7474.0, "vehicle_3": 5391.0}, "episode_return_mean": -991.2318819260597, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.035135972447060446, "episode_return_min": -2261.728507876396, "episode_len_max": 295, "num_module_steps_sampled_lifetime": {"shared_policy": 35838.0}, "module_episode_returns_mean": {"shared_policy": -455.2239204525947}, "episode_len_min": 108, "weights_seq_no": 8.0, "episode_duration_sec_mean": 0.10273989751862246, "num_module_steps_sampled": {"shared_policy": 7233.0}, "num_episodes_lifetime": 60.0, "episode_return_max": -21.25793218612671, "env_to_module_sum_episodes_length_out": 68.06832952371765, "num_episodes": 14.0, "num_env_steps_sampled_lifetime_throughput": 1855.8596761001759}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004812596580361539, "agent_to_module_mapping": 0.003005050965319644, "general_advantage_estimation": 0.015948697075514433, "add_time_dim_to_batch_and_zero_pad": 1.1934275094011492e-05, "add_columns_from_episodes_to_train_batch": 0.044247368537394305, "add_states_from_episodes_to_batch": 3.8106895505440736e-06, "numpy_to_tensor": 0.00022725514519596072, "batch_individual_items": 0.10711416537615008, "add_observations_from_episodes_to_batch": 0.0002878299277364348}}, "connector_pipeline_timer": 0.17583854494556553}, "learner_connector_sum_episodes_length_in": 1996.118804, "num_env_steps_trained": 1162000, "num_module_steps_trained_lifetime": 640640, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 9826000, "num_module_steps_trained": 74368, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.118804, "num_env_steps_trained_lifetime_throughput": 1099608.4976603126, "num_module_steps_trained_throughput": 70942.77767665245, "num_module_steps_trained_lifetime_throughput": 70943.61725751337}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.103866696357727, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.594100952148438, "total_loss": 8.512906074523926, "num_module_steps_trained": 74368, "num_trainable_parameters": 149763, "entropy": 0.7928416132926941, "vf_loss_unclipped": 1145.598876953125, "weights_seq_no": 9.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07221627235412598, "policy_loss": -0.07693037390708923, "mean_kl_loss": 0.012209821492433548, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 640640, "num_module_steps_trained_lifetime_throughput": 70944.5192391612}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "a8246_00000", "date": "2025-06-25_20-46-25", "timestamp": 1750909585, "time_this_iter_s": 1.9132318496704102, "time_total_s": 201.49475359916687, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a67a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.49475359916687, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.766666666666666, "ram_util_percent": 53.1}}
{"timers": {"training_iteration": 4.270761964563765, "restore_env_runners": 0.001343089703345519, "training_step": 4.269304153280643, "env_runner_sampling_timer": 3.0901958517739723, "learner_update_timer": 1.1771755294777957, "synch_weights": 0.0008954356345287087, "synch_env_connectors": 0.011563492963604892}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.526640211930499e-05, "add_time_dim_to_batch_and_zero_pad": 1.1924700083909557e-05, "add_observations_from_episodes_to_batch": 5.549970301217399e-05, "add_states_from_episodes_to_batch": 5.7163961173500866e-06, "agent_to_module_mapping": 9.445496107218788e-06, "numpy_to_tensor": 4.0308397001354027e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.302165285186376e-06, "batch_individual_items": 8.11219583483152e-06, "add_time_dim_to_batch_and_zero_pad": 2.4728765410887055e-06, "add_observations_from_episodes_to_batch": 1.3359326575458925e-05, "add_states_from_episodes_to_batch": 1.6314579340380217e-06, "agent_to_module_mapping": 2.482206858768784e-06}}, "connector_pipeline_timer": 6.28852347557401e-05}, "env_reset_timer": 0.00016415479622082784, "agent_episode_returns_mean": {"vehicle_1": 74.98782720565796, "vehicle_5": 251.67060079813007, "vehicle_3": -79.10781293392182, "vehicle_2": -245.8030331349373, "vehicle_4": -136.66984973192214, "vehicle_0": -109.07567909002304}, "sample": 0.12352813956659751, "rlmodule_inference_timer": 5.779717486560496e-05, "agent_steps": {"vehicle_5": 106.68000000000002, "vehicle_3": 78.72, "vehicle_2": 62.36, "vehicle_0": 75.78, "vehicle_4": 129.50000000000003, "vehicle_1": 62.96}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 143.12, "env_step_timer": 0.00013881126791221598, "connector_pipeline_timer": 0.0003474208984698635, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.621447406010038e-05, "tensor_to_numpy": 1.5847514615952458e-05, "module_to_agent_unmapping": 1.5846760376894501e-06, "normalize_and_clip_actions": 3.829816226054312e-05, "remove_single_ts_time_rank_from_batch": 6.191506067625422e-07, "un_batch_to_individual_items": 1.2877965447083314e-05, "listify_data_for_vector_env": 5.67895670020627e-06}}, "connector_pipeline_timer": 0.00014120330406083636}, "num_agent_steps_sampled": {"vehicle_5": 1457.0, "vehicle_3": 1096.0, "vehicle_2": 822.9999999999999, "vehicle_4": 1875.9999999999998, "vehicle_0": 1035.0, "vehicle_1": 822.9999999999999}, "env_to_module_sum_episodes_length_in": 72.04660882955392, "num_agent_steps_sampled_lifetime": {"vehicle_0": 6116.000000000001, "vehicle_2": 5588.0, "vehicle_4": 9981.0, "vehicle_1": 5845.0, "vehicle_5": 8931.0, "vehicle_3": 6487.000000000002}, "episode_return_mean": -243.99794831752777, "num_env_steps_sampled_lifetime": 12000.0, "time_between_sampling": 0.4692514898931857, "episode_return_min": -1094.4001597166061, "episode_len_max": 216, "num_module_steps_sampled_lifetime": {"shared_policy": 42948.0}, "module_episode_returns_mean": {"shared_policy": 45.76476234912872}, "episode_len_min": 108, "weights_seq_no": 9.0, "episode_duration_sec_mean": 0.08319652843943916, "num_module_steps_sampled": {"shared_policy": 7110.0}, "num_episodes_lifetime": 72.0, "episode_return_max": 173.2762393951416, "env_to_module_sum_episodes_length_out": 72.04660882955392, "num_episodes": 12.0, "num_env_steps_sampled_lifetime_throughput": 1863.3733046170055}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004818134364562412, "agent_to_module_mapping": 0.003004058795672024, "general_advantage_estimation": 0.0159396217747973, "add_time_dim_to_batch_and_zero_pad": 1.1892012310084939e-05, "add_columns_from_episodes_to_train_batch": 0.044258710262021335, "add_states_from_episodes_to_batch": 3.7946626398125146e-06, "numpy_to_tensor": 0.0002258092637464262, "batch_individual_items": 0.10639274705238899, "add_observations_from_episodes_to_batch": 0.00028840412840914223}}, "connector_pipeline_timer": 0.17512207616611108}, "learner_connector_sum_episodes_length_in": 1996.15761596, "num_env_steps_trained": 1140000, "num_module_steps_trained_lifetime": 713600, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 10966000, "num_module_steps_trained": 72960, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.15761596, "num_env_steps_trained_lifetime_throughput": 1098965.2772180815, "num_module_steps_trained_throughput": 70873.47604014467, "num_module_steps_trained_lifetime_throughput": 70874.18979320803}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.5174957513809204, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.016827583312988, "total_loss": 8.908304214477539, "num_module_steps_trained": 72960, "num_trainable_parameters": 149763, "entropy": 0.8029965162277222, "vf_loss_unclipped": 1292.4364013671875, "weights_seq_no": 10.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.04856199026107788, "policy_loss": -0.10401074588298798, "mean_kl_loss": 0.011725316755473614, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 713600, "num_module_steps_trained_lifetime_throughput": 70875.21693534669}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 3}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "a8246_00000", "date": "2025-06-25_20-47-30", "timestamp": 1750909650, "time_this_iter_s": 64.1536660194397, "time_total_s": 265.64841961860657, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a5da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 265.64841961860657, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 9.043956043956044, "ram_util_percent": 53.097802197802224}}
{"timers": {"training_iteration": 4.86758606283809, "restore_env_runners": 0.0013681175563714264, "training_step": 4.8661023859178325, "env_runner_sampling_timer": 3.685724589086291, "learner_update_timer": 1.1784428162730398, "synch_weights": 0.0008948437781949933, "synch_env_connectors": 0.011456794703951929}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3641598818358035e-05, "add_time_dim_to_batch_and_zero_pad": 7.99160188762471e-06, "add_observations_from_episodes_to_batch": 3.6091599031351504e-05, "add_states_from_episodes_to_batch": 3.7415957194752983e-06, "agent_to_module_mapping": 6.091601972002536e-06, "numpy_to_tensor": 2.5491400447208434e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.28349599362039e-06, "batch_individual_items": 8.503991858043363e-06, "add_time_dim_to_batch_and_zero_pad": 2.5199811411913817e-06, "add_observations_from_episodes_to_batch": 1.3885424808027561e-05, "add_states_from_episodes_to_batch": 1.6222511831779607e-06, "agent_to_module_mapping": 2.5754007370685427e-06}}, "connector_pipeline_timer": 6.418604641610952e-05}, "env_reset_timer": 0.00011420819791965186, "agent_episode_returns_mean": {"vehicle_1": 145.2765457875388, "vehicle_5": 321.1424153276852, "vehicle_3": -55.51410341399056, "vehicle_2": -208.28906782524925, "vehicle_4": 76.59101442847934, "vehicle_0": -23.628441013268066}, "sample": 0.12702068986741671, "rlmodule_inference_timer": 6.002380667556053e-05, "agent_steps": {"vehicle_5": 105.77714285714286, "vehicle_3": 56.725714285714275, "vehicle_2": 61.14, "vehicle_0": 56.725714285714275, "vehicle_4": 116.28571428571428, "vehicle_1": 61.14}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 117.52285714285713, "env_step_timer": 0.00014083101017447805, "connector_pipeline_timer": 0.00022769219940528275, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7986888415958406e-05, "tensor_to_numpy": 1.6655008621170105e-05, "module_to_agent_unmapping": 1.6178586461408628e-06, "normalize_and_clip_actions": 4.2723218858653345e-05, "remove_single_ts_time_rank_from_batch": 6.122802507969962e-07, "un_batch_to_individual_items": 1.4082702153768857e-05, "listify_data_for_vector_env": 6.274137337972307e-06}}, "connector_pipeline_timer": 0.00015035019010897272}, "num_agent_steps_sampled": {"vehicle_5": 1825.0, "vehicle_3": 989.0, "vehicle_2": 1082.0, "vehicle_4": 1929.0000000000002, "vehicle_0": 989.0, "vehicle_1": 1082.0}, "env_to_module_sum_episodes_length_in": 50.83053661625151, "num_agent_steps_sampled_lifetime": {"vehicle_0": 9058.0, "vehicle_2": 7983.0, "vehicle_4": 15817.999999999996, "vehicle_1": 8197.0, "vehicle_5": 13611.0, "vehicle_3": 9457.999999999998}, "episode_return_mean": 255.57836399487084, "num_env_steps_sampled_lifetime": 17400.0, "time_between_sampling": 0.4806012028210607, "episode_return_min": 6.981463193893433, "episode_len_max": 202, "num_module_steps_sampled_lifetime": {"shared_policy": 64125.0}, "module_episode_returns_mean": {"shared_policy": 257.35468499319893}, "episode_len_min": 108, "weights_seq_no": 10.0, "episode_duration_sec_mean": 0.06899846583103811, "num_module_steps_sampled": {"shared_policy": 7896.000000000001}, "num_episodes_lifetime": 122.0, "episode_return_max": 566.7679040431976, "env_to_module_sum_episodes_length_out": 50.83053661625151, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1834.7781629073415}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00483299052092049, "agent_to_module_mapping": 0.0030067998777308417, "general_advantage_estimation": 0.01595092555706628, "add_time_dim_to_batch_and_zero_pad": 1.1871842211319549e-05, "add_columns_from_episodes_to_train_batch": 0.04433103524940345, "add_states_from_episodes_to_batch": 3.7812960172245048e-06, "numpy_to_tensor": 0.00022441325108706755, "batch_individual_items": 0.10572380499181337, "add_observations_from_episodes_to_batch": 0.00029022092712476476}}, "connector_pipeline_timer": 0.17455411998448137}, "learner_connector_sum_episodes_length_in": 1996.1960398003998, "num_env_steps_trained": 1274000, "num_module_steps_trained_lifetime": 795136, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 12240000, "num_module_steps_trained": 81536, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.1960398003998, "num_env_steps_trained_lifetime_throughput": 1097340.1970701278, "num_module_steps_trained_throughput": 70742.69905014713, "num_module_steps_trained_lifetime_throughput": 70743.41738123495}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.3705061674118042, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.471858024597168, "total_loss": 9.454692840576172, "num_module_steps_trained": 81536, "num_trainable_parameters": 149763, "entropy": 0.7750537991523743, "vf_loss_unclipped": 1491.1614990234375, "weights_seq_no": 11.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07076197862625122, "policy_loss": -0.013117452152073383, "mean_kl_loss": 0.012336218729615211, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 795136, "num_module_steps_trained_lifetime_throughput": 70744.30128778702}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17400.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 4}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-34", "timestamp": 1750909714, "time_this_iter_s": 63.95564413070679, "time_total_s": 329.60406374931335, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b130220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 329.60406374931335, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 9.684615384615386, "ram_util_percent": 53.27032967032965}}
{"timers": {"training_iteration": 4.83916643512971, "restore_env_runners": 0.0018900005408258235, "training_step": 4.8371604578987, "env_runner_sampling_timer": 3.6560767981954023, "learner_update_timer": 1.1791450572802666, "synch_weights": 0.0008952074204141527, "synch_env_connectors": 0.011351172176889364}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.042140240532796e-05, "batch_individual_items": 8.859981374380544e-06, "add_time_dim_to_batch_and_zero_pad": 2.5932542521050887e-06, "add_observations_from_episodes_to_batch": 1.4319009362198458e-05, "add_states_from_episodes_to_batch": 1.650509937476168e-06, "agent_to_module_mapping": 2.6595594512099035e-06}}, "connector_pipeline_timer": 7.690179382852275e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 163.1884912586212, "vehicle_5": 348.1916295170784, "vehicle_3": -53.3897519659996, "vehicle_2": -138.14663208484646, "vehicle_4": 60.78754555463791, "vehicle_0": 26.044679098129272}, "sample": 0.1312206673673634, "rlmodule_inference_timer": 6.0904102171235324e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 59.42, "vehicle_2": 71.58, "vehicle_0": 61.88, "vehicle_4": 113.9, "vehicle_1": 71.66}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 124.16, "env_step_timer": 0.00014225031426354378, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9396741748901396e-05, "tensor_to_numpy": 1.7557914920185974e-05, "module_to_agent_unmapping": 1.6498104242234504e-06, "normalize_and_clip_actions": 4.424820033684945e-05, "remove_single_ts_time_rank_from_batch": 6.329136490623238e-07, "un_batch_to_individual_items": 1.4343908846387371e-05, "listify_data_for_vector_env": 6.38391569685104e-06}}, "connector_pipeline_timer": 0.0001551791357910632}, "num_agent_steps_sampled": {"vehicle_5": 1668.0, "vehicle_3": 1007.0000000000001, "vehicle_2": 1108.0, "vehicle_4": 1757.0, "vehicle_0": 1130.0, "vehicle_1": 1109.0}, "env_to_module_sum_episodes_length_in": 54.3296710543856, "num_agent_steps_sampled_lifetime": {"vehicle_0": 7028.999999999998, "vehicle_2": 7818.999999999998, "vehicle_4": 13257.999999999996, "vehicle_1": 7823.0, "vehicle_5": 12624.0, "vehicle_3": 6906.000000000002}, "episode_return_mean": 406.67596224546423, "num_env_steps_sampled_lifetime": 14000.0, "time_between_sampling": 0.333246593143511, "episode_return_min": 51.09420645236969, "episode_len_max": 246, "num_module_steps_sampled_lifetime": {"shared_policy": 55459.0}, "module_episode_returns_mean": {"shared_policy": 337.0909381175041}, "episode_len_min": 107, "weights_seq_no": 11.0, "episode_duration_sec_mean": 0.07754478250062674, "num_module_steps_sampled": {"shared_policy": 7778.999999999999}, "num_episodes_lifetime": 113.0, "episode_return_max": 835.2797875404358, "env_to_module_sum_episodes_length_out": 54.3296710543856, "num_episodes": 15.0, "num_env_steps_sampled_lifetime_throughput": 1782.0578168209324}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004843925205656372, "agent_to_module_mapping": 0.0030103106289615517, "general_advantage_estimation": 0.015957155881465866, "add_time_dim_to_batch_and_zero_pad": 1.1839373791120221e-05, "add_columns_from_episodes_to_train_batch": 0.04439574156690119, "add_states_from_episodes_to_batch": 3.766823092165766e-06, "numpy_to_tensor": 0.0002230561985263861, "batch_individual_items": 0.10505159235189139, "add_observations_from_episodes_to_batch": 0.0002917670478542585}}, "connector_pipeline_timer": 0.17396670253462876}, "learner_connector_sum_episodes_length_in": 1996.2340794023958, "num_env_steps_trained": 1252000, "num_module_steps_trained_lifetime": 875264, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 13492000, "num_module_steps_trained": 80128, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.2340794023958, "num_env_steps_trained_lifetime_throughput": 1097735.7546061617, "num_module_steps_trained_throughput": 70742.35055523537, "num_module_steps_trained_lifetime_throughput": 70743.042461375}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.865255117416382, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.390822410583496, "total_loss": 9.436556816101074, "num_module_steps_trained": 80128, "num_trainable_parameters": 149763, "entropy": 0.7717193365097046, "vf_loss_unclipped": 1275.224365234375, "weights_seq_no": 12.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.11786603927612305, "policy_loss": 0.048856787383556366, "mean_kl_loss": 0.015316874720156193, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 875264, "num_module_steps_trained_lifetime_throughput": 70743.88889072958}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-36", "timestamp": 1750909716, "time_this_iter_s": 2.0276782512664795, "time_total_s": 331.63174200057983, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b131300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 331.63174200057983, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 52.9}}
{"timers": {"training_iteration": 4.812963404528387, "restore_env_runners": 0.0018711426253771718, "training_step": 4.810975952489755, "env_runner_sampling_timer": 3.6268852106234717, "learner_update_timer": 1.182148214207471, "synch_weights": 0.0008938915961485252, "synch_env_connectors": 0.011246614625091291}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.508429356815334e-06, "batch_individual_items": 8.860836249109386e-06, "add_time_dim_to_batch_and_zero_pad": 2.5376844135267088e-06, "add_observations_from_episodes_to_batch": 1.4483209684608883e-05, "add_states_from_episodes_to_batch": 1.6418545982051842e-06, "agent_to_module_mapping": 2.7055527980947013e-06}}, "connector_pipeline_timer": 6.595163644053923e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 225.30116491079332, "vehicle_5": 366.54394666671755, "vehicle_3": -41.82181149244308, "vehicle_2": -69.802529848814, "vehicle_4": 236.49384519100187, "vehicle_0": 45.56196396827698}, "sample": 0.13114767046052184, "rlmodule_inference_timer": 7.575349386010467e-05, "agent_steps": {"vehicle_5": 105.28, "vehicle_3": 62.92, "vehicle_2": 76.3, "vehicle_0": 67.84, "vehicle_4": 108.08, "vehicle_1": 77.04}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 119.14, "env_step_timer": 0.0001477104813991565, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.584390135012005e-05, "tensor_to_numpy": 1.6287542822572036e-05, "module_to_agent_unmapping": 1.6289210422227196e-06, "normalize_and_clip_actions": 4.434848926043705e-05, "remove_single_ts_time_rank_from_batch": 6.27693698175977e-07, "un_batch_to_individual_items": 1.4658369052692729e-05, "listify_data_for_vector_env": 6.567536989777456e-06}}, "connector_pipeline_timer": 0.00015033442568755532}, "num_agent_steps_sampled": {"vehicle_5": 1850.9999999999998, "vehicle_3": 1050.0, "vehicle_2": 1374.0000000000002, "vehicle_4": 1855.9999999999998, "vehicle_0": 1050.0, "vehicle_1": 1390.0}, "env_to_module_sum_episodes_length_in": 53.8709362847669, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8078.999999999998, "vehicle_2": 9192.999999999998, "vehicle_4": 15113.999999999998, "vehicle_1": 9213.0, "vehicle_5": 14475.0, "vehicle_3": 7956.000000000002}, "episode_return_mean": 762.2765794622898, "num_env_steps_sampled_lifetime": 16000.0, "time_between_sampling": 0.2986978606258509, "episode_return_min": 103.1479526758194, "episode_len_max": 246, "num_module_steps_sampled_lifetime": {"shared_policy": 64030.0}, "module_episode_returns_mean": {"shared_policy": 402.1507544207574}, "episode_len_min": 107, "weights_seq_no": 12.0, "episode_duration_sec_mean": 0.07489572593985942, "num_module_steps_sampled": {"shared_policy": 8571.0}, "num_episodes_lifetime": 130.0, "episode_return_max": 1429.5729118585587, "env_to_module_sum_episodes_length_out": 53.8709362847669, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1756.1373453600002}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004859329283589858, "agent_to_module_mapping": 0.0030166587727247143, "general_advantage_estimation": 0.015967088912663574, "add_time_dim_to_batch_and_zero_pad": 1.1814309998438944e-05, "add_columns_from_episodes_to_train_batch": 0.044504650821273285, "add_states_from_episodes_to_batch": 3.7562449249119644e-06, "numpy_to_tensor": 0.00022173605652642497, "batch_individual_items": 0.10521404058837652, "add_observations_from_episodes_to_batch": 0.0002935852073828369}}, "connector_pipeline_timer": 0.1742695513492855}, "learner_connector_sum_episodes_length_in": 1996.2717386083718, "num_env_steps_trained": 1380000, "num_module_steps_trained_lifetime": 963584, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 14872000, "num_module_steps_trained": 88320, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.2717386083718, "num_env_steps_trained_lifetime_throughput": 1095887.1991760365, "num_module_steps_trained_throughput": 70599.51520918997, "num_module_steps_trained_lifetime_throughput": 70600.18262369068}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.5398517847061157, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.653313636779785, "total_loss": 9.631155014038086, "num_module_steps_trained": 88320, "num_trainable_parameters": 149763, "entropy": 0.5946434140205383, "vf_loss_unclipped": 1667.1781005859375, "weights_seq_no": 13.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07678836584091187, "policy_loss": -0.02187465876340866, "mean_kl_loss": 0.018875494599342346, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 963584, "num_module_steps_trained_lifetime_throughput": 70600.95185293458}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-38", "timestamp": 1750909718, "time_this_iter_s": 2.2212040424346924, "time_total_s": 333.8529460430145, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b133e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 333.8529460430145, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.966666666666667, "ram_util_percent": 52.9}}
{"timers": {"training_iteration": 4.785414897983075, "restore_env_runners": 0.0018524845291278483, "training_step": 4.783445697544876, "env_runner_sampling_timer": 3.5974287335172455, "learner_update_timer": 1.184071338735403, "synch_weights": 0.0008929718402006858, "synch_env_connectors": 0.011145795568836055}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.500521785326286e-06, "batch_individual_items": 8.875035065913615e-06, "add_time_dim_to_batch_and_zero_pad": 2.5737856744637117e-06, "add_observations_from_episodes_to_batch": 1.4699209617004472e-05, "add_states_from_episodes_to_batch": 1.6519463414561678e-06, "agent_to_module_mapping": 2.759280367930763e-06}}, "connector_pipeline_timer": 6.637448413704366e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 232.08942082881927, "vehicle_5": 380.9366188979149, "vehicle_3": -62.53969060897828, "vehicle_2": -62.32596511483193, "vehicle_4": 271.84237105965616, "vehicle_0": 122.67535809278486}, "sample": 0.131215014816935, "rlmodule_inference_timer": 6.143932784341339e-05, "agent_steps": {"vehicle_5": 107.07999999999998, "vehicle_3": 56.58, "vehicle_2": 75.52, "vehicle_0": 56.78, "vehicle_4": 100.30000000000001, "vehicle_1": 75.88000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.48, "env_step_timer": 0.0001463217229011452, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.631366436565539e-05, "tensor_to_numpy": 1.6405491171044137e-05, "module_to_agent_unmapping": 1.6445631479436397e-06, "normalize_and_clip_actions": 4.469435380989907e-05, "remove_single_ts_time_rank_from_batch": 6.275063969097489e-07, "un_batch_to_individual_items": 1.4759825687344677e-05, "listify_data_for_vector_env": 6.549508136998698e-06}}, "connector_pipeline_timer": 0.00015139631819537303}, "num_agent_steps_sampled": {"vehicle_5": 1932.0, "vehicle_3": 964.0, "vehicle_2": 1347.0, "vehicle_4": 1875.9999999999998, "vehicle_0": 969.0, "vehicle_1": 1348.0}, "env_to_module_sum_episodes_length_in": 50.070392509661815, "num_agent_steps_sampled_lifetime": {"vehicle_0": 9047.999999999998, "vehicle_2": 10540.0, "vehicle_4": 16989.999999999996, "vehicle_1": 10561.0, "vehicle_5": 16407.0, "vehicle_3": 8920.000000000002}, "episode_return_mean": 882.6781128787993, "num_env_steps_sampled_lifetime": 18000.0, "time_between_sampling": 0.2992609988352307, "episode_return_min": 478.900172829628, "episode_len_max": 133, "num_module_steps_sampled_lifetime": {"shared_policy": 72466.0}, "module_episode_returns_mean": {"shared_policy": 474.3563027739525}, "episode_len_min": 107, "weights_seq_no": 13.0, "episode_duration_sec_mean": 0.06845486573933159, "num_module_steps_sampled": {"shared_policy": 8436.0}, "num_episodes_lifetime": 148.0, "episode_return_max": 1429.5729118585587, "env_to_module_sum_episodes_length_out": 50.070392509661815, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1746.8538253632832}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004875695570803577, "agent_to_module_mapping": 0.0030223176049793145, "general_advantage_estimation": 0.01595801260350961, "add_time_dim_to_batch_and_zero_pad": 1.1785336887678146e-05, "add_columns_from_episodes_to_train_batch": 0.04461836973305224, "add_states_from_episodes_to_batch": 3.7386824824335602e-06, "numpy_to_tensor": 0.00022040411597437984, "batch_individual_items": 0.10457902810250184, "add_observations_from_episodes_to_batch": 0.0002953901953222639}}, "connector_pipeline_timer": 0.1737609583358132}, "learner_connector_sum_episodes_length_in": 1996.309021222288, "num_env_steps_trained": 1360000, "num_module_steps_trained_lifetime": 1050624, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 16232000, "num_module_steps_trained": 87040, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.309021222288, "num_env_steps_trained_lifetime_throughput": 1096163.996657605, "num_module_steps_trained_throughput": 70594.14635797997, "num_module_steps_trained_lifetime_throughput": 70594.78136353382}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.5833911895751953, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.420049667358398, "total_loss": 9.507197380065918, "num_module_steps_trained": 87040, "num_trainable_parameters": 149763, "entropy": 0.7127036452293396, "vf_loss_unclipped": 1740.0443115234375, "weights_seq_no": 14.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07279354333877563, "policy_loss": 0.08832567930221558, "mean_kl_loss": 0.019833702594041824, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1050624, "num_module_steps_trained_lifetime_throughput": 70595.4898230424}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-40", "timestamp": 1750909720, "time_this_iter_s": 2.060425043106079, "time_total_s": 335.9133710861206, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x100ea5da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 335.9133710861206, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.433333333333332, "ram_util_percent": 52.93333333333334}}
{"timers": {"training_iteration": 4.758954196503257, "restore_env_runners": 0.0018340042638471507, "training_step": 4.7570032784894405, "env_runner_sampling_timer": 3.5685304899320576, "learner_update_timer": 1.1865217999380837, "synch_weights": 0.0008937779518250085, "synch_env_connectors": 0.011046068443158186}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.608026800295602e-06, "batch_individual_items": 9.161902096895517e-06, "add_time_dim_to_batch_and_zero_pad": 2.5727696422751273e-06, "add_observations_from_episodes_to_batch": 1.4871489181162353e-05, "add_states_from_episodes_to_batch": 1.692961161760352e-06, "agent_to_module_mapping": 2.7701503131632514e-06}}, "connector_pipeline_timer": 6.713715461924149e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 251.85072447657586, "vehicle_5": 418.3286905241012, "vehicle_3": -60.86681813478471, "vehicle_2": -48.877423982620236, "vehicle_4": 431.3034387004374, "vehicle_0": 189.2336253297329}, "sample": 0.13120066784077147, "rlmodule_inference_timer": 6.280515498159276e-05, "agent_steps": {"vehicle_5": 107.4, "vehicle_3": 53.26, "vehicle_2": 76.55999999999999, "vehicle_0": 53.26, "vehicle_4": 107.74, "vehicle_1": 77.30000000000001}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.72, "env_step_timer": 0.0001493426088296244, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.632653175271196e-05, "tensor_to_numpy": 1.650453879439054e-05, "module_to_agent_unmapping": 1.667119795527692e-06, "normalize_and_clip_actions": 4.7218136164833756e-05, "remove_single_ts_time_rank_from_batch": 6.35686452332408e-07, "un_batch_to_individual_items": 1.548031655284226e-05, "listify_data_for_vector_env": 6.772187943342223e-06}}, "connector_pipeline_timer": 0.00015551552923072598}, "num_agent_steps_sampled": {"vehicle_5": 1955.9999999999998, "vehicle_3": 964.0, "vehicle_2": 1405.0, "vehicle_4": 1980.9999999999998, "vehicle_0": 964.0, "vehicle_1": 1419.0000000000002}, "env_to_module_sum_episodes_length_in": 48.337466771878944, "num_agent_steps_sampled_lifetime": {"vehicle_0": 10011.999999999996, "vehicle_2": 11945.0, "vehicle_4": 18971.0, "vehicle_1": 11980.0, "vehicle_5": 18363.0, "vehicle_3": 9884.0}, "episode_return_mean": 1180.9722387206552, "num_env_steps_sampled_lifetime": 20000.0, "time_between_sampling": 0.29859421335614467, "episode_return_min": 573.0513803958893, "episode_len_max": 112, "num_module_steps_sampled_lifetime": {"shared_policy": 81155.0}, "module_episode_returns_mean": {"shared_policy": 578.513709769249}, "episode_len_min": 107, "weights_seq_no": 14.0, "episode_duration_sec_mean": 0.06819029664009575, "num_module_steps_sampled": {"shared_policy": 8689.0}, "num_episodes_lifetime": 167.0, "episode_return_max": 1434.4343287944794, "env_to_module_sum_episodes_length_out": 48.337466771878944, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1690.8560583056362}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004895791955149007, "agent_to_module_mapping": 0.0030306660888998515, "general_advantage_estimation": 0.0159817416474991, "add_time_dim_to_batch_and_zero_pad": 1.1772063549694341e-05, "add_columns_from_episodes_to_train_batch": 0.044744059785662725, "add_states_from_episodes_to_batch": 3.724625651901223e-06, "numpy_to_tensor": 0.00021904924484286806, "batch_individual_items": 0.10397192282144871, "add_observations_from_episodes_to_batch": 0.0002971796233605114}}, "connector_pipeline_timer": 0.17333148458242287}, "learner_connector_sum_episodes_length_in": 1996.3459310100652, "num_env_steps_trained": 1400000, "num_module_steps_trained_lifetime": 1140224, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 17632000, "num_module_steps_trained": 89600, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.3459310100652, "num_env_steps_trained_lifetime_throughput": 1096014.6618648209, "num_module_steps_trained_throughput": 70562.80786715593, "num_module_steps_trained_lifetime_throughput": 70563.4339184351}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.209676742553711, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.359452247619629, "total_loss": 9.432008743286133, "num_module_steps_trained": 89600, "num_trainable_parameters": 149763, "entropy": 0.6933846473693848, "vf_loss_unclipped": 2975.6923828125, "weights_seq_no": 15.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.021648406982421875, "policy_loss": 0.07449360191822052, "mean_kl_loss": 0.016656123101711273, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1140224, "num_module_steps_trained_lifetime_throughput": 70564.15915043521}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-42", "timestamp": 1750909722, "time_this_iter_s": 2.141418933868408, "time_total_s": 338.054790019989, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f746ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 338.054790019989, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 14.366666666666665, "ram_util_percent": 52.96666666666667}}
{"timers": {"training_iteration": 4.734482878288214, "restore_env_runners": 0.0018157108912380847, "training_step": 4.732549911114526, "env_runner_sampling_timer": 3.5400451429427164, "learner_update_timer": 1.1905479219387194, "synch_weights": 0.0008931260022787685, "synch_env_connectors": 0.010944752338761958}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.532621543007825e-06, "batch_individual_items": 9.260372659138856e-06, "add_time_dim_to_batch_and_zero_pad": 2.5906621164638846e-06, "add_observations_from_episodes_to_batch": 1.5107463887514894e-05, "add_states_from_episodes_to_batch": 1.675781132928902e-06, "agent_to_module_mapping": 2.801583938559553e-06}}, "connector_pipeline_timer": 6.761022645363442e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 290.2484470748901, "vehicle_5": 419.4070001697539, "vehicle_3": -54.86209452867509, "vehicle_2": -13.81515890955925, "vehicle_4": 523.2880680894851, "vehicle_0": 215.29688316583633}, "sample": 0.13133054130171032, "rlmodule_inference_timer": 6.601827758460116e-05, "agent_steps": {"vehicle_5": 106.95999999999998, "vehicle_3": 56.92, "vehicle_2": 87.44, "vehicle_0": 56.28000000000001, "vehicle_4": 108.08000000000001, "vehicle_1": 88.44}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.36, "env_step_timer": 0.00015282909638807574, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.558454844194228e-05, "tensor_to_numpy": 1.635389010178461e-05, "module_to_agent_unmapping": 1.6502862482847195e-06, "normalize_and_clip_actions": 4.874333422238338e-05, "remove_single_ts_time_rank_from_batch": 6.355740372585894e-07, "un_batch_to_individual_items": 1.585876933478627e-05, "listify_data_for_vector_env": 6.9676301735097276e-06}}, "connector_pipeline_timer": 0.00015624576253504214}, "num_agent_steps_sampled": {"vehicle_5": 1954.0000000000002, "vehicle_3": 1039.0, "vehicle_2": 1630.0, "vehicle_4": 1974.0000000000002, "vehicle_0": 1022.9999999999999, "vehicle_1": 1660.9999999999998}, "env_to_module_sum_episodes_length_in": 48.63813311509572, "num_agent_steps_sampled_lifetime": {"vehicle_0": 11034.999999999996, "vehicle_2": 13575.0, "vehicle_4": 20945.0, "vehicle_1": 13641.0, "vehicle_5": 20317.0, "vehicle_3": 10923.0}, "episode_return_mean": 1379.5631452476982, "num_env_steps_sampled_lifetime": 22000.0, "time_between_sampling": 0.29854322937065125, "episode_return_min": 1099.81354534626, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 90436.0}, "module_episode_returns_mean": {"shared_policy": 680.8575203132631}, "episode_len_min": 107, "weights_seq_no": 15.0, "episode_duration_sec_mean": 0.06958445988144377, "num_module_steps_sampled": {"shared_policy": 9281.0}, "num_episodes_lifetime": 186.0, "episode_return_max": 1661.826316833496, "env_to_module_sum_episodes_length_out": 48.63813311509572, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1644.8553888500555}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004916029035557535, "agent_to_module_mapping": 0.003041070678050602, "general_advantage_estimation": 0.01602317590102926, "add_time_dim_to_batch_and_zero_pad": 1.1751002919708183e-05, "add_columns_from_episodes_to_train_batch": 0.044906703767772595, "add_states_from_episodes_to_batch": 3.710719357736141e-06, "numpy_to_tensor": 0.00021774292239814036, "batch_individual_items": 0.10418191567318681, "add_observations_from_episodes_to_batch": 0.0002996190771489134}}, "connector_pipeline_timer": 0.17377684765661788}, "learner_connector_sum_episodes_length_in": 1996.3824716999645, "num_env_steps_trained": 1492000, "num_module_steps_trained_lifetime": 1235712, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 19124000, "num_module_steps_trained": 95488, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.3824716999645, "num_env_steps_trained_lifetime_throughput": 1095215.870389595, "num_module_steps_trained_throughput": 70490.59809109266, "num_module_steps_trained_lifetime_throughput": 70491.27056283425}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.4570870399475098, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.64633560180664, "total_loss": 9.599223136901855, "num_module_steps_trained": 95488, "num_trainable_parameters": 149763, "entropy": 0.6306515336036682, "vf_loss_unclipped": 3360.98486328125, "weights_seq_no": 16.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.0071370601654052734, "policy_loss": -0.043408848345279694, "mean_kl_loss": 0.008677953854203224, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1235712, "num_module_steps_trained_lifetime_throughput": 70491.8094745514}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-44", "timestamp": 1750909724, "time_this_iter_s": 2.313822031021118, "time_total_s": 340.36861205101013, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1337e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 340.36861205101013, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 4.709093587835334, "restore_env_runners": 0.0017975992023455912, "training_step": 4.7071785120033836, "env_runner_sampling_timer": 3.5117609981733167, "learner_update_timer": 1.193457048549293, "synch_weights": 0.000891872652217766, "synch_env_connectors": 0.010843873985396721}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.651981703842718e-06, "batch_individual_items": 9.172935766130636e-06, "add_time_dim_to_batch_and_zero_pad": 2.5526526303102115e-06, "add_observations_from_episodes_to_batch": 1.4985237196262941e-05, "add_states_from_episodes_to_batch": 1.6615471157474888e-06, "agent_to_module_mapping": 2.7715475712598396e-06}}, "connector_pipeline_timer": 6.714986936007089e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 323.24473026514056, "vehicle_5": 459.9183232307434, "vehicle_3": -54.0701884675026, "vehicle_2": 86.16808326482773, "vehicle_4": 526.5514061808586, "vehicle_0": 217.6492851126194}, "sample": 0.13144752722040007, "rlmodule_inference_timer": 6.558777269815236e-05, "agent_steps": {"vehicle_5": 107.34, "vehicle_3": 54.26, "vehicle_2": 83.74, "vehicle_0": 53.72, "vehicle_4": 104.9, "vehicle_1": 86.64}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.06, "env_step_timer": 0.00015183192148249627, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5699136363043393e-05, "tensor_to_numpy": 1.6406634457077602e-05, "module_to_agent_unmapping": 1.6503742021091653e-06, "normalize_and_clip_actions": 4.708341463058822e-05, "remove_single_ts_time_rank_from_batch": 6.366236956255805e-07, "un_batch_to_individual_items": 1.531032081547523e-05, "listify_data_for_vector_env": 6.892815774906715e-06}}, "connector_pipeline_timer": 0.0001541275643767042}, "num_agent_steps_sampled": {"vehicle_5": 1970.9999999999998, "vehicle_3": 1020.0, "vehicle_2": 1530.9999999999998, "vehicle_4": 1929.0000000000002, "vehicle_0": 1009.0, "vehicle_1": 1584.0000000000002}, "env_to_module_sum_episodes_length_in": 50.033522756637694, "num_agent_steps_sampled_lifetime": {"vehicle_0": 12043.999999999996, "vehicle_2": 15106.000000000002, "vehicle_4": 22874.0, "vehicle_1": 15225.0, "vehicle_5": 22288.0, "vehicle_3": 11943.0}, "episode_return_mean": 1559.4616390144824, "num_env_steps_sampled_lifetime": 24000.0, "time_between_sampling": 0.30008573929637594, "episode_return_min": 1292.976530611515, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 99480.0}, "module_episode_returns_mean": {"shared_policy": 726.0946231293678}, "episode_len_min": 106, "weights_seq_no": 16.0, "episode_duration_sec_mean": 0.0686105875603971, "num_module_steps_sampled": {"shared_policy": 9044.0}, "num_episodes_lifetime": 204.0, "episode_return_max": 1772.1570508480072, "env_to_module_sum_episodes_length_out": 50.033522756637694, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1653.482624135202}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004932975405144266, "agent_to_module_mapping": 0.003049591641330361, "general_advantage_estimation": 0.01605659414202004, "add_time_dim_to_batch_and_zero_pad": 1.1714742927112077e-05, "add_columns_from_episodes_to_train_batch": 0.04505001631007025, "add_states_from_episodes_to_batch": 3.6981921679688944e-06, "numpy_to_tensor": 0.00021651799322376585, "batch_individual_items": 0.10359709318641865, "add_observations_from_episodes_to_batch": 0.00030118246635216315}}, "connector_pipeline_timer": 0.17339380918007263}, "learner_connector_sum_episodes_length_in": 1996.418646982965, "num_env_steps_trained": 1454000, "num_module_steps_trained_lifetime": 1328768, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 20578000, "num_module_steps_trained": 93056, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.418646982965, "num_env_steps_trained_lifetime_throughput": 1095373.5723564012, "num_module_steps_trained_throughput": 70480.60134336811, "num_module_steps_trained_lifetime_throughput": 70481.33524259746}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.7790402173995972, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.681072235107422, "total_loss": 9.653529167175293, "num_module_steps_trained": 93056, "num_trainable_parameters": 149763, "entropy": 0.5373998880386353, "vf_loss_unclipped": 3323.42578125, "weights_seq_no": 17.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.10618364810943604, "policy_loss": -0.027195710688829422, "mean_kl_loss": 0.016755130141973495, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1328768, "num_module_steps_trained_lifetime_throughput": 70481.61727536471}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-47", "timestamp": 1750909727, "time_this_iter_s": 2.197997808456421, "time_total_s": 342.56660985946655, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b133a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.56660985946655, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.2, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 4.683948827376997, "restore_env_runners": 0.0017796761202855502, "training_step": 4.682051169803416, "env_runner_sampling_timer": 3.4837944702715284, "learner_update_timer": 1.196292415563823, "synch_weights": 0.0008904401757288411, "synch_env_connectors": 0.01074731316558478}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2687498130835593e-05, "add_time_dim_to_batch_and_zero_pad": 7.687500328756869e-06, "add_observations_from_episodes_to_batch": 3.5416498576523736e-05, "add_states_from_episodes_to_batch": 3.5834964364767075e-06, "agent_to_module_mapping": 6.312500772764906e-06, "numpy_to_tensor": 2.289549956913106e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.710062399860627e-06, "batch_individual_items": 9.187041243277238e-06, "add_time_dim_to_batch_and_zero_pad": 2.571020426245023e-06, "add_observations_from_episodes_to_batch": 1.5043504436055723e-05, "add_states_from_episodes_to_batch": 1.6657405188805746e-06, "agent_to_module_mapping": 2.7834434399776006e-06}}, "connector_pipeline_timer": 6.744587582636062e-05}, "env_reset_timer": 0.00010745850158855319, "agent_episode_returns_mean": {"vehicle_1": 372.1028911614418, "vehicle_5": 466.3876181793213, "vehicle_3": -9.856997870206834, "vehicle_2": 110.38184482216835, "vehicle_4": 569.5428897476196, "vehicle_0": 226.1535961520672}, "sample": 0.1315630244207902, "rlmodule_inference_timer": 6.339566200717994e-05, "agent_steps": {"vehicle_5": 107.34, "vehicle_3": 53.94, "vehicle_2": 90.4, "vehicle_0": 53.66, "vehicle_4": 107.92, "vehicle_1": 94.18}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.08, "env_step_timer": 0.0001497594595137295, "connector_pipeline_timer": 0.00022181299937074073, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.598168425087432e-05, "tensor_to_numpy": 1.6529069497503883e-05, "module_to_agent_unmapping": 1.659182561260749e-06, "normalize_and_clip_actions": 4.7543293162139945e-05, "remove_single_ts_time_rank_from_batch": 6.301108775505482e-07, "un_batch_to_individual_items": 1.5674269794185174e-05, "listify_data_for_vector_env": 6.92192685094842e-06}}, "connector_pipeline_timer": 0.0001555432947233382}, "num_agent_steps_sampled": {"vehicle_5": 1970.0, "vehicle_3": 891.0, "vehicle_2": 1635.0, "vehicle_4": 1982.0, "vehicle_0": 895.0, "vehicle_1": 1705.9999999999998}, "env_to_module_sum_episodes_length_in": 50.08666766640124, "num_agent_steps_sampled_lifetime": {"vehicle_0": 12938.999999999996, "vehicle_2": 16741.0, "vehicle_4": 24856.0, "vehicle_1": 16931.0, "vehicle_5": 24258.0, "vehicle_3": 12834.0}, "episode_return_mean": 1734.7118379294873, "num_env_steps_sampled_lifetime": 26000.0, "time_between_sampling": 0.30047986837108337, "episode_return_min": 1294.1352090835571, "episode_len_max": 110, "num_module_steps_sampled_lifetime": {"shared_policy": 108559.0}, "module_episode_returns_mean": {"shared_policy": 679.2762552618981}, "episode_len_min": 108, "weights_seq_no": 17.0, "episode_duration_sec_mean": 0.06934369156035246, "num_module_steps_sampled": {"shared_policy": 9079.0}, "num_episodes_lifetime": 221.99999999999997, "episode_return_max": 1939.1714979410172, "env_to_module_sum_episodes_length_out": 50.08666766640124, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1658.0086486710204}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004953447731053761, "agent_to_module_mapping": 0.0030570894749281405, "general_advantage_estimation": 0.016092157370598877, "add_time_dim_to_batch_and_zero_pad": 1.1678845534441934e-05, "add_columns_from_episodes_to_train_batch": 0.04519817698693849, "add_states_from_episodes_to_batch": 3.686210218372811e-06, "numpy_to_tensor": 0.00021519531330389615, "batch_individual_items": 0.1030324839245427, "add_observations_from_episodes_to_batch": 0.000304676061639923}}, "connector_pipeline_timer": 0.1730424785883262}, "learner_connector_sum_episodes_length_in": 1996.4544605131352, "num_env_steps_trained": 1462000, "num_module_steps_trained_lifetime": 1422336, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 22040000, "num_module_steps_trained": 93568, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.4544605131352, "num_env_steps_trained_lifetime_throughput": 1096255.2266339113, "num_module_steps_trained_throughput": 70518.03802713357, "num_module_steps_trained_lifetime_throughput": 70518.80209082278}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.3699536323547363, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.535500526428223, "total_loss": 9.479665756225586, "num_module_steps_trained": 93568, "num_trainable_parameters": 149763, "entropy": 0.46153557300567627, "vf_loss_unclipped": 3996.0341796875, "weights_seq_no": 18.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.03206491470336914, "policy_loss": -0.054951272904872894, "mean_kl_loss": 0.012438083067536354, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1422336, "num_module_steps_trained_lifetime_throughput": 70518.8851568033}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "a8246_00000", "date": "2025-06-25_20-48-49", "timestamp": 1750909729, "time_this_iter_s": 2.1968271732330322, "time_total_s": 344.7634370326996, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b133380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 344.7634370326996, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.833333333333334, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 5.280823263683233, "restore_env_runners": 0.0017619206091057543, "training_step": 5.278943258525349, "env_runner_sampling_timer": 4.077287672648839, "learner_update_timer": 1.1996844951581946, "synch_weights": 0.0008918203540290396, "synch_env_connectors": 0.010650880033955628}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.1137497969903053e-05, "add_time_dim_to_batch_and_zero_pad": 7.137501961551607e-06, "add_observations_from_episodes_to_batch": 3.208329799235799e-05, "add_states_from_episodes_to_batch": 3.316695801913736e-06, "agent_to_module_mapping": 5.462503031594678e-06, "numpy_to_tensor": 2.1945501066511498e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.612930914460137e-06, "batch_individual_items": 9.058133994669878e-06, "add_time_dim_to_batch_and_zero_pad": 2.576529505925254e-06, "add_observations_from_episodes_to_batch": 1.4713402302095086e-05, "add_states_from_episodes_to_batch": 1.6516587947043803e-06, "agent_to_module_mapping": 2.779291733823587e-06}}, "connector_pipeline_timer": 6.656975542733151e-05}, "env_reset_timer": 0.0001027580990921706, "agent_episode_returns_mean": {"vehicle_1": 409.1120609521866, "vehicle_5": 489.95562478542314, "vehicle_3": 15.901184632778168, "vehicle_2": 157.92577329993247, "vehicle_4": 589.2266202163696, "vehicle_0": 195.16438024163247}, "sample": 0.1299248001883008, "rlmodule_inference_timer": 6.23808776147724e-05, "agent_steps": {"vehicle_5": 107.6, "vehicle_3": 47.42, "vehicle_2": 89.54, "vehicle_0": 47.5, "vehicle_4": 108.0, "vehicle_1": 94.34}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015065746776984288, "connector_pipeline_timer": 0.00020252979957149364, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.544952419626464e-05, "tensor_to_numpy": 1.6139127381630074e-05, "module_to_agent_unmapping": 1.650220900618035e-06, "normalize_and_clip_actions": 4.729721216809449e-05, "remove_single_ts_time_rank_from_batch": 6.259849832726632e-07, "un_batch_to_individual_items": 1.5471818859184013e-05, "listify_data_for_vector_env": 6.828491363513178e-06}}, "connector_pipeline_timer": 0.0001540105485127437}, "num_agent_steps_sampled": {"vehicle_5": 1974.0000000000002, "vehicle_3": 860.0, "vehicle_2": 1650.9999999999998, "vehicle_4": 1980.9999999999998, "vehicle_0": 860.0, "vehicle_1": 1745.9999999999998}, "env_to_module_sum_episodes_length_in": 48.38581688713384, "num_agent_steps_sampled_lifetime": {"vehicle_0": 13799.000000000002, "vehicle_2": 18391.999999999996, "vehicle_4": 26837.000000000004, "vehicle_1": 18677.0, "vehicle_5": 26232.000000000007, "vehicle_3": 13693.999999999998}, "episode_return_mean": 1857.2856440091134, "num_env_steps_sampled_lifetime": 28000.0, "time_between_sampling": 0.8750060248317748, "episode_return_min": 1592.2834199666977, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 117631.00000000003}, "module_episode_returns_mean": {"shared_policy": 781.7967351126671}, "episode_len_min": 108, "weights_seq_no": 18.0, "episode_duration_sec_mean": 0.06829916650109226, "num_module_steps_sampled": {"shared_policy": 9072.0}, "num_episodes_lifetime": 241.0, "episode_return_max": 2042.1034683585167, "env_to_module_sum_episodes_length_out": 48.38581688713384, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1662.3892654062558}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004970239093759584, "agent_to_module_mapping": 0.003065789000199189, "general_advantage_estimation": 0.016123902046897436, "add_time_dim_to_batch_and_zero_pad": 1.1660387062399906e-05, "add_columns_from_episodes_to_train_batch": 0.04533652563708739, "add_states_from_episodes_to_batch": 3.668518154474748e-06, "numpy_to_tensor": 0.00021394419015298611, "batch_individual_items": 0.10323442450526428, "add_observations_from_episodes_to_batch": 0.000306116800996562}}, "connector_pipeline_timer": 0.17343959505238102}, "learner_connector_sum_episodes_length_in": 1996.489915908004, "num_env_steps_trained": 1460000, "num_module_steps_trained_lifetime": 1515776, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 23500000, "num_module_steps_trained": 93440, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.489915908004, "num_env_steps_trained_lifetime_throughput": 1095032.736453852, "num_module_steps_trained_throughput": 70422.14876500468, "num_module_steps_trained_lifetime_throughput": 70422.73779562784}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.31758451461792, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.759465217590332, "total_loss": 9.705423355102539, "num_module_steps_trained": 93440, "num_trainable_parameters": 149763, "entropy": 0.43551400303840637, "vf_loss_unclipped": 3755.258056640625, "weights_seq_no": 19.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07330882549285889, "policy_loss": -0.05216151103377342, "mean_kl_loss": 0.008252186700701714, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1515776, "num_module_steps_trained_lifetime_throughput": 70423.0595863029}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 5}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "a8246_00000", "date": "2025-06-25_20-49-53", "timestamp": 1750909793, "time_this_iter_s": 64.37385487556458, "time_total_s": 409.13729190826416, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b131300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 409.13729190826416, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.963736263736264, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 5.250811667296388, "restore_env_runners": 0.0017851339030318283, "training_step": 5.248908055520118, "env_runner_sampling_timer": 4.04362793759233, "learner_update_timer": 1.203304337296618, "synch_weights": 0.0008906663204932698, "synch_env_connectors": 0.010553257893614169}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0395997125888243e-05, "add_time_dim_to_batch_and_zero_pad": 6.562499038409442e-06, "add_observations_from_episodes_to_batch": 3.08954986394383e-05, "add_states_from_episodes_to_batch": 3.166496753692627e-06, "agent_to_module_mapping": 5.104498995933682e-06, "numpy_to_tensor": 2.3979002435225993e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.616158750824055e-06, "batch_individual_items": 9.205602152171535e-06, "add_time_dim_to_batch_and_zero_pad": 2.53829202935998e-06, "add_observations_from_episodes_to_batch": 1.509057366915694e-05, "add_states_from_episodes_to_batch": 1.6357817743173803e-06, "agent_to_module_mapping": 2.792021751587577e-06}}, "connector_pipeline_timer": 6.704819470497926e-05}, "env_reset_timer": 9.779150059330277e-05, "agent_episode_returns_mean": {"vehicle_1": 395.4725139750753, "vehicle_5": 478.55266438484193, "vehicle_3": 44.41644537312644, "vehicle_2": 178.739041619982, "vehicle_4": 585.3410100460054, "vehicle_0": 249.30590035302296}, "sample": 0.13272366838844987, "rlmodule_inference_timer": 6.612285348623857e-05, "agent_steps": {"vehicle_5": 107.42857142857143, "vehicle_3": 56.33428571428573, "vehicle_2": 92.23714285714286, "vehicle_0": 56.714285714285715, "vehicle_4": 108.0, "vehicle_1": 97.50857142857141}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.07714285714286, "env_step_timer": 0.0001488350720583803, "connector_pipeline_timer": 0.00019662499835249037, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7317998205502904e-05, "tensor_to_numpy": 1.701766358916297e-05, "module_to_agent_unmapping": 1.6619295858470317e-06, "normalize_and_clip_actions": 5.0772415950045804e-05, "remove_single_ts_time_rank_from_batch": 6.476665501532493e-07, "un_batch_to_individual_items": 1.6280837101728907e-05, "listify_data_for_vector_env": 7.0959143514686415e-06}}, "connector_pipeline_timer": 0.00016163643585948197}, "num_agent_steps_sampled": {"vehicle_5": 1970.0, "vehicle_3": 1072.0, "vehicle_2": 1720.9999999999998, "vehicle_4": 1980.9999999999998, "vehicle_0": 1080.0, "vehicle_1": 1814.0000000000002}, "env_to_module_sum_episodes_length_in": 47.95964247641952, "num_agent_steps_sampled_lifetime": {"vehicle_0": 28419.000000000007, "vehicle_2": 41486.0, "vehicle_4": 56203.000000000015, "vehicle_1": 42615.0, "vehicle_5": 55611.0, "vehicle_3": 28345.999999999993}, "episode_return_mean": 1931.8275759857042, "num_env_steps_sampled_lifetime": 58000.0, "time_between_sampling": 0.5836519097217545, "episode_return_min": 1577.7709821462631, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 252680.0}, "module_episode_returns_mean": {"shared_policy": 864.468400569303}, "episode_len_min": 108, "weights_seq_no": 19.0, "episode_duration_sec_mean": 0.06828575310577956, "num_module_steps_sampled": {"shared_policy": 9637.999999999998}, "num_episodes_lifetime": 518.0, "episode_return_max": 2250.545851826668, "env_to_module_sum_episodes_length_out": 47.95964247641952, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1633.9571438607231}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.004990080042818004, "agent_to_module_mapping": 0.0030762448602458773, "general_advantage_estimation": 0.016170174696370058, "add_time_dim_to_batch_and_zero_pad": 1.1628363215898169e-05, "add_columns_from_episodes_to_train_batch": 0.045517807880690174, "add_states_from_episodes_to_batch": 3.6559930084666252e-06, "numpy_to_tensor": 0.0002127397482405691, "batch_individual_items": 0.10268033401018209, "add_observations_from_episodes_to_batch": 0.00030797938300727634}}, "connector_pipeline_timer": 0.1731435566018674}, "learner_connector_sum_episodes_length_in": 1996.525016748924, "num_env_steps_trained": 1548000, "num_module_steps_trained_lifetime": 1614848, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 25048000, "num_module_steps_trained": 99072, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.525016748924, "num_env_steps_trained_lifetime_throughput": 1095084.4381767593, "num_module_steps_trained_throughput": 70408.49049594755, "num_module_steps_trained_lifetime_throughput": 70409.03156349587}, "shared_policy": {"gradients_default_optimizer_global_norm": 4.136249542236328, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.658405303955078, "total_loss": 9.753342628479004, "num_module_steps_trained": 99072, "num_trainable_parameters": 149763, "entropy": 0.4891417622566223, "vf_loss_unclipped": 3263.1923828125, "weights_seq_no": 20.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.037020206451416016, "policy_loss": 0.0959865152835846, "mean_kl_loss": 0.012806055136024952, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1614848, "num_module_steps_trained_lifetime_throughput": 70409.33269320297}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 58000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 20, "trial_id": "a8246_00000", "date": "2025-06-25_20-49-56", "timestamp": 1750909796, "time_this_iter_s": 2.2816379070281982, "time_total_s": 411.41892981529236, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1327a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 411.41892981529236, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 53.0}}
{"timers": {"training_iteration": 5.220743176043435, "restore_env_runners": 0.0017673588140000385, "training_step": 5.218856425804924, "env_runner_sampling_timer": 4.010786407386428, "learner_update_timer": 1.2060870122536433, "synch_weights": 0.0008921200772713813, "synch_env_connectors": 0.010456378234683287}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0395997125888243e-05, "add_time_dim_to_batch_and_zero_pad": 6.562499038409442e-06, "add_observations_from_episodes_to_batch": 3.08954986394383e-05, "add_states_from_episodes_to_batch": 3.166496753692627e-06, "agent_to_module_mapping": 5.104498995933682e-06, "numpy_to_tensor": 2.3979002435225993e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.618688616179224e-06, "batch_individual_items": 9.06812847818346e-06, "add_time_dim_to_batch_and_zero_pad": 2.546311525493617e-06, "add_observations_from_episodes_to_batch": 1.4886874573345584e-05, "add_states_from_episodes_to_batch": 1.6508280325585242e-06, "agent_to_module_mapping": 2.7889650480860333e-06}}, "connector_pipeline_timer": 6.688053933093417e-05}, "env_reset_timer": 9.779150059330277e-05, "agent_episode_returns_mean": {"vehicle_1": 383.52183622598653, "vehicle_5": 472.2295630264282, "vehicle_3": 34.616454496383675, "vehicle_2": 186.32992431640625, "vehicle_4": 597.6359427118302, "vehicle_0": 207.32525071144102}, "sample": 0.1328264715091388, "rlmodule_inference_timer": 7.465599125757548e-05, "agent_steps": {"vehicle_5": 107.18, "vehicle_3": 48.959999999999994, "vehicle_2": 91.64, "vehicle_0": 49.16, "vehicle_4": 108.0, "vehicle_1": 96.78}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.02000000000002, "env_step_timer": 0.00015133028802007242, "connector_pipeline_timer": 0.00019662499835249037, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5628242650860124e-05, "tensor_to_numpy": 1.6321453524628502e-05, "module_to_agent_unmapping": 1.6692831759379913e-06, "normalize_and_clip_actions": 4.7596605003941933e-05, "remove_single_ts_time_rank_from_batch": 6.548702587852062e-07, "un_batch_to_individual_items": 1.5529952318370917e-05, "listify_data_for_vector_env": 6.7215008677904094e-06}}, "connector_pipeline_timer": 0.00015466375593258273}, "num_agent_steps_sampled": {"vehicle_5": 1965.9999999999998, "vehicle_3": 851.0, "vehicle_2": 1647.0, "vehicle_4": 1980.0, "vehicle_0": 857.0000000000001, "vehicle_1": 1740.9999999999998}, "env_to_module_sum_episodes_length_in": 48.93527138981703, "num_agent_steps_sampled_lifetime": {"vehicle_0": 29276.000000000007, "vehicle_2": 43133.0, "vehicle_4": 58183.00000000003, "vehicle_1": 44356.0, "vehicle_5": 57577.0, "vehicle_3": 29196.999999999985}, "episode_return_mean": 1881.6589738059045, "num_env_steps_sampled_lifetime": 60000.0, "time_between_sampling": 0.5165036106993383, "episode_return_min": 1668.5886957645416, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 261722.0}, "module_episode_returns_mean": {"shared_policy": 831.1095261669158}, "episode_len_min": 108, "weights_seq_no": 20.0, "episode_duration_sec_mean": 0.07028642575882259, "num_module_steps_sampled": {"shared_policy": 9042.0}, "num_episodes_lifetime": 537.0000000000001, "episode_return_max": 2166.0767464637756, "env_to_module_sum_episodes_length_out": 48.93527138981703, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1634.2815804781621}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005008689662413637, "agent_to_module_mapping": 0.0030817632415976125, "general_advantage_estimation": 0.016198262949410354, "add_time_dim_to_batch_and_zero_pad": 1.1624169567043218e-05, "add_columns_from_episodes_to_train_batch": 0.04568056813191649, "add_states_from_episodes_to_batch": 3.6465130284687315e-06, "numpy_to_tensor": 0.00021150360077794002, "batch_individual_items": 0.10211487567008361, "add_observations_from_episodes_to_batch": 0.000310155419214844}}, "connector_pipeline_timer": 0.17279352103580345}, "learner_connector_sum_episodes_length_in": 1996.5597665814346, "num_env_steps_trained": 1456000, "num_module_steps_trained_lifetime": 1708032, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 26504000, "num_module_steps_trained": 93184, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.5597665814346, "num_env_steps_trained_lifetime_throughput": 1095056.2476347114, "num_module_steps_trained_throughput": 70390.78024214438, "num_module_steps_trained_lifetime_throughput": 70391.32768846926}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.031050443649292, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.829516410827637, "total_loss": 9.819133758544922, "num_module_steps_trained": 93184, "num_trainable_parameters": 149763, "entropy": 0.4455235004425049, "vf_loss_unclipped": 3650.02490234375, "weights_seq_no": 21.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.048972487449645996, "policy_loss": -0.00933153461664915, "mean_kl_loss": 0.011349384672939777, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1708032, "num_module_steps_trained_lifetime_throughput": 70391.62548841245}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 60000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 21, "trial_id": "a8246_00000", "date": "2025-06-25_20-49-58", "timestamp": 1750909798, "time_this_iter_s": 2.246595859527588, "time_total_s": 413.66552567481995, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 413.66552567481995, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 15.95, "ram_util_percent": 53.1}}
{"timers": {"training_iteration": 5.8136816676129826, "restore_env_runners": 0.0017497285558611007, "training_step": 5.811812159876854, "env_runner_sampling_timer": 4.6004481074825465, "learner_update_timer": 1.209374818791103, "synch_weights": 0.0008929684564909478, "synch_env_connectors": 0.010366691542334208}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0112796482862906e-05, "add_time_dim_to_batch_and_zero_pad": 6.212496373336762e-06, "add_observations_from_episodes_to_batch": 3.061189927393571e-05, "add_states_from_episodes_to_batch": 3.099697642028332e-06, "agent_to_module_mapping": 4.9880953156389294e-06, "numpy_to_tensor": 2.5795803230721505e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.326328171120136e-06, "batch_individual_items": 8.804388900242958e-06, "add_time_dim_to_batch_and_zero_pad": 2.4676349192934177e-06, "add_observations_from_episodes_to_batch": 1.4369318176452703e-05, "add_states_from_episodes_to_batch": 1.588475447293693e-06, "agent_to_module_mapping": 2.6904444070477442e-06}}, "connector_pipeline_timer": 6.4841322394543e-05}, "env_reset_timer": 9.475830229348503e-05, "agent_episode_returns_mean": {"vehicle_1": 407.48763429880137, "vehicle_5": 470.50273644447327, "vehicle_3": 46.65413512587547, "vehicle_2": 179.35313021421427, "vehicle_4": 595.766488828659, "vehicle_0": 176.4889139676094}, "sample": 0.1353667563294519, "rlmodule_inference_timer": 6.261740800569383e-05, "agent_steps": {"vehicle_5": 107.32, "vehicle_3": 43.06, "vehicle_2": 92.42, "vehicle_0": 43.17999999999999, "vehicle_4": 108.0, "vehicle_1": 98.3}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.02, "env_step_timer": 0.00014369576737351537, "connector_pipeline_timer": 0.00019575779733713717, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5149929170230894e-05, "tensor_to_numpy": 1.574117454901976e-05, "module_to_agent_unmapping": 1.606569144607088e-06, "normalize_and_clip_actions": 4.570022616948376e-05, "remove_single_ts_time_rank_from_batch": 6.440253430503057e-07, "un_batch_to_individual_items": 1.499050989330388e-05, "listify_data_for_vector_env": 6.474157199206801e-06}}, "connector_pipeline_timer": 0.0001502753988534016}, "num_agent_steps_sampled": {"vehicle_5": 1969.0000000000002, "vehicle_3": 752.0000000000001, "vehicle_2": 1705.9999999999998, "vehicle_4": 1982.0, "vehicle_0": 752.0000000000001, "vehicle_1": 1818.0}, "env_to_module_sum_episodes_length_in": 48.77165198037848, "num_agent_steps_sampled_lifetime": {"vehicle_0": 30028.00000000001, "vehicle_2": 44839.00000000001, "vehicle_4": 60165.00000000004, "vehicle_1": 46174.00000000001, "vehicle_5": 59546.000000000015, "vehicle_3": 29948.999999999993}, "episode_return_mean": 1876.2530414354799, "num_env_steps_sampled_lifetime": 62000.0, "time_between_sampling": 0.5520080246428684, "episode_return_min": 1734.2671127319336, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 270701.0}, "module_episode_returns_mean": {"shared_policy": 773.5126240873337}, "episode_len_min": 108, "weights_seq_no": 21.0, "episode_duration_sec_mean": 0.06960645820014179, "num_module_steps_sampled": {"shared_policy": 8979.0}, "num_episodes_lifetime": 555.0, "episode_return_max": 2127.000092625618, "env_to_module_sum_episodes_length_out": 48.77165198037848, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1660.9281761838552}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005026298605833098, "agent_to_module_mapping": 0.0030884797791507854, "general_advantage_estimation": 0.016221354489919893, "add_time_dim_to_batch_and_zero_pad": 1.1587087889149088e-05, "add_columns_from_episodes_to_train_batch": 0.045800594540607024, "add_states_from_episodes_to_batch": 3.6321379237794337e-06, "numpy_to_tensor": 0.00021027981471717768, "batch_individual_items": 0.10232654233339045, "add_observations_from_episodes_to_batch": 0.00031204719502604}}, "connector_pipeline_timer": 0.17317263707543182}, "learner_connector_sum_episodes_length_in": 1996.5941689156202, "num_env_steps_trained": 1444000, "num_module_steps_trained_lifetime": 1800448, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 27948000, "num_module_steps_trained": 92416, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.5941689156202, "num_env_steps_trained_lifetime_throughput": 1097675.5536187547, "num_module_steps_trained_throughput": 70542.94865762308, "num_module_steps_trained_lifetime_throughput": 70543.59659596633}, "shared_policy": {"gradients_default_optimizer_global_norm": 3.3176841735839844, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.673506736755371, "total_loss": 9.597580909729004, "num_module_steps_trained": 92416, "num_trainable_parameters": 149763, "entropy": 0.43825146555900574, "vf_loss_unclipped": 3717.425537109375, "weights_seq_no": 22.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.02836441993713379, "policy_loss": -0.07368578016757965, "mean_kl_loss": 0.007143603637814522, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1800448, "num_module_steps_trained_lifetime_throughput": 70543.73553946265}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 62000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 6}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 22, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-02", "timestamp": 1750909862, "time_this_iter_s": 64.51684474945068, "time_total_s": 478.18237042427063, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b131e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 478.18237042427063, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.88131868131868, "ram_util_percent": 52.66263736263735}}
{"timers": {"training_iteration": 5.777241407186879, "restore_env_runners": 0.0017720337703347273, "training_step": 5.7753491749481, "env_runner_sampling_timer": 4.561430305157757, "learner_update_timer": 1.2119241618532284, "synch_weights": 0.0008934704418948006, "synch_env_connectors": 0.01026985170690745}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.739696644925136e-06, "batch_individual_items": 9.278198813615907e-06, "add_time_dim_to_batch_and_zero_pad": 2.544689980813921e-06, "add_observations_from_episodes_to_batch": 1.513866361940538e-05, "add_states_from_episodes_to_batch": 1.6598667681300188e-06, "agent_to_module_mapping": 2.8100772558168804e-06}}, "connector_pipeline_timer": 6.780434752038031e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 383.5021386575699, "vehicle_5": 487.3119616365434, "vehicle_3": 48.44032807929176, "vehicle_2": 180.8172756867749, "vehicle_4": 599.5954082877295, "vehicle_0": 189.23975840227948}, "sample": 0.1329002130429045, "rlmodule_inference_timer": 6.507639130788744e-05, "agent_steps": {"vehicle_5": 107.39142857142856, "vehicle_3": 44.78857142857143, "vehicle_2": 91.25999999999998, "vehicle_0": 45.148571428571415, "vehicle_4": 108.0, "vehicle_1": 96.68571428571427}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015026259654366667, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7823065304135445e-05, "tensor_to_numpy": 1.755784349604085e-05, "module_to_agent_unmapping": 1.6956841352219778e-06, "normalize_and_clip_actions": 4.896816709414037e-05, "remove_single_ts_time_rank_from_batch": 6.697161549579543e-07, "un_batch_to_individual_items": 1.5826341146276895e-05, "listify_data_for_vector_env": 6.86289482833619e-06}}, "connector_pipeline_timer": 0.0001606776986559821}, "num_agent_steps_sampled": {"vehicle_5": 1972.0, "vehicle_3": 832.0000000000001, "vehicle_2": 1667.0, "vehicle_4": 1982.0, "vehicle_0": 837.9999999999999, "vehicle_1": 1760.9999999999998}, "env_to_module_sum_episodes_length_in": 48.07289563623521, "num_agent_steps_sampled_lifetime": {"vehicle_0": 10689.0, "vehicle_2": 21347.0, "vehicle_4": 24774.000000000007, "vehicle_1": 22569.000000000004, "vehicle_5": 24618.0, "vehicle_3": 10640.0}, "episode_return_mean": 1888.906871613264, "num_env_steps_sampled_lifetime": 25000.0, "time_between_sampling": 0.3447591038407555, "episode_return_min": 1597.0461552739143, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 114637.0}, "module_episode_returns_mean": {"shared_policy": 858.6984085171562}, "episode_len_min": 108, "weights_seq_no": 22.0, "episode_duration_sec_mean": 0.06700538982890844, "num_module_steps_sampled": {"shared_policy": 9052.0}, "num_episodes_lifetime": 226.0, "episode_return_max": 2028.66240131855, "env_to_module_sum_episodes_length_out": 48.07289563623521, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1634.2183796080408}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005043445619748956, "agent_to_module_mapping": 0.0030971733113202096, "general_advantage_estimation": 0.016254670945076134, "add_time_dim_to_batch_and_zero_pad": 1.157329702211434e-05, "add_columns_from_episodes_to_train_batch": 0.04592663359519692, "add_states_from_episodes_to_batch": 3.624156544968036e-06, "numpy_to_tensor": 0.0002090907665428299, "batch_individual_items": 0.10175715900006176, "add_observations_from_episodes_to_batch": 0.000313907133088429}}, "connector_pipeline_timer": 0.17278860361473544}, "learner_connector_sum_episodes_length_in": 1996.628227226464, "num_env_steps_trained": 1456000, "num_module_steps_trained_lifetime": 1893632, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 29404000, "num_module_steps_trained": 93184, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.628227226464, "num_env_steps_trained_lifetime_throughput": 1095537.4416326394, "num_module_steps_trained_throughput": 70391.47503336871, "num_module_steps_trained_lifetime_throughput": 70392.11898179138}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.5019850730895996, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.898765563964844, "total_loss": 9.801440238952637, "num_module_steps_trained": 93184, "num_trainable_parameters": 149763, "entropy": 0.40022632479667664, "vf_loss_unclipped": 3636.19921875, "weights_seq_no": 23.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.046381235122680664, "policy_loss": -0.09670159965753555, "mean_kl_loss": 0.01125925313681364, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1893632, "num_module_steps_trained_lifetime_throughput": 70392.2026398821}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 25000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 23, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-05", "timestamp": 1750909865, "time_this_iter_s": 2.171733856201172, "time_total_s": 480.3541042804718, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 480.3541042804718, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 22.3, "ram_util_percent": 51.9}}
{"timers": {"training_iteration": 5.741752041865042, "restore_env_runners": 0.001754359272619541, "training_step": 5.739877131118577, "env_runner_sampling_timer": 4.523379241686157, "learner_update_timer": 1.214499975654639, "synch_weights": 0.0008919253275035947, "synch_env_connectors": 0.01017614984980095}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0019059772739913e-05, "batch_individual_items": 9.419049523946073e-06, "add_time_dim_to_batch_and_zero_pad": 2.6193841770156523e-06, "add_observations_from_episodes_to_batch": 1.5461691009577066e-05, "add_states_from_episodes_to_batch": 1.6951839527947364e-06, "agent_to_module_mapping": 2.847444658921692e-06}}, "connector_pipeline_timer": 6.910581840103648e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 415.16575954675676, "vehicle_5": 486.4812194728852, "vehicle_3": 60.36401787996292, "vehicle_2": 211.0320387899876, "vehicle_4": 602.1056725311279, "vehicle_0": 194.16249931812285}, "sample": 0.1329514633612873, "rlmodule_inference_timer": 6.31336527183857e-05, "agent_steps": {"vehicle_5": 107.69999999999999, "vehicle_3": 44.86, "vehicle_2": 91.73999999999998, "vehicle_0": 45.4, "vehicle_4": 107.96, "vehicle_1": 97.98}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.14, "env_step_timer": 0.0001546720971336926, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.655892101103663e-05, "tensor_to_numpy": 1.7023756324973905e-05, "module_to_agent_unmapping": 1.7152446916563674e-06, "normalize_and_clip_actions": 4.818723998981268e-05, "remove_single_ts_time_rank_from_batch": 6.809319740876962e-07, "un_batch_to_individual_items": 1.5786639935487513e-05, "listify_data_for_vector_env": 6.801804930141231e-06}}, "connector_pipeline_timer": 0.00015838581949283534}, "num_agent_steps_sampled": {"vehicle_5": 1975.0, "vehicle_3": 795.0, "vehicle_2": 1660.0, "vehicle_4": 1979.0000000000002, "vehicle_0": 804.0, "vehicle_1": 1772.0}, "env_to_module_sum_episodes_length_in": 51.04994565739645, "num_agent_steps_sampled_lifetime": {"vehicle_0": 11493.0, "vehicle_2": 23007.000000000004, "vehicle_4": 26753.000000000007, "vehicle_1": 24341.000000000004, "vehicle_5": 26593.0, "vehicle_3": 11435.0}, "episode_return_mean": 1969.3112075960637, "num_env_steps_sampled_lifetime": 27000.0, "time_between_sampling": 0.310537342723165, "episode_return_min": 1632.8832290172577, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 123622.0}, "module_episode_returns_mean": {"shared_policy": 857.6026630568505}, "episode_len_min": 108, "weights_seq_no": 23.0, "episode_duration_sec_mean": 0.06971203662076732, "num_module_steps_sampled": {"shared_policy": 8985.0}, "num_episodes_lifetime": 244.00000000000003, "episode_return_max": 2277.181640982628, "env_to_module_sum_episodes_length_out": 51.04994565739645, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1606.5285436845847}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005059454913516868, "agent_to_module_mapping": 0.0031051628282363956, "general_advantage_estimation": 0.016286527155576616, "add_time_dim_to_batch_and_zero_pad": 1.1543814053807064e-05, "add_columns_from_episodes_to_train_batch": 0.04604661225928942, "add_states_from_episodes_to_batch": 3.6137549609085188e-06, "numpy_to_tensor": 0.00020787902891578972, "batch_individual_items": 0.10118328782002114, "add_observations_from_episodes_to_batch": 0.0003156097217323172}}, "connector_pipeline_timer": 0.17239040882858173}, "learner_connector_sum_episodes_length_in": 1996.6619449541995, "num_env_steps_trained": 1446000, "num_module_steps_trained_lifetime": 1986176, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 30850000, "num_module_steps_trained": 92544, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.6619449541995, "num_env_steps_trained_lifetime_throughput": 1094693.8281178316, "num_module_steps_trained_throughput": 70323.67922746876, "num_module_steps_trained_lifetime_throughput": 70324.28912536798}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.013060092926025, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.902153015136719, "total_loss": 9.884913444519043, "num_module_steps_trained": 92544, "num_trainable_parameters": 149763, "entropy": 0.4058079421520233, "vf_loss_unclipped": 3994.6142578125, "weights_seq_no": 24.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.08699500560760498, "policy_loss": -0.018246598541736603, "mean_kl_loss": 0.01687919721007347, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 1986176, "num_module_steps_trained_lifetime_throughput": 70324.39519795385}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 27000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 24, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-07", "timestamp": 1750909867, "time_this_iter_s": 2.2302441596984863, "time_total_s": 482.5843484401703, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b133a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 482.5843484401703, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.23333333333333, "ram_util_percent": 51.9}}
{"timers": {"training_iteration": 5.7070137793563775, "restore_env_runners": 0.0017368565099481314, "training_step": 5.70515616230743, "env_runner_sampling_timer": 4.485214333849226, "learner_update_timer": 1.2179383925680716, "synch_weights": 0.0008922231542338869, "synch_env_connectors": 0.01008264168124576}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.757781948542798e-06, "batch_individual_items": 9.197731542829572e-06, "add_time_dim_to_batch_and_zero_pad": 2.512892422083561e-06, "add_observations_from_episodes_to_batch": 1.500840809583181e-05, "add_states_from_episodes_to_batch": 1.6485804691043955e-06, "agent_to_module_mapping": 2.8084348584836695e-06}}, "connector_pipeline_timer": 6.724589126198667e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 426.7987256956101, "vehicle_5": 510.37459052085876, "vehicle_3": 81.49066014528275, "vehicle_2": 203.59567339181893, "vehicle_4": 611.6853356075287, "vehicle_0": 190.42882417917252}, "sample": 0.13315638044730443, "rlmodule_inference_timer": 6.381358227897538e-05, "agent_steps": {"vehicle_5": 107.96, "vehicle_3": 44.29999999999999, "vehicle_2": 89.78, "vehicle_0": 44.87999999999999, "vehicle_4": 108.0, "vehicle_1": 95.16}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.18, "env_step_timer": 0.0001495783558948545, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.632987820528279e-05, "tensor_to_numpy": 1.6541316914353697e-05, "module_to_agent_unmapping": 1.6666066151487363e-06, "normalize_and_clip_actions": 4.8246424206483205e-05, "remove_single_ts_time_rank_from_batch": 6.636752064025417e-07, "un_batch_to_individual_items": 1.5616316806094925e-05, "listify_data_for_vector_env": 6.875355881891631e-06}}, "connector_pipeline_timer": 0.00015681754916934106}, "num_agent_steps_sampled": {"vehicle_5": 1979.0000000000002, "vehicle_3": 865.0, "vehicle_2": 1614.0000000000002, "vehicle_4": 1978.0, "vehicle_0": 884.0, "vehicle_1": 1712.0}, "env_to_module_sum_episodes_length_in": 49.386211838937356, "num_agent_steps_sampled_lifetime": {"vehicle_0": 12377.0, "vehicle_2": 24621.000000000004, "vehicle_4": 28731.000000000007, "vehicle_1": 26053.000000000004, "vehicle_5": 28572.0, "vehicle_3": 12300.0}, "episode_return_mean": 2024.3738084959984, "num_env_steps_sampled_lifetime": 29000.0, "time_between_sampling": 0.31048473305492025, "episode_return_min": 1672.8365333080292, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 132654.0}, "module_episode_returns_mean": {"shared_policy": 807.3607796120646}, "episode_len_min": 108, "weights_seq_no": 24.0, "episode_duration_sec_mean": 0.06963519809854915, "num_module_steps_sampled": {"shared_policy": 9032.0}, "num_episodes_lifetime": 262.0, "episode_return_max": 2410.9601986408234, "env_to_module_sum_episodes_length_out": 49.386211838937356, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1607.2431827256667}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005078476614347901, "agent_to_module_mapping": 0.003113659119904596, "general_advantage_estimation": 0.01632089355404752, "add_time_dim_to_batch_and_zero_pad": 1.15421259063027e-05, "add_columns_from_episodes_to_train_batch": 0.04619033863665555, "add_states_from_episodes_to_batch": 3.6042874339342227e-06, "numpy_to_tensor": 0.0002066969086527544, "batch_individual_items": 0.10140677327182109, "add_observations_from_episodes_to_batch": 0.0003176236244462345}}, "connector_pipeline_timer": 0.17281993016026095}, "learner_connector_sum_episodes_length_in": 1996.6953255046574, "num_env_steps_trained": 1454000, "num_module_steps_trained_lifetime": 2079232, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 32304000, "num_module_steps_trained": 93056, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.6953255046574, "num_env_steps_trained_lifetime_throughput": 1092336.974606283, "num_module_steps_trained_throughput": 70160.23984388022, "num_module_steps_trained_lifetime_throughput": 70160.53033255323}, "shared_policy": {"gradients_default_optimizer_global_norm": 4.553465843200684, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.76840877532959, "total_loss": 9.604045867919922, "num_module_steps_trained": 93056, "num_trainable_parameters": 149763, "entropy": 0.26275309920310974, "vf_loss_unclipped": 4733.0322265625, "weights_seq_no": 25.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.10601770877838135, "policy_loss": -0.16372980177402496, "mean_kl_loss": 0.006644383072853088, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2079232, "num_module_steps_trained_lifetime_throughput": 70161.06141553193}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 29000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 25, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-09", "timestamp": 1750909869, "time_this_iter_s": 2.270461320877075, "time_total_s": 484.85480976104736, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a7ec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 484.85480976104736, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 13.799999999999999, "ram_util_percent": 51.9}}
{"timers": {"training_iteration": 5.670959892392812, "restore_env_runners": 0.0017195312748497127, "training_step": 5.669119420684337, "env_runner_sampling_timer": 4.447457779680719, "learner_update_timer": 1.2196535923923977, "synch_weights": 0.0008918388426214976, "synch_env_connectors": 0.009994175264397548}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0000435557920576e-05, "batch_individual_items": 9.291574323743919e-06, "add_time_dim_to_batch_and_zero_pad": 2.577134703898873e-06, "add_observations_from_episodes_to_batch": 1.4957408090672084e-05, "add_states_from_episodes_to_batch": 1.679768198838148e-06, "agent_to_module_mapping": 2.8108268477552823e-06}}, "connector_pipeline_timer": 6.812850811742483e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 382.8366704201698, "vehicle_5": 526.3094001483918, "vehicle_3": 94.86888147592545, "vehicle_2": 157.7439291572571, "vehicle_4": 608.5469360637665, "vehicle_0": 199.76370914816857}, "sample": 0.13313649186486837, "rlmodule_inference_timer": 6.467516817525785e-05, "agent_steps": {"vehicle_5": 108.11999999999998, "vehicle_3": 46.34000000000001, "vehicle_2": 81.26, "vehicle_0": 47.220000000000006, "vehicle_4": 108.0, "vehicle_1": 85.2}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.36, "env_step_timer": 0.00014952072475844753, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.753441483535355e-05, "tensor_to_numpy": 1.6960640324389988e-05, "module_to_agent_unmapping": 1.6820123324147116e-06, "normalize_and_clip_actions": 4.6364485905591756e-05, "remove_single_ts_time_rank_from_batch": 6.727167600809853e-07, "un_batch_to_individual_items": 1.5327733444268916e-05, "listify_data_for_vector_env": 6.62537357083053e-06}}, "connector_pipeline_timer": 0.00015634828457122813}, "num_agent_steps_sampled": {"vehicle_5": 1977.0, "vehicle_3": 747.9999999999999, "vehicle_2": 1485.9999999999998, "vehicle_4": 1970.0, "vehicle_0": 756.0, "vehicle_1": 1574.0000000000002}, "env_to_module_sum_episodes_length_in": 47.85236859598545, "num_agent_steps_sampled_lifetime": {"vehicle_0": 13133.0, "vehicle_2": 26107.000000000004, "vehicle_4": 30701.000000000007, "vehicle_1": 27627.0, "vehicle_5": 30549.0, "vehicle_3": 13048.0}, "episode_return_mean": 1970.0695258510113, "num_env_steps_sampled_lifetime": 31000.0, "time_between_sampling": 0.31112597877939624, "episode_return_min": 1697.0010304450989, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 141165.0}, "module_episode_returns_mean": {"shared_policy": 921.5013422310351}, "episode_len_min": 108, "weights_seq_no": 25.0, "episode_duration_sec_mean": 0.0688038216411951, "num_module_steps_sampled": {"shared_policy": 8511.0}, "num_episodes_lifetime": 281.0, "episode_return_max": 2588.4943804740906, "env_to_module_sum_episodes_length_out": 47.85236859598545, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1616.3671981838788}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005094874348192543, "agent_to_module_mapping": 0.003119821688663461, "general_advantage_estimation": 0.01631791419850371, "add_time_dim_to_batch_and_zero_pad": 1.1522954652538897e-05, "add_columns_from_episodes_to_train_batch": 0.046288088170271906, "add_states_from_episodes_to_batch": 3.5915845947083866e-06, "numpy_to_tensor": 0.00020551118958261812, "batch_individual_items": 0.10082037511905187, "add_observations_from_episodes_to_batch": 0.0003195261382385455}}, "connector_pipeline_timer": 0.1723509991886901}, "learner_connector_sum_episodes_length_in": 1996.7283722496109, "num_env_steps_trained": 1374000, "num_module_steps_trained_lifetime": 2167168, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 33678000, "num_module_steps_trained": 87936, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.7283722496109, "num_env_steps_trained_lifetime_throughput": 1092473.1950219264, "num_module_steps_trained_throughput": 70156.41328271583, "num_module_steps_trained_lifetime_throughput": 70156.69875074507}, "shared_policy": {"gradients_default_optimizer_global_norm": 3.1000075340270996, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.763596534729004, "total_loss": 9.791254043579102, "num_module_steps_trained": 87936, "num_trainable_parameters": 149763, "entropy": 0.34024718403816223, "vf_loss_unclipped": 3840.306884765625, "weights_seq_no": 26.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.009261012077331543, "policy_loss": 0.0268536489456892, "mean_kl_loss": 0.014021547511219978, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2167168, "num_module_steps_trained_lifetime_throughput": 70157.17465256125}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 31000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 26, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-11", "timestamp": 1750909871, "time_this_iter_s": 2.1038191318511963, "time_total_s": 486.95862889289856, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a6de0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 486.95862889289856, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 14.166666666666666, "ram_util_percent": 51.9}}
{"timers": {"training_iteration": 5.635737324718883, "restore_env_runners": 0.0017023743021050274, "training_step": 5.633913812317476, "env_runner_sampling_timer": 4.410066629383877, "learner_update_timer": 1.2218352656284597, "synch_weights": 0.0008912471241901407, "synch_env_connectors": 0.009904929761782132}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.906647856684243e-06, "batch_individual_items": 9.293328603297881e-06, "add_time_dim_to_batch_and_zero_pad": 2.576713485645529e-06, "add_observations_from_episodes_to_batch": 1.5181746697574714e-05, "add_states_from_episodes_to_batch": 1.6743773801573462e-06, "agent_to_module_mapping": 2.836816534226752e-06}}, "connector_pipeline_timer": 6.826608928954787e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 435.2447018384934, "vehicle_5": 514.8640315723419, "vehicle_3": 93.56586518287656, "vehicle_2": 234.24179401159287, "vehicle_4": 608.7440639925004, "vehicle_0": 163.75880620479583}, "sample": 0.1331365010635038, "rlmodule_inference_timer": 6.478011781765224e-05, "agent_steps": {"vehicle_5": 108.78, "vehicle_3": 41.16, "vehicle_2": 89.70000000000002, "vehicle_0": 41.16, "vehicle_4": 107.96, "vehicle_1": 96.82}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.88, "env_step_timer": 0.0001531190549421554, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6255062741191865e-05, "tensor_to_numpy": 1.6902279247846003e-05, "module_to_agent_unmapping": 1.7014760361124996e-06, "normalize_and_clip_actions": 4.867873803892773e-05, "remove_single_ts_time_rank_from_batch": 6.735338750300692e-07, "un_batch_to_individual_items": 1.5641543784758492e-05, "listify_data_for_vector_env": 6.925313534646516e-06}}, "connector_pipeline_timer": 0.0001580280222558616}, "num_agent_steps_sampled": {"vehicle_5": 1980.0, "vehicle_3": 762.9999999999999, "vehicle_2": 1639.0000000000002, "vehicle_4": 1967.0, "vehicle_0": 762.9999999999999, "vehicle_1": 1772.0}, "env_to_module_sum_episodes_length_in": 47.9119263492776, "num_agent_steps_sampled_lifetime": {"vehicle_0": 13896.0, "vehicle_2": 27746.000000000004, "vehicle_4": 32668.000000000007, "vehicle_1": 29399.0, "vehicle_5": 32529.0, "vehicle_3": 13811.0}, "episode_return_mean": 2050.4192636418343, "num_env_steps_sampled_lifetime": 33000.0, "time_between_sampling": 0.3100570716218031, "episode_return_min": 1697.0010304450989, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 150049.0}, "module_episode_returns_mean": {"shared_policy": 950.0116699361802}, "episode_len_min": 108, "weights_seq_no": 26.0, "episode_duration_sec_mean": 0.06978600072048721, "num_module_steps_sampled": {"shared_policy": 8884.0}, "num_episodes_lifetime": 300.0, "episode_return_max": 2210.09653031826, "env_to_module_sum_episodes_length_out": 47.9119263492776, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1605.1530997449868}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0051138235147085796, "agent_to_module_mapping": 0.003126644721779029, "general_advantage_estimation": 0.01634374713652765, "add_time_dim_to_batch_and_zero_pad": 1.1521055130773724e-05, "add_columns_from_episodes_to_train_batch": 0.04640973437860096, "add_states_from_episodes_to_batch": 3.5819187303630255e-06, "numpy_to_tensor": 0.00020447815764630372, "batch_individual_items": 0.10025103178789713, "add_observations_from_episodes_to_batch": 0.00032131878685315855}}, "connector_pipeline_timer": 0.1719552066967562}, "learner_connector_sum_episodes_length_in": 1996.7610885271147, "num_env_steps_trained": 1430000, "num_module_steps_trained_lifetime": 2258688, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 35108000, "num_module_steps_trained": 91520, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.7610885271147, "num_env_steps_trained_lifetime_throughput": 1093243.3586181952, "num_module_steps_trained_throughput": 70193.47054738873, "num_module_steps_trained_lifetime_throughput": 70193.7965955628}, "shared_policy": {"gradients_default_optimizer_global_norm": 3.121755599975586, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.741006851196289, "total_loss": 9.666513442993164, "num_module_steps_trained": 91520, "num_trainable_parameters": 149763, "entropy": 0.3666798770427704, "vf_loss_unclipped": 4385.9013671875, "weights_seq_no": 27.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.02604842185974121, "policy_loss": -0.07310596853494644, "mean_kl_loss": 0.0075986068695783615, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2258688, "num_module_steps_trained_lifetime_throughput": 70194.1374318269}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 33000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 27, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-13", "timestamp": 1750909873, "time_this_iter_s": 2.1506781578063965, "time_total_s": 489.10930705070496, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a63e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 489.10930705070496, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 14.233333333333334, "ram_util_percent": 51.833333333333336}}
{"timers": {"training_iteration": 5.602021436051711, "restore_env_runners": 0.0016853963991448977, "training_step": 5.600214617524297, "env_runner_sampling_timer": 4.373094116010015, "learner_update_timer": 1.2251047496421745, "synch_weights": 0.0008901142329944292, "synch_env_connectors": 0.009814176294139706}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.98168687058975e-06, "batch_individual_items": 9.288363353922767e-06, "add_time_dim_to_batch_and_zero_pad": 2.557278572696881e-06, "add_observations_from_episodes_to_batch": 1.5072021600478299e-05, "add_states_from_episodes_to_batch": 1.6631146014970107e-06, "agent_to_module_mapping": 2.8460582231120293e-06}}, "connector_pipeline_timer": 6.80736827136301e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 437.78179512500765, "vehicle_5": 513.0496749782562, "vehicle_3": 112.57218486785888, "vehicle_2": 252.9874989700317, "vehicle_4": 606.664751329422, "vehicle_0": 161.8486752462387}, "sample": 0.13315955000859483, "rlmodule_inference_timer": 6.608687581893051e-05, "agent_steps": {"vehicle_5": 108.74, "vehicle_3": 40.900000000000006, "vehicle_2": 90.38000000000002, "vehicle_0": 40.900000000000006, "vehicle_4": 108.0, "vehicle_1": 97.86}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.74, "env_step_timer": 0.00015378569790528674, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.668356334430637e-05, "tensor_to_numpy": 1.68409123081144e-05, "module_to_agent_unmapping": 1.674457935447871e-06, "normalize_and_clip_actions": 4.768923984808219e-05, "remove_single_ts_time_rank_from_batch": 6.678297069818959e-07, "un_batch_to_individual_items": 1.5455440764645096e-05, "listify_data_for_vector_env": 6.7639704797616005e-06}}, "connector_pipeline_timer": 0.0001569076657311807}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 745.0, "vehicle_2": 1678.0, "vehicle_4": 1968.0, "vehicle_0": 745.0, "vehicle_1": 1813.0}, "env_to_module_sum_episodes_length_in": 50.164985527567865, "num_agent_steps_sampled_lifetime": {"vehicle_0": 14641.0, "vehicle_2": 29424.000000000004, "vehicle_4": 34636.00000000001, "vehicle_1": 31212.0, "vehicle_5": 34511.0, "vehicle_3": 14556.0}, "episode_return_mean": 2084.9045809793465, "num_env_steps_sampled_lifetime": 35000.0, "time_between_sampling": 0.30944579607250355, "episode_return_min": 1739.0075492858887, "episode_len_max": 111, "num_module_steps_sampled_lifetime": {"shared_policy": 158980.0}, "module_episode_returns_mean": {"shared_policy": 894.6387465429306}, "episode_len_min": 108, "weights_seq_no": 27.0, "episode_duration_sec_mean": 0.06943855996083585, "num_module_steps_sampled": {"shared_policy": 8931.0}, "num_episodes_lifetime": 318.0, "episode_return_max": 2174.2904558181763, "env_to_module_sum_episodes_length_out": 50.164985527567865, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1610.0761690039465}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0051348869495343495, "agent_to_module_mapping": 0.003134844524579688, "general_advantage_estimation": 0.01637072216517702, "add_time_dim_to_batch_and_zero_pad": 1.1493344590897971e-05, "add_columns_from_episodes_to_train_batch": 0.04654552912484601, "add_states_from_episodes_to_batch": 3.574849543697351e-06, "numpy_to_tensor": 0.0002033433760868699, "batch_individual_items": 0.10048413562997753, "add_observations_from_episodes_to_batch": 0.00032333059897086665}}, "connector_pipeline_timer": 0.1723807796298132}, "learner_connector_sum_episodes_length_in": 1996.7934776418435, "num_env_steps_trained": 1438000, "num_module_steps_trained_lifetime": 2350720, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 36546000, "num_module_steps_trained": 92032, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.7934776418435, "num_env_steps_trained_lifetime_throughput": 1092939.2890355594, "num_module_steps_trained_throughput": 70162.67353484088, "num_module_steps_trained_lifetime_throughput": 70163.0565831739}, "shared_policy": {"gradients_default_optimizer_global_norm": 4.527290344238281, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.72338581085205, "total_loss": 9.73621654510498, "num_module_steps_trained": 92032, "num_trainable_parameters": 149763, "entropy": 0.30828985571861267, "vf_loss_unclipped": 4259.66748046875, "weights_seq_no": 28.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.1511141061782837, "policy_loss": 0.013576554134488106, "mean_kl_loss": 0.007791152223944664, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2350720, "num_module_steps_trained_lifetime_throughput": 70163.27540832786}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 35000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 28, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-16", "timestamp": 1750909876, "time_this_iter_s": 2.2666261196136475, "time_total_s": 491.3759331703186, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 491.3759331703186, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 14.3, "ram_util_percent": 51.775000000000006}}
{"timers": {"training_iteration": 5.5673961254412365, "restore_env_runners": 0.0016685857751225733, "training_step": 5.5656058038489915, "env_runner_sampling_timer": 4.3363829085999, "learner_update_timer": 1.2272025863157838, "synch_weights": 0.0008899564207004256, "synch_env_connectors": 0.00972956244117602}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0125000446569175e-05, "add_time_dim_to_batch_and_zero_pad": 6.4374980865977705e-06, "add_observations_from_episodes_to_batch": 3.0832998163532466e-05, "add_states_from_episodes_to_batch": 3.187000402249396e-06, "agent_to_module_mapping": 4.95849599246867e-06, "numpy_to_tensor": 2.2937500034458935e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.770400311410115e-06, "batch_individual_items": 9.104565877343134e-06, "add_time_dim_to_batch_and_zero_pad": 2.5364163195552542e-06, "add_observations_from_episodes_to_batch": 1.4909554882780138e-05, "add_states_from_episodes_to_batch": 1.6554684091230963e-06, "agent_to_module_mapping": 2.776032092869221e-06}}, "connector_pipeline_timer": 6.716569840976901e-05}, "env_reset_timer": 0.00010020850095315836, "agent_episode_returns_mean": {"vehicle_1": 434.649514632225, "vehicle_5": 517.8356723451615, "vehicle_3": 110.98998626947403, "vehicle_2": 233.47961054801942, "vehicle_4": 601.1153427124024, "vehicle_0": 168.7251309561729}, "sample": 0.13321189579201337, "rlmodule_inference_timer": 6.435745672615949e-05, "agent_steps": {"vehicle_5": 109.24, "vehicle_3": 41.02000000000001, "vehicle_2": 89.57999999999998, "vehicle_0": 41.02000000000001, "vehicle_4": 108.0, "vehicle_1": 96.72}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.24, "env_step_timer": 0.00015013779217373495, "connector_pipeline_timer": 0.000194729000213556, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6521644298155204e-05, "tensor_to_numpy": 1.6632554659197165e-05, "module_to_agent_unmapping": 1.6544194424548656e-06, "normalize_and_clip_actions": 4.7039522191981694e-05, "remove_single_ts_time_rank_from_batch": 6.706214711674392e-07, "un_batch_to_individual_items": 1.5201060831978522e-05, "listify_data_for_vector_env": 6.746659171539231e-06}}, "connector_pipeline_timer": 0.0001552886890725799}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 727.9999999999999, "vehicle_2": 1627.0, "vehicle_4": 1957.0, "vehicle_0": 727.9999999999999, "vehicle_1": 1757.0}, "env_to_module_sum_episodes_length_in": 50.464128414489856, "num_agent_steps_sampled_lifetime": {"vehicle_0": 15369.0, "vehicle_2": 31051.0, "vehicle_4": 36593.000000000015, "vehicle_1": 32969.0, "vehicle_5": 36493.0, "vehicle_3": 15284.0}, "episode_return_mean": 2066.7952575206755, "num_env_steps_sampled_lifetime": 37000.0, "time_between_sampling": 0.3099923813261154, "episode_return_min": 1735.0750663280487, "episode_len_max": 112, "num_module_steps_sampled_lifetime": {"shared_policy": 167759.0}, "module_episode_returns_mean": {"shared_policy": 876.0767514801025}, "episode_len_min": 108, "weights_seq_no": 28.0, "episode_duration_sec_mean": 0.06968461502037826, "num_module_steps_sampled": {"shared_policy": 8779.0}, "num_episodes_lifetime": 336.0, "episode_return_max": 2184.285109400749, "env_to_module_sum_episodes_length_out": 50.464128414489856, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1617.3091149135107}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00514886266003029, "agent_to_module_mapping": 0.003142642329316769, "general_advantage_estimation": 0.016401105773498244, "add_time_dim_to_batch_and_zero_pad": 1.14546611435175e-05, "add_columns_from_episodes_to_train_batch": 0.046658622163610844, "add_states_from_episodes_to_batch": 3.557851045512976e-06, "numpy_to_tensor": 0.0002022253623493764, "batch_individual_items": 0.09992339635367821, "add_observations_from_episodes_to_batch": 0.00032494729294958616}}, "connector_pipeline_timer": 0.1719850705835335}, "learner_connector_sum_episodes_length_in": 1996.8255428654252, "num_env_steps_trained": 1414000, "num_module_steps_trained_lifetime": 2441216, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 37960000, "num_module_steps_trained": 90496, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.8255428654252, "num_env_steps_trained_lifetime_throughput": 1093012.6321272508, "num_module_steps_trained_throughput": 70156.62327857371, "num_module_steps_trained_lifetime_throughput": 70156.98766382616}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.845966815948486, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.825517654418945, "total_loss": 9.699261665344238, "num_module_steps_trained": 90496, "num_trainable_parameters": 149763, "entropy": 0.23723922669887543, "vf_loss_unclipped": 4451.2060546875, "weights_seq_no": 29.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.14112424850463867, "policy_loss": -0.12678654491901398, "mean_kl_loss": 0.009676269255578518, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2441216, "num_module_steps_trained_lifetime_throughput": 70157.1418182955}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 37000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 29, "trial_id": "a8246_00000", "date": "2025-06-25_20-51-18", "timestamp": 1750909878, "time_this_iter_s": 2.1419148445129395, "time_total_s": 493.51784801483154, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b105620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 493.51784801483154, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 14.133333333333335, "ram_util_percent": 51.76666666666667}}
{"timers": {"training_iteration": 6.150760810846798, "restore_env_runners": 0.0016519411673216475, "training_step": 6.148987034980511, "env_runner_sampling_timer": 4.916738157853901, "learner_update_timer": 1.2302236000425861, "synch_weights": 0.0008898397665018703, "synch_env_connectors": 0.009643981816764808}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0108399621676653e-05, "add_time_dim_to_batch_and_zero_pad": 6.374997610691935e-06, "add_observations_from_episodes_to_batch": 3.077459841733798e-05, "add_states_from_episodes_to_batch": 3.1661998946219684e-06, "agent_to_module_mapping": 4.958595673087984e-06, "numpy_to_tensor": 2.3600000713486224e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.814347419095375e-06, "batch_individual_items": 9.200136113185942e-06, "add_time_dim_to_batch_and_zero_pad": 2.540407682810057e-06, "add_observations_from_episodes_to_batch": 1.4962369025173476e-05, "add_states_from_episodes_to_batch": 1.6858805710478529e-06, "agent_to_module_mapping": 2.814907993693298e-06}}, "connector_pipeline_timer": 6.766438338893367e-05}, "env_reset_timer": 9.896680130623281e-05, "agent_episode_returns_mean": {"vehicle_1": 433.6637819433212, "vehicle_5": 518.780875029564, "vehicle_3": 99.2365031647682, "vehicle_2": 244.26740708827973, "vehicle_4": 586.2851420545577, "vehicle_0": 187.62663118600847}, "sample": 0.13351105908950267, "rlmodule_inference_timer": 6.343867052403098e-05, "agent_steps": {"vehicle_5": 108.64, "vehicle_3": 44.44, "vehicle_2": 89.35999999999999, "vehicle_0": 44.86000000000001, "vehicle_4": 107.96, "vehicle_1": 96.88}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.64, "env_step_timer": 0.00014960987147005382, "connector_pipeline_timer": 0.00019489139958750457, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.633554677576278e-05, "tensor_to_numpy": 1.6589074570978397e-05, "module_to_agent_unmapping": 1.6650196704086268e-06, "normalize_and_clip_actions": 4.687033572754817e-05, "remove_single_ts_time_rank_from_batch": 6.602101640910156e-07, "un_batch_to_individual_items": 1.5419221653854846e-05, "listify_data_for_vector_env": 6.661052872339233e-06}}, "connector_pipeline_timer": 0.00015510169927599243}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 770.0, "vehicle_2": 1639.0000000000002, "vehicle_4": 1970.9999999999998, "vehicle_0": 777.0000000000001, "vehicle_1": 1774.0000000000002}, "env_to_module_sum_episodes_length_in": 49.723665499447996, "num_agent_steps_sampled_lifetime": {"vehicle_0": 16146.0, "vehicle_2": 32690.0, "vehicle_4": 38564.000000000015, "vehicle_1": 34743.0, "vehicle_5": 38475.0, "vehicle_3": 16054.0}, "episode_return_mean": 2069.860341200828, "num_env_steps_sampled_lifetime": 39000.0, "time_between_sampling": 0.41127637663173056, "episode_return_min": 1673.58580327034, "episode_len_max": 111, "num_module_steps_sampled_lifetime": {"shared_policy": 176672.0}, "module_episode_returns_mean": {"shared_policy": 886.1631021380424}, "episode_len_min": 108, "weights_seq_no": 29.0, "episode_duration_sec_mean": 0.06909569234136143, "num_module_steps_sampled": {"shared_policy": 8913.0}, "num_episodes_lifetime": 354.0, "episode_return_max": 2374.800725221634, "env_to_module_sum_episodes_length_out": 49.723665499447996, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1608.8339070170462}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005179565693397053, "agent_to_module_mapping": 0.003153580905995652, "general_advantage_estimation": 0.016424271795769482, "add_time_dim_to_batch_and_zero_pad": 1.1451784547112867e-05, "add_columns_from_episodes_to_train_batch": 0.04679615677200503, "add_states_from_episodes_to_batch": 3.5506024946627354e-06, "numpy_to_tensor": 0.00020109685869193592, "batch_individual_items": 0.10017369530014708, "add_observations_from_episodes_to_batch": 0.0003279132300506537}}, "connector_pipeline_timer": 0.17243941612767819}, "learner_connector_sum_episodes_length_in": 1996.857287436771, "num_env_steps_trained": 1434000, "num_module_steps_trained_lifetime": 2532992, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 39394000, "num_module_steps_trained": 91776, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.857287436771, "num_env_steps_trained_lifetime_throughput": 1092784.4720445822, "num_module_steps_trained_throughput": 70131.91173147931, "num_module_steps_trained_lifetime_throughput": 70132.18872985696}, "shared_policy": {"gradients_default_optimizer_global_norm": 4.408917427062988, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.728464126586914, "total_loss": 9.780795097351074, "num_module_steps_trained": 91776, "num_trainable_parameters": 149763, "entropy": 0.302899569272995, "vf_loss_unclipped": 3840.28271484375, "weights_seq_no": 30.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.0397147536277771, "policy_loss": 0.052816569805145264, "mean_kl_loss": 0.008482356555759907, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2532992, "num_module_steps_trained_lifetime_throughput": 70132.38557154288}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 39000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 7}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 30, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-22", "timestamp": 1750909942, "time_this_iter_s": 63.906256914138794, "time_total_s": 557.4241049289703, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 557.4241049289703, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 12.54, "ram_util_percent": 51.919999999999995}}
{"timers": {"training_iteration": 6.110888363148262, "restore_env_runners": 0.0016747938456076463, "training_step": 6.10909100797072, "env_runner_sampling_timer": 4.8746768487753895, "learner_update_timer": 1.2323837386321628, "synch_weights": 0.0008887405288487793, "synch_env_connectors": 0.009555756998576987}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0131751271914731e-05, "batch_individual_items": 9.602895597991541e-06, "add_time_dim_to_batch_and_zero_pad": 2.7106210655788606e-06, "add_observations_from_episodes_to_batch": 1.5390117539072666e-05, "add_states_from_episodes_to_batch": 1.7256214667195907e-06, "agent_to_module_mapping": 2.8936689436517415e-06}}, "connector_pipeline_timer": 6.999261944339608e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 423.0141956172671, "vehicle_5": 520.1318717840741, "vehicle_3": 124.90537064007349, "vehicle_2": 249.43287877253127, "vehicle_4": 597.6920531954083, "vehicle_0": 162.54593037366863}, "sample": 0.13225561751796067, "rlmodule_inference_timer": 6.737485256576015e-05, "agent_steps": {"vehicle_5": 108.64, "vehicle_3": 40.78285714285715, "vehicle_2": 88.25142857142855, "vehicle_0": 40.78285714285715, "vehicle_4": 107.98285714285714, "vehicle_1": 95.25428571428569}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.64, "env_step_timer": 0.00015040547523349998, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.975218452578349e-05, "tensor_to_numpy": 1.8649723734373217e-05, "module_to_agent_unmapping": 1.7990080430552326e-06, "normalize_and_clip_actions": 4.988353682632206e-05, "remove_single_ts_time_rank_from_batch": 6.917995484771006e-07, "un_batch_to_individual_items": 1.5949517733288247e-05, "listify_data_for_vector_env": 6.959088866559199e-06}}, "connector_pipeline_timer": 0.00016653304061773337}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 735.0, "vehicle_2": 1599.0000000000002, "vehicle_4": 1969.0000000000002, "vehicle_0": 735.0, "vehicle_1": 1733.0}, "env_to_module_sum_episodes_length_in": 47.32649637014689, "num_agent_steps_sampled_lifetime": {"vehicle_0": 26807.0, "vehicle_2": 54213.000000000015, "vehicle_4": 65124.0, "vehicle_1": 57804.0, "vehicle_5": 65206.0, "vehicle_3": 26607.0}, "episode_return_mean": 2077.722304798535, "num_env_steps_sampled_lifetime": 66000.0, "time_between_sampling": 0.6197929858018666, "episode_return_min": 1694.1262488365173, "episode_len_max": 111, "num_module_steps_sampled_lifetime": {"shared_policy": 295760.99999999994}, "module_episode_returns_mean": {"shared_policy": 982.460142640727}, "episode_len_min": 108, "weights_seq_no": 30.0, "episode_duration_sec_mean": 0.0687742458975533, "num_module_steps_sampled": {"shared_policy": 8753.0}, "num_episodes_lifetime": 603.9999999999999, "episode_return_max": 2208.484057188034, "env_to_module_sum_episodes_length_out": 47.32649637014689, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1589.4104379250675}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005195685866467578, "agent_to_module_mapping": 0.0031613996869071766, "general_advantage_estimation": 0.016450591577804454, "add_time_dim_to_batch_and_zero_pad": 1.1455186691503287e-05, "add_columns_from_episodes_to_train_batch": 0.046910408534265716, "add_states_from_episodes_to_batch": 3.541346524077407e-06, "numpy_to_tensor": 0.00019994297011780926, "batch_individual_items": 0.0996021970971958, "add_observations_from_episodes_to_batch": 0.0003296470077919888}}, "connector_pipeline_timer": 0.17203250779640583}, "learner_connector_sum_episodes_length_in": 1996.8887145624033, "num_env_steps_trained": 1410000, "num_module_steps_trained_lifetime": 2623232, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 40804000, "num_module_steps_trained": 90240, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.8887145624033, "num_env_steps_trained_lifetime_throughput": 1092629.7765108596, "num_module_steps_trained_throughput": 70112.32669734693, "num_module_steps_trained_lifetime_throughput": 70112.57035948317}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.2422821521759033, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.829434394836426, "total_loss": 9.575409889221191, "num_module_steps_trained": 90240, "num_trainable_parameters": 149763, "entropy": 0.198390394449234, "vf_loss_unclipped": 4828.990234375, "weights_seq_no": 31.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.027626991271972656, "policy_loss": -0.25468164682388306, "mean_kl_loss": 0.008803330361843109, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2623232, "num_module_steps_trained_lifetime_throughput": 70112.860883728}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 66000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 31, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-24", "timestamp": 1750909944, "time_this_iter_s": 2.1655962467193604, "time_total_s": 559.5897011756897, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a6c00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 559.5897011756897, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.23333333333333, "ram_util_percent": 52.03333333333333}}
{"timers": {"training_iteration": 6.07147321243681, "restore_env_runners": 0.0016580921571399425, "training_step": 6.069692300390993, "env_runner_sampling_timer": 4.833406798207634, "learner_update_timer": 1.234251145415838, "synch_weights": 0.0008885764635575234, "synch_env_connectors": 0.009468759008537667}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.825412360013904e-06, "batch_individual_items": 9.100166109850448e-06, "add_time_dim_to_batch_and_zero_pad": 2.6053909196371452e-06, "add_observations_from_episodes_to_batch": 1.4757987470779998e-05, "add_states_from_episodes_to_batch": 1.6426139034940246e-06, "agent_to_module_mapping": 2.7678498715904503e-06}}, "connector_pipeline_timer": 6.708528651820876e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 431.3104244232178, "vehicle_5": 510.3149221324921, "vehicle_3": 94.13597187042238, "vehicle_2": 246.1771274137497, "vehicle_4": 610.5198180294037, "vehicle_0": 174.3562552022934}, "sample": 0.1323006915559942, "rlmodule_inference_timer": 7.13998276987181e-05, "agent_steps": {"vehicle_5": 108.55999999999999, "vehicle_3": 44.7, "vehicle_2": 90.08, "vehicle_0": 42.52, "vehicle_4": 108.0, "vehicle_1": 97.13999999999999}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.68, "env_step_timer": 0.00014683421327591728, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6872002738323195e-05, "tensor_to_numpy": 1.6561453379499826e-05, "module_to_agent_unmapping": 1.6618343488885403e-06, "normalize_and_clip_actions": 4.595215364380496e-05, "remove_single_ts_time_rank_from_batch": 6.612477503379683e-07, "un_batch_to_individual_items": 1.5001418902739153e-05, "listify_data_for_vector_env": 6.5270042340854295e-06}}, "connector_pipeline_timer": 0.00015413387736529753}, "num_agent_steps_sampled": {"vehicle_5": 1879.0000000000002, "vehicle_3": 886.0, "vehicle_2": 1568.0, "vehicle_4": 1870.0, "vehicle_0": 777.0000000000001, "vehicle_1": 1689.0000000000002}, "env_to_module_sum_episodes_length_in": 54.11562655514227, "num_agent_steps_sampled_lifetime": {"vehicle_0": 27583.999999999993, "vehicle_2": 55781.000000000015, "vehicle_4": 66993.99999999999, "vehicle_1": 59493.0, "vehicle_5": 67085.0, "vehicle_3": 27493.0}, "episode_return_mean": 2066.814518518448, "num_env_steps_sampled_lifetime": 68000.0, "time_between_sampling": 0.5463134959561753, "episode_return_min": 1753.4090234041214, "episode_len_max": 208, "num_module_steps_sampled_lifetime": {"shared_policy": 304429.9999999999}, "module_episode_returns_mean": {"shared_policy": 932.7513435459136}, "episode_len_min": 108, "weights_seq_no": 31.0, "episode_duration_sec_mean": 0.0710054065802251, "num_module_steps_sampled": {"shared_policy": 8669.0}, "num_episodes_lifetime": 621.9999999999999, "episode_return_max": 2729.5589401721954, "env_to_module_sum_episodes_length_out": 54.11562655514227, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1645.633104660886}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0052090402578032794, "agent_to_module_mapping": 0.0031662661100597942, "general_advantage_estimation": 0.016461275662035434, "add_time_dim_to_batch_and_zero_pad": 1.144646479223977e-05, "add_columns_from_episodes_to_train_batch": 0.047016049028931035, "add_states_from_episodes_to_batch": 3.5313431038913744e-06, "numpy_to_tensor": 0.00019897020044594188, "batch_individual_items": 0.0990381592962146, "add_observations_from_episodes_to_batch": 0.00033089053772307014}}, "connector_pipeline_timer": 0.17160289437840898}, "learner_connector_sum_episodes_length_in": 1996.9198274167793, "num_env_steps_trained": 1396000, "num_module_steps_trained_lifetime": 2712576, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 42200000, "num_module_steps_trained": 89344, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.9198274167793, "num_env_steps_trained_lifetime_throughput": 1091468.5881723624, "num_module_steps_trained_throughput": 70029.93614407154, "num_module_steps_trained_lifetime_throughput": 70030.06779270183}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.167929172515869, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.819437980651855, "total_loss": 9.793919563293457, "num_module_steps_trained": 89344, "num_trainable_parameters": 149763, "entropy": 0.2594464123249054, "vf_loss_unclipped": 3844.964111328125, "weights_seq_no": 32.0, "curr_kl_coeff": 0.30000001192092896, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.03363966941833496, "policy_loss": -0.026371872052550316, "mean_kl_loss": 0.011498929932713509, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2712576, "num_module_steps_trained_lifetime_throughput": 70030.69113924395}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 68000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 32, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-26", "timestamp": 1750909946, "time_this_iter_s": 2.1716620922088623, "time_total_s": 561.7613632678986, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a6d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 561.7613632678986, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 14.366666666666667, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 6.032920436982393, "restore_env_runners": 0.001641554985537879, "training_step": 6.031155849887046, "env_runner_sampling_timer": 4.792093855225586, "learner_update_timer": 1.2370239264616565, "synch_weights": 0.0008876731989503954, "synch_env_connectors": 0.009385586838426167}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.589922418764986e-06, "batch_individual_items": 8.983101168885088e-06, "add_time_dim_to_batch_and_zero_pad": 2.5751901441672367e-06, "add_observations_from_episodes_to_batch": 1.4776239031474654e-05, "add_states_from_episodes_to_batch": 1.6247541178446432e-06, "agent_to_module_mapping": 2.7398832968844504e-06}}, "connector_pipeline_timer": 6.647566130506365e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 434.0136655521393, "vehicle_5": 517.1412041878701, "vehicle_3": 107.5518166971207, "vehicle_2": 266.4346725392341, "vehicle_4": 607.4636377525329, "vehicle_0": 170.5983430826664}, "sample": 0.13241593988272854, "rlmodule_inference_timer": 6.370122028239593e-05, "agent_steps": {"vehicle_5": 109.54, "vehicle_3": 44.44, "vehicle_2": 90.48, "vehicle_0": 42.26, "vehicle_4": 108.0, "vehicle_1": 98.08000000000001}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 111.57999999999998, "env_step_timer": 0.0001481588692570825, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.569678363540002e-05, "tensor_to_numpy": 1.6379970618182514e-05, "module_to_agent_unmapping": 1.6396401400115807e-06, "normalize_and_clip_actions": 4.663173223042002e-05, "remove_single_ts_time_rank_from_batch": 6.673102962842086e-07, "un_batch_to_individual_items": 1.5308543303841342e-05, "listify_data_for_vector_env": 6.703510575048831e-06}}, "connector_pipeline_timer": 0.00015362756847693925}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 736.0, "vehicle_2": 1623.0, "vehicle_4": 1948.0, "vehicle_0": 736.0, "vehicle_1": 1762.0}, "env_to_module_sum_episodes_length_in": 49.879823143081595, "num_agent_steps_sampled_lifetime": {"vehicle_0": 28319.999999999993, "vehicle_2": 57404.000000000015, "vehicle_4": 68941.99999999999, "vehicle_1": 61255.000000000015, "vehicle_5": 69067.0, "vehicle_3": 28229.0}, "episode_return_mean": 2103.203341628313, "num_env_steps_sampled_lifetime": 70000.0, "time_between_sampling": 0.5342401333713813, "episode_return_min": 1783.9156440496445, "episode_len_max": 208, "num_module_steps_sampled_lifetime": {"shared_policy": 313216.9999999999}, "module_episode_returns_mean": {"shared_policy": 956.1444776558876}, "episode_len_min": 108, "weights_seq_no": 32.0, "episode_duration_sec_mean": 0.0716540224790515, "num_module_steps_sampled": {"shared_policy": 8787.0}, "num_episodes_lifetime": 640.0, "episode_return_max": 2729.5589401721954, "env_to_module_sum_episodes_length_out": 49.879823143081595, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1645.3974468636256}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00522226360524466, "agent_to_module_mapping": 0.0031704826189137654, "general_advantage_estimation": 0.016476474155396947, "add_time_dim_to_batch_and_zero_pad": 1.141409011746533e-05, "add_columns_from_episodes_to_train_batch": 0.047125307288699535, "add_states_from_episodes_to_batch": 3.5193696352063904e-06, "numpy_to_tensor": 0.00019784299838786155, "batch_individual_items": 0.09928207812328992, "add_observations_from_episodes_to_batch": 0.00033254621234854594}}, "connector_pipeline_timer": 0.17198861918465508}, "learner_connector_sum_episodes_length_in": 1996.9506291426114, "num_env_steps_trained": 1414000, "num_module_steps_trained_lifetime": 2803072, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 43614000, "num_module_steps_trained": 90496, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.9506291426114, "num_env_steps_trained_lifetime_throughput": 1092461.8107534419, "num_module_steps_trained_throughput": 70084.70408466228, "num_module_steps_trained_lifetime_throughput": 70084.81961384711}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.42944860458374, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.791807174682617, "total_loss": 9.79413890838623, "num_module_steps_trained": 90496, "num_trainable_parameters": 149763, "entropy": 0.2862451672554016, "vf_loss_unclipped": 4116.55078125, "weights_seq_no": 33.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.00532078742980957, "policy_loss": -0.0010074963793158531, "mean_kl_loss": 0.02067221887409687, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2803072, "num_module_steps_trained_lifetime_throughput": 70085.56183099303}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 70000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 33, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-28", "timestamp": 1750909948, "time_this_iter_s": 2.2187790870666504, "time_total_s": 563.9801423549652, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a7ce0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 563.9801423549652, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 13.700000000000001, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 5.993907912192619, "restore_env_runners": 0.0016251815257148665, "training_step": 5.992159490558233, "env_runner_sampling_timer": 4.751134796673274, "learner_update_timer": 1.238978607197039, "synch_weights": 0.0008896264669892549, "synch_env_connectors": 0.009306143050023316}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.649205510949457e-06, "batch_individual_items": 9.005894870366797e-06, "add_time_dim_to_batch_and_zero_pad": 2.573153240859616e-06, "add_observations_from_episodes_to_batch": 1.4635720565670638e-05, "add_states_from_episodes_to_batch": 1.6516259934011384e-06, "agent_to_module_mapping": 2.7461179374960958e-06}}, "connector_pipeline_timer": 6.63811863236997e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 438.8754727888107, "vehicle_5": 510.41267022609713, "vehicle_3": 103.23379181385044, "vehicle_2": 259.95299676775926, "vehicle_4": 605.1121732664109, "vehicle_0": 162.19509162425996}, "sample": 0.13237571941603496, "rlmodule_inference_timer": 6.561330287133448e-05, "agent_steps": {"vehicle_5": 110.42, "vehicle_3": 40.81999999999999, "vehicle_2": 91.60000000000002, "vehicle_0": 40.81999999999999, "vehicle_4": 108.0, "vehicle_1": 99.15999999999998}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.42, "env_step_timer": 0.00014779654377560357, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.555615866464977e-05, "tensor_to_numpy": 1.6277440026253028e-05, "module_to_agent_unmapping": 1.6569970085422122e-06, "normalize_and_clip_actions": 4.636070473574763e-05, "remove_single_ts_time_rank_from_batch": 6.607986855064124e-07, "un_batch_to_individual_items": 1.520653069358318e-05, "listify_data_for_vector_env": 6.599835766698978e-06}}, "connector_pipeline_timer": 0.0001528926366010066}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 724.0, "vehicle_2": 1652.0, "vehicle_4": 1938.0, "vehicle_0": 724.0, "vehicle_1": 1789.0000000000002}, "env_to_module_sum_episodes_length_in": 50.16694665749755, "num_agent_steps_sampled_lifetime": {"vehicle_0": 29043.999999999993, "vehicle_2": 59056.00000000002, "vehicle_4": 70879.99999999999, "vehicle_1": 63044.000000000015, "vehicle_5": 71049.0, "vehicle_3": 28953.0}, "episode_return_mean": 2079.7821965444086, "num_env_steps_sampled_lifetime": 72000.0, "time_between_sampling": 0.5234299648678867, "episode_return_min": 1801.9750100374222, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 322025.9999999999}, "module_episode_returns_mean": {"shared_policy": 897.889042491913}, "episode_len_min": 108, "weights_seq_no": 33.0, "episode_duration_sec_mean": 0.06945908476074691, "num_module_steps_sampled": {"shared_policy": 8809.0}, "num_episodes_lifetime": 657.9999999999999, "episode_return_max": 2235.820680618286, "env_to_module_sum_episodes_length_out": 50.16694665749755, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1649.4628608087646}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0052386197191891725, "agent_to_module_mapping": 0.0031769190426946953, "general_advantage_estimation": 0.01649680608387243, "add_time_dim_to_batch_and_zero_pad": 1.137952920234047e-05, "add_columns_from_episodes_to_train_batch": 0.047254440885861004, "add_states_from_episodes_to_batch": 3.5070959329347656e-06, "numpy_to_tensor": 0.00019675664839224462, "batch_individual_items": 0.0987273169221037, "add_observations_from_episodes_to_batch": 0.0003343261601708875}}, "connector_pipeline_timer": 0.1716061867428289}, "learner_connector_sum_episodes_length_in": 1996.9811228511853, "num_env_steps_trained": 1418000, "num_module_steps_trained_lifetime": 2893824, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 45032000, "num_module_steps_trained": 90752, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1996.9811228511853, "num_env_steps_trained_lifetime_throughput": 1092741.0236222723, "num_module_steps_trained_throughput": 70094.55661774828, "num_module_steps_trained_lifetime_throughput": 70094.16166402181}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.145124912261963, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.586658477783203, "total_loss": 9.556075096130371, "num_module_steps_trained": 90752, "num_trainable_parameters": 149763, "entropy": 0.2138979434967041, "vf_loss_unclipped": 3879.633056640625, "weights_seq_no": 34.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.006689906120300293, "policy_loss": -0.030720723792910576, "mean_kl_loss": 0.005059536080807447, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2893824, "num_module_steps_trained_lifetime_throughput": 70095.24304299851}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 72000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 34, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-30", "timestamp": 1750909950, "time_this_iter_s": 2.133902072906494, "time_total_s": 566.1140444278717, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a7e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 566.1140444278717, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 14.233333333333334, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 5.95562977932067, "restore_env_runners": 0.0016089755504458787, "training_step": 5.953897286062637, "env_runner_sampling_timer": 4.710725752036572, "learner_update_timer": 1.2411201007150785, "synch_weights": 0.000889222282261151, "synch_env_connectors": 0.009223857449537692}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.850303026669645e-06, "batch_individual_items": 9.113806219696508e-06, "add_time_dim_to_batch_and_zero_pad": 2.6135351613779813e-06, "add_observations_from_episodes_to_batch": 1.4833406133337064e-05, "add_states_from_episodes_to_batch": 1.663827897547871e-06, "agent_to_module_mapping": 2.815841212945236e-06}}, "connector_pipeline_timer": 6.725804905278287e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 450.0887915492058, "vehicle_5": 510.4600333881379, "vehicle_3": 103.50549515247347, "vehicle_2": 294.7741385507584, "vehicle_4": 604.3536923646925, "vehicle_0": 163.71064475536346}, "sample": 0.13237561198908682, "rlmodule_inference_timer": 6.508035604937125e-05, "agent_steps": {"vehicle_5": 109.52, "vehicle_3": 40.940000000000005, "vehicle_2": 90.74000000000002, "vehicle_0": 40.940000000000005, "vehicle_4": 108.0, "vehicle_1": 99.82}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.64, "env_step_timer": 0.0001504859302122224, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.608474570625675e-05, "tensor_to_numpy": 1.6410735772001997e-05, "module_to_agent_unmapping": 1.711928514984333e-06, "normalize_and_clip_actions": 4.72791985361036e-05, "remove_single_ts_time_rank_from_batch": 6.653110662891368e-07, "un_batch_to_individual_items": 1.5401903528872438e-05, "listify_data_for_vector_env": 6.690319277893144e-06}}, "connector_pipeline_timer": 0.00015537866850682793}, "num_agent_steps_sampled": {"vehicle_5": 1979.0000000000002, "vehicle_3": 727.0000000000001, "vehicle_2": 1640.9999999999998, "vehicle_4": 1955.9999999999998, "vehicle_0": 727.0000000000001, "vehicle_1": 1810.0}, "env_to_module_sum_episodes_length_in": 50.62342517669775, "num_agent_steps_sampled_lifetime": {"vehicle_0": 29770.999999999993, "vehicle_2": 60697.000000000015, "vehicle_4": 72835.99999999999, "vehicle_1": 64854.000000000015, "vehicle_5": 73028.0, "vehicle_3": 29680.0}, "episode_return_mean": 2126.8927972865104, "num_env_steps_sampled_lifetime": 74000.0, "time_between_sampling": 0.5123461573174365, "episode_return_min": 1978.2540357112885, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 330865.9999999999}, "module_episode_returns_mean": {"shared_policy": 881.7091937637329}, "episode_len_min": 108, "weights_seq_no": 34.0, "episode_duration_sec_mean": 0.06967127755997353, "num_module_steps_sampled": {"shared_policy": 8840.0}, "num_episodes_lifetime": 675.9999999999999, "episode_return_max": 2279.4901272058487, "env_to_module_sum_episodes_length_out": 50.62342517669775, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1655.4426572490033}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005253254351953444, "agent_to_module_mapping": 0.003184548602281537, "general_advantage_estimation": 0.0165249976130142, "add_time_dim_to_batch_and_zero_pad": 1.1348233883676583e-05, "add_columns_from_episodes_to_train_batch": 0.04737979647699578, "add_states_from_episodes_to_batch": 3.4928549488611827e-06, "numpy_to_tensor": 0.00019567450184878173, "batch_individual_items": 0.09817866625288796, "add_observations_from_episodes_to_batch": 0.0003357008086202916}}, "connector_pipeline_timer": 0.1712329315354324}, "learner_connector_sum_episodes_length_in": 1997.0113116226735, "num_env_steps_trained": 1424000, "num_module_steps_trained_lifetime": 2984960, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 46456000, "num_module_steps_trained": 91136, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.0113116226735, "num_env_steps_trained_lifetime_throughput": 1093171.152276902, "num_module_steps_trained_throughput": 70114.0135257934, "num_module_steps_trained_lifetime_throughput": 70113.7596670595}, "shared_policy": {"gradients_default_optimizer_global_norm": 3.1408579349517822, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.80820083618164, "total_loss": 9.766801834106445, "num_module_steps_trained": 91136, "num_trainable_parameters": 149763, "entropy": 0.20743225514888763, "vf_loss_unclipped": 4239.1923828125, "weights_seq_no": 35.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07218611240386963, "policy_loss": -0.04185878112912178, "mean_kl_loss": 0.0056290654465556145, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 2984960, "num_module_steps_trained_lifetime_throughput": 70114.75716908205}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 74000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 35, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-33", "timestamp": 1750909953, "time_this_iter_s": 2.1684601306915283, "time_total_s": 568.2825045585632, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a6f20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 568.2825045585632, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 14.466666666666663, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 5.918636954027505, "restore_env_runners": 0.0015929320449297923, "training_step": 5.916920194452014, "env_runner_sampling_timer": 4.670674282436169, "learner_update_timer": 1.2441894376179712, "synch_weights": 0.0008892325594874014, "synch_env_connectors": 0.009143516374977319}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.945267609816824e-06, "batch_individual_items": 9.272682747976196e-06, "add_time_dim_to_batch_and_zero_pad": 2.658374650856789e-06, "add_observations_from_episodes_to_batch": 1.4996523726934762e-05, "add_states_from_episodes_to_batch": 1.6991039984494946e-06, "agent_to_module_mapping": 2.8205457809657683e-06}}, "connector_pipeline_timer": 6.82756551489005e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 451.7494920921326, "vehicle_5": 513.8206996059419, "vehicle_3": 95.18985368013382, "vehicle_2": 298.0983760643006, "vehicle_4": 598.920654745102, "vehicle_0": 159.8058005142212}, "sample": 0.13244548604875997, "rlmodule_inference_timer": 6.437130562035652e-05, "agent_steps": {"vehicle_5": 108.96, "vehicle_3": 41.06, "vehicle_2": 90.33999999999997, "vehicle_0": 41.06, "vehicle_4": 108.0, "vehicle_1": 99.42000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.02, "env_step_timer": 0.00015146264662337642, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7203712708479354e-05, "tensor_to_numpy": 1.6788799148551278e-05, "module_to_agent_unmapping": 1.681083852581509e-06, "normalize_and_clip_actions": 4.767672708622672e-05, "remove_single_ts_time_rank_from_batch": 6.686009974690844e-07, "un_batch_to_individual_items": 1.5509930902288512e-05, "listify_data_for_vector_env": 6.722910983608867e-06}}, "connector_pipeline_timer": 0.0001574395119123873}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 722.0000000000001, "vehicle_2": 1642.0, "vehicle_4": 1964.0000000000002, "vehicle_0": 722.0000000000001, "vehicle_1": 1805.9999999999998}, "env_to_module_sum_episodes_length_in": 50.40763954624104, "num_agent_steps_sampled_lifetime": {"vehicle_0": 30492.99999999999, "vehicle_2": 62339.000000000015, "vehicle_4": 74799.99999999999, "vehicle_1": 66660.00000000001, "vehicle_5": 75010.0, "vehicle_3": 30401.999999999996}, "episode_return_mean": 2117.5848754906656, "num_env_steps_sampled_lifetime": 76000.0, "time_between_sampling": 0.5020207298466313, "episode_return_min": 2012.680270433426, "episode_len_max": 112, "num_module_steps_sampled_lifetime": {"shared_policy": 339703.9999999999}, "module_episode_returns_mean": {"shared_policy": 881.6128487682341}, "episode_len_min": 108, "weights_seq_no": 35.0, "episode_duration_sec_mean": 0.06911187665944453, "num_module_steps_sampled": {"shared_policy": 8838.0}, "num_episodes_lifetime": 693.9999999999999, "episode_return_max": 2189.935822367668, "env_to_module_sum_episodes_length_out": 50.40763954624104, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1623.0972879972203}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0052681626384594995, "agent_to_module_mapping": 0.003190819366256705, "general_advantage_estimation": 0.01654587679694938, "add_time_dim_to_batch_and_zero_pad": 1.1326001512066576e-05, "add_columns_from_episodes_to_train_batch": 0.047504699762208516, "add_states_from_episodes_to_batch": 3.4829263714561766e-06, "numpy_to_tensor": 0.00019459817680544055, "batch_individual_items": 0.09842756876040183, "add_observations_from_episodes_to_batch": 0.00033814255059632894}}, "connector_pipeline_timer": 0.17164970430007617}, "learner_connector_sum_episodes_length_in": 1997.0411985064468, "num_env_steps_trained": 1424000, "num_module_steps_trained_lifetime": 3076096, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 47880000, "num_module_steps_trained": 91136, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.0411985064468, "num_env_steps_trained_lifetime_throughput": 1093695.5932905811, "num_module_steps_trained_throughput": 70139.99213785892, "num_module_steps_trained_lifetime_throughput": 70139.71506864774}, "shared_policy": {"gradients_default_optimizer_global_norm": 1.8945846557617188, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.69649600982666, "total_loss": 9.611177444458008, "num_module_steps_trained": 91136, "num_trainable_parameters": 149763, "entropy": 0.11315223574638367, "vf_loss_unclipped": 4253.59375, "weights_seq_no": 36.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.0041574835777282715, "policy_loss": -0.08881925791501999, "mean_kl_loss": 0.010291213169693947, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3076096, "num_module_steps_trained_lifetime_throughput": 70140.87247280394}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 76000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 36, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-35", "timestamp": 1750909955, "time_this_iter_s": 2.2586560249328613, "time_total_s": 570.5411605834961, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a63e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 570.5411605834961, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 13.625, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 5.880669772407226, "restore_env_runners": 0.0015770427244940358, "training_step": 5.878968715007498, "env_runner_sampling_timer": 4.63102853627181, "learner_update_timer": 1.245880081991846, "synch_weights": 0.000888789813874498, "synch_env_connectors": 0.009063748291189172}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.813885746233103e-06, "batch_individual_items": 9.106055958100643e-06, "add_time_dim_to_batch_and_zero_pad": 2.6295660252962977e-06, "add_observations_from_episodes_to_batch": 1.4917485583253992e-05, "add_states_from_episodes_to_batch": 1.652456063845357e-06, "agent_to_module_mapping": 2.78946173417058e-06}}, "connector_pipeline_timer": 6.733366495091893e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 440.00951213121414, "vehicle_5": 504.28430768966666, "vehicle_3": 116.62206020593645, "vehicle_2": 301.90964906930924, "vehicle_4": 604.4728266048432, "vehicle_0": 176.0682721447945}, "sample": 0.1324442440523462, "rlmodule_inference_timer": 6.275638328169977e-05, "agent_steps": {"vehicle_5": 109.2, "vehicle_3": 50.56, "vehicle_2": 89.82, "vehicle_0": 44.56, "vehicle_4": 108.0, "vehicle_1": 98.88}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 114.42, "env_step_timer": 0.00014893313447697688, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.62601750544202e-05, "tensor_to_numpy": 1.654909180792856e-05, "module_to_agent_unmapping": 1.674513937931143e-06, "normalize_and_clip_actions": 4.6909157662986034e-05, "remove_single_ts_time_rank_from_batch": 6.580912706754027e-07, "un_batch_to_individual_items": 1.533573822185131e-05, "listify_data_for_vector_env": 6.692827141185266e-06}}, "connector_pipeline_timer": 0.00015486324721770506}, "num_agent_steps_sampled": {"vehicle_5": 1895.0, "vehicle_3": 860.0, "vehicle_2": 1543.0, "vehicle_4": 1870.0, "vehicle_0": 760.0, "vehicle_1": 1703.0}, "env_to_module_sum_episodes_length_in": 48.782836950976005, "num_agent_steps_sampled_lifetime": {"vehicle_0": 31252.99999999999, "vehicle_2": 63882.000000000015, "vehicle_4": 76669.99999999999, "vehicle_1": 68363.00000000001, "vehicle_5": 76905.0, "vehicle_3": 31261.999999999996}, "episode_return_mean": 2143.366633319855, "num_env_steps_sampled_lifetime": 78000.0, "time_between_sampling": 0.4931791695877834, "episode_return_min": 1997.1371116638184, "episode_len_max": 199, "num_module_steps_sampled_lifetime": {"shared_policy": 348334.9999999999}, "module_episode_returns_mean": {"shared_policy": 985.939648153782}, "episode_len_min": 108, "weights_seq_no": 36.0, "episode_duration_sec_mean": 0.07188672331991257, "num_module_steps_sampled": {"shared_policy": 8631.0}, "num_episodes_lifetime": 711.9999999999999, "episode_return_max": 2685.834406375885, "env_to_module_sum_episodes_length_out": 48.782836950976005, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1615.1400829434842}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0052827401721345256, "agent_to_module_mapping": 0.0031956120026177576, "general_advantage_estimation": 0.01654855177902847, "add_time_dim_to_batch_and_zero_pad": 1.1303161495687618e-05, "add_columns_from_episodes_to_train_batch": 0.04761108026458758, "add_states_from_episodes_to_batch": 3.4722571432782396e-06, "numpy_to_tensor": 0.00019353719500957218, "batch_individual_items": 0.09789156182283999, "add_observations_from_episodes_to_batch": 0.00034045153512509666}}, "connector_pipeline_timer": 0.17124294516705355}, "learner_connector_sum_episodes_length_in": 1997.0707865213824, "num_env_steps_trained": 1390000, "num_module_steps_trained_lifetime": 3165056, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 49270000, "num_module_steps_trained": 88960, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.0707865213824, "num_env_steps_trained_lifetime_throughput": 1093498.3875835938, "num_module_steps_trained_throughput": 70120.32594428975, "num_module_steps_trained_lifetime_throughput": 70120.03726964294}, "shared_policy": {"gradients_default_optimizer_global_norm": 6.985537528991699, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.619560241699219, "total_loss": 9.639618873596191, "num_module_steps_trained": 88960, "num_trainable_parameters": 149763, "entropy": 0.2525390684604645, "vf_loss_unclipped": 3649.728515625, "weights_seq_no": 37.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.04976952075958252, "policy_loss": 0.017017468810081482, "mean_kl_loss": 0.012369600124657154, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3165056, "num_module_steps_trained_lifetime_throughput": 70121.15523042405}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 78000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 37, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-37", "timestamp": 1750909957, "time_this_iter_s": 2.1242969036102295, "time_total_s": 572.6654574871063, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a5e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 572.6654574871063, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 14.433333333333332, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 5.8433293821831676, "restore_env_runners": 0.0015613164672594647, "training_step": 5.841643939517429, "env_runner_sampling_timer": 4.591760595909101, "learner_update_timer": 1.2478185445019567, "synch_weights": 0.0008888948357105971, "synch_env_connectors": 0.00898582330830629}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.692739058264784e-06, "batch_individual_items": 9.024242979526768e-06, "add_time_dim_to_batch_and_zero_pad": 2.596259599342477e-06, "add_observations_from_episodes_to_batch": 1.4775502084648654e-05, "add_states_from_episodes_to_batch": 1.6338046305318522e-06, "agent_to_module_mapping": 2.7779534148886525e-06}}, "connector_pipeline_timer": 6.675391249709362e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 447.4202625739574, "vehicle_5": 516.6263177013398, "vehicle_3": 96.24150343418121, "vehicle_2": 289.4279934883117, "vehicle_4": 607.53988386631, "vehicle_0": 163.01533787250514}, "sample": 0.13240036959760054, "rlmodule_inference_timer": 6.52097477831733e-05, "agent_steps": {"vehicle_5": 109.4, "vehicle_3": 40.88, "vehicle_2": 90.42, "vehicle_0": 40.88, "vehicle_4": 108.0, "vehicle_1": 100.28}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.51999999999997, "env_step_timer": 0.0001494316836363853, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5374489339367235e-05, "tensor_to_numpy": 1.621593686035106e-05, "module_to_agent_unmapping": 1.6422850224737678e-06, "normalize_and_clip_actions": 4.666262287810604e-05, "remove_single_ts_time_rank_from_batch": 6.504000117030679e-07, "un_batch_to_individual_items": 1.519148917891075e-05, "listify_data_for_vector_env": 6.6743591678966934e-06}}, "connector_pipeline_timer": 0.00015278214047572672}, "num_agent_steps_sampled": {"vehicle_5": 1980.0, "vehicle_3": 735.0, "vehicle_2": 1635.0, "vehicle_4": 1954.0000000000002, "vehicle_0": 735.0, "vehicle_1": 1818.0}, "env_to_module_sum_episodes_length_in": 49.959167348291984, "num_agent_steps_sampled_lifetime": {"vehicle_0": 31987.99999999999, "vehicle_2": 65517.000000000015, "vehicle_4": 78623.99999999999, "vehicle_1": 70181.00000000001, "vehicle_5": 78885.0, "vehicle_3": 31996.999999999996}, "episode_return_mean": 2120.271302088499, "num_env_steps_sampled_lifetime": 80000.0, "time_between_sampling": 0.48345680048418205, "episode_return_min": 1972.6384230852127, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 357191.9999999999}, "module_episode_returns_mean": {"shared_policy": 903.4735498571396}, "episode_len_min": 108, "weights_seq_no": 37.0, "episode_duration_sec_mean": 0.06911548766147461, "num_module_steps_sampled": {"shared_policy": 8857.0}, "num_episodes_lifetime": 729.9999999999999, "episode_return_max": 2285.0662734508514, "env_to_module_sum_episodes_length_out": 49.959167348291984, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1627.8149927092195}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005299126520443211, "agent_to_module_mapping": 0.003201545042603708, "general_advantage_estimation": 0.016574582931258245, "add_time_dim_to_batch_and_zero_pad": 1.1269289898507045e-05, "add_columns_from_episodes_to_train_batch": 0.04772139529198428, "add_states_from_episodes_to_batch": 3.4587845881342893e-06, "numpy_to_tensor": 0.0001924772430693102, "batch_individual_items": 0.09737673370461569, "add_observations_from_episodes_to_batch": 0.00034195493978458284}}, "connector_pipeline_timer": 0.1708866494653971}, "learner_connector_sum_episodes_length_in": 1997.1000786561685, "num_env_steps_trained": 1426000, "num_module_steps_trained_lifetime": 3256320, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 50696000, "num_module_steps_trained": 91264, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.1000786561685, "num_env_steps_trained_lifetime_throughput": 1094066.1583627225, "num_module_steps_trained_throughput": 70149.63319695178, "num_module_steps_trained_lifetime_throughput": 70149.54124721639}, "shared_policy": {"gradients_default_optimizer_global_norm": 6.099457263946533, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.683014869689941, "total_loss": 9.661187171936035, "num_module_steps_trained": 91264, "num_trainable_parameters": 149763, "entropy": 0.23301108181476593, "vf_loss_unclipped": 4030.8388671875, "weights_seq_no": 38.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.419960618019104, "policy_loss": -0.02385663241147995, "mean_kl_loss": 0.009684046730399132, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3256320, "num_module_steps_trained_lifetime_throughput": 70150.36520553334}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 80000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 38, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-39", "timestamp": 1750909959, "time_this_iter_s": 2.1489391326904297, "time_total_s": 574.8143966197968, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a5800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 574.8143966197968, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 13.866666666666665, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 5.806411335451328, "restore_env_runners": 0.0015457474725972394, "training_step": 5.804741172202291, "env_runner_sampling_timer": 4.552944161200043, "learner_update_timer": 1.249727646136963, "synch_weights": 0.0008881221373817428, "synch_env_connectors": 0.00890764090517872}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.068749745376408e-05, "add_time_dim_to_batch_and_zero_pad": 7.312497473321855e-06, "add_observations_from_episodes_to_batch": 3.135399674647488e-05, "add_states_from_episodes_to_batch": 3.6454985092859715e-06, "agent_to_module_mapping": 5.812995368614792e-06, "numpy_to_tensor": 2.247900192742236e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0090709685975713e-05, "batch_individual_items": 9.284879708208551e-06, "add_time_dim_to_batch_and_zero_pad": 2.6442600023450387e-06, "add_observations_from_episodes_to_batch": 1.5121964648165746e-05, "add_states_from_episodes_to_batch": 1.657051653124198e-06, "agent_to_module_mapping": 2.8247984500300838e-06}}, "connector_pipeline_timer": 6.825331169987182e-05}, "env_reset_timer": 0.00010002050112234429, "agent_episode_returns_mean": {"vehicle_1": 452.199171987772, "vehicle_5": 519.8983550834656, "vehicle_3": 89.15796617984772, "vehicle_2": 300.81972864151, "vehicle_4": 608.927570939064, "vehicle_0": 165.9236970949173}, "sample": 0.1324015493249043, "rlmodule_inference_timer": 6.579609660194154e-05, "agent_steps": {"vehicle_5": 109.69999999999999, "vehicle_3": 41.04, "vehicle_2": 90.22, "vehicle_0": 41.04, "vehicle_4": 108.0, "vehicle_1": 99.46000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.69999999999999, "env_step_timer": 0.00015152930986970294, "connector_pipeline_timer": 0.00020233299801475368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6414126529678364e-05, "tensor_to_numpy": 1.6593471037361282e-05, "module_to_agent_unmapping": 1.676106672345509e-06, "normalize_and_clip_actions": 4.7486460768756665e-05, "remove_single_ts_time_rank_from_batch": 6.59689658288751e-07, "un_batch_to_individual_items": 1.5408862924239733e-05, "listify_data_for_vector_env": 6.713389355159188e-06}}, "connector_pipeline_timer": 0.0001558135245709264}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 722.9999999999999, "vehicle_2": 1620.0, "vehicle_4": 1950.0, "vehicle_0": 722.9999999999999, "vehicle_1": 1787.0}, "env_to_module_sum_episodes_length_in": 49.675285811747734, "num_agent_steps_sampled_lifetime": {"vehicle_0": 32710.999999999993, "vehicle_2": 67137.00000000001, "vehicle_4": 80573.99999999999, "vehicle_1": 71968.00000000001, "vehicle_5": 80867.0, "vehicle_3": 32720.0}, "episode_return_mean": 2136.9264889252186, "num_env_steps_sampled_lifetime": 82000.0, "time_between_sampling": 0.4744228219987211, "episode_return_min": 1970.0450059175491, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 365976.9999999999}, "module_episode_returns_mean": {"shared_policy": 881.6101738119125}, "episode_len_min": 108, "weights_seq_no": 38.0, "episode_duration_sec_mean": 0.06953434429931803, "num_module_steps_sampled": {"shared_policy": 8785.0}, "num_episodes_lifetime": 747.9999999999999, "episode_return_max": 2210.5719754695892, "env_to_module_sum_episodes_length_out": 49.675285811747734, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1621.6843822536275}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005313177755252264, "agent_to_module_mapping": 0.0032087008421326324, "general_advantage_estimation": 0.01660019169193356, "add_time_dim_to_batch_and_zero_pad": 1.1237426995089885e-05, "add_columns_from_episodes_to_train_batch": 0.0478282092591137, "add_states_from_episodes_to_batch": 3.447526736544945e-06, "numpy_to_tensor": 0.00019145122064274288, "batch_individual_items": 0.09686100427756297, "add_observations_from_episodes_to_batch": 0.00034360331037888025}}, "connector_pipeline_timer": 0.17052462505076316}, "learner_connector_sum_episodes_length_in": 1997.1290778696068, "num_env_steps_trained": 1416000, "num_module_steps_trained_lifetime": 3346944, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 52112000, "num_module_steps_trained": 90624, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.1290778696068, "num_env_steps_trained_lifetime_throughput": 1094832.9183458532, "num_module_steps_trained_throughput": 70192.25479908915, "num_module_steps_trained_lifetime_throughput": 70192.18042597869}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.2305474281311035, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.732149124145508, "total_loss": 9.793096542358398, "num_module_steps_trained": 90624, "num_trainable_parameters": 149763, "entropy": 0.17223811149597168, "vf_loss_unclipped": 3801.131591796875, "weights_seq_no": 39.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.09818136692047119, "policy_loss": 0.05729440599679947, "mean_kl_loss": 0.01194450818002224, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3346944, "num_module_steps_trained_lifetime_throughput": 70192.9495189848}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 82000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 39, "trial_id": "a8246_00000", "date": "2025-06-25_20-52-41", "timestamp": 1750909961, "time_this_iter_s": 2.1539199352264404, "time_total_s": 576.9683165550232, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a617f60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 576.9683165550232, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 14.699999999999998, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 6.390866515426784, "restore_env_runners": 0.0015303266678245275, "training_step": 6.389211699230293, "env_runner_sampling_timer": 5.135465128748029, "learner_update_timer": 1.2516741355055947, "synch_weights": 0.0008870513360008183, "synch_env_connectors": 0.008831254906130348}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.120389835909009e-05, "add_time_dim_to_batch_and_zero_pad": 8.262498886324465e-06, "add_observations_from_episodes_to_batch": 3.2004394597606733e-05, "add_states_from_episodes_to_batch": 4.095499025424942e-06, "agent_to_module_mapping": 6.496196147054434e-06, "numpy_to_tensor": 1.9462200725683942e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.314267052747846e-06, "batch_individual_items": 8.892556489547523e-06, "add_time_dim_to_batch_and_zero_pad": 2.5736739912532245e-06, "add_observations_from_episodes_to_batch": 1.4552436897560096e-05, "add_states_from_episodes_to_batch": 1.6167378100608318e-06, "agent_to_module_mapping": 2.702584655755705e-06}}, "connector_pipeline_timer": 6.564428369257628e-05}, "env_reset_timer": 0.00010483689984539524, "agent_episode_returns_mean": {"vehicle_1": 449.48108385801316, "vehicle_5": 505.59371277332303, "vehicle_3": 100.88748548507691, "vehicle_2": 271.17418372392655, "vehicle_4": 603.4853595972061, "vehicle_0": 169.50193193674087}, "sample": 0.1310423407381956, "rlmodule_inference_timer": 6.02980041599652e-05, "agent_steps": {"vehicle_5": 110.43999999999997, "vehicle_3": 40.88, "vehicle_2": 90.60000000000002, "vehicle_0": 40.88, "vehicle_4": 108.0, "vehicle_1": 100.98}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.43999999999997, "env_step_timer": 0.0001461605619423396, "connector_pipeline_timer": 0.00020776659875991753, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5035064543539796e-05, "tensor_to_numpy": 1.6056246368462052e-05, "module_to_agent_unmapping": 1.621743594734107e-06, "normalize_and_clip_actions": 4.595658799794892e-05, "remove_single_ts_time_rank_from_batch": 6.200735148177573e-07, "un_batch_to_individual_items": 1.5069526690559087e-05, "listify_data_for_vector_env": 6.545961756197672e-06}}, "connector_pipeline_timer": 0.00015138378143070147}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 715.0, "vehicle_2": 1638.0, "vehicle_4": 1935.9999999999998, "vehicle_0": 715.0, "vehicle_1": 1819.0000000000002}, "env_to_module_sum_episodes_length_in": 51.20036530006935, "num_agent_steps_sampled_lifetime": {"vehicle_0": 33425.99999999999, "vehicle_2": 68775.00000000001, "vehicle_4": 82510.0, "vehicle_1": 73787.00000000001, "vehicle_5": 82848.99999999999, "vehicle_3": 33435.0}, "episode_return_mean": 2100.1237568688393, "num_env_steps_sampled_lifetime": 84000.0, "time_between_sampling": 0.6040294315134022, "episode_return_min": 1970.0450059175491, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 374781.9999999998}, "module_episode_returns_mean": {"shared_policy": 919.4322791671752}, "episode_len_min": 108, "weights_seq_no": 39.0, "episode_duration_sec_mean": 0.06819019917966215, "num_module_steps_sampled": {"shared_policy": 8805.0}, "num_episodes_lifetime": 765.9999999999999, "episode_return_max": 2245.74649643898, "env_to_module_sum_episodes_length_out": 51.20036530006935, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1644.7075743740438}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00532690847772505, "agent_to_module_mapping": 0.003213905923693963, "general_advantage_estimation": 0.016615031445022018, "add_time_dim_to_batch_and_zero_pad": 1.1207552771258079e-05, "add_columns_from_episodes_to_train_batch": 0.04793025841654368, "add_states_from_episodes_to_batch": 3.4334714442237014e-06, "numpy_to_tensor": 0.00019041379849670038, "batch_individual_items": 0.09633382465482004, "add_observations_from_episodes_to_batch": 0.00034501810728476424}}, "connector_pipeline_timer": 0.1701331513002534}, "learner_connector_sum_episodes_length_in": 1997.1577870909107, "num_env_steps_trained": 1418000, "num_module_steps_trained_lifetime": 3437696, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 53530000, "num_module_steps_trained": 90752, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.1577870909107, "num_env_steps_trained_lifetime_throughput": 1095789.2655145146, "num_module_steps_trained_throughput": 70247.2459654025, "num_module_steps_trained_lifetime_throughput": 70247.19165444137}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.08613920211792, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.59212875366211, "total_loss": 9.497831344604492, "num_module_steps_trained": 90752, "num_trainable_parameters": 149763, "entropy": 0.10300961136817932, "vf_loss_unclipped": 4192.25927734375, "weights_seq_no": 40.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.17891716957092285, "policy_loss": -0.09626464545726776, "mean_kl_loss": 0.006658449769020081, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3437696, "num_module_steps_trained_lifetime_throughput": 70247.88354469363}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 84000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 8}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 40, "trial_id": "a8246_00000", "date": "2025-06-25_20-53-46", "timestamp": 1750910026, "time_this_iter_s": 64.25429916381836, "time_total_s": 641.2226157188416, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 641.2226157188416, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.54835164835165, "ram_util_percent": 52.215384615384586}}
{"timers": {"training_iteration": 6.34838304527249, "restore_env_runners": 0.0015582184011082795, "training_step": 6.3466997901580005, "env_runner_sampling_timer": 5.091096499960535, "learner_update_timer": 1.2535254012405541, "synch_weights": 0.0008878195726205958, "synch_env_connectors": 0.00875078527709113}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.110399873345159e-05, "add_time_dim_to_batch_and_zero_pad": 7.583501428598538e-06, "add_observations_from_episodes_to_batch": 3.231249502277933e-05, "add_states_from_episodes_to_batch": 3.582998033380136e-06, "agent_to_module_mapping": 5.833499017171562e-06, "numpy_to_tensor": 1.862450153566897e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.818916825537113e-06, "batch_individual_items": 9.278281518064004e-06, "add_time_dim_to_batch_and_zero_pad": 2.6407533612601576e-06, "add_observations_from_episodes_to_batch": 1.511899210508302e-05, "add_states_from_episodes_to_batch": 1.6635695524486248e-06, "agent_to_module_mapping": 2.7711748439178493e-06}}, "connector_pipeline_timer": 6.783264147379107e-05}, "env_reset_timer": 0.00010552049934631214, "agent_episode_returns_mean": {"vehicle_1": 449.1464733803272, "vehicle_5": 522.7212284094948, "vehicle_3": 112.97361905847278, "vehicle_2": 293.01794512884953, "vehicle_4": 608.4739627804076, "vehicle_0": 163.60865976537977}, "sample": 0.1296691469317067, "rlmodule_inference_timer": 6.652505953411159e-05, "agent_steps": {"vehicle_5": 109.56571428571428, "vehicle_3": 40.745714285714286, "vehicle_2": 89.97142857142858, "vehicle_0": 40.745714285714286, "vehicle_4": 108.0, "vehicle_1": 100.77714285714286}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.78571428571428, "env_step_timer": 0.00014704649446463936, "connector_pipeline_timer": 0.0002003539993893355, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.839099092726533e-05, "tensor_to_numpy": 1.7079672112403297e-05, "module_to_agent_unmapping": 1.6448242003969912e-06, "normalize_and_clip_actions": 4.837239666275881e-05, "remove_single_ts_time_rank_from_batch": 6.406526007984044e-07, "un_batch_to_individual_items": 1.557746864553334e-05, "listify_data_for_vector_env": 6.807608618706634e-06}}, "connector_pipeline_timer": 0.00015929008821790745}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 737.0000000000001, "vehicle_2": 1630.9999999999998, "vehicle_4": 1960.0, "vehicle_0": 737.0000000000001, "vehicle_1": 1829.0000000000002}, "env_to_module_sum_episodes_length_in": 48.176945961251384, "num_agent_steps_sampled_lifetime": {"vehicle_0": 22244.000000000004, "vehicle_2": 48321.999999999985, "vehicle_4": 57618.000000000015, "vehicle_1": 53179.0, "vehicle_5": 58494.0, "vehicle_3": 23289.000000000004}, "episode_return_mean": 2149.941888103315, "num_env_steps_sampled_lifetime": 60000.0, "time_between_sampling": 0.3857921167115642, "episode_return_min": 2009.2875734567642, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 263146.0}, "module_episode_returns_mean": {"shared_policy": 972.2390101064954}, "episode_len_min": 108, "weights_seq_no": 40.0, "episode_duration_sec_mean": 0.06799466318619256, "num_module_steps_sampled": {"shared_policy": 8872.0}, "num_episodes_lifetime": 533.9999999999999, "episode_return_max": 2275.2811980247498, "env_to_module_sum_episodes_length_out": 48.176945961251384, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1634.6304922082413}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005342558982923649, "agent_to_module_mapping": 0.0032204085344918723, "general_advantage_estimation": 0.016641606540514595, "add_time_dim_to_batch_and_zero_pad": 1.1200067242500404e-05, "add_columns_from_episodes_to_train_batch": 0.048023039582390334, "add_states_from_episodes_to_batch": 3.422466724073463e-06, "numpy_to_tensor": 0.00018938299050274245, "batch_individual_items": 0.09581320098833007, "add_observations_from_episodes_to_batch": 0.00034655959620553137}}, "connector_pipeline_timer": 0.16975414520722013}, "learner_connector_sum_episodes_length_in": 1997.1862092200015, "num_env_steps_trained": 1428000, "num_module_steps_trained_lifetime": 3529088, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 54958000, "num_module_steps_trained": 91392, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.1862092200015, "num_env_steps_trained_lifetime_throughput": 1097236.029904868, "num_module_steps_trained_throughput": 70334.00880541689, "num_module_steps_trained_lifetime_throughput": 70333.9395266843}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.11597204208374, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.429980278015137, "total_loss": 9.467362403869629, "num_module_steps_trained": 91392, "num_trainable_parameters": 149763, "entropy": 0.2645782232284546, "vf_loss_unclipped": 3762.787841796875, "weights_seq_no": 41.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.39583849906921387, "policy_loss": 0.035852231085300446, "mean_kl_loss": 0.009278059005737305, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3529088, "num_module_steps_trained_lifetime_throughput": 70334.61703638494}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 60000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 9}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 41, "trial_id": "a8246_00000", "date": "2025-06-25_20-53-48", "timestamp": 1750910028, "time_this_iter_s": 2.1448352336883545, "time_total_s": 643.3674509525299, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 643.3674509525299, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 15.866666666666665, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 6.930970619409731, "restore_env_runners": 0.0015426808070758396, "training_step": 6.929302694756442, "env_runner_sampling_timer": 5.671672622040951, "learner_update_timer": 1.2555461780582113, "synch_weights": 0.0008895122168440405, "synch_env_connectors": 0.008674802014328993}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.1241398644633575e-05, "add_time_dim_to_batch_and_zero_pad": 8.133400115184486e-06, "add_observations_from_episodes_to_batch": 3.222519444534555e-05, "add_states_from_episodes_to_batch": 3.957998706027865e-06, "agent_to_module_mapping": 6.333597411867231e-06, "numpy_to_tensor": 1.867460086941719e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.48001019849972e-06, "batch_individual_items": 8.923770346594412e-06, "add_time_dim_to_batch_and_zero_pad": 2.5781068410155156e-06, "add_observations_from_episodes_to_batch": 1.4682111931952298e-05, "add_states_from_episodes_to_batch": 1.6244656018418592e-06, "agent_to_module_mapping": 2.6925490795524877e-06}}, "connector_pipeline_timer": 6.593278953196233e-05}, "env_reset_timer": 0.00010583279945421963, "agent_episode_returns_mean": {"vehicle_1": 455.64461004495615, "vehicle_5": 513.9605109643936, "vehicle_3": 121.87583894252776, "vehicle_2": 292.7986310124398, "vehicle_4": 611.1070424699783, "vehicle_0": 166.55554065227508}, "sample": 0.13028427268195208, "rlmodule_inference_timer": 6.366121267204469e-05, "agent_steps": {"vehicle_5": 109.54, "vehicle_3": 40.62, "vehicle_2": 89.98, "vehicle_0": 40.62, "vehicle_4": 107.96, "vehicle_1": 100.26}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.64000000000001, "env_step_timer": 0.0001472446619806023, "connector_pipeline_timer": 0.0002056165991234593, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5254010116405745e-05, "tensor_to_numpy": 1.60313875777244e-05, "module_to_agent_unmapping": 1.5918087181558308e-06, "normalize_and_clip_actions": 4.582083712059494e-05, "remove_single_ts_time_rank_from_batch": 6.230469851530636e-07, "un_batch_to_individual_items": 1.5074947536632932e-05, "listify_data_for_vector_env": 6.587473836129356e-06}}, "connector_pipeline_timer": 0.00015123660688801482}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 730.0, "vehicle_2": 1620.0, "vehicle_4": 1942.0, "vehicle_0": 730.0, "vehicle_1": 1808.0}, "env_to_module_sum_episodes_length_in": 50.69413960651339, "num_agent_steps_sampled_lifetime": {"vehicle_0": 22974.000000000004, "vehicle_2": 49941.999999999985, "vehicle_4": 59560.000000000015, "vehicle_1": 54987.0, "vehicle_5": 60472.0, "vehicle_3": 24019.000000000004}, "episode_return_mean": 2161.9421746206285, "num_env_steps_sampled_lifetime": 62000.0, "time_between_sampling": 0.8329150730834337, "episode_return_min": 2052.8647000789642, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 271954.0}, "module_episode_returns_mean": {"shared_policy": 964.1379919314386}, "episode_len_min": 108, "weights_seq_no": 41.0, "episode_duration_sec_mean": 0.06911260839930038, "num_module_steps_sampled": {"shared_policy": 8808.0}, "num_episodes_lifetime": 551.9999999999999, "episode_return_max": 2275.2811980247498, "env_to_module_sum_episodes_length_out": 50.69413960651339, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1661.278793410267}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00535700547312957, "agent_to_module_mapping": 0.003225403199143559, "general_advantage_estimation": 0.016660679225103413, "add_time_dim_to_batch_and_zero_pad": 1.1199316544072874e-05, "add_columns_from_episodes_to_train_batch": 0.04811910210658008, "add_states_from_episodes_to_batch": 3.423242105061268e-06, "numpy_to_tensor": 0.00018839625059549646, "batch_individual_items": 0.0952971177284933, "add_observations_from_episodes_to_batch": 0.00034778400023049804}}, "connector_pipeline_timer": 0.16937245875514137}, "learner_connector_sum_episodes_length_in": 1997.2143471278014, "num_env_steps_trained": 1416000, "num_module_steps_trained_lifetime": 3619712, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 56374000, "num_module_steps_trained": 90624, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.2143471278014, "num_env_steps_trained_lifetime_throughput": 1096183.2123240435, "num_module_steps_trained_throughput": 70261.15825656024, "num_module_steps_trained_lifetime_throughput": 70261.07910338657}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.709926605224609, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.806669235229492, "total_loss": 9.936917304992676, "num_module_steps_trained": 90624, "num_trainable_parameters": 149763, "entropy": 0.23397701978683472, "vf_loss_unclipped": 3896.714599609375, "weights_seq_no": 42.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.30570852756500244, "policy_loss": 0.12912814319133759, "mean_kl_loss": 0.007685650140047073, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3619712, "num_module_steps_trained_lifetime_throughput": 70261.7355220163}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 62000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 9}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 42, "trial_id": "a8246_00000", "date": "2025-06-25_20-54-52", "timestamp": 1750910092, "time_this_iter_s": 64.60979914665222, "time_total_s": 707.9772500991821, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b104360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 707.9772500991821, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.96813186813187, "ram_util_percent": 51.962637362637345}}
{"timers": {"training_iteration": 7.499199653215651, "restore_env_runners": 0.001568322339001936, "training_step": 7.497505685308821, "env_runner_sampling_timer": 6.238067361650548, "learner_update_timer": 1.2573483066976698, "synch_weights": 0.0008887783446827061, "synch_env_connectors": 0.008598430244178692}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0370501442812382e-05, "add_time_dim_to_batch_and_zero_pad": 7.450001430697739e-06, "add_observations_from_episodes_to_batch": 3.129199758404866e-05, "add_states_from_episodes_to_batch": 3.5667995689436794e-06, "agent_to_module_mapping": 5.7037963415496055e-06, "numpy_to_tensor": 2.0370497804833575e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.629097291002839e-06, "batch_individual_items": 9.055496868111295e-06, "add_time_dim_to_batch_and_zero_pad": 2.573915981670517e-06, "add_observations_from_episodes_to_batch": 1.4695732073224897e-05, "add_states_from_episodes_to_batch": 1.618993166111833e-06, "agent_to_module_mapping": 2.7070219575030914e-06}}, "connector_pipeline_timer": 6.624829761987145e-05}, "env_reset_timer": 0.00010469979970366694, "agent_episode_returns_mean": {"vehicle_1": 436.0895276374476, "vehicle_5": 507.6573174422128, "vehicle_3": 113.19989628314971, "vehicle_2": 281.2462334050451, "vehicle_4": 606.1093909263611, "vehicle_0": 160.44653903007503}, "sample": 0.13008683557435255, "rlmodule_inference_timer": 6.485934679458092e-05, "agent_steps": {"vehicle_5": 109.46285714285713, "vehicle_3": 41.11714285714285, "vehicle_2": 89.4, "vehicle_0": 41.11714285714285, "vehicle_4": 107.98, "vehicle_1": 99.79428571428572}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.79142857142858, "env_step_timer": 0.00014500016268739914, "connector_pipeline_timer": 0.00020017059941892512, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8482858528792005e-05, "tensor_to_numpy": 1.708582761751984e-05, "module_to_agent_unmapping": 1.6429002915861365e-06, "normalize_and_clip_actions": 4.720332087760678e-05, "remove_single_ts_time_rank_from_batch": 6.391654852799783e-07, "un_batch_to_individual_items": 1.5193725019661093e-05, "listify_data_for_vector_env": 6.662749800840231e-06}}, "connector_pipeline_timer": 0.00015760975565522157}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 725.0, "vehicle_2": 1630.0, "vehicle_4": 1953.0, "vehicle_0": 725.0, "vehicle_1": 1802.0}, "env_to_module_sum_episodes_length_in": 50.264397531282036, "num_agent_steps_sampled_lifetime": {"vehicle_0": 17367.000000000004, "vehicle_2": 37920.99999999999, "vehicle_4": 45291.0, "vehicle_1": 41791.0, "vehicle_5": 45991.99999999999, "vehicle_3": 17994.0}, "episode_return_mean": 2104.7489061071187, "num_env_steps_sampled_lifetime": 47000.0, "time_between_sampling": 0.6121304114521713, "episode_return_min": 1881.985686302185, "episode_len_max": 116, "num_module_steps_sampled_lifetime": {"shared_policy": 206356.0}, "module_episode_returns_mean": {"shared_policy": 911.1852144254957}, "episode_len_min": 108, "weights_seq_no": 42.0, "episode_duration_sec_mean": 0.06757829720302004, "num_module_steps_sampled": {"shared_policy": 8813.0}, "num_episodes_lifetime": 418.0, "episode_return_max": 2236.247615456581, "env_to_module_sum_episodes_length_out": 50.264397531282036, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1674.0253564690704}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005369918748408943, "agent_to_module_mapping": 0.003231069587151987, "general_advantage_estimation": 0.016687823682824062, "add_time_dim_to_batch_and_zero_pad": 1.1174403421790638e-05, "add_columns_from_episodes_to_train_batch": 0.048243362745526756, "add_states_from_episodes_to_batch": 3.4135896878207705e-06, "numpy_to_tensor": 0.00018739395807420626, "batch_individual_items": 0.09479096614120554, "add_observations_from_episodes_to_batch": 0.0003489957402469416}}, "connector_pipeline_timer": 0.16903602374763615}, "learner_connector_sum_episodes_length_in": 1997.2422036565233, "num_env_steps_trained": 1418000, "num_module_steps_trained_lifetime": 3710464, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 57792000, "num_module_steps_trained": 90752, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.2422036565233, "num_env_steps_trained_lifetime_throughput": 1095513.5505699462, "num_module_steps_trained_throughput": 70213.45916645195, "num_module_steps_trained_lifetime_throughput": 70213.03521253643}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.525454521179199, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.687544822692871, "total_loss": 9.5667724609375, "num_module_steps_trained": 90752, "num_trainable_parameters": 149763, "entropy": 0.17381645739078522, "vf_loss_unclipped": 4573.75, "weights_seq_no": 43.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.14245235919952393, "policy_loss": -0.12169971317052841, "mean_kl_loss": 0.005918266251683235, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3710464, "num_module_steps_trained_lifetime_throughput": 70213.85585088602}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 47000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 10}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 43, "trial_id": "a8246_00000", "date": "2025-06-25_20-55-56", "timestamp": 1750910156, "time_this_iter_s": 63.756676197052, "time_total_s": 771.7339262962341, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b132660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 771.7339262962341, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 9.473333333333334, "ram_util_percent": 52.10222222222221}}
{"timers": {"training_iteration": 7.445878783353466, "restore_env_runners": 0.001590004535605792, "training_step": 7.444162780955683, "env_runner_sampling_timer": 6.1831723138640555, "learner_update_timer": 1.2588979165507468, "synch_weights": 0.0008870888912217192, "synch_env_connectors": 0.008523409271796798}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.329150083824061e-05, "add_time_dim_to_batch_and_zero_pad": 7.81250128056854e-06, "add_observations_from_episodes_to_batch": 4.439599797478874e-05, "add_states_from_episodes_to_batch": 3.5420016502030194e-06, "agent_to_module_mapping": 5.707999662263319e-06, "numpy_to_tensor": 2.4083499738480896e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.86561110895037e-06, "batch_individual_items": 9.261184211131905e-06, "add_time_dim_to_batch_and_zero_pad": 2.613262881558527e-06, "add_observations_from_episodes_to_batch": 1.4874094334370532e-05, "add_states_from_episodes_to_batch": 1.6643691847439835e-06, "agent_to_module_mapping": 2.769281255824453e-06}}, "connector_pipeline_timer": 6.739538320224576e-05}, "env_reset_timer": 0.00010454199946252629, "agent_episode_returns_mean": {"vehicle_1": 447.1751611471176, "vehicle_5": 504.00628501210883, "vehicle_3": 112.47905891827173, "vehicle_2": 254.57760544572557, "vehicle_4": 614.3993908003398, "vehicle_0": 161.020437944276}, "sample": 0.1311019246172945, "rlmodule_inference_timer": 0.0001007048726477144, "agent_steps": {"vehicle_5": 110.51428571428572, "vehicle_3": 40.76571428571429, "vehicle_2": 90.15142857142858, "vehicle_0": 40.76571428571429, "vehicle_4": 107.96285714285713, "vehicle_1": 100.2142857142857}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.79428571428572, "env_step_timer": 0.00014718107631865747, "connector_pipeline_timer": 0.00023604150192113593, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.913480974901681e-05, "tensor_to_numpy": 1.7581206528114577e-05, "module_to_agent_unmapping": 1.6679059849022352e-06, "normalize_and_clip_actions": 4.848623405950631e-05, "remove_single_ts_time_rank_from_batch": 6.639918828526191e-07, "un_batch_to_individual_items": 1.5301579598831235e-05, "listify_data_for_vector_env": 6.8252807051446625e-06}}, "connector_pipeline_timer": 0.00016050783045710245}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 716.0, "vehicle_2": 1618.0, "vehicle_4": 1932.0, "vehicle_0": 716.0, "vehicle_1": 1805.0}, "env_to_module_sum_episodes_length_in": 49.386039844596944, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4843.000000000001, "vehicle_2": 10525.0, "vehicle_4": 12635.0, "vehicle_1": 11647.000000000002, "vehicle_5": 12857.999999999996, "vehicle_3": 4843.000000000001}, "episode_return_mean": 2093.6579385811942, "num_env_steps_sampled_lifetime": 13000.0, "time_between_sampling": 0.33901137273974663, "episode_return_min": 1808.3215489387512, "episode_len_max": 116, "num_module_steps_sampled_lifetime": {"shared_policy": 57351.0}, "module_episode_returns_mean": {"shared_policy": 981.7263422645843}, "episode_len_min": 108, "weights_seq_no": 43.0, "episode_duration_sec_mean": 0.07257401002637509, "num_module_steps_sampled": {"shared_policy": 8765.0}, "num_episodes_lifetime": 113.0, "episode_return_max": 2225.8845069408417, "env_to_module_sum_episodes_length_out": 49.386039844596944, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1667.7616938800406}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005383541640919336, "agent_to_module_mapping": 0.0032355163912641174, "general_advantage_estimation": 0.016707349616013164, "add_time_dim_to_batch_and_zero_pad": 1.1160999338937055e-05, "add_columns_from_episodes_to_train_batch": 0.04834527286801398, "add_states_from_episodes_to_batch": 3.402373785023002e-06, "numpy_to_tensor": 0.00018648126846417876, "batch_individual_items": 0.09428305355982304, "add_observations_from_episodes_to_batch": 0.00035036453287952716}}, "connector_pipeline_timer": 0.16866758726016137}, "learner_connector_sum_episodes_length_in": 1997.2697816199582, "num_env_steps_trained": 1412000, "num_module_steps_trained_lifetime": 3800832, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 59204000, "num_module_steps_trained": 90368, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.2697816199582, "num_env_steps_trained_lifetime_throughput": 1094418.3541253477, "num_module_steps_trained_throughput": 70137.9824495482, "num_module_steps_trained_lifetime_throughput": 70137.71139016033}, "shared_policy": {"gradients_default_optimizer_global_norm": 10.10254192352295, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.601417541503906, "total_loss": 9.70206069946289, "num_module_steps_trained": 90368, "num_trainable_parameters": 149763, "entropy": 0.24911317229270935, "vf_loss_unclipped": 3952.431640625, "weights_seq_no": 44.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.04235506057739258, "policy_loss": 0.10024097561836243, "mean_kl_loss": 0.006428340449929237, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3800832, "num_module_steps_trained_lifetime_throughput": 70138.32952655676}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 13000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 11}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 44, "trial_id": "a8246_00000", "date": "2025-06-25_20-55-58", "timestamp": 1750910158, "time_this_iter_s": 2.1691713333129883, "time_total_s": 773.9030976295471, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 773.9030976295471, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 13.775, "ram_util_percent": 51.95}}
{"timers": {"training_iteration": 8.008089703439941, "restore_env_runners": 0.0015741499002287999, "training_step": 8.006389383976163, "env_runner_sampling_timer": 6.7430460828054155, "learner_update_timer": 1.2612483757152053, "synch_weights": 0.000886239252269213, "synch_env_connectors": 0.008447037259073116}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3958200472407043e-05, "add_time_dim_to_batch_and_zero_pad": 7.97500106273219e-06, "add_observations_from_episodes_to_batch": 4.7091797750908884e-05, "add_states_from_episodes_to_batch": 3.592002030927688e-06, "agent_to_module_mapping": 5.791400326415896e-06, "numpy_to_tensor": 2.4683600349817426e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0028159463344836e-05, "batch_individual_items": 9.201663120133137e-06, "add_time_dim_to_batch_and_zero_pad": 2.6116117729598324e-06, "add_observations_from_episodes_to_batch": 1.5118481336834792e-05, "add_states_from_episodes_to_batch": 1.6938906747833346e-06, "agent_to_module_mapping": 2.8027348868772563e-06}}, "connector_pipeline_timer": 6.801607730176343e-05}, "env_reset_timer": 0.00010462539939908311, "agent_episode_returns_mean": {"vehicle_1": 427.71125792026504, "vehicle_5": 499.94448410987854, "vehicle_3": 141.73896538734436, "vehicle_2": 261.8573746919632, "vehicle_4": 614.3213387584686, "vehicle_0": 161.1582779169083}, "sample": 0.13164184614757135, "rlmodule_inference_timer": 6.735124563377413e-05, "agent_steps": {"vehicle_5": 110.36, "vehicle_3": 40.46, "vehicle_2": 90.34000000000002, "vehicle_0": 40.46, "vehicle_4": 108.0, "vehicle_1": 102.31999999999998}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.72, "env_step_timer": 0.00015250632231052612, "connector_pipeline_timer": 0.00024398320238105953, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7013252909999075e-05, "tensor_to_numpy": 1.667930212506482e-05, "module_to_agent_unmapping": 1.6713314710791344e-06, "normalize_and_clip_actions": 4.7753030569046374e-05, "remove_single_ts_time_rank_from_batch": 6.828893233992763e-07, "un_batch_to_individual_items": 1.532871253698078e-05, "listify_data_for_vector_env": 6.838808534228904e-06}}, "connector_pipeline_timer": 0.00015677898081022822}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 707.0000000000001, "vehicle_2": 1613.0, "vehicle_4": 1935.9999999999998, "vehicle_0": 707.0000000000001, "vehicle_1": 1829.0000000000002}, "env_to_module_sum_episodes_length_in": 49.917868373082314, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5550.000000000001, "vehicle_2": 12137.999999999998, "vehicle_4": 14571.000000000002, "vehicle_1": 13476.000000000002, "vehicle_5": 14835.999999999995, "vehicle_3": 5550.000000000001}, "episode_return_mean": 2106.7316962575915, "num_env_steps_sampled_lifetime": 15000.0, "time_between_sampling": 0.30993169731389336, "episode_return_min": 1808.3215489387512, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 66121.0}, "module_episode_returns_mean": {"shared_policy": 917.0327949047089}, "episode_len_min": 108, "weights_seq_no": 44.0, "episode_duration_sec_mean": 0.0730748101999052, "num_module_steps_sampled": {"shared_policy": 8770.0}, "num_episodes_lifetime": 130.0, "episode_return_max": 2242.661694288254, "env_to_module_sum_episodes_length_out": 49.917868373082314, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1643.2286963708937}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005399282474535564, "agent_to_module_mapping": 0.003243134147336779, "general_advantage_estimation": 0.016719691949842044, "add_time_dim_to_batch_and_zero_pad": 1.1191469370945858e-05, "add_columns_from_episodes_to_train_batch": 0.04844646429937811, "add_states_from_episodes_to_batch": 3.395850038292611e-06, "numpy_to_tensor": 0.00018546437579825087, "batch_individual_items": 0.09455974885417189, "add_observations_from_episodes_to_batch": 0.0003517883875272067}}, "connector_pipeline_timer": 0.16908135554758322}, "learner_connector_sum_episodes_length_in": 1997.2970838037586, "num_env_steps_trained": 1412000, "num_module_steps_trained_lifetime": 3891200, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 60616000, "num_module_steps_trained": 90368, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.2970838037586, "num_env_steps_trained_lifetime_throughput": 1096399.9261653484, "num_module_steps_trained_throughput": 70259.99301928382, "num_module_steps_trained_lifetime_throughput": 70259.73941810144}, "shared_policy": {"gradients_default_optimizer_global_norm": 2.6758251190185547, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.845291137695312, "total_loss": 9.82198429107666, "num_module_steps_trained": 90368, "num_trainable_parameters": 149763, "entropy": 0.17405909299850464, "vf_loss_unclipped": 3983.73828125, "weights_seq_no": 45.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.2830864191055298, "policy_loss": -0.02584143728017807, "mean_kl_loss": 0.009500711224973202, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3891200, "num_module_steps_trained_lifetime_throughput": 70260.28234313303}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 15000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 11}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 45, "trial_id": "a8246_00000", "date": "2025-06-25_20-57-02", "timestamp": 1750910222, "time_this_iter_s": 63.66965079307556, "time_total_s": 837.5727484226227, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b107ba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 837.5727484226227, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 8.931111111111111, "ram_util_percent": 51.914444444444435}}
{"timers": {"training_iteration": 8.565770373485556, "restore_env_runners": 0.0015986196511697526, "training_step": 8.564045390556382, "env_runner_sampling_timer": 7.298910504897379, "learner_update_timer": 1.263036800708084, "synch_weights": 0.000885146859757599, "synch_env_connectors": 0.008372589806442125}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.60791988694109e-05, "add_time_dim_to_batch_and_zero_pad": 8.487499871989713e-06, "add_observations_from_episodes_to_batch": 5.5649997375439855e-05, "add_states_from_episodes_to_batch": 3.7128033000044524e-06, "agent_to_module_mapping": 6.012502126395702e-06, "numpy_to_tensor": 2.6433902530698105e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.46544045416665e-06, "batch_individual_items": 8.934275081072766e-06, "add_time_dim_to_batch_and_zero_pad": 2.4648949141251134e-06, "add_observations_from_episodes_to_batch": 1.4421515621772084e-05, "add_states_from_episodes_to_batch": 1.6205306773419235e-06, "agent_to_module_mapping": 2.6879156576227264e-06}}, "connector_pipeline_timer": 6.523339408286655e-05}, "env_reset_timer": 0.00010400479877716861, "agent_episode_returns_mean": {"vehicle_1": 443.7374650976393, "vehicle_5": 516.1553801218669, "vehicle_3": 115.45255725860596, "vehicle_2": 268.49044108152384, "vehicle_4": 607.3520304785835, "vehicle_0": 159.9222527949015}, "sample": 0.13252264570693778, "rlmodule_inference_timer": 6.416567210039501e-05, "agent_steps": {"vehicle_5": 110.19555555555554, "vehicle_3": 40.77111111111111, "vehicle_2": 90.46, "vehicle_0": 40.77111111111111, "vehicle_4": 108.0, "vehicle_1": 100.2822222222222}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.22444444444446, "env_step_timer": 0.00014610204971445847, "connector_pipeline_timer": 0.00027076250335085207, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.810919905314755e-05, "tensor_to_numpy": 1.69869555644953e-05, "module_to_agent_unmapping": 1.6167209557239436e-06, "normalize_and_clip_actions": 4.7067325393581046e-05, "remove_single_ts_time_rank_from_batch": 6.613933726094394e-07, "un_batch_to_individual_items": 1.5214320268534455e-05, "listify_data_for_vector_env": 6.673531760680527e-06}}, "connector_pipeline_timer": 0.00015650311726652242}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 740.0, "vehicle_2": 1635.0, "vehicle_4": 1943.0, "vehicle_0": 740.0, "vehicle_1": 1797.0}, "env_to_module_sum_episodes_length_in": 48.723377827076696, "num_agent_steps_sampled_lifetime": {"vehicle_0": 10546.0, "vehicle_2": 23517.0, "vehicle_4": 28090.999999999993, "vehicle_1": 26349.000000000007, "vehicle_5": 28698.0, "vehicle_3": 10546.0}, "episode_return_mean": 2111.110128149191, "num_env_steps_sampled_lifetime": 29000.0, "time_between_sampling": 1.0786623996926086, "episode_return_min": 1974.2211854457855, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 127747.0}, "module_episode_returns_mean": {"shared_policy": 977.484262499809}, "episode_len_min": 108, "weights_seq_no": 45.0, "episode_duration_sec_mean": 0.06934959234815326, "num_module_steps_sampled": {"shared_policy": 8837.0}, "num_episodes_lifetime": 256.99999999999994, "episode_return_max": 2203.469151735306, "env_to_module_sum_episodes_length_out": 48.723377827076696, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1635.368111243344}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005412945069779232, "agent_to_module_mapping": 0.003247933225847964, "general_advantage_estimation": 0.01674448170030452, "add_time_dim_to_batch_and_zero_pad": 1.1169964707916178e-05, "add_columns_from_episodes_to_train_batch": 0.048544180076408414, "add_states_from_episodes_to_batch": 3.38730151020485e-06, "numpy_to_tensor": 0.00018451806207950598, "batch_individual_items": 0.09406970969562543, "add_observations_from_episodes_to_batch": 0.00035293050370156017}}, "connector_pipeline_timer": 0.16873198032208972}, "learner_connector_sum_episodes_length_in": 1997.324112965721, "num_env_steps_trained": 1422000, "num_module_steps_trained_lifetime": 3982208, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 62038000, "num_module_steps_trained": 91008, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1997.324112965721, "num_env_steps_trained_lifetime_throughput": 1095404.7605770468, "num_module_steps_trained_throughput": 70191.9928341234, "num_module_steps_trained_lifetime_throughput": 70191.66897095034}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.774980545043945, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.53776741027832, "total_loss": 9.449051856994629, "num_module_steps_trained": 91008, "num_trainable_parameters": 149763, "entropy": 0.18844424188137054, "vf_loss_unclipped": 4147.16259765625, "weights_seq_no": 46.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.26727378368377686, "policy_loss": -0.09038781374692917, "mean_kl_loss": 0.00790393352508545, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 3982208, "num_module_steps_trained_lifetime_throughput": 70192.37283123031}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 29000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 12}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 46, "trial_id": "a8246_00000", "date": "2025-06-25_20-58-06", "timestamp": 1750910286, "time_this_iter_s": 63.77892780303955, "time_total_s": 901.3516762256622, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c1620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 901.3516762256622, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 9.565934065934066, "ram_util_percent": 52.04505494505492}}
{"timers": {"training_iteration": 9.715762708920694, "restore_env_runners": 0.0024228338746468876, "training_step": 9.713213306230806, "env_runner_sampling_timer": 8.44813988484838, "learner_update_timer": 1.2629752681210278, "synch_weights": 0.0008840958011814686, "synch_env_connectors": 0.008300813078380185}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.9343747883103788e-05, "add_time_dim_to_batch_and_zero_pad": 8.843246178003028e-06, "add_observations_from_episodes_to_batch": 4.6062499677645974e-05, "add_states_from_episodes_to_batch": 3.916498826583847e-06, "agent_to_module_mapping": 6.437747288146056e-06, "numpy_to_tensor": 2.6489253286854364e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.891466359696633e-06, "batch_individual_items": 9.315221284372104e-06, "add_time_dim_to_batch_and_zero_pad": 2.56514317728233e-06, "add_observations_from_episodes_to_batch": 1.512171806874899e-05, "add_states_from_episodes_to_batch": 1.6879757118562875e-06, "agent_to_module_mapping": 2.7753217034040965e-06}}, "connector_pipeline_timer": 6.802885409146179e-05}, "env_reset_timer": 0.00011536449892446399, "agent_episode_returns_mean": {"vehicle_1": 458.7916760611534, "vehicle_5": 509.766793525219, "vehicle_3": 129.2682701396942, "vehicle_2": 267.64270954608924, "vehicle_4": 599.5962686181068, "vehicle_0": 149.64374435663223}, "sample": 0.1368604392278995, "rlmodule_inference_timer": 6.87073886868426e-05, "agent_steps": {"vehicle_5": 109.36, "vehicle_3": 40.800000000000004, "vehicle_2": 91.21, "vehicle_0": 40.800000000000004, "vehicle_4": 108.0, "vehicle_1": 99.7}, "num_env_steps_sampled": 1600.0, "episode_len_mean": 109.36, "env_step_timer": 0.00014445979657262662, "connector_pipeline_timer": 0.00026234375036437996, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.097172167699129e-05, "tensor_to_numpy": 1.7814968981401582e-05, "module_to_agent_unmapping": 1.65453883284458e-06, "normalize_and_clip_actions": 4.878096009732993e-05, "remove_single_ts_time_rank_from_batch": 6.523498097026777e-07, "un_batch_to_individual_items": 1.5594496676662936e-05, "listify_data_for_vector_env": 6.7553730101409775e-06}}, "connector_pipeline_timer": 0.0001632304104835763}, "num_agent_steps_sampled": {"vehicle_5": 1587.0, "vehicle_3": 573.0, "vehicle_2": 1328.0, "vehicle_4": 1573.0, "vehicle_0": 573.0, "vehicle_1": 1457.0}, "env_to_module_sum_episodes_length_in": 50.35989437026532, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4710.0, "vehicle_2": 10496.0, "vehicle_4": 12470.0, "vehicle_1": 11619.0, "vehicle_5": 12678.0, "vehicle_3": 4710.0}, "episode_return_mean": 2114.7094578790666, "num_env_steps_sampled_lifetime": 12800.0, "time_between_sampling": 0.5956033527335232, "episode_return_min": 1967.3863393068314, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 56683.0}, "module_episode_returns_mean": {"shared_policy": 976.8283224010468}, "episode_len_min": 108, "weights_seq_no": 46.0, "episode_duration_sec_mean": 0.06896580741158687, "num_module_steps_sampled": {"shared_policy": 7091.0}, "num_episodes_lifetime": 112.0, "episode_return_max": 2233.36767745018, "env_to_module_sum_episodes_length_out": 50.35989437026532, "num_episodes": 13.0, "num_env_steps_sampled_lifetime_throughput": 1656.1159089509736}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005417655199096485, "agent_to_module_mapping": 0.003249250983589492, "general_advantage_estimation": 0.01674445938331846, "add_time_dim_to_batch_and_zero_pad": 1.1142015043714651e-05, "add_columns_from_episodes_to_train_batch": 0.04856812993566059, "add_states_from_episodes_to_batch": 3.3730185016619573e-06, "numpy_to_tensor": 0.00018358955149160424, "batch_individual_items": 0.09349668843869437, "add_observations_from_episodes_to_batch": 0.00035389369867565523}}, "connector_pipeline_timer": 0.16818889385888794}, "learner_connector_sum_episodes_length_in": 1993.3508718360638, "num_env_steps_trained": 913600, "num_module_steps_trained_lifetime": 4055296, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 62951600, "num_module_steps_trained": 73088, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.3508718360638, "num_env_steps_trained_lifetime_throughput": 1081454.6065786127, "num_module_steps_trained_throughput": 69948.10192063199, "num_module_steps_trained_lifetime_throughput": 69947.7400358498}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.54938268661499, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.838894844055176, "total_loss": 9.96189022064209, "num_module_steps_trained": 73088, "num_trainable_parameters": 149763, "entropy": 0.17071424424648285, "vf_loss_unclipped": 3756.12158203125, "weights_seq_no": 47.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.057126760482788086, "policy_loss": 0.12227865308523178, "mean_kl_loss": 0.005384888034313917, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4055296, "num_module_steps_trained_lifetime_throughput": 69948.48414272131}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12800.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 13}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 47, "trial_id": "a8246_00000", "date": "2025-06-25_21-00-11", "timestamp": 1750910411, "time_this_iter_s": 124.86978530883789, "time_total_s": 1026.2214615345001, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c2840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1026.2214615345001, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 9.14858757062147, "ram_util_percent": 51.97683615819208}}
{"timers": {"training_iteration": 10.253686309741465, "restore_env_runners": 0.002477085115870426, "training_step": 10.251081147338484, "env_runner_sampling_timer": 8.984047428089891, "learner_update_timer": 1.2649321179398025, "synch_weights": 0.0008839669231859204, "synch_env_connectors": 0.021242757447650883}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.190880088368431e-05, "add_time_dim_to_batch_and_zero_pad": 1.1549801274668426e-05, "add_observations_from_episodes_to_batch": 5.345899990061298e-05, "add_states_from_episodes_to_batch": 5.241998587734998e-06, "agent_to_module_mapping": 7.84220319474116e-06, "numpy_to_tensor": 3.2507801370229573e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0458332919965354e-05, "batch_individual_items": 9.855331675235367e-06, "add_time_dim_to_batch_and_zero_pad": 2.677940458101297e-06, "add_observations_from_episodes_to_batch": 1.583254456712841e-05, "add_states_from_episodes_to_batch": 1.7204352886372968e-06, "agent_to_module_mapping": 2.909369555822097e-06}}, "connector_pipeline_timer": 7.112737043558927e-05}, "env_reset_timer": 0.0001568163963383995, "agent_episode_returns_mean": {"vehicle_1": 450.1795911860466, "vehicle_5": 505.1442242574692, "vehicle_3": 137.77281493663787, "vehicle_2": 264.44720242500307, "vehicle_4": 604.9633147096633, "vehicle_0": 158.933996720314}, "sample": 0.14149554387942237, "rlmodule_inference_timer": 7.262536120422461e-05, "agent_steps": {"vehicle_5": 109.56, "vehicle_3": 40.42, "vehicle_2": 90.64, "vehicle_0": 40.42, "vehicle_4": 108.0, "vehicle_1": 99.92}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.56, "env_step_timer": 0.0001509349571333645, "connector_pipeline_timer": 0.00030527459894074126, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.506202437432997e-05, "tensor_to_numpy": 1.959974550702352e-05, "module_to_agent_unmapping": 1.7627413687119191e-06, "normalize_and_clip_actions": 5.4041814151620354e-05, "remove_single_ts_time_rank_from_batch": 6.862364410352857e-07, "un_batch_to_individual_items": 1.6720467100885615e-05, "listify_data_for_vector_env": 7.29054021687219e-06}}, "connector_pipeline_timer": 0.00017889498316700462}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 751.0, "vehicle_2": 1635.0, "vehicle_4": 1960.0, "vehicle_0": 751.0, "vehicle_1": 1798.0}, "env_to_module_sum_episodes_length_in": 47.874716304782254, "num_agent_steps_sampled_lifetime": {"vehicle_0": 2360.9999999999995, "vehicle_2": 5173.999999999999, "vehicle_4": 6070.0, "vehicle_1": 5660.0, "vehicle_5": 6148.999999999998, "vehicle_3": 2360.9999999999995}, "episode_return_mean": 2121.441145656109, "num_env_steps_sampled_lifetime": 6200.0, "time_between_sampling": 0.08190638392894695, "episode_return_min": 1814.1691625118256, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 27775.0}, "module_episode_returns_mean": {"shared_policy": 991.3126374363899}, "episode_len_min": 108, "weights_seq_no": 47.0, "episode_duration_sec_mean": 0.07016127819995746, "num_module_steps_sampled": {"shared_policy": 8878.0}, "num_episodes_lifetime": 51.0, "episode_return_max": 2223.4286445379257, "env_to_module_sum_episodes_length_out": 47.874716304782254, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1626.8703136484444}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005434260307066151, "agent_to_module_mapping": 0.003255500133781478, "general_advantage_estimation": 0.016766172289475238, "add_time_dim_to_batch_and_zero_pad": 1.1118094904709489e-05, "add_columns_from_episodes_to_train_batch": 0.04867974654629371, "add_states_from_episodes_to_batch": 3.36095830120766e-06, "numpy_to_tensor": 0.0001826303259232805, "batch_individual_items": 0.0930232073942947, "add_observations_from_episodes_to_batch": 0.0003558401816586716}}, "connector_pipeline_timer": 0.16787218492029246}, "learner_connector_sum_episodes_length_in": 1993.4173631177032, "num_env_steps_trained": 1428000, "num_module_steps_trained_lifetime": 4146688, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 64379600, "num_module_steps_trained": 91392, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.4173631177032, "num_env_steps_trained_lifetime_throughput": 1080385.4718974177, "num_module_steps_trained_throughput": 69842.79671686438, "num_module_steps_trained_lifetime_throughput": 69842.4930771897}, "shared_policy": {"gradients_default_optimizer_global_norm": 20.290857315063477, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.742022514343262, "total_loss": 9.662216186523438, "num_module_steps_trained": 91392, "num_trainable_parameters": 149763, "entropy": 0.08767139911651611, "vf_loss_unclipped": 4506.837890625, "weights_seq_no": 48.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.13788831233978271, "policy_loss": -0.08456403762102127, "mean_kl_loss": 0.012520833872258663, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4146688, "num_module_steps_trained_lifetime_throughput": 69843.0963442921}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6200.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 15}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 48, "trial_id": "a8246_00000", "date": "2025-06-25_21-01-14", "timestamp": 1750910474, "time_this_iter_s": 63.5106520652771, "time_total_s": 1089.7321135997772, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b132d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1089.7321135997772, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 9.378888888888888, "ram_util_percent": 51.98444444444445}}
{"timers": {"training_iteration": 10.173782921224047, "restore_env_runners": 0.0024903734247086412, "training_step": 10.171163844195126, "env_runner_sampling_timer": 8.902512513808999, "learner_update_timer": 1.2665465346704097, "synch_weights": 0.0008828630939262173, "synch_env_connectors": 0.021039327373219015}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.5333501980639994e-05, "add_time_dim_to_batch_and_zero_pad": 1.0020499757956713e-05, "add_observations_from_episodes_to_batch": 4.368800000520423e-05, "add_states_from_episodes_to_batch": 4.374996933620423e-06, "agent_to_module_mapping": 6.479498551925644e-06, "numpy_to_tensor": 3.116649895673618e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.838439359575917e-06, "batch_individual_items": 9.218226411331534e-06, "add_time_dim_to_batch_and_zero_pad": 2.6053792583948266e-06, "add_observations_from_episodes_to_batch": 1.5144231543563409e-05, "add_states_from_episodes_to_batch": 1.6580006863622277e-06, "agent_to_module_mapping": 2.792788999158726e-06}}, "connector_pipeline_timer": 6.760339926090449e-05}, "env_reset_timer": 0.00012654099555220455, "agent_episode_returns_mean": {"vehicle_1": 452.53091801762565, "vehicle_5": 511.7325540556227, "vehicle_3": 128.29378123215264, "vehicle_2": 238.11438977888653, "vehicle_4": 612.4547467299869, "vehicle_0": 161.42936598845893}, "sample": 0.13696903581030964, "rlmodule_inference_timer": 0.00011800737951798689, "agent_steps": {"vehicle_5": 109.40857142857143, "vehicle_3": 40.64571428571428, "vehicle_2": 91.32285714285713, "vehicle_0": 40.64571428571428, "vehicle_4": 108.0, "vehicle_1": 101.18}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.9085714285714, "env_step_timer": 0.00014766264463385924, "connector_pipeline_timer": 0.0002598745013528969, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9836308708690477e-05, "tensor_to_numpy": 1.7589151421404556e-05, "module_to_agent_unmapping": 1.6535694361199227e-06, "normalize_and_clip_actions": 4.836019918677286e-05, "remove_single_ts_time_rank_from_batch": 6.424178504666465e-07, "un_batch_to_individual_items": 1.5558719866403286e-05, "listify_data_for_vector_env": 6.82307639584519e-06}}, "connector_pipeline_timer": 0.0001611413578622217}, "num_agent_steps_sampled": {"vehicle_5": 1965.9999999999998, "vehicle_3": 722.0000000000001, "vehicle_2": 1645.9999999999998, "vehicle_4": 1937.0, "vehicle_0": 722.0000000000001, "vehicle_1": 1828.0}, "env_to_module_sum_episodes_length_in": 48.17465327314206, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4451.0, "vehicle_2": 9922.999999999998, "vehicle_4": 11689.0, "vehicle_1": 10977.000000000002, "vehicle_5": 11871.0, "vehicle_3": 4451.0}, "episode_return_mean": 2104.555757195098, "num_env_steps_sampled_lifetime": 12000.0, "time_between_sampling": 0.3451661141671331, "episode_return_min": 1973.8505454063416, "episode_len_max": 118, "num_module_steps_sampled_lifetime": {"shared_policy": 53361.999999999985}, "module_episode_returns_mean": {"shared_policy": 988.0151050070353}, "episode_len_min": 108, "weights_seq_no": 48.0, "episode_duration_sec_mean": 0.07212748815097646, "num_module_steps_sampled": {"shared_policy": 8821.0}, "num_episodes_lifetime": 104.00000000000003, "episode_return_max": 2292.9043865203857, "env_to_module_sum_episodes_length_out": 48.17465327314206, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1625.8325798444253}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00544612104395219, "agent_to_module_mapping": 0.0032607318024437224, "general_advantage_estimation": 0.01679377181655404, "add_time_dim_to_batch_and_zero_pad": 1.1080664007914246e-05, "add_columns_from_episodes_to_train_batch": 0.048764444910839415, "add_states_from_episodes_to_batch": 3.347348724966299e-06, "numpy_to_tensor": 0.00018162944265695468, "batch_individual_items": 0.09252996240038096, "add_observations_from_episodes_to_batch": 0.0003569021998464425}}, "connector_pipeline_timer": 0.16750774349113653}, "learner_connector_sum_episodes_length_in": 1993.483189486526, "num_env_steps_trained": 1420000, "num_module_steps_trained_lifetime": 4237568, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 65799600, "num_module_steps_trained": 90880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.483189486526, "num_env_steps_trained_lifetime_throughput": 1081747.0690178035, "num_module_steps_trained_throughput": 69895.45449149447, "num_module_steps_trained_lifetime_throughput": 69894.99840072144}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.80337381362915, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.575848579406738, "total_loss": 9.449925422668457, "num_module_steps_trained": 90880, "num_trainable_parameters": 149763, "entropy": 0.1642421931028366, "vf_loss_unclipped": 4002.124755859375, "weights_seq_no": 49.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.0722130537033081, "policy_loss": -0.12733018398284912, "mean_kl_loss": 0.006775376852601767, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4237568, "num_module_steps_trained_lifetime_throughput": 69895.93825921831}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 16}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 49, "trial_id": "a8246_00000", "date": "2025-06-25_21-01-16", "timestamp": 1750910476, "time_this_iter_s": 2.265413999557495, "time_total_s": 1091.9975275993347, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c1580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1091.9975275993347, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 52.1}}
{"timers": {"training_iteration": 10.093716774921825, "restore_env_runners": 0.002465523440507036, "training_step": 10.091122412423198, "env_runner_sampling_timer": 8.82089764033095, "learner_update_timer": 1.2681173118236793, "synch_weights": 0.0008822161329691052, "synch_env_connectors": 0.020837258269462648}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.5333501980639994e-05, "add_time_dim_to_batch_and_zero_pad": 1.0020499757956713e-05, "add_observations_from_episodes_to_batch": 4.368800000520423e-05, "add_states_from_episodes_to_batch": 4.374996933620423e-06, "agent_to_module_mapping": 6.479498551925644e-06, "numpy_to_tensor": 3.116649895673618e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.45864812758722e-06, "batch_individual_items": 8.889796216155056e-06, "add_time_dim_to_batch_and_zero_pad": 2.5867151091920497e-06, "add_observations_from_episodes_to_batch": 1.4709344935196042e-05, "add_states_from_episodes_to_batch": 1.6666568241079121e-06, "agent_to_module_mapping": 2.779414195103123e-06}}, "connector_pipeline_timer": 6.60645714908239e-05}, "env_reset_timer": 0.00012654099555220455, "agent_episode_returns_mean": {"vehicle_1": 449.881524144411, "vehicle_5": 497.19980017185213, "vehicle_3": 147.25682218551637, "vehicle_2": 193.57012859344482, "vehicle_4": 602.9339438819885, "vehicle_0": 150.87754489898683}, "sample": 0.13691757925858197, "rlmodule_inference_timer": 0.0001001356944606607, "agent_steps": {"vehicle_5": 111.07999999999997, "vehicle_3": 40.459999999999994, "vehicle_2": 93.1, "vehicle_0": 40.459999999999994, "vehicle_4": 108.0, "vehicle_1": 101.74000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 111.53999999999998, "env_step_timer": 0.0001468734656146785, "connector_pipeline_timer": 0.0002598745013528969, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.587466588331727e-05, "tensor_to_numpy": 1.620943841839771e-05, "module_to_agent_unmapping": 1.6009139016872249e-06, "normalize_and_clip_actions": 4.5896993998928525e-05, "remove_single_ts_time_rank_from_batch": 6.26918611815381e-07, "un_batch_to_individual_items": 1.4969632857768706e-05, "listify_data_for_vector_env": 6.61391195713547e-06}}, "connector_pipeline_timer": 0.00015179691864832998}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 702.9999999999999, "vehicle_2": 1650.0, "vehicle_4": 1925.0, "vehicle_0": 702.9999999999999, "vehicle_1": 1795.0}, "env_to_module_sum_episodes_length_in": 50.835585204237866, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5154.0, "vehicle_2": 11572.999999999998, "vehicle_4": 13614.0, "vehicle_1": 12772.0, "vehicle_5": 13853.0, "vehicle_3": 5154.0}, "episode_return_mean": 2041.7197651445865, "num_env_steps_sampled_lifetime": 14000.0, "time_between_sampling": 0.3116616088562986, "episode_return_min": 1914.397118806839, "episode_len_max": 118, "num_module_steps_sampled_lifetime": {"shared_policy": 62119.999999999985}, "module_episode_returns_mean": {"shared_policy": 914.6805611133575}, "episode_len_min": 108, "weights_seq_no": 49.0, "episode_duration_sec_mean": 0.07315741411875935, "num_module_steps_sampled": {"shared_policy": 8758.0}, "num_episodes_lifetime": 122.00000000000003, "episode_return_max": 2206.148784637451, "env_to_module_sum_episodes_length_out": 50.835585204237866, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1645.2921796985495}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005458256923484433, "agent_to_module_mapping": 0.003267107814433447, "general_advantage_estimation": 0.016811287018365748, "add_time_dim_to_batch_and_zero_pad": 1.1066947382440886e-05, "add_columns_from_episodes_to_train_batch": 0.04885976546172517, "add_states_from_episodes_to_batch": 3.33428524469891e-06, "numpy_to_tensor": 0.00018070314824064366, "batch_individual_items": 0.09204385902638568, "add_observations_from_episodes_to_batch": 0.0003580202578476903}}, "connector_pipeline_timer": 0.16715273772620456}, "learner_connector_sum_episodes_length_in": 1993.5483575916608, "num_env_steps_trained": 1410000, "num_module_steps_trained_lifetime": 4327808, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 67209600, "num_module_steps_trained": 90240, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.5483575916608, "num_env_steps_trained_lifetime_throughput": 1082193.4108006177, "num_module_steps_trained_throughput": 69890.92309936234, "num_module_steps_trained_lifetime_throughput": 69890.47170899583}, "shared_policy": {"gradients_default_optimizer_global_norm": 6.705488204956055, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.689650535583496, "total_loss": 9.753019332885742, "num_module_steps_trained": 90240, "num_trainable_parameters": 149763, "entropy": 0.3212888836860657, "vf_loss_unclipped": 3652.906982421875, "weights_seq_no": 50.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.007979094982147217, "policy_loss": 0.06359328329563141, "mean_kl_loss": 0.006638421211391687, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4327808, "num_module_steps_trained_lifetime_throughput": 69891.3948569572}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 16}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 50, "trial_id": "a8246_00000", "date": "2025-06-25_21-01-19", "timestamp": 1750910479, "time_this_iter_s": 2.169481039047241, "time_total_s": 1094.167008638382, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1094.167008638382, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 13.399999999999999, "ram_util_percent": 52.074999999999996}}
{"timers": {"training_iteration": 10.01499277301261, "restore_env_runners": 0.002440934876138142, "training_step": 10.01242245829901, "env_runner_sampling_timer": 8.739611381427622, "learner_update_timer": 1.2706999399554089, "synch_weights": 0.0008819377215759213, "synch_env_connectors": 0.020639133186726517}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.5333501980639994e-05, "add_time_dim_to_batch_and_zero_pad": 1.0020499757956713e-05, "add_observations_from_episodes_to_batch": 4.368800000520423e-05, "add_states_from_episodes_to_batch": 4.374996933620423e-06, "agent_to_module_mapping": 6.479498551925644e-06, "numpy_to_tensor": 3.116649895673618e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.355261856544223e-06, "batch_individual_items": 8.892335461039019e-06, "add_time_dim_to_batch_and_zero_pad": 2.567597831729928e-06, "add_observations_from_episodes_to_batch": 1.4852685332513151e-05, "add_states_from_episodes_to_batch": 1.6473420713412024e-06, "agent_to_module_mapping": 2.772489310890513e-06}}, "connector_pipeline_timer": 6.599895223018361e-05}, "env_reset_timer": 0.00012654099555220455, "agent_episode_returns_mean": {"vehicle_1": 443.467072160244, "vehicle_5": 490.13676238298416, "vehicle_3": 144.06595231056212, "vehicle_2": 198.58793823957444, "vehicle_4": 609.8956181240081, "vehicle_0": 161.23438499927516}, "sample": 0.136775013641028, "rlmodule_inference_timer": 6.342419441598632e-05, "agent_steps": {"vehicle_5": 110.69999999999999, "vehicle_3": 42.599999999999994, "vehicle_2": 91.67999999999998, "vehicle_0": 42.92, "vehicle_4": 107.96, "vehicle_1": 100.64}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.73999999999998, "env_step_timer": 0.00014759527406452266, "connector_pipeline_timer": 0.0002598745013528969, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.56486331338874e-05, "tensor_to_numpy": 1.6164842814740615e-05, "module_to_agent_unmapping": 1.6366693970857602e-06, "normalize_and_clip_actions": 4.619525156097996e-05, "remove_single_ts_time_rank_from_batch": 6.434035657451515e-07, "un_batch_to_individual_items": 1.5211286250935252e-05, "listify_data_for_vector_env": 6.636510571327713e-06}}, "connector_pipeline_timer": 0.00015217906540861413}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 764.0, "vehicle_2": 1629.0000000000002, "vehicle_4": 1925.9999999999998, "vehicle_0": 772.0000000000001, "vehicle_1": 1794.0000000000002}, "env_to_module_sum_episodes_length_in": 50.28369639587565, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5926.0, "vehicle_2": 13202.0, "vehicle_4": 15540.0, "vehicle_1": 14566.0, "vehicle_5": 15834.0, "vehicle_3": 5918.0}, "episode_return_mean": 2047.3877268242836, "num_env_steps_sampled_lifetime": 16000.0, "time_between_sampling": 0.31122295104731534, "episode_return_min": 1858.8902620077133, "episode_len_max": 117, "num_module_steps_sampled_lifetime": {"shared_policy": 70985.99999999999}, "module_episode_returns_mean": {"shared_policy": 888.133733484745}, "episode_len_min": 108, "weights_seq_no": 50.0, "episode_duration_sec_mean": 0.07031498259922955, "num_module_steps_sampled": {"shared_policy": 8866.0}, "num_episodes_lifetime": 141.00000000000003, "episode_return_max": 2206.148784637451, "env_to_module_sum_episodes_length_out": 50.28369639587565, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1647.5863558632805}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005471595604260429, "agent_to_module_mapping": 0.0032740192362468723, "general_advantage_estimation": 0.01683832164816261, "add_time_dim_to_batch_and_zero_pad": 1.1047937876054794e-05, "add_columns_from_episodes_to_train_batch": 0.048957324467100334, "add_states_from_episodes_to_batch": 3.322602408752312e-06, "numpy_to_tensor": 0.00017978861678753197, "batch_individual_items": 0.09234266251616384, "add_observations_from_episodes_to_batch": 0.0003592983852632353}}, "connector_pipeline_timer": 0.16759633826898465}, "learner_connector_sum_episodes_length_in": 1993.6128740157442, "num_env_steps_trained": 1426000, "num_module_steps_trained_lifetime": 4419072, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 68635600, "num_module_steps_trained": 91264, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.6128740157442, "num_env_steps_trained_lifetime_throughput": 1083494.8692247006, "num_module_steps_trained_throughput": 69942.75065795828, "num_module_steps_trained_lifetime_throughput": 69942.29876387418}, "shared_policy": {"gradients_default_optimizer_global_norm": 23.913419723510742, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.141250610351562, "total_loss": 9.1893949508667, "num_module_steps_trained": 91264, "num_trainable_parameters": 149763, "entropy": 0.2257678061723709, "vf_loss_unclipped": 3701.75439453125, "weights_seq_no": 51.0, "curr_kl_coeff": 0.45000001788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.13120722770690918, "policy_loss": 0.04257678985595703, "mean_kl_loss": 0.017388176172971725, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4419072, "num_module_steps_trained_lifetime_throughput": 69943.24067274062}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 16}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 51, "trial_id": "a8246_00000", "date": "2025-06-25_21-01-21", "timestamp": 1750910481, "time_this_iter_s": 2.223331928253174, "time_total_s": 1096.3903405666351, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1077e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1096.3903405666351, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 16.7, "ram_util_percent": 52.1}}
{"timers": {"training_iteration": 10.556897662782442, "restore_env_runners": 0.0024165676073683055, "training_step": 10.554351627465977, "env_runner_sampling_timer": 9.279094210113316, "learner_update_timer": 1.273142517635865, "synch_weights": 0.0008817000144049669, "synch_env_connectors": 0.020441383104883335}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.1366702276282007e-05, "add_time_dim_to_batch_and_zero_pad": 8.370498835574836e-06, "add_observations_from_episodes_to_batch": 3.587120008887723e-05, "add_states_from_episodes_to_batch": 3.441398439463228e-06, "agent_to_module_mapping": 5.495896766660735e-06, "numpy_to_tensor": 2.986689651152119e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.369276181033693e-06, "batch_individual_items": 8.767096205013107e-06, "add_time_dim_to_batch_and_zero_pad": 2.5529970460469506e-06, "add_observations_from_episodes_to_batch": 1.4721326577080842e-05, "add_states_from_episodes_to_batch": 1.6214370228869806e-06, "agent_to_module_mapping": 2.6774719812943957e-06}}, "connector_pipeline_timer": 6.529260871913311e-05}, "env_reset_timer": 9.844099695328623e-05, "agent_episode_returns_mean": {"vehicle_1": 446.1286492371559, "vehicle_5": 509.1819745206833, "vehicle_3": 142.1761811876297, "vehicle_2": 197.9423082947731, "vehicle_4": 613.5142586326599, "vehicle_0": 153.0753534221649}, "sample": 0.13319306509452877, "rlmodule_inference_timer": 6.488245564768071e-05, "agent_steps": {"vehicle_5": 110.52, "vehicle_3": 41.72, "vehicle_2": 92.25999999999998, "vehicle_0": 41.88, "vehicle_4": 108.0, "vehicle_1": 101.03999999999998}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.52, "env_step_timer": 0.00014872906971815698, "connector_pipeline_timer": 0.00022474130310001783, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6127506701909063e-05, "tensor_to_numpy": 1.604650891333361e-05, "module_to_agent_unmapping": 1.5968292891654022e-06, "normalize_and_clip_actions": 4.6484173464599676e-05, "remove_single_ts_time_rank_from_batch": 6.245811567157228e-07, "un_batch_to_individual_items": 1.5008878721177091e-05, "listify_data_for_vector_env": 6.630126397874973e-06}}, "connector_pipeline_timer": 0.00015225767873274174}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 749.0, "vehicle_2": 1679.0000000000002, "vehicle_4": 1945.9999999999998, "vehicle_0": 749.0, "vehicle_1": 1827.0}, "env_to_module_sum_episodes_length_in": 49.53410868926483, "num_agent_steps_sampled_lifetime": {"vehicle_0": 6675.0, "vehicle_2": 14881.0, "vehicle_4": 17486.0, "vehicle_1": 16393.0, "vehicle_5": 17817.0, "vehicle_3": 6667.0}, "episode_return_mean": 2062.0187244606013, "num_env_steps_sampled_lifetime": 18000.0, "time_between_sampling": 0.5193724713773059, "episode_return_min": 1858.8902620077133, "episode_len_max": 116, "num_module_steps_sampled_lifetime": {"shared_policy": 79919.0}, "module_episode_returns_mean": {"shared_policy": 866.5875353574753}, "episode_len_min": 108, "weights_seq_no": 51.0, "episode_duration_sec_mean": 0.06929963336049695, "num_module_steps_sampled": {"shared_policy": 8933.0}, "num_episodes_lifetime": 158.00000000000003, "episode_return_max": 2224.3311190605164, "env_to_module_sum_episodes_length_out": 49.53410868926483, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1643.1683015893618}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005495595488208589, "agent_to_module_mapping": 0.003279409043914327, "general_advantage_estimation": 0.016990687181699524, "add_time_dim_to_batch_and_zero_pad": 1.1027048527550904e-05, "add_columns_from_episodes_to_train_batch": 0.049103695382450935, "add_states_from_episodes_to_batch": 3.313546388263345e-06, "numpy_to_tensor": 0.00017891656064662875, "batch_individual_items": 0.09207929631097973, "add_observations_from_episodes_to_batch": 0.00036110748147046934}}, "connector_pipeline_timer": 0.16766183946626748}, "learner_connector_sum_episodes_length_in": 1993.6767452755867, "num_env_steps_trained": 1436000, "num_module_steps_trained_lifetime": 4510976, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 70071600, "num_module_steps_trained": 91904, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.6767452755867, "num_env_steps_trained_lifetime_throughput": 1081106.126011186, "num_module_steps_trained_throughput": 69759.87922427856, "num_module_steps_trained_lifetime_throughput": 69759.47519628871}, "shared_policy": {"gradients_default_optimizer_global_norm": 24.77544593811035, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.631375312805176, "total_loss": 9.600056648254395, "num_module_steps_trained": 91904, "num_trainable_parameters": 149763, "entropy": -0.04868045076727867, "vf_loss_unclipped": 4108.9697265625, "weights_seq_no": 52.0, "curr_kl_coeff": 0.675000011920929, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.08866763114929199, "policy_loss": -0.043380916118621826, "mean_kl_loss": 0.02572261542081833, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4510976, "num_module_steps_trained_lifetime_throughput": 69760.28434688378}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 16}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 52, "trial_id": "a8246_00000", "date": "2025-06-25_21-02-25", "timestamp": 1750910545, "time_this_iter_s": 64.20790219306946, "time_total_s": 1160.5982427597046, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1160.5982427597046, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 9.105494505494505, "ram_util_percent": 51.99560439560438}}
{"timers": {"training_iteration": 10.472725276154621, "restore_env_runners": 0.0024369298513303842, "training_step": 10.47015860911131, "env_runner_sampling_timer": 9.193304124672197, "learner_update_timer": 1.2747343474594877, "synch_weights": 0.0008812601042409757, "synch_env_connectors": 0.020244662193805805}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.1208503312664106e-05, "add_time_dim_to_batch_and_zero_pad": 7.124999683583155e-06, "add_observations_from_episodes_to_batch": 3.483350155875087e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 5.104498995933682e-06, "numpy_to_tensor": 2.5541998184053224e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0123765595825114e-05, "batch_individual_items": 9.372914187981293e-06, "add_time_dim_to_batch_and_zero_pad": 2.6624492691789764e-06, "add_observations_from_episodes_to_batch": 1.5301312139259276e-05, "add_states_from_episodes_to_batch": 1.690807224920712e-06, "agent_to_module_mapping": 2.815448739455913e-06}}, "connector_pipeline_timer": 6.873684881267871e-05}, "env_reset_timer": 9.768749805516563e-05, "agent_episode_returns_mean": {"vehicle_1": 446.34667573383865, "vehicle_5": 520.0655753966739, "vehicle_3": 149.49688825130465, "vehicle_2": 210.38386632544652, "vehicle_4": 610.8058267075676, "vehicle_0": 152.96729059423717}, "sample": 0.1324244809215977, "rlmodule_inference_timer": 6.761590148176419e-05, "agent_steps": {"vehicle_5": 110.26857142857143, "vehicle_3": 40.31428571428572, "vehicle_2": 91.66285714285713, "vehicle_0": 40.31428571428572, "vehicle_4": 107.94285714285715, "vehicle_1": 100.58}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.32571428571427, "env_step_timer": 0.00014900759379638431, "connector_pipeline_timer": 0.00020918700101901777, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9591239317970274e-05, "tensor_to_numpy": 1.776720640403477e-05, "module_to_agent_unmapping": 1.6805237486541322e-06, "normalize_and_clip_actions": 4.886531785350439e-05, "remove_single_ts_time_rank_from_batch": 6.529583189263215e-07, "un_batch_to_individual_items": 1.5683010257732647e-05, "listify_data_for_vector_env": 6.931224562243846e-06}}, "connector_pipeline_timer": 0.00016248336370721267}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 716.0, "vehicle_2": 1638.0, "vehicle_4": 1935.9999999999998, "vehicle_0": 716.0, "vehicle_1": 1797.0}, "env_to_module_sum_episodes_length_in": 49.61310359303728, "num_agent_steps_sampled_lifetime": {"vehicle_0": 10852.999999999998, "vehicle_2": 24678.0, "vehicle_4": 29022.0, "vehicle_1": 27015.999999999993, "vehicle_5": 29734.000000000007, "vehicle_3": 10852.999999999998}, "episode_return_mean": 2090.0661216739245, "num_env_steps_sampled_lifetime": 30000.0, "time_between_sampling": 0.3489565727133986, "episode_return_min": 1977.3593983650208, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 132156.00000000003}, "module_episode_returns_mean": {"shared_policy": 991.9718927907944}, "episode_len_min": 108, "weights_seq_no": 52.0, "episode_duration_sec_mean": 0.0690928362664168, "num_module_steps_sampled": {"shared_policy": 8785.0}, "num_episodes_lifetime": 266.0, "episode_return_max": 2224.3311190605164, "env_to_module_sum_episodes_length_out": 49.61310359303728, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1622.216303576256}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005505614113344818, "agent_to_module_mapping": 0.0032851282935165743, "general_advantage_estimation": 0.017009288639911965, "add_time_dim_to_batch_and_zero_pad": 1.103177804482722e-05, "add_columns_from_episodes_to_train_batch": 0.04920767800862243, "add_states_from_episodes_to_batch": 3.305000896252758e-06, "numpy_to_tensor": 0.00017799447498358095, "batch_individual_items": 0.09159786667787595, "add_observations_from_episodes_to_batch": 0.00036249390665593693}}, "connector_pipeline_timer": 0.16731876482161115}, "learner_connector_sum_episodes_length_in": 1993.7399778228307, "num_env_steps_trained": 1414000, "num_module_steps_trained_lifetime": 4601472, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 71485600, "num_module_steps_trained": 90496, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.7399778228307, "num_env_steps_trained_lifetime_throughput": 1081271.3698813915, "num_module_steps_trained_throughput": 69741.69739717833, "num_module_steps_trained_lifetime_throughput": 69741.44963821085}, "shared_policy": {"gradients_default_optimizer_global_norm": 19.051002502441406, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.557629585266113, "total_loss": 9.647236824035645, "num_module_steps_trained": 90496, "num_trainable_parameters": 149763, "entropy": 0.3010191023349762, "vf_loss_unclipped": 3303.809814453125, "weights_seq_no": 53.0, "curr_kl_coeff": 0.675000011920929, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.13140368461608887, "policy_loss": 0.08758430927991867, "mean_kl_loss": 0.007455779705196619, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4601472, "num_module_steps_trained_lifetime_throughput": 69741.87664865842}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 17}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 53, "trial_id": "a8246_00000", "date": "2025-06-25_21-02-27", "timestamp": 1750910547, "time_this_iter_s": 2.142190933227539, "time_total_s": 1162.7404336929321, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b107ec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1162.7404336929321, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 14.433333333333332, "ram_util_percent": 51.9}}
{"timers": {"training_iteration": 11.009909129233048, "restore_env_runners": 0.002412606802805453, "training_step": 11.007366726350144, "env_runner_sampling_timer": 9.728947847595482, "learner_update_timer": 1.276295274814899, "synch_weights": 0.0008800950031499835, "synch_env_connectors": 0.02005448640191553}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2042004275135696e-05, "add_time_dim_to_batch_and_zero_pad": 6.2920007621869445e-06, "add_observations_from_episodes_to_batch": 3.5750003007706255e-05, "add_states_from_episodes_to_batch": 3.0410010367631912e-06, "agent_to_module_mapping": 4.959001671522856e-06, "numpy_to_tensor": 2.154200046788901e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.325646415286241e-06, "batch_individual_items": 8.795872967770486e-06, "add_time_dim_to_batch_and_zero_pad": 2.4431140833413313e-06, "add_observations_from_episodes_to_batch": 1.4398880012444975e-05, "add_states_from_episodes_to_batch": 1.580049636168877e-06, "agent_to_module_mapping": 2.6738563454909334e-06}}, "connector_pipeline_timer": 6.438665565664913e-05}, "env_reset_timer": 0.00010395899880677462, "agent_episode_returns_mean": {"vehicle_1": 439.46495511770235, "vehicle_5": 504.25023875713356, "vehicle_3": 147.027180185318, "vehicle_2": 227.67606327295303, "vehicle_4": 612.442198972702, "vehicle_0": 150.86430769920347}, "sample": 0.13268331697974572, "rlmodule_inference_timer": 0.00011348237154167553, "agent_steps": {"vehicle_5": 110.84000000000002, "vehicle_3": 40.49999999999999, "vehicle_2": 89.97999999999998, "vehicle_0": 40.49999999999999, "vehicle_4": 108.0, "vehicle_1": 98.48}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.84000000000002, "env_step_timer": 0.00014384616017192427, "connector_pipeline_timer": 0.00020241599850123748, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5554020805386025e-05, "tensor_to_numpy": 1.5879424168521198e-05, "module_to_agent_unmapping": 1.6170226366774825e-06, "normalize_and_clip_actions": 4.51751564339708e-05, "remove_single_ts_time_rank_from_batch": 6.145081903880608e-07, "un_batch_to_individual_items": 1.4639520486072036e-05, "listify_data_for_vector_env": 6.461041621082851e-06}}, "connector_pipeline_timer": 0.00014980564588326861}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 719.0, "vehicle_2": 1610.9999999999998, "vehicle_4": 1933.0, "vehicle_0": 719.0, "vehicle_1": 1762.0}, "env_to_module_sum_episodes_length_in": 50.10077332051286, "num_agent_steps_sampled_lifetime": {"vehicle_0": 11572.0, "vehicle_2": 26288.999999999996, "vehicle_4": 30955.000000000004, "vehicle_1": 28777.99999999999, "vehicle_5": 31716.000000000007, "vehicle_3": 11572.0}, "episode_return_mean": 2081.7249447107315, "num_env_steps_sampled_lifetime": 32000.0, "time_between_sampling": 0.5488796840350796, "episode_return_min": 1842.8484108448029, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 140882.00000000006}, "module_episode_returns_mean": {"shared_policy": 911.5643246841431}, "episode_len_min": 108, "weights_seq_no": 53.0, "episode_duration_sec_mean": 0.07072882263979409, "num_module_steps_sampled": {"shared_policy": 8726.0}, "num_episodes_lifetime": 284.0, "episode_return_max": 2253.2051651477814, "env_to_module_sum_episodes_length_out": 50.10077332051286, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1641.5799999814085}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005517364222172161, "agent_to_module_mapping": 0.0032900903405632814, "general_advantage_estimation": 0.01702314242351678, "add_time_dim_to_batch_and_zero_pad": 1.1043550251068335e-05, "add_columns_from_episodes_to_train_batch": 0.04930087955849953, "add_states_from_episodes_to_batch": 3.2957008498557193e-06, "numpy_to_tensor": 0.00017708162021798517, "batch_individual_items": 0.09111886260107205, "add_observations_from_episodes_to_batch": 0.0003636298075366441}}, "connector_pipeline_timer": 0.16696339967338153}, "learner_connector_sum_episodes_length_in": 1993.8025780446023, "num_env_steps_trained": 1406000, "num_module_steps_trained_lifetime": 4691456, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 72891600, "num_module_steps_trained": 89984, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.8025780446023, "num_env_steps_trained_lifetime_throughput": 1082433.1487282615, "num_module_steps_trained_throughput": 69789.02996518744, "num_module_steps_trained_lifetime_throughput": 69788.79836158323}, "shared_policy": {"gradients_default_optimizer_global_norm": 20.770843505859375, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.688523292541504, "total_loss": 9.696118354797363, "num_module_steps_trained": 89984, "num_trainable_parameters": 149763, "entropy": 0.15723375976085663, "vf_loss_unclipped": 3645.90966796875, "weights_seq_no": 54.0, "curr_kl_coeff": 0.675000011920929, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.06703388690948486, "policy_loss": 0.004019125830382109, "mean_kl_loss": 0.0076277535408735275, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4691456, "num_module_steps_trained_lifetime_throughput": 69789.18140253914}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 17}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 54, "trial_id": "a8246_00000", "date": "2025-06-25_21-03-31", "timestamp": 1750910611, "time_this_iter_s": 64.1719229221344, "time_total_s": 1226.9123566150665, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a60c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1226.9123566150665, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 9.897802197802198, "ram_util_percent": 52.23296703296702}}
{"timers": {"training_iteration": 10.92133006086073, "restore_env_runners": 0.0024312340647581676, "training_step": 10.918768742836601, "env_runner_sampling_timer": 9.638649745789502, "learner_update_timer": 1.277990851236756, "synch_weights": 0.0008795711330966265, "synch_env_connectors": 0.01986417236783562}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.1458501578308642e-05, "add_time_dim_to_batch_and_zero_pad": 6.4375017245765775e-06, "add_observations_from_episodes_to_batch": 3.352100247866474e-05, "add_states_from_episodes_to_batch": 3.0619994504377246e-06, "agent_to_module_mapping": 5.146001058164984e-06, "numpy_to_tensor": 2.110449713654816e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0002840431124962e-05, "batch_individual_items": 9.198166461152987e-06, "add_time_dim_to_batch_and_zero_pad": 2.537257252498789e-06, "add_observations_from_episodes_to_batch": 1.486134431736528e-05, "add_states_from_episodes_to_batch": 1.6229678156882545e-06, "agent_to_module_mapping": 2.7518655915898916e-06}}, "connector_pipeline_timer": 6.71543454476184e-05}, "env_reset_timer": 9.656299880589359e-05, "agent_episode_returns_mean": {"vehicle_1": 450.5657317168371, "vehicle_5": 501.38734275341034, "vehicle_3": 140.16388308422904, "vehicle_2": 243.4356672930718, "vehicle_4": 614.5804680074964, "vehicle_0": 148.51090579918454}, "sample": 0.13267817483914862, "rlmodule_inference_timer": 6.493721720759192e-05, "agent_steps": {"vehicle_5": 109.93999999999998, "vehicle_3": 41.93142857142857, "vehicle_2": 91.27714285714286, "vehicle_0": 41.93142857142857, "vehicle_4": 108.0, "vehicle_1": 100.28571428571428}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.93999999999998, "env_step_timer": 0.00014595997574744273, "connector_pipeline_timer": 0.00019939549747505225, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.927813562787232e-05, "tensor_to_numpy": 1.763880909311652e-05, "module_to_agent_unmapping": 1.7158972284172917e-06, "normalize_and_clip_actions": 4.781934637198292e-05, "remove_single_ts_time_rank_from_batch": 6.339442490230351e-07, "un_batch_to_individual_items": 1.5508554051610344e-05, "listify_data_for_vector_env": 6.820207219185569e-06}}, "connector_pipeline_timer": 0.00016032131103251392}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 756.0, "vehicle_2": 1643.0, "vehicle_4": 1947.0, "vehicle_0": 756.0, "vehicle_1": 1808.0}, "env_to_module_sum_episodes_length_in": 48.516909703492914, "num_agent_steps_sampled_lifetime": {"vehicle_0": 7713.0, "vehicle_2": 17172.999999999996, "vehicle_4": 20379.000000000004, "vehicle_1": 18799.000000000004, "vehicle_5": 20815.0, "vehicle_3": 7713.0}, "episode_return_mean": 2098.6440002182553, "num_env_steps_sampled_lifetime": 21000.0, "time_between_sampling": 0.3262924166474011, "episode_return_min": 1941.2763574123383, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 92592.0}, "module_episode_returns_mean": {"shared_policy": 982.7006239993233}, "episode_len_min": 108, "weights_seq_no": 54.0, "episode_duration_sec_mean": 0.06845425522472529, "num_module_steps_sampled": {"shared_policy": 8892.0}, "num_episodes_lifetime": 185.0, "episode_return_max": 2253.2051651477814, "env_to_module_sum_episodes_length_out": 48.516909703492914, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1636.9721793789981}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0055318230799676175, "agent_to_module_mapping": 0.003295849437148717, "general_advantage_estimation": 0.017040135589326544, "add_time_dim_to_batch_and_zero_pad": 1.1053944757666992e-05, "add_columns_from_episodes_to_train_batch": 0.04939117576287826, "add_states_from_episodes_to_batch": 3.292323810480168e-06, "numpy_to_tensor": 0.00017635622401043058, "batch_individual_items": 0.09065547980503323, "add_observations_from_episodes_to_batch": 0.0003649947594900043}}, "connector_pipeline_timer": 0.16662797734661186}, "learner_connector_sum_episodes_length_in": 1993.8645522641564, "num_env_steps_trained": 1430000, "num_module_steps_trained_lifetime": 4782976, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 74321600, "num_module_steps_trained": 91520, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.8645522641564, "num_env_steps_trained_lifetime_throughput": 1082851.867920063, "num_module_steps_trained_throughput": 69789.99501726431, "num_module_steps_trained_lifetime_throughput": 69789.836907064}, "shared_policy": {"gradients_default_optimizer_global_norm": 16.109357833862305, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.745715141296387, "total_loss": 9.746064186096191, "num_module_steps_trained": 91520, "num_trainable_parameters": 149763, "entropy": -0.04220835119485855, "vf_loss_unclipped": 3885.611328125, "weights_seq_no": 55.0, "curr_kl_coeff": 0.675000011920929, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.1263177990913391, "policy_loss": -0.0050239283591508865, "mean_kl_loss": 0.007334527559578419, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4782976, "num_module_steps_trained_lifetime_throughput": 69789.97080995739}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 21000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 18}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 55, "trial_id": "a8246_00000", "date": "2025-06-25_21-03-34", "timestamp": 1750910614, "time_this_iter_s": 2.1525869369506836, "time_total_s": 1229.0649435520172, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b104b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1229.0649435520172, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 14.066666666666668, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 10.835017246922092, "restore_env_runners": 0.0024069613141239157, "training_step": 10.832479911658194, "env_runner_sampling_timer": 9.549733089581594, "learner_update_timer": 1.280615916894403, "synch_weights": 0.0008788454218055395, "synch_env_connectors": 0.019674438984180743}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.1458501578308642e-05, "add_time_dim_to_batch_and_zero_pad": 6.4375017245765775e-06, "add_observations_from_episodes_to_batch": 3.352100247866474e-05, "add_states_from_episodes_to_batch": 3.0619994504377246e-06, "agent_to_module_mapping": 5.146001058164984e-06, "numpy_to_tensor": 2.110449713654816e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.708272578385826e-06, "batch_individual_items": 9.04835610500807e-06, "add_time_dim_to_batch_and_zero_pad": 2.4983503854463842e-06, "add_observations_from_episodes_to_batch": 1.4807007123155477e-05, "add_states_from_episodes_to_batch": 1.6174542727827314e-06, "agent_to_module_mapping": 2.76568208063985e-06}}, "connector_pipeline_timer": 6.631662202098304e-05}, "env_reset_timer": 9.656299880589359e-05, "agent_episode_returns_mean": {"vehicle_1": 439.23820824623095, "vehicle_5": 524.9352604508399, "vehicle_3": 142.0435477089882, "vehicle_2": 239.42983806133267, "vehicle_4": 608.112953300476, "vehicle_0": 174.40348853111266}, "sample": 0.13267360216986607, "rlmodule_inference_timer": 7.267813460735053e-05, "agent_steps": {"vehicle_5": 109.52, "vehicle_3": 43.74, "vehicle_2": 91.14, "vehicle_0": 44.28, "vehicle_4": 108.0, "vehicle_1": 99.7}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.52, "env_step_timer": 0.00014856577332906368, "connector_pipeline_timer": 0.00019939549747505225, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.598994058549217e-05, "tensor_to_numpy": 1.6525685945682984e-05, "module_to_agent_unmapping": 1.6680458698432558e-06, "normalize_and_clip_actions": 4.720569271931637e-05, "remove_single_ts_time_rank_from_batch": 6.458395638116015e-07, "un_batch_to_individual_items": 1.546903788449615e-05, "listify_data_for_vector_env": 6.68038746904953e-06}}, "connector_pipeline_timer": 0.0001546890108677015}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 790.0, "vehicle_2": 1647.0, "vehicle_4": 1950.9999999999998, "vehicle_0": 799.0, "vehicle_1": 1799.0000000000002}, "env_to_module_sum_episodes_length_in": 50.07681317966645, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8512.0, "vehicle_2": 18819.999999999996, "vehicle_4": 22330.000000000004, "vehicle_1": 20598.000000000004, "vehicle_5": 22797.000000000004, "vehicle_3": 8503.0}, "episode_return_mean": 2128.1632989120485, "num_env_steps_sampled_lifetime": 23000.0, "time_between_sampling": 0.2945402235380154, "episode_return_min": 2036.1590918302536, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 101559.99999999999}, "module_episode_returns_mean": {"shared_policy": 942.1666648364067}, "episode_len_min": 108, "weights_seq_no": 55.0, "episode_duration_sec_mean": 0.0699211564596044, "num_module_steps_sampled": {"shared_policy": 8968.0}, "num_episodes_lifetime": 203.0, "episode_return_max": 2333.5624804496765, "env_to_module_sum_episodes_length_out": 50.07681317966645, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1634.3096736105042}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0055415131791522075, "agent_to_module_mapping": 0.003302233022758227, "general_advantage_estimation": 0.01706377882345872, "add_time_dim_to_batch_and_zero_pad": 1.1042155261666205e-05, "add_columns_from_episodes_to_train_batch": 0.049498567755185525, "add_states_from_episodes_to_batch": 3.281070556937689e-06, "numpy_to_tensor": 0.0001754530818114618, "batch_individual_items": 0.09098497708696769, "add_observations_from_episodes_to_batch": 0.00036595106189924863}}, "connector_pipeline_timer": 0.16710402924318415}, "learner_connector_sum_episodes_length_in": 1993.9259067415148, "num_env_steps_trained": 1442000, "num_module_steps_trained_lifetime": 4875264, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 75763600, "num_module_steps_trained": 92288, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.9259067415148, "num_env_steps_trained_lifetime_throughput": 1082386.29010227, "num_module_steps_trained_throughput": 69735.99841072832, "num_module_steps_trained_lifetime_throughput": 69735.77034522881}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.761082649230957, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.578898429870605, "total_loss": 9.568359375, "num_module_steps_trained": 92288, "num_trainable_parameters": 149763, "entropy": 0.25441595911979675, "vf_loss_unclipped": 3580.197021484375, "weights_seq_no": 56.0, "curr_kl_coeff": 0.3375000059604645, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.17889559268951416, "policy_loss": -0.011028891429305077, "mean_kl_loss": 0.004496151115745306, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4875264, "num_module_steps_trained_lifetime_throughput": 69736.03662465683}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 23000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 18}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 56, "trial_id": "a8246_00000", "date": "2025-06-25_21-03-36", "timestamp": 1750910616, "time_this_iter_s": 2.290726900100708, "time_total_s": 1231.355670452118, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b104680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1231.355670452118, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 13.125, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 11.366332486532865, "restore_env_runners": 0.0023829379510438087, "training_step": 11.363818988371621, "env_runner_sampling_timer": 10.079486047435736, "learner_update_timer": 1.2821995093954823, "synch_weights": 0.0008777936276328228, "synch_env_connectors": 0.019486755844359684}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.110839996021241e-05, "add_time_dim_to_batch_and_zero_pad": 6.524802302010357e-06, "add_observations_from_episodes_to_batch": 3.218360216123983e-05, "add_states_from_episodes_to_batch": 3.0745984986424444e-06, "agent_to_module_mapping": 5.258200690150261e-06, "numpy_to_tensor": 2.0841995137743652e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.55788640728729e-06, "batch_individual_items": 8.867735805947796e-06, "add_time_dim_to_batch_and_zero_pad": 2.502517249325321e-06, "add_observations_from_episodes_to_batch": 1.4428715089189438e-05, "add_states_from_episodes_to_batch": 1.5989977425538746e-06, "agent_to_module_mapping": 2.696884532203756e-06}}, "connector_pipeline_timer": 6.537636799783254e-05}, "env_reset_timer": 9.212539880536497e-05, "agent_episode_returns_mean": {"vehicle_1": 447.0979708123207, "vehicle_5": 516.4502989125252, "vehicle_3": 126.99456220865248, "vehicle_2": 256.41029499530794, "vehicle_4": 610.6462017393113, "vehicle_0": 136.08047287464143}, "sample": 0.13293691313935505, "rlmodule_inference_timer": 6.365353674968861e-05, "agent_steps": {"vehicle_5": 109.11999999999998, "vehicle_3": 41.06, "vehicle_2": 90.50000000000004, "vehicle_0": 41.06, "vehicle_4": 108.0, "vehicle_1": 99.64}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.11999999999998, "env_step_timer": 0.0001470482013202384, "connector_pipeline_timer": 0.00019758319685934112, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5863265972621117e-05, "tensor_to_numpy": 1.634694735838575e-05, "module_to_agent_unmapping": 1.6707724394547324e-06, "normalize_and_clip_actions": 4.604909886023866e-05, "remove_single_ts_time_rank_from_batch": 6.308905979252289e-07, "un_batch_to_individual_items": 1.4932464151460556e-05, "listify_data_for_vector_env": 6.572928779426537e-06}}, "connector_pipeline_timer": 0.00015253747094230082}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 702.9999999999999, "vehicle_2": 1639.0000000000002, "vehicle_4": 1965.0, "vehicle_0": 702.9999999999999, "vehicle_1": 1815.9999999999998}, "env_to_module_sum_episodes_length_in": 50.976566837887916, "num_agent_steps_sampled_lifetime": {"vehicle_0": 9215.0, "vehicle_2": 20458.999999999996, "vehicle_4": 24295.000000000004, "vehicle_1": 22414.000000000004, "vehicle_5": 24779.0, "vehicle_3": 9206.0}, "episode_return_mean": 2093.679804942608, "num_env_steps_sampled_lifetime": 25000.0, "time_between_sampling": 0.44045561368541397, "episode_return_min": 1921.222234249115, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 110367.99999999999}, "module_episode_returns_mean": {"shared_policy": 889.2742305445671}, "episode_len_min": 108, "weights_seq_no": 56.0, "episode_duration_sec_mean": 0.07026776504062582, "num_module_steps_sampled": {"shared_policy": 8808.0}, "num_episodes_lifetime": 221.0, "episode_return_max": 2233.915867805481, "env_to_module_sum_episodes_length_out": 50.976566837887916, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1654.046191733641}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005554485967324838, "agent_to_module_mapping": 0.0033081065225333745, "general_advantage_estimation": 0.017079372285269373, "add_time_dim_to_batch_and_zero_pad": 1.1031313701870051e-05, "add_columns_from_episodes_to_train_batch": 0.04959207707768093, "add_states_from_episodes_to_batch": 3.2732598234519176e-06, "numpy_to_tensor": 0.00017456230102200397, "batch_individual_items": 0.09051742564611538, "add_observations_from_episodes_to_batch": 0.0003674140512863656}}, "connector_pipeline_timer": 0.16676459854073136}, "learner_connector_sum_episodes_length_in": 1993.9866476740997, "num_env_steps_trained": 1420000, "num_module_steps_trained_lifetime": 4966144, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 77183600, "num_module_steps_trained": 90880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1993.9866476740997, "num_env_steps_trained_lifetime_throughput": 1082269.0623557433, "num_module_steps_trained_throughput": 69705.1972067038, "num_module_steps_trained_lifetime_throughput": 69705.01138794815}, "shared_policy": {"gradients_default_optimizer_global_norm": 9.940366744995117, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.550237655639648, "total_loss": 9.59289836883545, "num_module_steps_trained": 90880, "num_trainable_parameters": 149763, "entropy": 0.27532219886779785, "vf_loss_unclipped": 3713.626953125, "weights_seq_no": 57.0, "curr_kl_coeff": 0.3375000059604645, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.3568820357322693, "policy_loss": 0.039678242057561874, "mean_kl_loss": 0.016991836950182915, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 4966144, "num_module_steps_trained_lifetime_throughput": 69705.2232228782}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 25000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 18}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 57, "trial_id": "a8246_00000", "date": "2025-06-25_21-04-40", "timestamp": 1750910680, "time_this_iter_s": 63.95993208885193, "time_total_s": 1295.3156025409698, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1295.3156025409698, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 8.88021978021978, "ram_util_percent": 51.917582417582395}}
{"timers": {"training_iteration": 11.274142339577548, "restore_env_runners": 0.002683278151586792, "training_step": 11.271327972657943, "env_runner_sampling_timer": 9.985591288211372, "learner_update_timer": 1.2836008509714931, "synch_weights": 0.0008764311013567433, "synch_env_connectors": 0.019298927445889007}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.4146000214386714e-05, "add_time_dim_to_batch_and_zero_pad": 9.624498488847166e-06, "add_observations_from_episodes_to_batch": 3.727100192918442e-05, "add_states_from_episodes_to_batch": 3.895496774930507e-06, "agent_to_module_mapping": 5.562502337852493e-06, "numpy_to_tensor": 2.3020995286060497e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.646477893812466e-06, "batch_individual_items": 9.141031201615447e-06, "add_time_dim_to_batch_and_zero_pad": 2.54141537890305e-06, "add_observations_from_episodes_to_batch": 1.4829144438243306e-05, "add_states_from_episodes_to_batch": 1.6618863946705665e-06, "agent_to_module_mapping": 2.744913021208106e-06}}, "connector_pipeline_timer": 6.669555515746175e-05}, "env_reset_timer": 9.733349725138396e-05, "agent_episode_returns_mean": {"vehicle_1": 417.29878895844723, "vehicle_5": 509.5029979004178, "vehicle_3": 102.7291186596666, "vehicle_2": 253.13100487470624, "vehicle_4": 610.191440097264, "vehicle_0": 152.82291014535087}, "sample": 0.13104118653858457, "rlmodule_inference_timer": 6.391114202724777e-05, "agent_steps": {"vehicle_5": 110.12857142857142, "vehicle_3": 42.12285714285716, "vehicle_2": 90.4, "vehicle_0": 42.12285714285716, "vehicle_4": 108.0, "vehicle_1": 101.41142857142854}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.24571428571427, "env_step_timer": 0.00014487826304612354, "connector_pipeline_timer": 0.00021833349819644354, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8525798683579465e-05, "tensor_to_numpy": 1.7412976467300378e-05, "module_to_agent_unmapping": 1.6935545002119944e-06, "normalize_and_clip_actions": 4.806146438669077e-05, "remove_single_ts_time_rank_from_batch": 6.686017626732851e-07, "un_batch_to_individual_items": 1.548349554269715e-05, "listify_data_for_vector_env": 6.845451384467423e-06}}, "connector_pipeline_timer": 0.00015977032156388882}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 754.0, "vehicle_2": 1627.0, "vehicle_4": 1940.9999999999998, "vehicle_0": 754.0, "vehicle_1": 1830.0}, "env_to_module_sum_episodes_length_in": 48.87031052280067, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8981.000000000002, "vehicle_2": 19720.0, "vehicle_4": 23489.000000000007, "vehicle_1": 21793.0, "vehicle_5": 23778.0, "vehicle_3": 8981.000000000002}, "episode_return_mean": 2045.676259691715, "num_env_steps_sampled_lifetime": 24000.0, "time_between_sampling": 0.34916153155117, "episode_return_min": 1784.0112082958221, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 106742.0}, "module_episode_returns_mean": {"shared_policy": 896.8363029936381}, "episode_len_min": 108, "weights_seq_no": 57.0, "episode_duration_sec_mean": 0.06802095586471425, "num_module_steps_sampled": {"shared_policy": 8884.0}, "num_episodes_lifetime": 215.0, "episode_return_max": 2193.802924156189, "env_to_module_sum_episodes_length_out": 48.87031052280067, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1641.5821342619693}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005567628197676058, "agent_to_module_mapping": 0.0033144992073108393, "general_advantage_estimation": 0.017094911892401015, "add_time_dim_to_batch_and_zero_pad": 1.101225053207811e-05, "add_columns_from_episodes_to_train_batch": 0.049677941306862594, "add_states_from_episodes_to_batch": 3.2613672412946708e-06, "numpy_to_tensor": 0.00017369292799010273, "batch_individual_items": 0.09004754138960455, "add_observations_from_episodes_to_batch": 0.0003685853307448907}}, "connector_pipeline_timer": 0.16641545296530366}, "learner_connector_sum_episodes_length_in": 1994.0467811973588, "num_env_steps_trained": 1430000, "num_module_steps_trained_lifetime": 5057664, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 78613600, "num_module_steps_trained": 91520, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1994.0467811973588, "num_env_steps_trained_lifetime_throughput": 1084023.3491325325, "num_module_steps_trained_throughput": 69795.3141520873, "num_module_steps_trained_lifetime_throughput": 69795.18084892746}, "shared_policy": {"gradients_default_optimizer_global_norm": 25.648975372314453, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.39858341217041, "total_loss": 9.504659652709961, "num_module_steps_trained": 91520, "num_trainable_parameters": 149763, "entropy": 0.11872656643390656, "vf_loss_unclipped": 3246.66357421875, "weights_seq_no": 58.0, "curr_kl_coeff": 0.3375000059604645, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.20367169380187988, "policy_loss": 0.1006590947508812, "mean_kl_loss": 0.01956520788371563, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5057664, "num_module_steps_trained_lifetime_throughput": 69795.33120335365}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 19}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 58, "trial_id": "a8246_00000", "date": "2025-06-25_21-04-42", "timestamp": 1750910682, "time_this_iter_s": 2.1499340534210205, "time_total_s": 1297.4655365943909, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1297.4655365943909, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 13.766666666666666, "ram_util_percent": 51.93333333333334}}
{"timers": {"training_iteration": 12.40379267327178, "restore_env_runners": 0.0026564870300214353, "training_step": 12.401004942521316, "env_runner_sampling_timer": 11.114894661169254, "learner_update_timer": 1.283975120791785, "synch_weights": 0.0008755784603794406, "synch_env_connectors": 0.01912077609145557}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.659925121406559e-05, "add_time_dim_to_batch_and_zero_pad": 1.1905620340257883e-05, "add_observations_from_episodes_to_batch": 4.175525191385532e-05, "add_states_from_episodes_to_batch": 4.504870958044194e-06, "agent_to_module_mapping": 5.7346287576365285e-06, "numpy_to_tensor": 2.4786496396700386e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.4856125753188374e-05, "batch_individual_items": 8.985272230516217e-06, "add_time_dim_to_batch_and_zero_pad": 2.4825030119655197e-06, "add_observations_from_episodes_to_batch": 1.4471525573245697e-05, "add_states_from_episodes_to_batch": 1.6493250890886393e-06, "agent_to_module_mapping": 2.6797589234200893e-06}}, "connector_pipeline_timer": 8.094096871478265e-05}, "env_reset_timer": 0.00010345837108616245, "agent_episode_returns_mean": {"vehicle_1": 405.63937384009364, "vehicle_5": 512.6714200532437, "vehicle_3": 102.85886858344078, "vehicle_2": 225.824235060215, "vehicle_4": 610.0005022525787, "vehicle_0": 146.68143792629243}, "sample": 0.1299361174552461, "rlmodule_inference_timer": 6.238072964427112e-05, "agent_steps": {"vehicle_5": 109.385, "vehicle_3": 41.165, "vehicle_2": 90.935, "vehicle_0": 41.165, "vehicle_4": 108.0, "vehicle_1": 101.575}, "num_env_steps_sampled": 1600.0, "episode_len_mean": 109.685, "env_step_timer": 0.00014746283174122185, "connector_pipeline_timer": 0.00023480237450712593, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.601860389797207e-05, "tensor_to_numpy": 1.6189815386482692e-05, "module_to_agent_unmapping": 1.619232781468377e-06, "normalize_and_clip_actions": 4.590543881288857e-05, "remove_single_ts_time_rank_from_batch": 6.479154294782673e-07, "un_batch_to_individual_items": 1.4778226937907404e-05, "listify_data_for_vector_env": 6.577482540230149e-06}}, "connector_pipeline_timer": 0.00015216478234773148}, "num_agent_steps_sampled": {"vehicle_5": 1583.0, "vehicle_3": 590.0, "vehicle_2": 1339.0, "vehicle_4": 1564.0, "vehicle_0": 590.0, "vehicle_1": 1477.0}, "env_to_module_sum_episodes_length_in": 51.15878935712463, "num_agent_steps_sampled_lifetime": {"vehicle_0": 9571.000000000002, "vehicle_2": 21059.0, "vehicle_4": 25053.000000000007, "vehicle_1": 23270.0, "vehicle_5": 25361.0, "vehicle_3": 9571.000000000002}, "episode_return_mean": 2003.6758394801616, "num_env_steps_sampled_lifetime": 25600.0, "time_between_sampling": 0.47336598571027655, "episode_return_min": 1674.5339186191559, "episode_len_max": 115, "num_module_steps_sampled_lifetime": {"shared_policy": 113885.0}, "module_episode_returns_mean": {"shared_policy": 853.8467685604096}, "episode_len_min": 108, "weights_seq_no": 58.0, "episode_duration_sec_mean": 0.07176274500016007, "num_module_steps_sampled": {"shared_policy": 7143.0}, "num_episodes_lifetime": 228.0, "episode_return_max": 2193.802924156189, "env_to_module_sum_episodes_length_out": 51.15878935712463, "num_episodes": 13.0, "num_env_steps_sampled_lifetime_throughput": 1639.3378311086171}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005573359825660714, "agent_to_module_mapping": 0.0033115446252719965, "general_advantage_estimation": 0.017075738193421904, "add_time_dim_to_batch_and_zero_pad": 1.0999628041574671e-05, "add_columns_from_episodes_to_train_batch": 0.049656921473797765, "add_states_from_episodes_to_batch": 3.2512535946886726e-06, "numpy_to_tensor": 0.00017290807871877552, "batch_individual_items": 0.09032393930567717, "add_observations_from_episodes_to_batch": 0.00036872781748739127}}, "connector_pipeline_timer": 0.16665356593562297}, "learner_connector_sum_episodes_length_in": 1990.1063133853852, "num_env_steps_trained": 918400, "num_module_steps_trained_lifetime": 5131136, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 79532000, "num_module_steps_trained": 73472, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.1063133853852, "num_env_steps_trained_lifetime_throughput": 1070933.803720678, "num_module_steps_trained_throughput": 69594.53735027942, "num_module_steps_trained_lifetime_throughput": 69594.37945531105}, "shared_policy": {"gradients_default_optimizer_global_norm": 25.117919921875, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.290152549743652, "total_loss": 9.27972412109375, "num_module_steps_trained": 73472, "num_trainable_parameters": 149763, "entropy": 0.07257147133350372, "vf_loss_unclipped": 4096.40380859375, "weights_seq_no": 59.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.03628963232040405, "policy_loss": -0.020007409155368805, "mean_kl_loss": 0.030533866956830025, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5131136, "num_module_steps_trained_lifetime_throughput": 69594.54864208354}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 25600.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 19}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 59, "trial_id": "a8246_00000", "date": "2025-06-25_21-06-48", "timestamp": 1750910808, "time_this_iter_s": 126.0123860836029, "time_total_s": 1423.4779226779938, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a68e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1423.4779226779938, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 9.020786516853933, "ram_util_percent": 51.987078651685394}}
{"timers": {"training_iteration": 12.301556053209085, "restore_env_runners": 0.002700086739750307, "training_step": 12.298723191846126, "env_runner_sampling_timer": 11.01085881330754, "learner_update_timer": 1.285726108753811, "synch_weights": 0.0008744893357972875, "synch_env_connectors": 0.03665560958053008}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.527100125211291e-05, "add_time_dim_to_batch_and_zero_pad": 1.0874999134102836e-05, "add_observations_from_episodes_to_batch": 5.0999999075429514e-05, "add_states_from_episodes_to_batch": 5.395500920712948e-06, "agent_to_module_mapping": 9.083501936402172e-06, "numpy_to_tensor": 3.6354500480229035e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0511286791384633e-05, "batch_individual_items": 9.920581765485061e-06, "add_time_dim_to_batch_and_zero_pad": 2.671658015210813e-06, "add_observations_from_episodes_to_batch": 1.5866530472073444e-05, "add_states_from_episodes_to_batch": 1.7241631256179774e-06, "agent_to_module_mapping": 2.899637057870814e-06}}, "connector_pipeline_timer": 7.103181525506421e-05}, "env_reset_timer": 0.00014495800132863224, "agent_episode_returns_mean": {"vehicle_1": 431.47785160779955, "vehicle_5": 503.9547778272629, "vehicle_3": 113.21982611656189, "vehicle_2": 271.0771062088013, "vehicle_4": 608.4952717208862, "vehicle_0": 118.73357841491699}, "sample": 0.1411155179846843, "rlmodule_inference_timer": 7.185545020773086e-05, "agent_steps": {"vehicle_5": 109.22, "vehicle_3": 41.46, "vehicle_2": 90.42, "vehicle_0": 41.46, "vehicle_4": 108.0, "vehicle_1": 100.38}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.26, "env_step_timer": 0.00014881223792491283, "connector_pipeline_timer": 0.00032227100018644705, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.746837817596451e-05, "tensor_to_numpy": 2.014777780225424e-05, "module_to_agent_unmapping": 1.7137661830061612e-06, "normalize_and_clip_actions": 5.211264853943402e-05, "remove_single_ts_time_rank_from_batch": 6.712843600247758e-07, "un_batch_to_individual_items": 1.6607014427657493e-05, "listify_data_for_vector_env": 7.189969246830001e-06}}, "connector_pipeline_timer": 0.00017848725940585993}, "num_agent_steps_sampled": {"vehicle_5": 1980.0, "vehicle_3": 777.9999999999999, "vehicle_2": 1647.0, "vehicle_4": 1963.0, "vehicle_0": 777.9999999999999, "vehicle_1": 1832.0}, "env_to_module_sum_episodes_length_in": 46.28698532241066, "num_agent_steps_sampled_lifetime": {"vehicle_0": 2370.9999999999995, "vehicle_2": 5001.999999999999, "vehicle_4": 5887.0, "vehicle_1": 5506.000000000001, "vehicle_5": 5948.0, "vehicle_3": 2370.9999999999995}, "episode_return_mean": 2046.9584116673466, "num_env_steps_sampled_lifetime": 6000.0, "time_between_sampling": 0.006605347991158275, "episode_return_min": 1711.6459486484528, "episode_len_max": 111, "num_module_steps_sampled_lifetime": {"shared_policy": 27085.0}, "module_episode_returns_mean": {"shared_policy": 988.2914354896544}, "episode_len_min": 108, "weights_seq_no": 59.0, "episode_duration_sec_mean": 0.07097103331936522, "num_module_steps_sampled": {"shared_policy": 8978.0}, "num_episodes_lifetime": 50.0, "episode_return_max": 2204.0597248077393, "env_to_module_sum_episodes_length_out": 46.28698532241066, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1623.5496141228775}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005586190807400853, "agent_to_module_mapping": 0.0033167066790081847, "general_advantage_estimation": 0.01709760123154489, "add_time_dim_to_batch_and_zero_pad": 1.0995881769843506e-05, "add_columns_from_episodes_to_train_batch": 0.04975351184904901, "add_states_from_episodes_to_batch": 3.2449910403435087e-06, "numpy_to_tensor": 0.00017211232794290898, "batch_individual_items": 0.08986071366259646, "add_observations_from_episodes_to_batch": 0.0003699388693200807}}, "connector_pipeline_timer": 0.1663268936163024}, "learner_connector_sum_episodes_length_in": 1990.2052502515314, "num_env_steps_trained": 1444000, "num_module_steps_trained_lifetime": 5223552, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 80976000, "num_module_steps_trained": 92416, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.2052502515314, "num_env_steps_trained_lifetime_throughput": 1072193.0374384478, "num_module_steps_trained_throughput": 69622.32331319612, "num_module_steps_trained_lifetime_throughput": 69622.22454167051}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.31034517288208, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.47730827331543, "total_loss": 9.385183334350586, "num_module_steps_trained": 92416, "num_trainable_parameters": 149763, "entropy": 0.09252661466598511, "vf_loss_unclipped": 4034.019775390625, "weights_seq_no": 60.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.021245479583740234, "policy_loss": -0.09386784583330154, "mean_kl_loss": 0.005269024055451155, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5223552, "num_module_steps_trained_lifetime_throughput": 69622.25791902361}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 21}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 60, "trial_id": "a8246_00000", "date": "2025-06-25_21-06-50", "timestamp": 1750910810, "time_this_iter_s": 2.182631254196167, "time_total_s": 1425.66055393219, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a6a6ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1425.66055393219, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 13.899999999999999, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 12.819656100177028, "restore_env_runners": 0.002673162532351544, "training_step": 12.816849814507698, "env_runner_sampling_timer": 11.527554304754425, "learner_update_timer": 1.2871540539163335, "synch_weights": 0.0008744223624166592, "synch_env_connectors": 0.0363025822347118}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.425419781706295e-05, "add_time_dim_to_batch_and_zero_pad": 1.1541398271219805e-05, "add_observations_from_episodes_to_batch": 5.1700001495191825e-05, "add_states_from_episodes_to_batch": 5.4790987633168696e-06, "agent_to_module_mapping": 9.450303332414478e-06, "numpy_to_tensor": 3.490449817036279e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.525086872382146e-06, "batch_individual_items": 8.919325796888788e-06, "add_time_dim_to_batch_and_zero_pad": 2.524863359417855e-06, "add_observations_from_episodes_to_batch": 1.4717870786891309e-05, "add_states_from_episodes_to_batch": 1.635097559378738e-06, "agent_to_module_mapping": 2.7126866833875184e-06}}, "connector_pipeline_timer": 6.57433620194914e-05}, "env_reset_timer": 0.00014445800334215165, "agent_episode_returns_mean": {"vehicle_1": 343.8456892299652, "vehicle_5": 516.9724221324922, "vehicle_3": 118.3044983291626, "vehicle_2": 245.90916305541984, "vehicle_4": 605.5574177360535, "vehicle_0": 142.14319954633717}, "sample": 0.14030419619011242, "rlmodule_inference_timer": 7.275253779760355e-05, "agent_steps": {"vehicle_5": 109.02, "vehicle_3": 41.6, "vehicle_2": 90.6, "vehicle_0": 41.6, "vehicle_4": 108.0, "vehicle_1": 102.5}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.40000000000002, "env_step_timer": 0.0001470303468563575, "connector_pipeline_timer": 0.0003221542006940581, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5327796299352706e-05, "tensor_to_numpy": 1.6081182764373575e-05, "module_to_agent_unmapping": 1.5880295058073106e-06, "normalize_and_clip_actions": 4.536725107145698e-05, "remove_single_ts_time_rank_from_batch": 6.155499730350896e-07, "un_batch_to_individual_items": 1.4923101059124579e-05, "listify_data_for_vector_env": 6.499002170427186e-06}}, "connector_pipeline_timer": 0.00015076947002753562}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 717.9999999999999, "vehicle_2": 1648.0, "vehicle_4": 1957.0, "vehicle_0": 717.9999999999999, "vehicle_1": 1847.0}, "env_to_module_sum_episodes_length_in": 51.79301798216405, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3089.0, "vehicle_2": 6650.0, "vehicle_4": 7844.0, "vehicle_1": 7353.0, "vehicle_5": 7926.0, "vehicle_3": 3089.0}, "episode_return_mean": 1972.7323838686943, "num_env_steps_sampled_lifetime": 8000.0, "time_between_sampling": 0.437640296006519, "episode_return_min": 1711.6459486484528, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 35951.0}, "module_episode_returns_mean": {"shared_policy": 893.2498259711268}, "episode_len_min": 108, "weights_seq_no": 60.0, "episode_duration_sec_mean": 0.06967329234073986, "num_module_steps_sampled": {"shared_policy": 8866.0}, "num_episodes_lifetime": 67.0, "episode_return_max": 2232.4183433055878, "env_to_module_sum_episodes_length_out": 51.79301798216405, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1644.0251559011622}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005596074319324101, "agent_to_module_mapping": 0.003321715862236399, "general_advantage_estimation": 0.01711636188922899, "add_time_dim_to_batch_and_zero_pad": 1.0986762995305205e-05, "add_columns_from_episodes_to_train_batch": 0.049827938820520265, "add_states_from_episodes_to_batch": 3.2350411557470223e-06, "numpy_to_tensor": 0.0001713374546654962, "batch_individual_items": 0.08939527652600347, "add_observations_from_episodes_to_batch": 0.0003708923906923679}}, "connector_pipeline_timer": 0.16596918010010664}, "learner_connector_sum_episodes_length_in": 1990.3031977490161, "num_env_steps_trained": 1426000, "num_module_steps_trained_lifetime": 5314816, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 82402000, "num_module_steps_trained": 91264, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.3031977490161, "num_env_steps_trained_lifetime_throughput": 1073813.1175486795, "num_module_steps_trained_throughput": 69675.9142600648, "num_module_steps_trained_lifetime_throughput": 69675.8012286261}, "shared_policy": {"gradients_default_optimizer_global_norm": 20.676250457763672, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.349128723144531, "total_loss": 9.371463775634766, "num_module_steps_trained": 91264, "num_trainable_parameters": 149763, "entropy": 0.08514072000980377, "vf_loss_unclipped": 4004.58642578125, "weights_seq_no": 61.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.14358758926391602, "policy_loss": 0.016110887750983238, "mean_kl_loss": 0.013977224938571453, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5314816, "num_module_steps_trained_lifetime_throughput": 69675.84983830116}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 21}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 61, "trial_id": "a8246_00000", "date": "2025-06-25_21-07-54", "timestamp": 1750910874, "time_this_iter_s": 64.11337018013, "time_total_s": 1489.77392411232, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c28e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1489.77392411232, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 9.79010989010989, "ram_util_percent": 52.07362637362636}}
{"timers": {"training_iteration": 12.713810290845277, "restore_env_runners": 0.0026887971570823573, "training_step": 12.710988143022607, "env_runner_sampling_timer": 11.419222890456917, "learner_update_timer": 1.2896192292071509, "synch_weights": 0.0008749264787855569, "synch_env_connectors": 0.03594849974239557}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.77499966614414e-05, "add_time_dim_to_batch_and_zero_pad": 9.020997822517529e-06, "add_observations_from_episodes_to_batch": 4.1957999201258644e-05, "add_states_from_episodes_to_batch": 4.3125000956933945e-06, "agent_to_module_mapping": 7.3334995249751955e-06, "numpy_to_tensor": 2.6666995836421847e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.975958592765362e-06, "batch_individual_items": 9.31335874290826e-06, "add_time_dim_to_batch_and_zero_pad": 2.639270340492377e-06, "add_observations_from_episodes_to_batch": 1.4988258613549529e-05, "add_states_from_episodes_to_batch": 1.6715939619955225e-06, "agent_to_module_mapping": 2.8182278354628152e-06}}, "connector_pipeline_timer": 6.786085210648412e-05}, "env_reset_timer": 0.00011866649947478433, "agent_episode_returns_mean": {"vehicle_1": 397.20798475844526, "vehicle_5": 525.1115469333104, "vehicle_3": 146.71400896378927, "vehicle_2": 261.41831468718397, "vehicle_4": 611.3439839737755, "vehicle_0": 142.1824055147171}, "sample": 0.13654106121146836, "rlmodule_inference_timer": 6.545446808480375e-05, "agent_steps": {"vehicle_5": 108.64, "vehicle_3": 40.328571428571436, "vehicle_2": 89.61714285714287, "vehicle_0": 40.328571428571436, "vehicle_4": 108.0, "vehicle_1": 100.04571428571427}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.92571428571428, "env_step_timer": 0.00014715994165395932, "connector_pipeline_timer": 0.0002581665030447766, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.900565069562234e-05, "tensor_to_numpy": 1.741551605503455e-05, "module_to_agent_unmapping": 1.6729876817556737e-06, "normalize_and_clip_actions": 4.843363051287254e-05, "remove_single_ts_time_rank_from_batch": 6.394057305778765e-07, "un_batch_to_individual_items": 1.5613683357575775e-05, "listify_data_for_vector_env": 6.795595399464076e-06}}, "connector_pipeline_timer": 0.00016070120160630624}, "num_agent_steps_sampled": {"vehicle_5": 1977.0, "vehicle_3": 722.9999999999999, "vehicle_2": 1620.9999999999998, "vehicle_4": 1965.9999999999998, "vehicle_0": 722.9999999999999, "vehicle_1": 1823.0}, "env_to_module_sum_episodes_length_in": 48.19085775776538, "num_agent_steps_sampled_lifetime": {"vehicle_0": 7483.0, "vehicle_2": 16470.0, "vehicle_4": 19615.0, "vehicle_1": 18465.0, "vehicle_5": 19770.999999999996, "vehicle_3": 7483.0}, "episode_return_mean": 2083.9782432004386, "num_env_steps_sampled_lifetime": 20000.0, "time_between_sampling": 0.3352495613992754, "episode_return_min": 1724.3034645318985, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 89287.0}, "module_episode_returns_mean": {"shared_policy": 959.6007750609944}, "episode_len_min": 108, "weights_seq_no": 61.0, "episode_duration_sec_mean": 0.06769527484313584, "num_module_steps_sampled": {"shared_policy": 8833.0}, "num_episodes_lifetime": 179.0, "episode_return_max": 2243.7298760414124, "env_to_module_sum_episodes_length_out": 48.19085775776538, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1631.3413676055086}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005609144406185404, "agent_to_module_mapping": 0.0033269732836105808, "general_advantage_estimation": 0.017138717860366307, "add_time_dim_to_batch_and_zero_pad": 1.096397533575107e-05, "add_columns_from_episodes_to_train_batch": 0.04993227734228681, "add_states_from_episodes_to_batch": 3.227690789032734e-06, "numpy_to_tensor": 0.00017051117010985197, "batch_individual_items": 0.08972977917068947, "add_observations_from_episodes_to_batch": 0.0003719801367494243}}, "connector_pipeline_timer": 0.16644857370912286}, "learner_connector_sum_episodes_length_in": 1990.400165771526, "num_env_steps_trained": 1422000, "num_module_steps_trained_lifetime": 5405824, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 83824000, "num_module_steps_trained": 91008, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.400165771526, "num_env_steps_trained_lifetime_throughput": 1075072.2186823704, "num_module_steps_trained_throughput": 69710.42419696265, "num_module_steps_trained_lifetime_throughput": 69709.06468450188}, "shared_policy": {"gradients_default_optimizer_global_norm": 6.452043056488037, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.293917655944824, "total_loss": 9.502729415893555, "num_module_steps_trained": 91008, "num_trainable_parameters": 149763, "entropy": 0.47421133518218994, "vf_loss_unclipped": 2825.17529296875, "weights_seq_no": 62.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.28893882036209106, "policy_loss": 0.20896752178668976, "mean_kl_loss": 0.009059945121407509, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5405824, "num_module_steps_trained_lifetime_throughput": 69710.3831882793}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 22}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 62, "trial_id": "a8246_00000", "date": "2025-06-25_21-07-57", "timestamp": 1750910877, "time_this_iter_s": 2.2373859882354736, "time_total_s": 1492.0113101005554, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c1580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1492.0113101005554, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 14.933333333333332, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 12.608890621266877, "restore_env_runners": 0.0026619504355345934, "training_step": 12.606094971172407, "env_runner_sampling_timer": 11.312564257392342, "learner_update_timer": 1.291378616085073, "synch_weights": 0.0008752217939992018, "synch_env_connectors": 0.03559972599496887}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.77499966614414e-05, "add_time_dim_to_batch_and_zero_pad": 9.020997822517529e-06, "add_observations_from_episodes_to_batch": 4.1957999201258644e-05, "add_states_from_episodes_to_batch": 4.3125000956933945e-06, "agent_to_module_mapping": 7.3334995249751955e-06, "numpy_to_tensor": 2.6666995836421847e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.770449335439272e-06, "batch_individual_items": 9.166210579108965e-06, "add_time_dim_to_batch_and_zero_pad": 2.5777065911312674e-06, "add_observations_from_episodes_to_batch": 1.4992770481323409e-05, "add_states_from_episodes_to_batch": 1.6491030240643107e-06, "agent_to_module_mapping": 2.7624681663103463e-06}}, "connector_pipeline_timer": 6.700474857117264e-05}, "env_reset_timer": 0.00011866649947478433, "agent_episode_returns_mean": {"vehicle_1": 321.11077643394475, "vehicle_5": 507.6453029489517, "vehicle_3": 132.14432945251463, "vehicle_2": 254.86715276002883, "vehicle_4": 610.1818265342713, "vehicle_0": 121.03251507759094}, "sample": 0.13632509637573886, "rlmodule_inference_timer": 7.499876781238851e-05, "agent_steps": {"vehicle_5": 108.57999999999998, "vehicle_3": 40.919999999999995, "vehicle_2": 89.94, "vehicle_0": 40.919999999999995, "vehicle_4": 107.96, "vehicle_1": 102.68000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.98, "env_step_timer": 0.0001500229404126949, "connector_pipeline_timer": 0.0002581665030447766, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.608116415755144e-05, "tensor_to_numpy": 1.6378724603368902e-05, "module_to_agent_unmapping": 1.6292741314971396e-06, "normalize_and_clip_actions": 4.736602892681441e-05, "remove_single_ts_time_rank_from_batch": 6.254206484939127e-07, "un_batch_to_individual_items": 1.5425983690400537e-05, "listify_data_for_vector_env": 6.709221509606117e-06}}, "connector_pipeline_timer": 0.0001548598216396991}, "num_agent_steps_sampled": {"vehicle_5": 1973.0, "vehicle_3": 742.0000000000001, "vehicle_2": 1630.9999999999998, "vehicle_4": 1962.0, "vehicle_0": 742.0000000000001, "vehicle_1": 1887.0}, "env_to_module_sum_episodes_length_in": 48.681727402527734, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8225.0, "vehicle_2": 18101.0, "vehicle_4": 21577.0, "vehicle_1": 20352.0, "vehicle_5": 21743.999999999996, "vehicle_3": 8225.0}, "episode_return_mean": 1946.9819030356405, "num_env_steps_sampled_lifetime": 22000.0, "time_between_sampling": 0.3034018803033437, "episode_return_min": 1656.9604461193085, "episode_len_max": 111, "num_module_steps_sampled_lifetime": {"shared_policy": 98224.0}, "module_episode_returns_mean": {"shared_policy": 912.2670874214175}, "episode_len_min": 108, "weights_seq_no": 62.0, "episode_duration_sec_mean": 0.06942910682104411, "num_module_steps_sampled": {"shared_policy": 8937.0}, "num_episodes_lifetime": 198.0, "episode_return_max": 2197.1478111743927, "env_to_module_sum_episodes_length_out": 48.681727402527734, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1637.414697758495}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005620028382173407, "agent_to_module_mapping": 0.0033322635508044496, "general_advantage_estimation": 0.01715681110177549, "add_time_dim_to_batch_and_zero_pad": 1.0950995587904346e-05, "add_columns_from_episodes_to_train_batch": 0.050025200398839516, "add_states_from_episodes_to_batch": 3.219583884740963e-06, "numpy_to_tensor": 0.00016966146844375456, "batch_individual_items": 0.08928139054899142, "add_observations_from_episodes_to_batch": 0.0003740378353551219}}, "connector_pipeline_timer": 0.16612817297205043}, "learner_connector_sum_episodes_length_in": 1990.4961641138107, "num_env_steps_trained": 1438000, "num_module_steps_trained_lifetime": 5497856, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 85262000, "num_module_steps_trained": 92032, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.4961641138107, "num_env_steps_trained_lifetime_throughput": 1075839.6195481098, "num_module_steps_trained_throughput": 69713.75398173384, "num_module_steps_trained_lifetime_throughput": 69712.60145719559}, "shared_policy": {"gradients_default_optimizer_global_norm": 12.602816581726074, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.681906700134277, "total_loss": 9.688370704650879, "num_module_steps_trained": 92032, "num_trainable_parameters": 149763, "entropy": 0.25305572152137756, "vf_loss_unclipped": 3412.32373046875, "weights_seq_no": 63.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.2494785189628601, "policy_loss": 0.0051487525925040245, "mean_kl_loss": 0.007596420589834452, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5497856, "num_module_steps_trained_lifetime_throughput": 69713.84294491567}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 22}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 63, "trial_id": "a8246_00000", "date": "2025-06-25_21-07-59", "timestamp": 1750910879, "time_this_iter_s": 2.2244300842285156, "time_total_s": 1494.235740184784, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1494.235740184784, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 15.4, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 12.504227649634247, "restore_env_runners": 0.0026353725912025183, "training_step": 12.501458499370724, "env_runner_sampling_timer": 11.206399308568425, "learner_update_timer": 1.2929049495041804, "synch_weights": 0.0008740012360715285, "synch_env_connectors": 0.035257029575019916}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.77499966614414e-05, "add_time_dim_to_batch_and_zero_pad": 9.020997822517529e-06, "add_observations_from_episodes_to_batch": 4.1957999201258644e-05, "add_states_from_episodes_to_batch": 4.3125000956933945e-06, "agent_to_module_mapping": 7.3334995249751955e-06, "numpy_to_tensor": 2.6666995836421847e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.749423949840248e-06, "batch_individual_items": 9.180088142051009e-06, "add_time_dim_to_batch_and_zero_pad": 2.590571852096148e-06, "add_observations_from_episodes_to_batch": 1.4981210784064954e-05, "add_states_from_episodes_to_batch": 1.674075832789791e-06, "agent_to_module_mapping": 2.777935376450819e-06}}, "connector_pipeline_timer": 6.733098138333993e-05}, "env_reset_timer": 0.00011866649947478433, "agent_episode_returns_mean": {"vehicle_1": 354.447148156166, "vehicle_5": 516.4148914813995, "vehicle_3": 144.30793203353886, "vehicle_2": 217.65224711179732, "vehicle_4": 611.6812475204467, "vehicle_0": 124.94020402431488}, "sample": 0.13627733422080063, "rlmodule_inference_timer": 6.601318919980737e-05, "agent_steps": {"vehicle_5": 108.74, "vehicle_3": 40.68, "vehicle_2": 89.98, "vehicle_0": 40.68, "vehicle_4": 108.0, "vehicle_1": 99.94}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.9, "env_step_timer": 0.00015179994335046094, "connector_pipeline_timer": 0.0002581665030447766, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.582556232835401e-05, "tensor_to_numpy": 1.65209368076933e-05, "module_to_agent_unmapping": 1.6453283063201737e-06, "normalize_and_clip_actions": 4.741811529683847e-05, "remove_single_ts_time_rank_from_batch": 6.32625776578059e-07, "un_batch_to_individual_items": 1.54194115728649e-05, "listify_data_for_vector_env": 6.699650112172546e-06}}, "connector_pipeline_timer": 0.000154833148511987}, "num_agent_steps_sampled": {"vehicle_5": 1978.0, "vehicle_3": 740.0, "vehicle_2": 1628.0, "vehicle_4": 1963.0, "vehicle_0": 740.0, "vehicle_1": 1789.0000000000002}, "env_to_module_sum_episodes_length_in": 49.06276012930893, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8965.0, "vehicle_2": 19729.0, "vehicle_4": 23540.0, "vehicle_1": 22141.0, "vehicle_5": 23721.999999999996, "vehicle_3": 8965.0}, "episode_return_mean": 1969.443669912815, "num_env_steps_sampled_lifetime": 24000.0, "time_between_sampling": 0.30368901727858594, "episode_return_min": 1681.4785846471786, "episode_len_max": 112, "num_module_steps_sampled_lifetime": {"shared_policy": 107062.0}, "module_episode_returns_mean": {"shared_policy": 908.7220207309723}, "episode_len_min": 108, "weights_seq_no": 63.0, "episode_duration_sec_mean": 0.06995914489918506, "num_module_steps_sampled": {"shared_policy": 8838.0}, "num_episodes_lifetime": 216.0, "episode_return_max": 2279.7752661705017, "env_to_module_sum_episodes_length_out": 49.06276012930893, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1607.654912251914}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005632221848395141, "agent_to_module_mapping": 0.003340258835336861, "general_advantage_estimation": 0.017169976740750763, "add_time_dim_to_batch_and_zero_pad": 1.093648562780641e-05, "add_columns_from_episodes_to_train_batch": 0.050112276734894434, "add_states_from_episodes_to_batch": 3.2148880370133925e-06, "numpy_to_tensor": 0.00016881569376534064, "batch_individual_items": 0.0888402099734413, "add_observations_from_episodes_to_batch": 0.0003749337070158711}}, "connector_pipeline_timer": 0.16580710790235803}, "learner_connector_sum_episodes_length_in": 1990.5912024726726, "num_env_steps_trained": 1422000, "num_module_steps_trained_lifetime": 5588864, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 86684000, "num_module_steps_trained": 91008, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.5912024726726, "num_env_steps_trained_lifetime_throughput": 1076382.828663176, "num_module_steps_trained_throughput": 69708.5518725311, "num_module_steps_trained_lifetime_throughput": 69707.49250025152}, "shared_policy": {"gradients_default_optimizer_global_norm": 16.112417221069336, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.188809394836426, "total_loss": 9.173147201538086, "num_module_steps_trained": 91008, "num_trainable_parameters": 149763, "entropy": 0.17856383323669434, "vf_loss_unclipped": 3413.986572265625, "weights_seq_no": 64.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.010994315147399902, "policy_loss": -0.01775280572474003, "mean_kl_loss": 0.00765813747420907, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5588864, "num_module_steps_trained_lifetime_throughput": 69708.56831191822}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 22}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 64, "trial_id": "a8246_00000", "date": "2025-06-25_21-08-01", "timestamp": 1750910881, "time_this_iter_s": 2.1448910236358643, "time_total_s": 1496.3806312084198, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1496.3806312084198, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 14.366666666666665, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 12.40147566188784, "restore_env_runners": 0.0026090646952378325, "training_step": 12.398732530627024, "env_runner_sampling_timer": 11.102086731732772, "learner_update_timer": 1.2944885854291157, "synch_weights": 0.0008737895537103485, "synch_env_connectors": 0.03491580677930956}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.77499966614414e-05, "add_time_dim_to_batch_and_zero_pad": 9.020997822517529e-06, "add_observations_from_episodes_to_batch": 4.1957999201258644e-05, "add_states_from_episodes_to_batch": 4.3125000956933945e-06, "agent_to_module_mapping": 7.3334995249751955e-06, "numpy_to_tensor": 2.6666995836421847e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.63260593891002e-06, "batch_individual_items": 9.11048089248362e-06, "add_time_dim_to_batch_and_zero_pad": 2.562632772345288e-06, "add_observations_from_episodes_to_batch": 1.4741407275716682e-05, "add_states_from_episodes_to_batch": 1.6427986498738219e-06, "agent_to_module_mapping": 2.768582417406225e-06}}, "connector_pipeline_timer": 6.638070626073862e-05}, "env_reset_timer": 0.00011866649947478433, "agent_episode_returns_mean": {"vehicle_1": 326.1603827238083, "vehicle_5": 536.7745365858078, "vehicle_3": 141.63729554891586, "vehicle_2": 259.7596066451073, "vehicle_4": 609.2694590854645, "vehicle_0": 118.511411819458}, "sample": 0.13603013599993616, "rlmodule_inference_timer": 6.371835541967166e-05, "agent_steps": {"vehicle_5": 108.72000000000004, "vehicle_3": 40.66, "vehicle_2": 89.8, "vehicle_0": 40.66, "vehicle_4": 108.0, "vehicle_1": 101.0}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.86000000000001, "env_step_timer": 0.00014889900788743135, "connector_pipeline_timer": 0.0002581665030447766, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5691002393648614e-05, "tensor_to_numpy": 1.635670331571368e-05, "module_to_agent_unmapping": 1.6169682288731843e-06, "normalize_and_clip_actions": 4.689432120392446e-05, "remove_single_ts_time_rank_from_batch": 6.429949109006989e-07, "un_batch_to_individual_items": 1.5306605219725236e-05, "listify_data_for_vector_env": 6.643769184350546e-06}}, "connector_pipeline_timer": 0.00015361544600264292}, "num_agent_steps_sampled": {"vehicle_5": 1977.0, "vehicle_3": 727.0000000000001, "vehicle_2": 1658.0, "vehicle_4": 1965.0, "vehicle_0": 727.0000000000001, "vehicle_1": 1882.0}, "env_to_module_sum_episodes_length_in": 50.48794518282653, "num_agent_steps_sampled_lifetime": {"vehicle_0": 9692.0, "vehicle_2": 21387.0, "vehicle_4": 25505.0, "vehicle_1": 24023.0, "vehicle_5": 25698.999999999996, "vehicle_3": 9692.0}, "episode_return_mean": 1992.1126901626585, "num_env_steps_sampled_lifetime": 26000.0, "time_between_sampling": 0.3039493161468726, "episode_return_min": 1637.871482849121, "episode_len_max": 116, "num_module_steps_sampled_lifetime": {"shared_policy": 115998.0}, "module_episode_returns_mean": {"shared_policy": 925.6119645881653}, "episode_len_min": 108, "weights_seq_no": 64.0, "episode_duration_sec_mean": 0.06827343238037428, "num_module_steps_sampled": {"shared_policy": 8936.0}, "num_episodes_lifetime": 234.0, "episode_return_max": 2279.7752661705017, "env_to_module_sum_episodes_length_out": 50.48794518282653, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1630.682662899795}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005642764629882775, "agent_to_module_mapping": 0.0033460474970179836, "general_advantage_estimation": 0.017191381973341725, "add_time_dim_to_batch_and_zero_pad": 1.0928780815111599e-05, "add_columns_from_episodes_to_train_batch": 0.050231412297490986, "add_states_from_episodes_to_batch": 3.201489153895857e-06, "numpy_to_tensor": 0.00016815503686630454, "batch_individual_items": 0.08839893662372694, "add_observations_from_episodes_to_batch": 0.00037812061993828974}}, "connector_pipeline_timer": 0.16552518140332453}, "learner_connector_sum_episodes_length_in": 1990.6852904479458, "num_env_steps_trained": 1438000, "num_module_steps_trained_lifetime": 5680896, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 88122000, "num_module_steps_trained": 92032, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.6852904479458, "num_env_steps_trained_lifetime_throughput": 1075225.1895141078, "num_module_steps_trained_throughput": 69593.34489660252, "num_module_steps_trained_lifetime_throughput": 69592.37582457066}, "shared_policy": {"gradients_default_optimizer_global_norm": 37.33998107910156, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.473957061767578, "total_loss": 9.62820816040039, "num_module_steps_trained": 92032, "num_trainable_parameters": 149763, "entropy": 0.2553006708621979, "vf_loss_unclipped": 4394.51611328125, "weights_seq_no": 65.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.16134107112884521, "policy_loss": 0.14772135019302368, "mean_kl_loss": 0.01794545166194439, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5680896, "num_module_steps_trained_lifetime_throughput": 69593.16753998204}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 26000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 22}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 65, "trial_id": "a8246_00000", "date": "2025-06-25_21-08-03", "timestamp": 1750910883, "time_this_iter_s": 2.2313687801361084, "time_total_s": 1498.611999988556, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c32e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1498.611999988556, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 12.29893650484897, "restore_env_runners": 0.0025830177982547903, "training_step": 12.296219430740706, "env_runner_sampling_timer": 10.99803944441542, "learner_update_timer": 1.296020064574834, "synch_weights": 0.0008726804082001695, "synch_env_connectors": 0.0345786691314794}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.77499966614414e-05, "add_time_dim_to_batch_and_zero_pad": 9.020997822517529e-06, "add_observations_from_episodes_to_batch": 4.1957999201258644e-05, "add_states_from_episodes_to_batch": 4.3125000956933945e-06, "agent_to_module_mapping": 7.3334995249751955e-06, "numpy_to_tensor": 2.6666995836421847e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.543973880964767e-06, "batch_individual_items": 9.00889834914676e-06, "add_time_dim_to_batch_and_zero_pad": 2.527440512850796e-06, "add_observations_from_episodes_to_batch": 1.4699356478908044e-05, "add_states_from_episodes_to_batch": 1.6487572562007364e-06, "agent_to_module_mapping": 2.7510962112391544e-06}}, "connector_pipeline_timer": 6.606529007036448e-05}, "env_reset_timer": 0.00011866649947478433, "agent_episode_returns_mean": {"vehicle_1": 307.94802721500395, "vehicle_5": 531.1732738161087, "vehicle_3": 144.1658546304703, "vehicle_2": 241.16723027706146, "vehicle_4": 612.7974705791472, "vehicle_0": 120.46775695323942}, "sample": 0.13581641509731548, "rlmodule_inference_timer": 6.315585216213593e-05, "agent_steps": {"vehicle_5": 109.0, "vehicle_3": 40.5, "vehicle_2": 91.04, "vehicle_0": 40.5, "vehicle_4": 108.0, "vehicle_1": 104.0}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.44, "env_step_timer": 0.00014699357865284867, "connector_pipeline_timer": 0.0002581665030447766, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5086247005378386e-05, "tensor_to_numpy": 1.6032759190801284e-05, "module_to_agent_unmapping": 1.612883604926693e-06, "normalize_and_clip_actions": 4.648919621525107e-05, "remove_single_ts_time_rank_from_batch": 6.181026270255525e-07, "un_batch_to_individual_items": 1.5209592598014523e-05, "listify_data_for_vector_env": 6.599971863600583e-06}}, "connector_pipeline_timer": 0.0001517971989898738}, "num_agent_steps_sampled": {"vehicle_5": 1974.0000000000002, "vehicle_3": 711.0, "vehicle_2": 1648.0, "vehicle_4": 1953.0, "vehicle_0": 711.0, "vehicle_1": 1880.9999999999998}, "env_to_module_sum_episodes_length_in": 50.446787114184744, "num_agent_steps_sampled_lifetime": {"vehicle_0": 10403.0, "vehicle_2": 23035.0, "vehicle_4": 27458.0, "vehicle_1": 25904.0, "vehicle_5": 27672.999999999993, "vehicle_3": 10403.0}, "episode_return_mean": 1957.7196123218537, "num_env_steps_sampled_lifetime": 28000.0, "time_between_sampling": 0.30410922198557044, "episode_return_min": 1648.9552139043808, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 124876.0}, "module_episode_returns_mean": {"shared_policy": 864.2766513252259}, "episode_len_min": 108, "weights_seq_no": 65.0, "episode_duration_sec_mean": 0.06889950736149329, "num_module_steps_sampled": {"shared_policy": 8878.0}, "num_episodes_lifetime": 252.0, "episode_return_max": 2212.1912982463837, "env_to_module_sum_episodes_length_out": 50.446787114184744, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1651.2258757878917}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005654319073551646, "agent_to_module_mapping": 0.003349527862047974, "general_advantage_estimation": 0.01721347315354766, "add_time_dim_to_batch_and_zero_pad": 1.0902823021564627e-05, "add_columns_from_episodes_to_train_batch": 0.050318647344551826, "add_states_from_episodes_to_batch": 3.196564326024754e-06, "numpy_to_tensor": 0.00016751556653668356, "batch_individual_items": 0.08795580225754135, "add_observations_from_episodes_to_batch": 0.00037918982378030617}}, "connector_pipeline_timer": 0.16520638041927682}, "learner_connector_sum_episodes_length_in": 1990.7784375434665, "num_env_steps_trained": 1430000, "num_module_steps_trained_lifetime": 5772416, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 89552000, "num_module_steps_trained": 91520, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.7784375434665, "num_env_steps_trained_lifetime_throughput": 1076724.5093999298, "num_module_steps_trained_throughput": 69650.11026311063, "num_module_steps_trained_lifetime_throughput": 69649.3349971911}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.995875358581543, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.479132652282715, "total_loss": 9.44395923614502, "num_module_steps_trained": 91520, "num_trainable_parameters": 149763, "entropy": 0.05743512883782387, "vf_loss_unclipped": 3643.27978515625, "weights_seq_no": 66.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.04254192113876343, "policy_loss": -0.03877339884638786, "mean_kl_loss": 0.008244539611041546, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5772416, "num_module_steps_trained_lifetime_throughput": 69649.72377711399}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 22}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 66, "trial_id": "a8246_00000", "date": "2025-06-25_21-08-05", "timestamp": 1750910885, "time_this_iter_s": 2.149527072906494, "time_total_s": 1500.7615270614624, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b34f880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1500.7615270614624, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 16.133333333333336, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 12.814428029800471, "restore_env_runners": 0.0025572284502542687, "training_step": 12.811736661023268, "env_runner_sampling_timer": 11.5113927824713, "learner_update_timer": 1.298180668509087, "synch_weights": 0.0008720994440836044, "synch_env_connectors": 0.03424146244015886}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.149999683955684e-05, "add_time_dim_to_batch_and_zero_pad": 1.063319796230644e-05, "add_observations_from_episodes_to_batch": 4.79082009405829e-05, "add_states_from_episodes_to_batch": 5.024998972658068e-06, "agent_to_module_mapping": 8.65860201884061e-06, "numpy_to_tensor": 3.1391996890306474e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.372329103258376e-06, "batch_individual_items": 8.991162008175502e-06, "add_time_dim_to_batch_and_zero_pad": 2.5033749287902277e-06, "add_observations_from_episodes_to_batch": 1.4544027838615754e-05, "add_states_from_episodes_to_batch": 1.6180071351342428e-06, "agent_to_module_mapping": 2.6949738760090354e-06}}, "connector_pipeline_timer": 6.521289103353538e-05}, "env_reset_timer": 0.00013406640209723264, "agent_episode_returns_mean": {"vehicle_1": 347.38461404681215, "vehicle_5": 503.52444050788887, "vehicle_3": 127.4927640736103, "vehicle_2": 256.2786329126358, "vehicle_4": 613.2097600030899, "vehicle_0": 108.76146439552309}, "sample": 0.13677657404607352, "rlmodule_inference_timer": 6.355734673599758e-05, "agent_steps": {"vehicle_5": 110.14, "vehicle_3": 40.9, "vehicle_2": 90.49999999999999, "vehicle_0": 40.9, "vehicle_4": 108.0, "vehicle_1": 102.98}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 110.14, "env_step_timer": 0.0001458253328029152, "connector_pipeline_timer": 0.00029654160171048715, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.483255823239532e-05, "tensor_to_numpy": 1.5857678879344502e-05, "module_to_agent_unmapping": 1.6118619800837827e-06, "normalize_and_clip_actions": 4.616536671058203e-05, "remove_single_ts_time_rank_from_batch": 6.196658463807008e-07, "un_batch_to_individual_items": 1.5072654324645353e-05, "listify_data_for_vector_env": 6.613330198192405e-06}}, "connector_pipeline_timer": 0.00015080432742293207}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 721.0, "vehicle_2": 1599.0000000000002, "vehicle_4": 1933.0, "vehicle_0": 721.0, "vehicle_1": 1838.0}, "env_to_module_sum_episodes_length_in": 49.50318771863066, "num_agent_steps_sampled_lifetime": {"vehicle_0": 11124.0, "vehicle_2": 24634.0, "vehicle_4": 29391.0, "vehicle_1": 27742.0, "vehicle_5": 29653.999999999993, "vehicle_3": 11124.0}, "episode_return_mean": 1956.6516759824756, "num_env_steps_sampled_lifetime": 30000.0, "time_between_sampling": 0.7341716259672156, "episode_return_min": 1658.1456425189972, "episode_len_max": 114, "num_module_steps_sampled_lifetime": {"shared_policy": 133669.0}, "module_episode_returns_mean": {"shared_policy": 915.3491190719604}, "episode_len_min": 108, "weights_seq_no": 66.0, "episode_duration_sec_mean": 0.06855166985842516, "num_module_steps_sampled": {"shared_policy": 8793.0}, "num_episodes_lifetime": 271.0, "episode_return_max": 2212.1912982463837, "env_to_module_sum_episodes_length_out": 49.50318771863066, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1654.4737764514098}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005665492972803257, "agent_to_module_mapping": 0.0033566267434458666, "general_advantage_estimation": 0.01723188883198264, "add_time_dim_to_batch_and_zero_pad": 1.0890874765133257e-05, "add_columns_from_episodes_to_train_batch": 0.05039902795113606, "add_states_from_episodes_to_batch": 3.187098708571455e-06, "numpy_to_tensor": 0.00016675750087248353, "batch_individual_items": 0.08829876381500792, "add_observations_from_episodes_to_batch": 0.00038022583555809546}}, "connector_pipeline_timer": 0.16566639703513134}, "learner_connector_sum_episodes_length_in": 1990.8706531680318, "num_env_steps_trained": 1416000, "num_module_steps_trained_lifetime": 5863040, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 90968000, "num_module_steps_trained": 90624, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.8706531680318, "num_env_steps_trained_lifetime_throughput": 1076841.6193992768, "num_module_steps_trained_throughput": 69620.56038367002, "num_module_steps_trained_lifetime_throughput": 69619.82558392746}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.536493301391602, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.578194618225098, "total_loss": 9.621978759765625, "num_module_steps_trained": 90624, "num_trainable_parameters": 149763, "entropy": 0.3274877071380615, "vf_loss_unclipped": 3603.488525390625, "weights_seq_no": 67.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.12149244546890259, "policy_loss": 0.04260794818401337, "mean_kl_loss": 0.00879353191703558, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5863040, "num_module_steps_trained_lifetime_throughput": 69620.20501558566}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 30000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 22}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 67, "trial_id": "a8246_00000", "date": "2025-06-25_21-09-09", "timestamp": 1750910949, "time_this_iter_s": 63.84973382949829, "time_total_s": 1564.6112608909607, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b34d580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1564.6112608909607, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 9.07, "ram_util_percent": 52.105555555555554}}
{"timers": {"training_iteration": 13.32962526742252, "restore_env_runners": 0.0025699761657732114, "training_step": 13.326921161083042, "env_runner_sampling_timer": 12.024809322146607, "learner_update_timer": 1.299946790573999, "synch_weights": 0.0008713188696069115, "synch_env_connectors": 0.03390650156576133}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.266249696025625e-05, "add_time_dim_to_batch_and_zero_pad": 1.127889845520258e-05, "add_observations_from_episodes_to_batch": 5.0075001490768044e-05, "add_states_from_episodes_to_batch": 5.249998503131791e-06, "agent_to_module_mapping": 9.079402661882342e-06, "numpy_to_tensor": 3.342529817018658e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.309301401445933e-06, "batch_individual_items": 8.905382140662715e-06, "add_time_dim_to_batch_and_zero_pad": 2.4623559438122215e-06, "add_observations_from_episodes_to_batch": 1.4637603361799487e-05, "add_states_from_episodes_to_batch": 1.6335216408636e-06, "agent_to_module_mapping": 2.698037612171814e-06}}, "connector_pipeline_timer": 6.537366069479226e-05}, "env_reset_timer": 0.00014007470308570192, "agent_episode_returns_mean": {"vehicle_1": 266.3371361335118, "vehicle_5": 520.7142780823177, "vehicle_3": 149.99269705719416, "vehicle_2": 252.59748037603163, "vehicle_4": 614.9778933223089, "vehicle_0": 120.9783576022254}, "sample": 0.1362005645272306, "rlmodule_inference_timer": 6.756224626093467e-05, "agent_steps": {"vehicle_5": 109.86, "vehicle_3": 40.51333333333334, "vehicle_2": 91.36, "vehicle_0": 40.51333333333334, "vehicle_4": 108.0, "vehicle_1": 103.75777777777778}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.86, "env_step_timer": 0.00014623359868682836, "connector_pipeline_timer": 0.00031175830081338064, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.683736489272229e-05, "tensor_to_numpy": 1.665513576032938e-05, "module_to_agent_unmapping": 1.5927881509632234e-06, "normalize_and_clip_actions": 4.7088183975315505e-05, "remove_single_ts_time_rank_from_batch": 6.176724124217696e-07, "un_batch_to_individual_items": 1.5377669069971297e-05, "listify_data_for_vector_env": 6.579322274283232e-06}}, "connector_pipeline_timer": 0.0001550304954899715}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 749.0, "vehicle_2": 1675.9999999999998, "vehicle_4": 1957.0, "vehicle_0": 749.0, "vehicle_1": 1878.0}, "env_to_module_sum_episodes_length_in": 49.37864709517287, "num_agent_steps_sampled_lifetime": {"vehicle_0": 34370.99999999999, "vehicle_2": 77008.99999999999, "vehicle_4": 91813.99999999999, "vehicle_1": 87210.0, "vehicle_5": 92777.0, "vehicle_3": 34370.99999999999}, "episode_return_mean": 1925.5978445953788, "num_env_steps_sampled_lifetime": 93800.0, "time_between_sampling": 1.5203827905430478, "episode_return_min": 1583.190592288971, "episode_len_max": 113, "num_module_steps_sampled_lifetime": {"shared_policy": 417552.0}, "module_episode_returns_mean": {"shared_policy": 902.1607718287571}, "episode_len_min": 108, "weights_seq_no": 67.0, "episode_duration_sec_mean": 0.06783671072986584, "num_module_steps_sampled": {"shared_policy": 8992.0}, "num_episodes_lifetime": 852.0000000000002, "episode_return_max": 2259.7546002864838, "env_to_module_sum_episodes_length_out": 49.37864709517287, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1653.4030799112684}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0056769272031247904, "agent_to_module_mapping": 0.0033618850660217434, "general_advantage_estimation": 0.017253478283669417, "add_time_dim_to_batch_and_zero_pad": 1.0886966016648392e-05, "add_columns_from_episodes_to_train_batch": 0.05050315183161084, "add_states_from_episodes_to_batch": 3.1781477155661794e-06, "numpy_to_tensor": 0.00016596034583552, "batch_individual_items": 0.0878694570168586, "add_observations_from_episodes_to_batch": 0.0003810439871660506}}, "connector_pipeline_timer": 0.16537918973477966}, "learner_connector_sum_episodes_length_in": 1990.9619466363515, "num_env_steps_trained": 1446000, "num_module_steps_trained_lifetime": 5955584, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 92414000, "num_module_steps_trained": 92544, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1990.9619466363515, "num_env_steps_trained_lifetime_throughput": 1078720.8125230982, "num_module_steps_trained_throughput": 69706.25653033816, "num_module_steps_trained_lifetime_throughput": 69705.37639432079}, "shared_policy": {"gradients_default_optimizer_global_norm": 9.14838695526123, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.26218032836914, "total_loss": 9.253729820251465, "num_module_steps_trained": 92544, "num_trainable_parameters": 149763, "entropy": 0.08797591179609299, "vf_loss_unclipped": 3431.082275390625, "weights_seq_no": 68.0, "curr_kl_coeff": 0.5062500238418579, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.18336379528045654, "policy_loss": -0.010650517418980598, "mean_kl_loss": 0.006083959713578224, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 5955584, "num_module_steps_trained_lifetime_throughput": 69705.95635246039}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 93800.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 23}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 68, "trial_id": "a8246_00000", "date": "2025-06-25_21-10-14", "timestamp": 1750911014, "time_this_iter_s": 64.3360321521759, "time_total_s": 1628.9472930431366, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1322a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1628.9472930431366, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 8.923076923076925, "ram_util_percent": 51.996703296703295}}
{"timers": {"training_iteration": 13.83656093307832, "restore_env_runners": 0.0025831676541211695, "training_step": 13.833843404052192, "env_runner_sampling_timer": 12.530274420175175, "learner_update_timer": 1.3014016039182594, "synch_weights": 0.0008705527609227876, "synch_env_connectors": 0.03357755905005628}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.257909702369943e-05, "add_time_dim_to_batch_and_zero_pad": 1.119969820138067e-05, "add_observations_from_episodes_to_batch": 4.982920218026266e-05, "add_states_from_episodes_to_batch": 5.258298915578052e-06, "agent_to_module_mapping": 9.083603072213008e-06, "numpy_to_tensor": 3.2933698093984276e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.64532846075613e-06, "batch_individual_items": 9.016752232696434e-06, "add_time_dim_to_batch_and_zero_pad": 2.5156825396751973e-06, "add_observations_from_episodes_to_batch": 1.4785864376466509e-05, "add_states_from_episodes_to_batch": 1.6257827597934916e-06, "agent_to_module_mapping": 2.7024280539070255e-06}}, "connector_pipeline_timer": 6.610849333834779e-05}, "env_reset_timer": 0.0001390372031892184, "agent_episode_returns_mean": {"vehicle_1": 396.7840081267886, "vehicle_5": 512.5604163564576, "vehicle_3": 124.90623217900594, "vehicle_2": 265.3844046399328, "vehicle_4": 616.6313922691345, "vehicle_0": 136.9684237803353}, "sample": 0.1357248042550522, "rlmodule_inference_timer": 6.672603923564506e-05, "agent_steps": {"vehicle_5": 109.96444444444444, "vehicle_3": 41.01555555555556, "vehicle_2": 90.40444444444444, "vehicle_0": 41.01555555555556, "vehicle_4": 108.0, "vehicle_1": 100.4488888888889}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 109.96444444444444, "env_step_timer": 0.0001469816951167458, "connector_pipeline_timer": 0.00030915000097593294, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8144223502892835e-05, "tensor_to_numpy": 1.691436290086511e-05, "module_to_agent_unmapping": 1.6110505515143565e-06, "normalize_and_clip_actions": 4.730971668339913e-05, "remove_single_ts_time_rank_from_batch": 6.224592124056923e-07, "un_batch_to_individual_items": 1.5238813790722413e-05, "listify_data_for_vector_env": 6.613724035321337e-06}}, "connector_pipeline_timer": 0.00015716608466530288}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 721.0, "vehicle_2": 1649.0000000000002, "vehicle_4": 1948.0, "vehicle_0": 721.0, "vehicle_1": 1825.9999999999998}, "env_to_module_sum_episodes_length_in": 50.38830717383862, "num_agent_steps_sampled_lifetime": {"vehicle_0": 40220.0, "vehicle_2": 90222.0, "vehicle_4": 107586.00000000003, "vehicle_1": 101968.0, "vehicle_5": 108828.99999999997, "vehicle_3": 40220.0}, "episode_return_mean": 2053.2348782099616, "num_env_steps_sampled_lifetime": 110000.0, "time_between_sampling": 1.994100924033616, "episode_return_min": 1583.190592288971, "episode_len_max": 116, "num_module_steps_sampled_lifetime": {"shared_policy": 489045.0}, "module_episode_returns_mean": {"shared_policy": 880.4230208526718}, "episode_len_min": 108, "weights_seq_no": 68.0, "episode_duration_sec_mean": 0.06766338466823477, "num_module_steps_sampled": {"shared_policy": 8848.0}, "num_episodes_lifetime": 1000.0, "episode_return_max": 2220.5101096630096, "env_to_module_sum_episodes_length_out": 50.38830717383862, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1650.8234002747572}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005687761681087847, "agent_to_module_mapping": 0.0033671062154135307, "general_advantage_estimation": 0.01727749142081891, "add_time_dim_to_batch_and_zero_pad": 1.0887266352476214e-05, "add_columns_from_episodes_to_train_batch": 0.05057006281324992, "add_states_from_episodes_to_batch": 3.1713662104941233e-06, "numpy_to_tensor": 0.00016517115238086415, "batch_individual_items": 0.087441184116647, "add_observations_from_episodes_to_batch": 0.00038173104727081363}}, "connector_pipeline_timer": 0.1650574686674626}, "learner_connector_sum_episodes_length_in": 1991.052327169988, "num_env_steps_trained": 1422000, "num_module_steps_trained_lifetime": 6046592, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 93836000, "num_module_steps_trained": 91008, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1991.052327169988, "num_env_steps_trained_lifetime_throughput": 1079267.3406971693, "num_module_steps_trained_throughput": 69707.69115537703, "num_module_steps_trained_lifetime_throughput": 69706.93436544192}, "shared_policy": {"gradients_default_optimizer_global_norm": 166.55519104003906, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.704144477844238, "total_loss": 20.448345184326172, "num_module_steps_trained": 91008, "num_trainable_parameters": 149763, "entropy": 0.9796116352081299, "vf_loss_unclipped": 2876.771484375, "weights_seq_no": 69.0, "curr_kl_coeff": 0.7593750357627869, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.18414700031280518, "policy_loss": 0.4314562678337097, "mean_kl_loss": 20.390199661254883, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6046592, "num_module_steps_trained_lifetime_throughput": 69707.06598197305}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 110000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 24}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 69, "trial_id": "a8246_00000", "date": "2025-06-25_21-11-18", "timestamp": 1750911078, "time_this_iter_s": 64.02479529380798, "time_total_s": 1692.9720883369446, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a5da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1692.9720883369446, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 9.335555555555556, "ram_util_percent": 52.144444444444446}}
{"timers": {"training_iteration": 13.720452237497563, "restore_env_runners": 0.0025969884775614155, "training_step": 13.717720662511702, "env_runner_sampling_timer": 12.412681507643422, "learner_update_timer": 1.3028695499591032, "synch_weights": 0.000869907653318327, "synch_env_connectors": 0.033249042209602904}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.722949648159556e-05, "add_time_dim_to_batch_and_zero_pad": 9.874500392470509e-06, "add_observations_from_episodes_to_batch": 4.475000241654925e-05, "add_states_from_episodes_to_batch": 4.3125000956933945e-06, "agent_to_module_mapping": 7.375001587206498e-06, "numpy_to_tensor": 2.7583497285377234e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.836023873528826e-06, "batch_individual_items": 9.213179207951958e-06, "add_time_dim_to_batch_and_zero_pad": 2.5657844667178793e-06, "add_observations_from_episodes_to_batch": 1.505406502112638e-05, "add_states_from_episodes_to_batch": 1.6542282998795057e-06, "agent_to_module_mapping": 2.794631055408109e-06}}, "connector_pipeline_timer": 6.74390905693704e-05}, "env_reset_timer": 0.00012162500206613913, "agent_episode_returns_mean": {"vehicle_1": 440.3061276505674, "vehicle_5": 517.1426888241085, "vehicle_3": 143.18839902128494, "vehicle_2": 250.1898732818876, "vehicle_4": 616.7029576015474, "vehicle_0": 159.37027339254107}, "sample": 0.13202501556517757, "rlmodule_inference_timer": 6.697544495158011e-05, "agent_steps": {"vehicle_5": 108.10857142857141, "vehicle_3": 40.70285714285714, "vehicle_2": 89.77428571428571, "vehicle_0": 40.70285714285714, "vehicle_4": 108.0, "vehicle_1": 97.64000000000001}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.10857142857141, "env_step_timer": 0.00014692626771276688, "connector_pipeline_timer": 0.0002626249988679774, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.859298999522409e-05, "tensor_to_numpy": 1.7118361793430058e-05, "module_to_agent_unmapping": 1.6540774803662613e-06, "normalize_and_clip_actions": 4.8423147040637973e-05, "remove_single_ts_time_rank_from_batch": 6.393633798723042e-07, "un_batch_to_individual_items": 1.561324914332764e-05, "listify_data_for_vector_env": 6.784929128015625e-06}}, "connector_pipeline_timer": 0.00016004530738322807}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 747.9999999999999, "vehicle_2": 1630.9999999999998, "vehicle_4": 1980.9999999999998, "vehicle_0": 747.9999999999999, "vehicle_1": 1767.0}, "env_to_module_sum_episodes_length_in": 46.2593715449513, "num_agent_steps_sampled_lifetime": {"vehicle_0": 26060.999999999993, "vehicle_2": 58273.000000000015, "vehicle_4": 69510.0, "vehicle_1": 65581.99999999999, "vehicle_5": 70260.0, "vehicle_3": 26060.999999999993}, "episode_return_mean": 2126.900318427257, "num_env_steps_sampled_lifetime": 71000.0, "time_between_sampling": 1.1505709935045876, "episode_return_min": 1740.6904730796814, "episode_len_max": 112, "num_module_steps_sampled_lifetime": {"shared_policy": 315747.00000000006}, "module_episode_returns_mean": {"shared_policy": 1038.8728770828247}, "episode_len_min": 108, "weights_seq_no": 69.0, "episode_duration_sec_mean": 0.06741610775206938, "num_module_steps_sampled": {"shared_policy": 8856.0}, "num_episodes_lifetime": 645.0, "episode_return_max": 2321.7835595607758, "env_to_module_sum_episodes_length_out": 46.2593715449513, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1628.0249160056042}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005699761154292999, "agent_to_module_mapping": 0.0033716597332440665, "general_advantage_estimation": 0.017296601916632945, "add_time_dim_to_batch_and_zero_pad": 1.0870893738455904e-05, "add_columns_from_episodes_to_train_batch": 0.05066077801512226, "add_states_from_episodes_to_batch": 3.1646525204727876e-06, "numpy_to_tensor": 0.00016441694085166315, "batch_individual_items": 0.08700742894544228, "add_observations_from_episodes_to_batch": 0.0003839199868396425}}, "connector_pipeline_timer": 0.16475109732076493}, "learner_connector_sum_episodes_length_in": 1991.1418038982881, "num_env_steps_trained": 1428000, "num_module_steps_trained_lifetime": 6137984, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 95264000, "num_module_steps_trained": 91392, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1991.1418038982881, "num_env_steps_trained_lifetime_throughput": 1077685.0182525462, "num_module_steps_trained_throughput": 69574.59809538379, "num_module_steps_trained_lifetime_throughput": 69573.8989785112}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.650679588317871, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.408037185668945, "total_loss": 9.336905479431152, "num_module_steps_trained": 91392, "num_trainable_parameters": 149763, "entropy": 0.7639193534851074, "vf_loss_unclipped": 4095.53857421875, "weights_seq_no": 70.0, "curr_kl_coeff": 0.37968751788139343, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.1274382472038269, "policy_loss": -0.06410807371139526, "mean_kl_loss": 0.0008102196734398603, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6137984, "num_module_steps_trained_lifetime_throughput": 69574.0464221517}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 71000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 25}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 70, "trial_id": "a8246_00000", "date": "2025-06-25_21-11-20", "timestamp": 1750911080, "time_this_iter_s": 2.227907180786133, "time_total_s": 1695.1999955177307, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a6520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1695.1999955177307, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 13.45, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 14.816061714712585, "restore_env_runners": 0.002571073592768041, "training_step": 14.813355459216549, "env_runner_sampling_timer": 13.510569690066996, "learner_update_timer": 1.3006181990394952, "synch_weights": 0.0008686619067481713, "synch_env_connectors": 0.03292674303747361}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.2393424712520626e-05, "add_time_dim_to_batch_and_zero_pad": 8.564859204592981e-06, "add_observations_from_episodes_to_batch": 3.9660716928275565e-05, "add_states_from_episodes_to_batch": 3.464287146925926e-06, "agent_to_module_mapping": 5.827142948484314e-06, "numpy_to_tensor": 2.2613139922863672e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.719730805570473e-06, "batch_individual_items": 8.878784719629426e-06, "add_time_dim_to_batch_and_zero_pad": 2.5188796984079044e-06, "add_observations_from_episodes_to_batch": 1.4620128121380674e-05, "add_states_from_episodes_to_batch": 1.6152622739985543e-06, "agent_to_module_mapping": 2.7281759942244815e-06}}, "connector_pipeline_timer": 6.619921530618122e-05}, "env_reset_timer": 0.00010540500079514459, "agent_episode_returns_mean": {"vehicle_1": 407.11395344870425, "vehicle_5": 526.974344719478, "vehicle_3": 157.6226026562282, "vehicle_2": 209.73829430648257, "vehicle_4": 617.6093265526634, "vehicle_0": 167.14258906568796}, "sample": 0.12953984776636063, "rlmodule_inference_timer": 7.882575937237079e-05, "agent_steps": {"vehicle_5": 107.92, "vehicle_3": 40.32857142857143, "vehicle_2": 82.36, "vehicle_0": 40.32857142857143, "vehicle_4": 108.0, "vehicle_1": 87.29428571428572}, "num_env_steps_sampled": 1400.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014781186998404512, "connector_pipeline_timer": 0.00022012499747298925, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.560168482007865e-05, "tensor_to_numpy": 1.6119420349231032e-05, "module_to_agent_unmapping": 1.6115124271617467e-06, "normalize_and_clip_actions": 4.4976357241012784e-05, "remove_single_ts_time_rank_from_batch": 6.257839483949875e-07, "un_batch_to_individual_items": 1.4504541247731969e-05, "listify_data_for_vector_env": 6.3815617632639926e-06}}, "connector_pipeline_timer": 0.00015041424011262016}, "num_agent_steps_sampled": {"vehicle_5": 1387.0, "vehicle_3": 515.0, "vehicle_2": 1051.9999999999998, "vehicle_4": 1387.9999999999998, "vehicle_0": 515.0, "vehicle_1": 1123.0}, "env_to_module_sum_episodes_length_in": 50.729629577234405, "num_agent_steps_sampled_lifetime": {"vehicle_0": 26575.999999999993, "vehicle_2": 59325.000000000015, "vehicle_4": 70898.0, "vehicle_1": 66704.99999999999, "vehicle_5": 71647.0, "vehicle_3": 26575.999999999993}, "episode_return_mean": 2086.201110935211, "num_env_steps_sampled_lifetime": 72400.0, "time_between_sampling": 0.703791385225019, "episode_return_min": 1762.3117377758026, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 321727.00000000006}, "module_episode_returns_mean": {"shared_policy": 936.041951789856}, "episode_len_min": 108, "weights_seq_no": 70.0, "episode_duration_sec_mean": 0.06898088592468413, "num_module_steps_sampled": {"shared_policy": 5980.000000000001}, "num_episodes_lifetime": 657.0, "episode_return_max": 2360.1485557556152, "env_to_module_sum_episodes_length_out": 50.729629577234405, "num_episodes": 11.999999999999998, "num_env_steps_sampled_lifetime_throughput": 1656.7593177235517}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005697755622790461, "agent_to_module_mapping": 0.0033666885459296444, "general_advantage_estimation": 0.017260782977488877, "add_time_dim_to_batch_and_zero_pad": 1.0912184779092133e-05, "add_columns_from_episodes_to_train_batch": 0.05057250564503885, "add_states_from_episodes_to_batch": 3.1625859643910657e-06, "numpy_to_tensor": 0.00016369611141914432, "batch_individual_items": 0.08647533798601564, "add_observations_from_episodes_to_batch": 0.00038438036693072525}}, "connector_pipeline_timer": 0.164087783427518}, "learner_connector_sum_episodes_length_in": 1985.2303858593052, "num_env_steps_trained": 674800, "num_module_steps_trained_lifetime": 6199680, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 95938800, "num_module_steps_trained": 61696, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.2303858593052, "num_env_steps_trained_lifetime_throughput": 1060003.7770606435, "num_module_steps_trained_throughput": 69405.52069253728, "num_module_steps_trained_lifetime_throughput": 69404.96148766074}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.390200138092041, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.217782974243164, "total_loss": 9.285634994506836, "num_module_steps_trained": 61696, "num_trainable_parameters": 149763, "entropy": 0.7115200757980347, "vf_loss_unclipped": 3829.774169921875, "weights_seq_no": 71.0, "curr_kl_coeff": 0.18984375894069672, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.10489225387573242, "policy_loss": 0.07480866461992264, "mean_kl_loss": 0.0004137366486247629, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6199680, "num_module_steps_trained_lifetime_throughput": 69404.80730970998}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 72400.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 25}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 71, "trial_id": "a8246_00000", "date": "2025-06-25_21-13-24", "timestamp": 1750911204, "time_this_iter_s": 124.59169602394104, "time_total_s": 1819.7916915416718, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a617f60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1819.7916915416718, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 9.362146892655367, "ram_util_percent": 52.10112994350281}}
{"timers": {"training_iteration": 15.310272232145413, "restore_env_runners": 0.0029343195269076337, "training_step": 15.307201066714448, "env_runner_sampling_timer": 14.003213245666323, "learner_update_timer": 1.3018335678891115, "synch_weights": 0.0008681469476913926, "synch_env_connectors": 0.045692884357112905}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.3366903517162426e-05, "add_time_dim_to_batch_and_zero_pad": 1.0495503374841064e-05, "add_observations_from_episodes_to_batch": 6.066640053177252e-05, "add_states_from_episodes_to_batch": 5.041999247623607e-06, "agent_to_module_mapping": 8.645200432511047e-06, "numpy_to_tensor": 4.0312498458661136e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0361020582901423e-05, "batch_individual_items": 9.504349220439788e-06, "add_time_dim_to_batch_and_zero_pad": 2.6609591916393586e-06, "add_observations_from_episodes_to_batch": 1.5218255417175988e-05, "add_states_from_episodes_to_batch": 1.7342471307567133e-06, "agent_to_module_mapping": 2.8087731182040454e-06}}, "connector_pipeline_timer": 6.916915814129139e-05}, "env_reset_timer": 0.00016505470121046527, "agent_episode_returns_mean": {"vehicle_1": 435.1756498527527, "vehicle_5": 540.0939263153076, "vehicle_3": 147.84653358459474, "vehicle_2": 234.4792953721682, "vehicle_4": 614.4165122699739, "vehicle_0": 170.66313454469045}, "sample": 0.14240150708203997, "rlmodule_inference_timer": 6.920182969430479e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.306666666666665, "vehicle_2": 86.01333333333336, "vehicle_0": 40.306666666666665, "vehicle_4": 108.0, "vehicle_1": 92.22}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014635445649060697, "connector_pipeline_timer": 0.000350887501554098, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.533785880314515e-05, "tensor_to_numpy": 1.9277992686553654e-05, "module_to_agent_unmapping": 1.681965601218946e-06, "normalize_and_clip_actions": 4.9436273397415525e-05, "remove_single_ts_time_rank_from_batch": 6.451309617283319e-07, "un_batch_to_individual_items": 1.577592375554603e-05, "listify_data_for_vector_env": 6.851385778191207e-06}}, "connector_pipeline_timer": 0.00017070380720564214}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 746.0, "vehicle_2": 1599.0000000000002, "vehicle_4": 1983.0, "vehicle_0": 746.0, "vehicle_1": 1707.0}, "env_to_module_sum_episodes_length_in": 48.87522847316003, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3459.0, "vehicle_2": 7448.999999999998, "vehicle_4": 9121.000000000002, "vehicle_1": 8006.000000000002, "vehicle_5": 9121.000000000002, "vehicle_3": 3459.0}, "episode_return_mean": 2142.675051499208, "num_env_steps_sampled_lifetime": 9200.0, "time_between_sampling": 0.5272864750261825, "episode_return_min": 1880.0923429727554, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 40615.0}, "module_episode_returns_mean": {"shared_policy": 978.9124641187987}, "episode_len_min": 108, "weights_seq_no": 71.0, "episode_duration_sec_mean": 0.0673735827796433, "num_module_steps_sampled": {"shared_policy": 8764.0}, "num_episodes_lifetime": 79.00000000000001, "episode_return_max": 2300.5753548145294, "env_to_module_sum_episodes_length_out": 48.87522847316003, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1679.8073228912149}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0057077172365546675, "agent_to_module_mapping": 0.0033705633304966054, "general_advantage_estimation": 0.01727357639769652, "add_time_dim_to_batch_and_zero_pad": 1.0901812882877095e-05, "add_columns_from_episodes_to_train_batch": 0.05064669767858753, "add_states_from_episodes_to_batch": 3.1542900990391535e-06, "numpy_to_tensor": 0.00016294748026466022, "batch_individual_items": 0.08604923210620563, "add_observations_from_episodes_to_batch": 0.00038535365327320187}}, "connector_pipeline_timer": 0.16376235018324278}, "learner_connector_sum_episodes_length_in": 1985.378082000712, "num_env_steps_trained": 1410000, "num_module_steps_trained_lifetime": 6289920, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 97348800, "num_module_steps_trained": 90240, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.378082000712, "num_env_steps_trained_lifetime_throughput": 1062855.6467666712, "num_module_steps_trained_throughput": 69509.75802344468, "num_module_steps_trained_lifetime_throughput": 69509.25319977394}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.8930745124816895, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.620173454284668, "total_loss": 9.645681381225586, "num_module_steps_trained": 90240, "num_trainable_parameters": 149763, "entropy": 0.7541675567626953, "vf_loss_unclipped": 4770.67919921875, "weights_seq_no": 72.0, "curr_kl_coeff": 0.09492187947034836, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.36003577709198, "policy_loss": 0.032877929508686066, "mean_kl_loss": 0.0009026924381032586, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6289920, "num_module_steps_trained_lifetime_throughput": 69509.04712090452}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9200.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 27}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 72, "trial_id": "a8246_00000", "date": "2025-06-25_21-14-29", "timestamp": 1750911269, "time_this_iter_s": 64.23923802375793, "time_total_s": 1884.0309295654297, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b133420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1884.0309295654297, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 9.186813186813186, "ram_util_percent": 51.99340659340659}}
{"timers": {"training_iteration": 15.795343879403969, "restore_env_runners": 0.0029478029916305453, "training_step": 15.792258886467305, "env_runner_sampling_timer": 14.48680791528962, "learner_update_timer": 1.30329093096025, "synch_weights": 0.0008699033982055695, "synch_env_connectors": 0.045245137603539695}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.5583399110473693e-05, "add_time_dim_to_batch_and_zero_pad": 7.449400436598808e-06, "add_observations_from_episodes_to_batch": 3.850020002573729e-05, "add_states_from_episodes_to_batch": 3.7420002627186475e-06, "agent_to_module_mapping": 5.800402141176164e-06, "numpy_to_tensor": 2.450780157232657e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.682104258433079e-06, "batch_individual_items": 9.08506797986173e-06, "add_time_dim_to_batch_and_zero_pad": 2.490423166747404e-06, "add_observations_from_episodes_to_batch": 1.4548532403446039e-05, "add_states_from_episodes_to_batch": 1.5932267326981466e-06, "agent_to_module_mapping": 2.739151020465503e-06}}, "connector_pipeline_timer": 6.590159454149566e-05}, "env_reset_timer": 0.0001082253991626203, "agent_episode_returns_mean": {"vehicle_1": 463.68659777981884, "vehicle_5": 525.36144257273, "vehicle_3": 147.73458558831896, "vehicle_2": 264.8703266521863, "vehicle_4": 615.8109481995446, "vehicle_0": 169.84087860107422}, "sample": 0.13267819590542151, "rlmodule_inference_timer": 8.081525679971972e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.33142857142857, "vehicle_2": 88.96571428571427, "vehicle_0": 40.33142857142857, "vehicle_4": 108.0, "vehicle_1": 96.72285714285715}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.0001460319256229628, "connector_pipeline_timer": 0.00023250859812833368, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.860315932606355e-05, "tensor_to_numpy": 1.725598800955617e-05, "module_to_agent_unmapping": 1.6517927670516007e-06, "normalize_and_clip_actions": 4.81707661195938e-05, "remove_single_ts_time_rank_from_batch": 6.499585023886643e-07, "un_batch_to_individual_items": 1.5573177378924708e-05, "listify_data_for_vector_env": 6.669263193653784e-06}}, "connector_pipeline_timer": 0.0001588325087194886}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 747.0000000000001, "vehicle_2": 1649.0000000000002, "vehicle_4": 1982.0, "vehicle_0": 747.0000000000001, "vehicle_1": 1785.9999999999998}, "env_to_module_sum_episodes_length_in": 47.89303318705153, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4291.999999999999, "vehicle_2": 9362.999999999998, "vehicle_4": 11300.0, "vehicle_1": 10113.999999999998, "vehicle_5": 11300.0, "vehicle_3": 4291.999999999999}, "episode_return_mean": 2187.30477948904, "num_env_steps_sampled_lifetime": 11400.0, "time_between_sampling": 0.5665124089175873, "episode_return_min": 1880.0923429727554, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 50661.0}, "module_episode_returns_mean": {"shared_policy": 995.2234077136858}, "episode_len_min": 108, "weights_seq_no": 72.0, "episode_duration_sec_mean": 0.06896387076585336, "num_module_steps_sampled": {"shared_policy": 8893.0}, "num_episodes_lifetime": 100.0, "episode_return_max": 2369.4688634872437, "env_to_module_sum_episodes_length_out": 47.89303318705153, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1664.644580288014}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0057180154741880524, "agent_to_module_mapping": 0.0033749047772071703, "general_advantage_estimation": 0.017289968963740604, "add_time_dim_to_batch_and_zero_pad": 1.0880714806513375e-05, "add_columns_from_episodes_to_train_batch": 0.05073696445179131, "add_states_from_episodes_to_batch": 3.1444171826110845e-06, "numpy_to_tensor": 0.00016221717543441286, "batch_individual_items": 0.08562499853512173, "add_observations_from_episodes_to_batch": 0.0003862576167321531}}, "connector_pipeline_timer": 0.16345932834139293}, "learner_connector_sum_episodes_length_in": 1985.524301180705, "num_env_steps_trained": 1432000, "num_module_steps_trained_lifetime": 6381568, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 98780800, "num_module_steps_trained": 91648, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.524301180705, "num_env_steps_trained_lifetime_throughput": 1063797.7799974387, "num_module_steps_trained_throughput": 69495.47805273932, "num_module_steps_trained_lifetime_throughput": 69495.094460134}, "shared_policy": {"gradients_default_optimizer_global_norm": 12.624887466430664, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.314908981323242, "total_loss": 9.269187927246094, "num_module_steps_trained": 91648, "num_trainable_parameters": 149763, "entropy": 0.7683418989181519, "vf_loss_unclipped": 4304.52099609375, "weights_seq_no": 73.0, "curr_kl_coeff": 0.04746093973517418, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.08035141229629517, "policy_loss": -0.038093820214271545, "mean_kl_loss": 0.000597856123931706, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6381568, "num_module_steps_trained_lifetime_throughput": 69494.70088733264}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11400.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 28}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 73, "trial_id": "a8246_00000", "date": "2025-06-25_21-15-33", "timestamp": 1750911333, "time_this_iter_s": 63.8194420337677, "time_total_s": 1947.8503715991974, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b131a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1947.8503715991974, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 9.18901098901099, "ram_util_percent": 52.06703296703297}}
{"timers": {"training_iteration": 16.275250194359945, "restore_env_runners": 0.0029602078717232477, "training_step": 16.272152700102662, "env_runner_sampling_timer": 14.965406920716767, "learner_update_timer": 1.3045827041506572, "synch_weights": 0.0008687289542605785, "synch_env_connectors": 0.044803649557491436}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.648310182848945e-05, "add_time_dim_to_batch_and_zero_pad": 8.621099550509825e-06, "add_observations_from_episodes_to_batch": 3.799199766945094e-05, "add_states_from_episodes_to_batch": 3.270699380664155e-06, "agent_to_module_mapping": 5.8127028751187004e-06, "numpy_to_tensor": 2.916599769378081e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.50059787510698e-06, "batch_individual_items": 8.984475165453062e-06, "add_time_dim_to_batch_and_zero_pad": 2.500752428450756e-06, "add_observations_from_episodes_to_batch": 1.4388315060263445e-05, "add_states_from_episodes_to_batch": 1.5975494654562883e-06, "agent_to_module_mapping": 2.6814370627174744e-06}}, "connector_pipeline_timer": 6.504539903529889e-05}, "env_reset_timer": 0.00010368759903940372, "agent_episode_returns_mean": {"vehicle_1": 427.1720972444331, "vehicle_5": 510.7345073529652, "vehicle_3": 152.95154991081785, "vehicle_2": 223.7095592917715, "vehicle_4": 617.5235146011624, "vehicle_0": 167.67673275606973}, "sample": 0.12860485476779887, "rlmodule_inference_timer": 7.871018036265879e-05, "agent_steps": {"vehicle_5": 107.97999999999998, "vehicle_3": 40.39142857142856, "vehicle_2": 87.41142857142859, "vehicle_0": 40.39142857142856, "vehicle_4": 108.0, "vehicle_1": 92.92}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014263238782790156, "connector_pipeline_timer": 0.0002210706996265799, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.946250723875146e-05, "tensor_to_numpy": 1.7328844104989683e-05, "module_to_agent_unmapping": 1.6140059162477446e-06, "normalize_and_clip_actions": 4.8313823643508183e-05, "remove_single_ts_time_rank_from_batch": 6.278116641834884e-07, "un_batch_to_individual_items": 1.5167509467836076e-05, "listify_data_for_vector_env": 6.5768231382883285e-06}}, "connector_pipeline_timer": 0.00015934691694220295}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 749.0, "vehicle_2": 1609.0000000000002, "vehicle_4": 1982.0, "vehicle_0": 749.0, "vehicle_1": 1719.0000000000002}, "env_to_module_sum_episodes_length_in": 47.279480021379364, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4374.0, "vehicle_2": 9451.000000000002, "vehicle_4": 11497.999999999998, "vehicle_1": 10097.999999999998, "vehicle_5": 11497.000000000002, "vehicle_3": 4374.0}, "episode_return_mean": 2099.7679614862373, "num_env_steps_sampled_lifetime": 11600.0, "time_between_sampling": 0.4478002443343916, "episode_return_min": 1816.664068222046, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 51291.999999999985}, "module_episode_returns_mean": {"shared_policy": 995.7451013966967}, "episode_len_min": 108, "weights_seq_no": 73.0, "episode_duration_sec_mean": 0.06807756928492122, "num_module_steps_sampled": {"shared_policy": 8789.0}, "num_episodes_lifetime": 102.0, "episode_return_max": 2287.3009229898453, "env_to_module_sum_episodes_length_out": 47.279480021379364, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1679.3107211952827}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0057282919794089445, "agent_to_module_mapping": 0.0033799144794505027, "general_advantage_estimation": 0.017301088434109043, "add_time_dim_to_batch_and_zero_pad": 1.0858567660573668e-05, "add_columns_from_episodes_to_train_batch": 0.05079087897730832, "add_states_from_episodes_to_batch": 3.1346330272853646e-06, "numpy_to_tensor": 0.00016148333371253563, "batch_individual_items": 0.08520699813977682, "add_observations_from_episodes_to_batch": 0.00038712879052118983}}, "connector_pipeline_timer": 0.16312133005792787}, "learner_connector_sum_episodes_length_in": 1985.669058168898, "num_env_steps_trained": 1416000, "num_module_steps_trained_lifetime": 6472192, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 100196800, "num_module_steps_trained": 90624, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.669058168898, "num_env_steps_trained_lifetime_throughput": 1065692.6287740415, "num_module_steps_trained_throughput": 69546.55978440719, "num_module_steps_trained_lifetime_throughput": 69546.1889710273}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.390557289123535, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.552063941955566, "total_loss": 9.643747329711914, "num_module_steps_trained": 90624, "num_trainable_parameters": 149763, "entropy": 0.8338382840156555, "vf_loss_unclipped": 4093.5234375, "weights_seq_no": 74.0, "curr_kl_coeff": 0.02373046986758709, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.08115184307098389, "policy_loss": 0.09999369829893112, "mean_kl_loss": 0.0006169357802718878, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6472192, "num_module_steps_trained_lifetime_throughput": 69545.85921969588}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11600.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 29}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 74, "trial_id": "a8246_00000", "date": "2025-06-25_21-16-36", "timestamp": 1750911396, "time_this_iter_s": 63.7876980304718, "time_total_s": 2011.6380696296692, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x100ea5da0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2011.6380696296692, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 9.203333333333335, "ram_util_percent": 52.07111111111113}}
{"timers": {"training_iteration": 16.751884436996313, "restore_env_runners": 0.0029711607930201526, "training_step": 16.74877554768167, "env_runner_sampling_timer": 15.439597986929577, "learner_update_timer": 1.3070116696091045, "synch_weights": 0.0008677145847552665, "synch_env_connectors": 0.044363807641921306}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3407803382724524e-05, "add_time_dim_to_batch_and_zero_pad": 8.058601815719158e-06, "add_observations_from_episodes_to_batch": 3.456659760558978e-05, "add_states_from_episodes_to_batch": 3.2079988159239292e-06, "agent_to_module_mapping": 5.45000220881775e-06, "numpy_to_tensor": 2.5940994964912535e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.64563484395085e-06, "batch_individual_items": 9.093281038411865e-06, "add_time_dim_to_batch_and_zero_pad": 2.5222827672468045e-06, "add_observations_from_episodes_to_batch": 1.4599413741343004e-05, "add_states_from_episodes_to_batch": 1.640200258707244e-06, "agent_to_module_mapping": 2.746906820687713e-06}}, "connector_pipeline_timer": 6.59894176517729e-05}, "env_reset_timer": 0.00010612480109557509, "agent_episode_returns_mean": {"vehicle_1": 443.7123575748716, "vehicle_5": 494.84264934948516, "vehicle_3": 148.86177053110939, "vehicle_2": 261.03766795158384, "vehicle_4": 613.1446526466096, "vehicle_0": 166.1948404128211}, "sample": 0.13204070703930565, "rlmodule_inference_timer": 7.698378211923657e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.431428571428576, "vehicle_2": 89.31714285714283, "vehicle_0": 40.431428571428576, "vehicle_4": 108.0, "vehicle_1": 97.0}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.04, "env_step_timer": 0.00014561910285923506, "connector_pipeline_timer": 0.00020718340092571453, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8838385898265264e-05, "tensor_to_numpy": 1.7167479798281584e-05, "module_to_agent_unmapping": 1.632461967259768e-06, "normalize_and_clip_actions": 4.7760035755169526e-05, "remove_single_ts_time_rank_from_batch": 6.155896683151041e-07, "un_batch_to_individual_items": 1.5151009559381945e-05, "listify_data_for_vector_env": 6.768831246614384e-06}}, "connector_pipeline_timer": 0.00015815689315168565}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 761.0, "vehicle_2": 1618.0, "vehicle_4": 1980.0, "vehicle_0": 761.0, "vehicle_1": 1748.0}, "env_to_module_sum_episodes_length_in": 46.97778475067363, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4459.0, "vehicle_2": 9691.000000000002, "vehicle_4": 11694.0, "vehicle_1": 10429.0, "vehicle_5": 11692.000000000002, "vehicle_3": 4459.0}, "episode_return_mean": 2127.7939379419595, "num_env_steps_sampled_lifetime": 11800.0, "time_between_sampling": 0.3425919176889297, "episode_return_min": 1900.4752736091614, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 52424.0}, "module_episode_returns_mean": {"shared_policy": 1011.1737008081162}, "episode_len_min": 108, "weights_seq_no": 74.0, "episode_duration_sec_mean": 0.06856850365989625, "num_module_steps_sampled": {"shared_policy": 8849.0}, "num_episodes_lifetime": 104.00000000000003, "episode_return_max": 2287.3009229898453, "env_to_module_sum_episodes_length_out": 46.97778475067363, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1649.6128568556376}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0057701553096099565, "agent_to_module_mapping": 0.0033840324246683403, "general_advantage_estimation": 0.017315319219759588, "add_time_dim_to_batch_and_zero_pad": 1.0845812020993666e-05, "add_columns_from_episodes_to_train_batch": 0.05093726101752413, "add_states_from_episodes_to_batch": 3.1232867037832263e-06, "numpy_to_tensor": 0.0001607818303799608, "batch_individual_items": 0.08557886482837321, "add_observations_from_episodes_to_batch": 0.00038979666263790796}}, "connector_pipeline_timer": 0.16370149216731866}, "learner_connector_sum_episodes_length_in": 1985.8123675872089, "num_env_steps_trained": 1424000, "num_module_steps_trained_lifetime": 6563328, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 101620800, "num_module_steps_trained": 91136, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.8123675872089, "num_env_steps_trained_lifetime_throughput": 1066152.7172179364, "num_module_steps_trained_throughput": 69508.93193488978, "num_module_steps_trained_lifetime_throughput": 69508.51693900579}, "shared_policy": {"gradients_default_optimizer_global_norm": 13.656277656555176, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.558778762817383, "total_loss": 9.509504318237305, "num_module_steps_trained": 91136, "num_trainable_parameters": 149763, "entropy": 0.6352851390838623, "vf_loss_unclipped": 4473.79541015625, "weights_seq_no": 75.0, "curr_kl_coeff": 0.011865234933793545, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.2470405101776123, "policy_loss": -0.04296182096004486, "mean_kl_loss": 0.001689684228040278, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6563328, "num_module_steps_trained_lifetime_throughput": 69508.23150993415}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11800.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 30}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 75, "trial_id": "a8246_00000", "date": "2025-06-25_21-17-40", "timestamp": 1750911460, "time_this_iter_s": 63.940359115600586, "time_total_s": 2075.57842874527, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c00e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2075.57842874527, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 9.143333333333334, "ram_util_percent": 52.021111111111104}}
{"timers": {"training_iteration": 16.606482406786387, "restore_env_runners": 0.0029830883550299777, "training_step": 16.603361413874843, "env_runner_sampling_timer": 15.292617950810302, "learner_update_timer": 1.30857432041302, "synch_weights": 0.0008672995189171584, "synch_env_connectors": 0.04392784956555546}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.102049984387122e-05, "add_time_dim_to_batch_and_zero_pad": 6.895501428516582e-06, "add_observations_from_episodes_to_batch": 3.189549897797406e-05, "add_states_from_episodes_to_batch": 4.89550075144507e-06, "agent_to_module_mapping": 5.0835042202379555e-06, "numpy_to_tensor": 2.087449684040621e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.86322269088167e-06, "batch_individual_items": 9.205279365961238e-06, "add_time_dim_to_batch_and_zero_pad": 2.5713516191135477e-06, "add_observations_from_episodes_to_batch": 1.4790605769931506e-05, "add_states_from_episodes_to_batch": 1.6529608345033386e-06, "agent_to_module_mapping": 2.7379604875507944e-06}}, "connector_pipeline_timer": 6.657078418300215e-05}, "env_reset_timer": 9.814549775910564e-05, "agent_episode_returns_mean": {"vehicle_1": 453.82505226782376, "vehicle_5": 508.6095280531474, "vehicle_3": 134.05097897223067, "vehicle_2": 265.4719556927681, "vehicle_4": 617.5677808168956, "vehicle_0": 170.71607710668016}, "sample": 0.13286798060170404, "rlmodule_inference_timer": 8.11095320678504e-05, "agent_steps": {"vehicle_5": 108.02, "vehicle_3": 40.588571428571434, "vehicle_2": 91.21428571428572, "vehicle_0": 40.588571428571434, "vehicle_4": 108.0, "vehicle_1": 99.04}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.02, "env_step_timer": 0.00014720010441149011, "connector_pipeline_timer": 0.0001979375010705553, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.923324690016872e-05, "tensor_to_numpy": 1.7142550723715403e-05, "module_to_agent_unmapping": 1.6088650802656847e-06, "normalize_and_clip_actions": 4.8280745704681915e-05, "remove_single_ts_time_rank_from_batch": 6.184456333516713e-07, "un_batch_to_individual_items": 1.5325917224028842e-05, "listify_data_for_vector_env": 6.780683260410039e-06}}, "connector_pipeline_timer": 0.00015910872819576766}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 766.0, "vehicle_2": 1685.9999999999998, "vehicle_4": 1982.0, "vehicle_0": 766.0, "vehicle_1": 1820.9999999999998}, "env_to_module_sum_episodes_length_in": 47.60155574096386, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4546.0, "vehicle_2": 10098.999999999998, "vehicle_4": 11890.0, "vehicle_1": 10939.0, "vehicle_5": 11895.0, "vehicle_3": 4546.0}, "episode_return_mean": 2150.2413723373415, "num_env_steps_sampled_lifetime": 12000.0, "time_between_sampling": 0.34670662800208657, "episode_return_min": 1872.8439890146255, "episode_len_max": 109, "num_module_steps_sampled_lifetime": {"shared_policy": 53915.0}, "module_episode_returns_mean": {"shared_policy": 1018.7999510145187}, "episode_len_min": 108, "weights_seq_no": 75.0, "episode_duration_sec_mean": 0.06887854430639502, "num_module_steps_sampled": {"shared_policy": 9003.0}, "num_episodes_lifetime": 105.0, "episode_return_max": 2343.093120574951, "env_to_module_sum_episodes_length_out": 47.60155574096386, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1641.2379675787397}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005785205006486355, "agent_to_module_mapping": 0.0033873487604586558, "general_advantage_estimation": 0.01733507519756234, "add_time_dim_to_batch_and_zero_pad": 1.0819433905869755e-05, "add_columns_from_episodes_to_train_batch": 0.051023082567326725, "add_states_from_episodes_to_batch": 3.1166438813770167e-06, "numpy_to_tensor": 0.0001600536020828228, "batch_individual_items": 0.08518196076009212, "add_observations_from_episodes_to_batch": 0.0003908745260271388}}, "connector_pipeline_timer": 0.1634283980856582}, "learner_connector_sum_episodes_length_in": 1985.9542439113368, "num_env_steps_trained": 1448000, "num_module_steps_trained_lifetime": 6656000, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 103068800, "num_module_steps_trained": 92672, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.9542439113368, "num_env_steps_trained_lifetime_throughput": 1067286.986113526, "num_module_steps_trained_throughput": 69517.83847837127, "num_module_steps_trained_lifetime_throughput": 69517.43019124471}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.439123153686523, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.317916870117188, "total_loss": 9.203095436096191, "num_module_steps_trained": 92672, "num_trainable_parameters": 149763, "entropy": 0.570213258266449, "vf_loss_unclipped": 4141.8798828125, "weights_seq_no": 76.0, "curr_kl_coeff": 0.005932617466896772, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.11951690912246704, "policy_loss": -0.1091390922665596, "mean_kl_loss": 0.0016453589778393507, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6656000, "num_module_steps_trained_lifetime_throughput": 69517.10081333971}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 31}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 76, "trial_id": "a8246_00000", "date": "2025-06-25_21-17-43", "timestamp": 1750911463, "time_this_iter_s": 2.213624954223633, "time_total_s": 2077.7920536994934, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b104c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2077.7920536994934, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 13.55, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 17.68353278771852, "restore_env_runners": 0.002953300811521562, "training_step": 17.68044142890606, "env_runner_sampling_timer": 16.368776502972207, "learner_update_timer": 1.3094921088788403, "synch_weights": 0.0008693102737341242, "synch_env_connectors": 0.0434969481499119}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.118033201744159e-05, "add_time_dim_to_batch_and_zero_pad": 6.819000797501455e-06, "add_observations_from_episodes_to_batch": 3.224966591612125e-05, "add_states_from_episodes_to_batch": 5.4580013966187835e-06, "agent_to_module_mapping": 5.111338396091014e-06, "numpy_to_tensor": 2.0735664293169975e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.712402328682208e-06, "batch_individual_items": 9.044483189009315e-06, "add_time_dim_to_batch_and_zero_pad": 2.5224010556303737e-06, "add_observations_from_episodes_to_batch": 1.4620988887314288e-05, "add_states_from_episodes_to_batch": 1.6450937043975072e-06, "agent_to_module_mapping": 2.7265869752672513e-06}}, "connector_pipeline_timer": 6.597991207131775e-05}, "env_reset_timer": 9.587466289910178e-05, "agent_episode_returns_mean": {"vehicle_1": 450.3874892669254, "vehicle_5": 544.9083512338002, "vehicle_3": 141.9805423777633, "vehicle_2": 249.32345941993924, "vehicle_4": 618.4130555963516, "vehicle_0": 165.21268573111956}, "sample": 0.13242902592500613, "rlmodule_inference_timer": 7.848159408853822e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.57333333333334, "vehicle_2": 89.67555555555556, "vehicle_0": 40.57333333333334, "vehicle_4": 108.0, "vehicle_1": 96.71111111111114}, "num_env_steps_sampled": 1800.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014752380790846283, "connector_pipeline_timer": 0.00019969433439352238, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.688212088633581e-05, "tensor_to_numpy": 1.6359635917388738e-05, "module_to_agent_unmapping": 1.583955362824567e-06, "normalize_and_clip_actions": 4.6389718581658924e-05, "remove_single_ts_time_rank_from_batch": 6.179672006693697e-07, "un_batch_to_individual_items": 1.4863198505767003e-05, "listify_data_for_vector_env": 6.563588864949604e-06}}, "connector_pipeline_timer": 0.00015334995738771273}, "num_agent_steps_sampled": {"vehicle_5": 1784.0, "vehicle_3": 646.0, "vehicle_2": 1478.0, "vehicle_4": 1784.0, "vehicle_0": 646.0, "vehicle_1": 1601.0}, "env_to_module_sum_episodes_length_in": 50.39899283972542, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5192.0, "vehicle_2": 11576.999999999998, "vehicle_4": 13674.0, "vehicle_1": 12540.0, "vehicle_5": 13679.0, "vehicle_3": 5192.0}, "episode_return_mean": 2170.2255885897744, "num_env_steps_sampled_lifetime": 13800.0, "time_between_sampling": 0.35206713809842605, "episode_return_min": 1822.3022675514221, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 61854.0}, "module_episode_returns_mean": {"shared_policy": 960.3713837859365}, "episode_len_min": 108, "weights_seq_no": 76.0, "episode_duration_sec_mean": 0.07060686493756495, "num_module_steps_sampled": {"shared_policy": 7939.0}, "num_episodes_lifetime": 121.0, "episode_return_max": 2340.702582359314, "env_to_module_sum_episodes_length_out": 50.39899283972542, "num_episodes": 16.0, "num_env_steps_sampled_lifetime_throughput": 1656.1163255055071}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005794927536374125, "agent_to_module_mapping": 0.0033889677728824092, "general_advantage_estimation": 0.017343028615623753, "add_time_dim_to_batch_and_zero_pad": 1.0797909536998417e-05, "add_columns_from_episodes_to_train_batch": 0.051056503411667245, "add_states_from_episodes_to_batch": 3.1088174049171764e-06, "numpy_to_tensor": 0.00015934681610080742, "batch_individual_items": 0.08474024824248358, "add_observations_from_episodes_to_batch": 0.00039222037076305164}}, "connector_pipeline_timer": 0.16303993826479773}, "learner_connector_sum_episodes_length_in": 1984.0947014722235, "num_env_steps_trained": 1152000, "num_module_steps_trained_lifetime": 6737920, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 104220800, "num_module_steps_trained": 81920, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1984.0947014722235, "num_env_steps_trained_lifetime_throughput": 1061389.4990925973, "num_module_steps_trained_throughput": 69417.26085153558, "num_module_steps_trained_lifetime_throughput": 69416.94800285403}, "shared_policy": {"gradients_default_optimizer_global_norm": 11.538259506225586, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.302606582641602, "total_loss": 9.30959701538086, "num_module_steps_trained": 81920, "num_trainable_parameters": 149763, "entropy": 0.7018917798995972, "vf_loss_unclipped": 4004.056884765625, "weights_seq_no": 77.0, "curr_kl_coeff": 0.002966308733448386, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.10843765735626221, "policy_loss": 0.01400276180356741, "mean_kl_loss": 0.001232540118508041, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6737920, "num_module_steps_trained_lifetime_throughput": 69416.32115744679}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 13800.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 31}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 77, "trial_id": "a8246_00000", "date": "2025-06-25_21-19-47", "timestamp": 1750911587, "time_this_iter_s": 124.31347370147705, "time_total_s": 2202.1055274009705, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b450fe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2202.1055274009705, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 9.110857142857142, "ram_util_percent": 52.147999999999996}}
{"timers": {"training_iteration": 17.528728080261306, "restore_env_runners": 0.0029642507234187835, "training_step": 17.525625440446984, "env_runner_sampling_timer": 16.211979371692493, "learner_update_timer": 1.311469938620056, "synch_weights": 0.0008690563409751566, "synch_env_connectors": 0.0430730978283845}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.878227244867225e-06, "batch_individual_items": 9.391387021154337e-06, "add_time_dim_to_batch_and_zero_pad": 2.5590340433699606e-06, "add_observations_from_episodes_to_batch": 1.4864796053972715e-05, "add_states_from_episodes_to_batch": 1.6783822194405724e-06, "agent_to_module_mapping": 2.7666408162603184e-06}}, "connector_pipeline_timer": 6.730265889818294e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 489.51658612012864, "vehicle_5": 539.6749134874344, "vehicle_3": 152.85045291423802, "vehicle_2": 264.34613173007966, "vehicle_4": 613.1237327861786, "vehicle_0": 165.63471195697784}, "sample": 0.12859060115033286, "rlmodule_inference_timer": 6.730120724179157e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.34, "vehicle_2": 89.08, "vehicle_0": 40.34, "vehicle_4": 108.0, "vehicle_1": 96.66}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014470930046217684, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.175557133592483e-05, "tensor_to_numpy": 1.8366411022897487e-05, "module_to_agent_unmapping": 1.6629461936841267e-06, "normalize_and_clip_actions": 4.954232236206549e-05, "remove_single_ts_time_rank_from_batch": 6.532415439484742e-07, "un_batch_to_individual_items": 1.568860907310389e-05, "listify_data_for_vector_env": 6.846436746686145e-06}}, "connector_pipeline_timer": 0.00016544559822544706}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 765.0, "vehicle_2": 1605.0, "vehicle_4": 1982.0, "vehicle_0": 765.0, "vehicle_1": 1734.0000000000002}, "env_to_module_sum_episodes_length_in": 45.84693909226319, "num_agent_steps_sampled_lifetime": {"vehicle_0": 2340.0, "vehicle_2": 5006.000000000001, "vehicle_4": 5950.0, "vehicle_1": 5383.0, "vehicle_5": 5950.0, "vehicle_3": 2340.0}, "episode_return_mean": 2225.146528995037, "num_env_steps_sampled_lifetime": 6000.0, "time_between_sampling": 0.006334194629321624, "episode_return_min": 1758.8425061702728, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 26969.000000000007}, "module_episode_returns_mean": {"shared_policy": 1070.0868739318848}, "episode_len_min": 108, "weights_seq_no": 77.0, "episode_duration_sec_mean": 0.0665985126592568, "num_module_steps_sampled": {"shared_policy": 8833.0}, "num_episodes_lifetime": 50.0, "episode_return_max": 2337.868324160576, "env_to_module_sum_episodes_length_out": 45.84693909226319, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1642.409613131692}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005803030761052517, "agent_to_module_mapping": 0.0033926060051070817, "general_advantage_estimation": 0.017351902919447566, "add_time_dim_to_batch_and_zero_pad": 1.0776600484575368e-05, "add_columns_from_episodes_to_train_batch": 0.0511234242175906, "add_states_from_episodes_to_batch": 3.0998092156418867e-06, "numpy_to_tensor": 0.00015864375795026942, "batch_individual_items": 0.08512596910004785, "add_observations_from_episodes_to_batch": 0.0003929827470360972}}, "connector_pipeline_timer": 0.16351289554215878}, "learner_connector_sum_episodes_length_in": 1984.2537544575011, "num_env_steps_trained": 1422000, "num_module_steps_trained_lifetime": 6828928, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 105642800, "num_module_steps_trained": 91008, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1984.2537544575011, "num_env_steps_trained_lifetime_throughput": 1062469.566058704, "num_module_steps_trained_throughput": 69411.45795059393, "num_module_steps_trained_lifetime_throughput": 69411.24500769112}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.891600608825684, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.654045104980469, "total_loss": 9.661038398742676, "num_module_steps_trained": 91008, "num_trainable_parameters": 149763, "entropy": 0.7933640480041504, "vf_loss_unclipped": 4117.19091796875, "weights_seq_no": 78.0, "curr_kl_coeff": 0.001483154366724193, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.19036966562271118, "policy_loss": 0.014922352507710457, "mean_kl_loss": 0.0019821112509816885, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6828928, "num_module_steps_trained_lifetime_throughput": 69410.41269076559}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 78, "trial_id": "a8246_00000", "date": "2025-06-25_21-19-49", "timestamp": 1750911589, "time_this_iter_s": 2.205353021621704, "time_total_s": 2204.310880422592, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b4531a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2204.310880422592, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 16.133333333333333, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 17.375309554458653, "restore_env_runners": 0.0029346486361664106, "training_step": 17.372236498132477, "env_runner_sampling_timer": 16.05721901588562, "learner_update_timer": 1.3128367925638251, "synch_weights": 0.0008700603575686751, "synch_env_connectors": 0.04265337352012967}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.689139419345407e-06, "batch_individual_items": 9.139134385674347e-06, "add_time_dim_to_batch_and_zero_pad": 2.5401503420130463e-06, "add_observations_from_episodes_to_batch": 1.4745488998167281e-05, "add_states_from_episodes_to_batch": 1.6596264138071243e-06, "agent_to_module_mapping": 2.74357514765234e-06}}, "connector_pipeline_timer": 6.646745200167448e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 481.25295474886894, "vehicle_5": 541.0038279533386, "vehicle_3": 153.267352938652, "vehicle_2": 284.5135943365097, "vehicle_4": 617.3898581027984, "vehicle_0": 167.16135161399842}, "sample": 0.1287718973135066, "rlmodule_inference_timer": 8.930451827148223e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.38, "vehicle_2": 88.8, "vehicle_0": 40.38, "vehicle_4": 108.0, "vehicle_1": 96.68}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015006753208590543, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.549925996674553e-05, "tensor_to_numpy": 1.634466064386761e-05, "module_to_agent_unmapping": 1.6277012387182235e-06, "normalize_and_clip_actions": 4.6755848879933864e-05, "remove_single_ts_time_rank_from_batch": 6.394544333745436e-07, "un_batch_to_individual_items": 1.5129208106305172e-05, "listify_data_for_vector_env": 6.650748383755904e-06}}, "connector_pipeline_timer": 0.00015307089673579965}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 731.0, "vehicle_2": 1670.0, "vehicle_4": 1982.0, "vehicle_0": 731.0, "vehicle_1": 1818.0}, "env_to_module_sum_episodes_length_in": 51.022676409772906, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3071.0, "vehicle_2": 6676.000000000001, "vehicle_4": 7932.0, "vehicle_1": 7201.0, "vehicle_5": 7932.0, "vehicle_3": 3071.0}, "episode_return_mean": 2244.5889380919934, "num_env_steps_sampled_lifetime": 8000.0, "time_between_sampling": 0.02130678202791826, "episode_return_min": 1758.8425061702728, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 35883.00000000001}, "module_episode_returns_mean": {"shared_policy": 1003.8108616352081}, "episode_len_min": 108, "weights_seq_no": 78.0, "episode_duration_sec_mean": 0.06915149584019673, "num_module_steps_sampled": {"shared_policy": 8914.0}, "num_episodes_lifetime": 68.0, "episode_return_max": 2411.8635866642, "env_to_module_sum_episodes_length_out": 51.022676409772906, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1640.391505100452}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005811654203478485, "agent_to_module_mapping": 0.0033990086950208393, "general_advantage_estimation": 0.017367423470253187, "add_time_dim_to_batch_and_zero_pad": 1.0773424478684522e-05, "add_columns_from_episodes_to_train_batch": 0.051199965385436697, "add_states_from_episodes_to_batch": 3.092141117777466e-06, "numpy_to_tensor": 0.00015790982038652005, "batch_individual_items": 0.08471994856900988, "add_observations_from_episodes_to_batch": 0.0003947420795909492}}, "connector_pipeline_timer": 0.16321466116675473}, "learner_connector_sum_episodes_length_in": 1984.4112169129262, "num_env_steps_trained": 1434000, "num_module_steps_trained_lifetime": 6920704, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 107076800, "num_module_steps_trained": 91776, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1984.4112169129262, "num_env_steps_trained_lifetime_throughput": 1064201.804709261, "num_module_steps_trained_throughput": 69451.71982237122, "num_module_steps_trained_lifetime_throughput": 69451.49469759493}, "shared_policy": {"gradients_default_optimizer_global_norm": 4.691284656524658, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.215717315673828, "total_loss": 8.220292091369629, "num_module_steps_trained": 91776, "num_trainable_parameters": 149763, "entropy": 0.7427599430084229, "vf_loss_unclipped": 4530.96875, "weights_seq_no": 79.0, "curr_kl_coeff": 0.0007415771833620965, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.025526225566864014, "policy_loss": 0.011999543756246567, "mean_kl_loss": 0.002595065161585808, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6920704, "num_module_steps_trained_lifetime_throughput": 69450.74027242488}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 79, "trial_id": "a8246_00000", "date": "2025-06-25_21-19-51", "timestamp": 1750911591, "time_this_iter_s": 2.1892220973968506, "time_total_s": 2206.500102519989, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b451260>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2206.500102519989, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 14.566666666666665, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 17.22297828558404, "restore_env_runners": 0.0029053488097933304, "training_step": 17.21993440690112, "env_runner_sampling_timer": 15.903555361556773, "learner_update_timer": 1.3141964008881346, "synch_weights": 0.0008690380839958065, "synch_env_connectors": 0.04223862603488938}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.482484888968948e-06, "batch_individual_items": 9.105039343360613e-06, "add_time_dim_to_batch_and_zero_pad": 2.4763789975921426e-06, "add_observations_from_episodes_to_batch": 1.4508331260357124e-05, "add_states_from_episodes_to_batch": 1.6484633789046023e-06, "agent_to_module_mapping": 2.743689772465369e-06}}, "connector_pipeline_timer": 6.54862400764122e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 485.4947404038906, "vehicle_5": 535.7823770523071, "vehicle_3": 150.92863057136535, "vehicle_2": 280.6305152702332, "vehicle_4": 618.129278383255, "vehicle_0": 163.08394457340242}, "sample": 0.12926431100058372, "rlmodule_inference_timer": 6.754001157506244e-05, "agent_steps": {"vehicle_5": 107.96, "vehicle_3": 40.38, "vehicle_2": 91.54, "vehicle_0": 40.38, "vehicle_4": 108.0, "vehicle_1": 98.97999999999998}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014521497038065204, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.540975075135888e-05, "tensor_to_numpy": 1.6197147050812015e-05, "module_to_agent_unmapping": 1.613975467824034e-06, "normalize_and_clip_actions": 4.6261471240966235e-05, "remove_single_ts_time_rank_from_batch": 6.4096440215631e-07, "un_batch_to_individual_items": 1.501620805265789e-05, "listify_data_for_vector_env": 6.522173155500385e-06}}, "connector_pipeline_timer": 0.0001517336074985883}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 712.0000000000001, "vehicle_2": 1687.0, "vehicle_4": 1982.0, "vehicle_0": 712.0000000000001, "vehicle_1": 1819.0000000000002}, "env_to_module_sum_episodes_length_in": 50.10019818634622, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3783.0, "vehicle_2": 8363.0, "vehicle_4": 9914.0, "vehicle_1": 9020.0, "vehicle_5": 9913.0, "vehicle_3": 3783.0}, "episode_return_mean": 2234.0494874608517, "num_env_steps_sampled_lifetime": 10000.0, "time_between_sampling": 0.03495500271807477, "episode_return_min": 1970.3186542987823, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 44776.0}, "module_episode_returns_mean": {"shared_policy": 874.1061176490782}, "episode_len_min": 108, "weights_seq_no": 79.0, "episode_duration_sec_mean": 0.07153660492054768, "num_module_steps_sampled": {"shared_policy": 8893.0}, "num_episodes_lifetime": 86.0, "episode_return_max": 2366.5731081962585, "env_to_module_sum_episodes_length_out": 50.10019818634622, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1659.6229827102443}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0058198189114086595, "agent_to_module_mapping": 0.0034029094481013715, "general_advantage_estimation": 0.017386722155527112, "add_time_dim_to_batch_and_zero_pad": 1.0746520229465587e-05, "add_columns_from_episodes_to_train_batch": 0.05129186198154111, "add_states_from_episodes_to_batch": 3.083309732195081e-06, "numpy_to_tensor": 0.00015727072220984015, "batch_individual_items": 0.08432232075335282, "add_observations_from_episodes_to_batch": 0.0003955334087894704}}, "connector_pipeline_timer": 0.16293995914511752}, "learner_connector_sum_episodes_length_in": 1984.567104743797, "num_env_steps_trained": 1430000, "num_module_steps_trained_lifetime": 7012224, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 108506800, "num_module_steps_trained": 91520, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1984.567104743797, "num_env_steps_trained_lifetime_throughput": 1065853.4282280141, "num_module_steps_trained_throughput": 69490.77017242728, "num_module_steps_trained_lifetime_throughput": 69490.38017328801}, "shared_policy": {"gradients_default_optimizer_global_norm": 13.041605949401855, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.054444313049316, "total_loss": 8.9126615524292, "num_module_steps_trained": 91520, "num_trainable_parameters": 149763, "entropy": 0.6577280163764954, "vf_loss_unclipped": 4699.5380859375, "weights_seq_no": 80.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.14711648225784302, "policy_loss": -0.13520744442939758, "mean_kl_loss": 0.002710931468755007, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7012224, "num_module_steps_trained_lifetime_throughput": 69489.92414140151}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 80, "trial_id": "a8246_00000", "date": "2025-06-25_21-19-53", "timestamp": 1750911593, "time_this_iter_s": 2.1448209285736084, "time_total_s": 2208.6449234485626, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b452200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2208.6449234485626, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 13.899999999999999, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 17.073285407728218, "restore_env_runners": 0.0028763461516808086, "training_step": 17.070270248252168, "env_runner_sampling_timer": 15.751498799611172, "learner_update_timer": 1.3165855085492282, "synch_weights": 0.0008681652030920576, "synch_env_connectors": 0.041829306854539505}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.680163443932309e-06, "batch_individual_items": 9.257559822677801e-06, "add_time_dim_to_batch_and_zero_pad": 2.536123586823859e-06, "add_observations_from_episodes_to_batch": 1.4811937475310398e-05, "add_states_from_episodes_to_batch": 1.6571226390756272e-06, "agent_to_module_mapping": 2.7654466711551305e-06}}, "connector_pipeline_timer": 6.666744241343707e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 509.10756934881204, "vehicle_5": 554.6201566410065, "vehicle_3": 142.47809466600418, "vehicle_2": 300.28705572366715, "vehicle_4": 618.1617890262605, "vehicle_0": 165.35810935497284}, "sample": 0.12937845987765273, "rlmodule_inference_timer": 6.493334554168772e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.7, "vehicle_2": 90.46, "vehicle_0": 40.7, "vehicle_4": 108.0, "vehicle_1": 98.86}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014857010747356943, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.611928468633076e-05, "tensor_to_numpy": 1.6513918791147388e-05, "module_to_agent_unmapping": 1.639683932464905e-06, "normalize_and_clip_actions": 4.762085619873598e-05, "remove_single_ts_time_rank_from_batch": 6.447231011024929e-07, "un_batch_to_individual_items": 1.5290125515467775e-05, "listify_data_for_vector_env": 6.837184265850776e-06}}, "connector_pipeline_timer": 0.0001553062530321994}, "num_agent_steps_sampled": {"vehicle_5": 1980.0, "vehicle_3": 721.0, "vehicle_2": 1632.0, "vehicle_4": 1980.0, "vehicle_0": 721.0, "vehicle_1": 1798.0}, "env_to_module_sum_episodes_length_in": 47.00401497392899, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4504.000000000001, "vehicle_2": 9994.999999999998, "vehicle_4": 11894.0, "vehicle_1": 10818.0, "vehicle_5": 11893.0, "vehicle_3": 4504.000000000001}, "episode_return_mean": 2290.01277192831, "num_env_steps_sampled_lifetime": 12000.0, "time_between_sampling": 0.048133595049707184, "episode_return_min": 2182.5596599578857, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 53608.0}, "module_episode_returns_mean": {"shared_policy": 971.185789952278}, "episode_len_min": 108, "weights_seq_no": 80.0, "episode_duration_sec_mean": 0.0679480207999586, "num_module_steps_sampled": {"shared_policy": 8832.0}, "num_episodes_lifetime": 106.0, "episode_return_max": 2411.8628072738647, "env_to_module_sum_episodes_length_out": 47.00401497392899, "num_episodes": 20.0, "num_env_steps_sampled_lifetime_throughput": 1630.028481462986}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005832053632291753, "agent_to_module_mapping": 0.0034083649436358484, "general_advantage_estimation": 0.01740949035396946, "add_time_dim_to_batch_and_zero_pad": 1.0745725004129006e-05, "add_columns_from_episodes_to_train_batch": 0.05138589836176501, "add_states_from_episodes_to_batch": 3.0791466575079195e-06, "numpy_to_tensor": 0.00015657217501999546, "batch_individual_items": 0.08470604212579498, "add_observations_from_episodes_to_batch": 0.0003970959947733005}}, "connector_pipeline_timer": 0.16345870455369466}, "learner_connector_sum_episodes_length_in": 1984.721433696359, "num_env_steps_trained": 1426000, "num_module_steps_trained_lifetime": 7103488, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 109932800, "num_module_steps_trained": 91264, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1984.721433696359, "num_env_steps_trained_lifetime_throughput": 1068520.5472215358, "num_module_steps_trained_throughput": 69597.55145647506, "num_module_steps_trained_lifetime_throughput": 69597.22563471526}, "shared_policy": {"gradients_default_optimizer_global_norm": 16.133544921875, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.871126174926758, "total_loss": 8.704276084899902, "num_module_steps_trained": 91264, "num_trainable_parameters": 149763, "entropy": 0.6805182099342346, "vf_loss_unclipped": 4928.35400390625, "weights_seq_no": 81.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.045021235942840576, "policy_loss": -0.16004806756973267, "mean_kl_loss": 0.007090568542480469, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7103488, "num_module_steps_trained_lifetime_throughput": 69596.69517101227}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 81, "trial_id": "a8246_00000", "date": "2025-06-25_21-19-56", "timestamp": 1750911596, "time_this_iter_s": 2.255859851837158, "time_total_s": 2210.9007833004, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b453060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2210.9007833004, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.0, "ram_util_percent": 52.06666666666666}}
{"timers": {"training_iteration": 16.923871588650915, "restore_env_runners": 0.0028476247701555452, "training_step": 16.920884874519658, "env_runner_sampling_timer": 15.600961741615054, "learner_update_timer": 1.3177329859637594, "synch_weights": 0.0008670052110700704, "synch_env_connectors": 0.04142134837596382}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.615303368354702e-06, "batch_individual_items": 9.15834926724986e-06, "add_time_dim_to_batch_and_zero_pad": 2.515020784546752e-06, "add_observations_from_episodes_to_batch": 1.4716968422175638e-05, "add_states_from_episodes_to_batch": 1.6431917292150572e-06, "agent_to_module_mapping": 2.7428147545945745e-06}}, "connector_pipeline_timer": 6.620942484853916e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 489.13837693691244, "vehicle_5": 564.7506187820435, "vehicle_3": 144.96276320934297, "vehicle_2": 239.18988667726512, "vehicle_4": 617.713688879013, "vehicle_0": 165.04074926376342}, "sample": 0.1294373204116453, "rlmodule_inference_timer": 6.324043064942058e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.459999999999994, "vehicle_2": 88.05999999999996, "vehicle_0": 40.459999999999994, "vehicle_4": 108.0, "vehicle_1": 94.28000000000002}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014945092500272012, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5341173390014185e-05, "tensor_to_numpy": 1.6309150434238508e-05, "module_to_agent_unmapping": 1.634793687832437e-06, "normalize_and_clip_actions": 4.669797493721602e-05, "remove_single_ts_time_rank_from_batch": 6.391618652741178e-07, "un_batch_to_individual_items": 1.5167993678403846e-05, "listify_data_for_vector_env": 6.657300943046037e-06}}, "connector_pipeline_timer": 0.00015286625858153984}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 767.9999999999999, "vehicle_2": 1612.0, "vehicle_4": 1982.0, "vehicle_0": 767.9999999999999, "vehicle_1": 1717.0}, "env_to_module_sum_episodes_length_in": 48.06611413132987, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5272.0, "vehicle_2": 11606.999999999998, "vehicle_4": 13876.0, "vehicle_1": 12535.0, "vehicle_5": 13875.0, "vehicle_3": 5272.0}, "episode_return_mean": 2220.7960815835, "num_env_steps_sampled_lifetime": 14000.0, "time_between_sampling": 0.06154317279850151, "episode_return_min": 1855.6822204589844, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 62437.00000000001}, "module_episode_returns_mean": {"shared_policy": 955.7578636217117}, "episode_len_min": 108, "weights_seq_no": 81.0, "episode_duration_sec_mean": 0.06741423919927911, "num_module_steps_sampled": {"shared_policy": 8829.0}, "num_episodes_lifetime": 124.0, "episode_return_max": 2411.8628072738647, "env_to_module_sum_episodes_length_out": 48.06611413132987, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1647.8478880254372}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005838725175974886, "agent_to_module_mapping": 0.0034139687942291758, "general_advantage_estimation": 0.017414630040389144, "add_time_dim_to_batch_and_zero_pad": 1.074910772787363e-05, "add_columns_from_episodes_to_train_batch": 0.051458396878144026, "add_states_from_episodes_to_batch": 3.077515191782355e-06, "numpy_to_tensor": 0.00015588478329887708, "batch_individual_items": 0.08430658711454572, "add_observations_from_episodes_to_batch": 0.0003976521147711141}}, "connector_pipeline_timer": 0.1631487845881285}, "learner_connector_sum_episodes_length_in": 1984.8742193593955, "num_env_steps_trained": 1420000, "num_module_steps_trained_lifetime": 7194368, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 111352800, "num_module_steps_trained": 90880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1984.8742193593955, "num_env_steps_trained_lifetime_throughput": 1068772.7815416392, "num_module_steps_trained_throughput": 69553.04946154558, "num_module_steps_trained_lifetime_throughput": 69552.7117744625}, "shared_policy": {"gradients_default_optimizer_global_norm": 5.173266887664795, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.816625595092773, "total_loss": 8.861390113830566, "num_module_steps_trained": 90880, "num_trainable_parameters": 149763, "entropy": 0.7041696310043335, "vf_loss_unclipped": 4129.345703125, "weights_seq_no": 82.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.020335376262664795, "policy_loss": 0.05180428549647331, "mean_kl_loss": 0.007022409234195948, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7194368, "num_module_steps_trained_lifetime_throughput": 69552.25080580031}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 82, "trial_id": "a8246_00000", "date": "2025-06-25_21-19-58", "timestamp": 1750911598, "time_this_iter_s": 2.1343090534210205, "time_total_s": 2213.035092353821, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b4532e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2213.035092353821, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 15.033333333333333, "ram_util_percent": 52.1}}
{"timers": {"training_iteration": 16.775419576934425, "restore_env_runners": 0.0028191910224865677, "training_step": 16.77246128160444, "env_runner_sampling_timer": 15.451785240448885, "learner_update_timer": 1.3184837881841582, "synch_weights": 0.0008665843290189407, "synch_env_connectors": 0.04101958822218642}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.479994450928841e-06, "batch_individual_items": 8.9744891419923e-06, "add_time_dim_to_batch_and_zero_pad": 2.504108812693279e-06, "add_observations_from_episodes_to_batch": 1.4345965155745041e-05, "add_states_from_episodes_to_batch": 1.6386215100677143e-06, "agent_to_module_mapping": 2.6927889679020018e-06}}, "connector_pipeline_timer": 6.514605163752743e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 462.1710158491135, "vehicle_5": 574.3237398481369, "vehicle_3": 157.7246999073028, "vehicle_2": 201.317161462307, "vehicle_4": 618.4130634880066, "vehicle_0": 170.49249608993534}, "sample": 0.1294460674470766, "rlmodule_inference_timer": 6.211417481606048e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.19999999999999, "vehicle_2": 85.39999999999998, "vehicle_0": 40.19999999999999, "vehicle_4": 108.0, "vehicle_1": 89.71999999999998}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014685427229149924, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.487770627100609e-05, "tensor_to_numpy": 1.6076583399594418e-05, "module_to_agent_unmapping": 1.6162089135082409e-06, "normalize_and_clip_actions": 4.502428610963098e-05, "remove_single_ts_time_rank_from_batch": 6.309525498025305e-07, "un_batch_to_individual_items": 1.457979243899302e-05, "listify_data_for_vector_env": 6.4957389751704975e-06}}, "connector_pipeline_timer": 0.0001492126947400651}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 719.0, "vehicle_2": 1538.0, "vehicle_4": 1982.0, "vehicle_0": 719.0, "vehicle_1": 1604.0000000000002}, "env_to_module_sum_episodes_length_in": 51.44694042307515, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5990.999999999998, "vehicle_2": 13144.999999999996, "vehicle_4": 15858.000000000002, "vehicle_1": 14139.0, "vehicle_5": 15857.000000000002, "vehicle_3": 5990.999999999998}, "episode_return_mean": 2184.442180221081, "num_env_steps_sampled_lifetime": 16000.0, "time_between_sampling": 0.07307745676362185, "episode_return_min": 1829.1935420036316, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 70981.0}, "module_episode_returns_mean": {"shared_policy": 886.7348220205308}, "episode_len_min": 108, "weights_seq_no": 82.0, "episode_duration_sec_mean": 0.06668363160031732, "num_module_steps_sampled": {"shared_policy": 8544.0}, "num_episodes_lifetime": 141.99999999999997, "episode_return_max": 2404.375473856926, "env_to_module_sum_episodes_length_out": 51.44694042307515, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1681.8224124907354}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005844841254210342, "agent_to_module_mapping": 0.003417380776316527, "general_advantage_estimation": 0.017391490830011066, "add_time_dim_to_batch_and_zero_pad": 1.0741616611688893e-05, "add_columns_from_episodes_to_train_batch": 0.051516941659328276, "add_states_from_episodes_to_batch": 3.069650065883039e-06, "numpy_to_tensor": 0.00015518885552606005, "batch_individual_items": 0.08389733124343164, "add_observations_from_episodes_to_batch": 0.0003989155935783409}}, "connector_pipeline_timer": 0.1627847734023157}, "learner_connector_sum_episodes_length_in": 1985.0254771658015, "num_env_steps_trained": 1376000, "num_module_steps_trained_lifetime": 7282432, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 112728800, "num_module_steps_trained": 88064, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.0254771658015, "num_env_steps_trained_lifetime_throughput": 1069357.2223155757, "num_module_steps_trained_throughput": 69532.82196632879, "num_module_steps_trained_lifetime_throughput": 69532.53322842292}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.456975936889648, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.43404769897461, "total_loss": 9.452208518981934, "num_module_steps_trained": 88064, "num_trainable_parameters": 149763, "entropy": 0.6001533269882202, "vf_loss_unclipped": 4441.2265625, "weights_seq_no": 83.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.12827491760253906, "policy_loss": 0.024157103151082993, "mean_kl_loss": 0.013440553098917007, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7282432, "num_module_steps_trained_lifetime_throughput": 69532.04129061056}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 83, "trial_id": "a8246_00000", "date": "2025-06-25_21-20-00", "timestamp": 1750911600, "time_this_iter_s": 2.081240177154541, "time_total_s": 2215.1163325309753, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b451760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2215.1163325309753, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 14.466666666666667, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 16.629802426585105, "restore_env_runners": 0.0027910453622500744, "training_step": 16.626872036708377, "env_runner_sampling_timer": 15.30501402137435, "learner_update_timer": 1.3196628615523553, "synch_weights": 0.0008660401457225274, "synch_env_connectors": 0.04062307941995518}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.810274662410602e-06, "batch_individual_items": 9.27856660580169e-06, "add_time_dim_to_batch_and_zero_pad": 2.566679570845026e-06, "add_observations_from_episodes_to_batch": 1.4884363982464772e-05, "add_states_from_episodes_to_batch": 1.6826158345654833e-06, "agent_to_module_mapping": 2.77356510609821e-06}}, "connector_pipeline_timer": 6.723777352284503e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 481.97193496465684, "vehicle_5": 575.7149352264404, "vehicle_3": 159.2304307460785, "vehicle_2": 223.23263580083855, "vehicle_4": 618.413045463562, "vehicle_0": 163.00515642642975}, "sample": 0.12953466866688063, "rlmodule_inference_timer": 6.38695185180345e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.24, "vehicle_2": 89.28000000000002, "vehicle_0": 40.24, "vehicle_4": 108.0, "vehicle_1": 94.32}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014973893498462185, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6341753883035835e-05, "tensor_to_numpy": 1.6635878030738823e-05, "module_to_agent_unmapping": 1.650766909145993e-06, "normalize_and_clip_actions": 4.734168760634539e-05, "remove_single_ts_time_rank_from_batch": 6.556882786573975e-07, "un_batch_to_individual_items": 1.5246009441966375e-05, "listify_data_for_vector_env": 6.737928412742588e-06}}, "connector_pipeline_timer": 0.00015536118824072728}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 707.0000000000001, "vehicle_2": 1672.0, "vehicle_4": 1982.0, "vehicle_0": 707.0000000000001, "vehicle_1": 1774.0000000000002}, "env_to_module_sum_episodes_length_in": 49.984125090254906, "num_agent_steps_sampled_lifetime": {"vehicle_0": 6697.999999999998, "vehicle_2": 14816.999999999996, "vehicle_4": 17840.0, "vehicle_1": 15912.999999999996, "vehicle_5": 17839.0, "vehicle_3": 6697.999999999998}, "episode_return_mean": 2221.568138227463, "num_env_steps_sampled_lifetime": 18000.0, "time_between_sampling": 0.08368782541550057, "episode_return_min": 1855.0453137159348, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 79805.0}, "module_episode_returns_mean": {"shared_policy": 938.7439531755449}, "episode_len_min": 108, "weights_seq_no": 83.0, "episode_duration_sec_mean": 0.06789523157931399, "num_module_steps_sampled": {"shared_policy": 8824.0}, "num_episodes_lifetime": 160.00000000000003, "episode_return_max": 2387.9535052776337, "env_to_module_sum_episodes_length_out": 49.984125090254906, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1661.301093080371}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005850846181687338, "agent_to_module_mapping": 0.0034205157185144466, "general_advantage_estimation": 0.017409243011677317, "add_time_dim_to_batch_and_zero_pad": 1.0713780431621797e-05, "add_columns_from_episodes_to_train_batch": 0.051582503492746005, "add_states_from_episodes_to_batch": 3.062703527789698e-06, "numpy_to_tensor": 0.00015448654692648347, "batch_individual_items": 0.08349496960100851, "add_observations_from_episodes_to_batch": 0.0003996806076467195}}, "connector_pipeline_timer": 0.16247449232829256}, "learner_connector_sum_episodes_length_in": 1985.1752223941435, "num_env_steps_trained": 1420000, "num_module_steps_trained_lifetime": 7373312, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 114148800, "num_module_steps_trained": 90880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1985.1752223941435, "num_env_steps_trained_lifetime_throughput": 1069975.086424668, "num_module_steps_trained_throughput": 69517.68274149537, "num_module_steps_trained_lifetime_throughput": 69517.40272067004}, "shared_policy": {"gradients_default_optimizer_global_norm": 25.050535202026367, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.049927711486816, "total_loss": 8.838846206665039, "num_module_steps_trained": 90880, "num_trainable_parameters": 149763, "entropy": 0.35024553537368774, "vf_loss_unclipped": 4854.6337890625, "weights_seq_no": 84.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.04398685693740845, "policy_loss": -0.20758266746997833, "mean_kl_loss": 0.010595709085464478, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7373312, "num_module_steps_trained_lifetime_throughput": 69516.95025322406}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 84, "trial_id": "a8246_00000", "date": "2025-06-25_21-20-02", "timestamp": 1750911602, "time_this_iter_s": 2.215916872024536, "time_total_s": 2217.332249403, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b453d80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2217.332249403, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 14.866666666666667, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 17.081262961069246, "restore_env_runners": 0.0027631786586696694, "training_step": 17.078360196761274, "env_runner_sampling_timer": 15.759780705330611, "learner_update_timer": 1.3163856937668195, "synch_weights": 0.0008673851542692436, "synch_env_connectors": 0.04022757945571862}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.3437500203726813e-05, "add_time_dim_to_batch_and_zero_pad": 7.396003638859838e-06, "add_observations_from_episodes_to_batch": 3.5041502997046337e-05, "add_states_from_episodes_to_batch": 3.4164986573159695e-06, "agent_to_module_mapping": 5.249999958323315e-06, "numpy_to_tensor": 2.4791501346044242e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.570500206880453e-06, "batch_individual_items": 9.138046958627355e-06, "add_time_dim_to_batch_and_zero_pad": 2.5191860190711484e-06, "add_observations_from_episodes_to_batch": 1.4789013740485643e-05, "add_states_from_episodes_to_batch": 1.653886116102212e-06, "agent_to_module_mapping": 2.736046092287478e-06}}, "connector_pipeline_timer": 6.615734486499642e-05}, "env_reset_timer": 0.00010264600132359192, "agent_episode_returns_mean": {"vehicle_1": 489.3534111861388, "vehicle_5": 566.4669231478374, "vehicle_3": 158.83536454995473, "vehicle_2": 227.1651592381795, "vehicle_4": 618.4130716578167, "vehicle_0": 166.34382120132446}, "sample": 0.12957980485386447, "rlmodule_inference_timer": 6.3756891018892e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.22666666666666, "vehicle_2": 89.91333333333333, "vehicle_0": 40.22666666666666, "vehicle_4": 108.0, "vehicle_1": 95.27999999999999}, "num_env_steps_sampled": 1200.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015018800888839666, "connector_pipeline_timer": 0.00021162450138945132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5204982875998164e-05, "tensor_to_numpy": 1.624253819535285e-05, "module_to_agent_unmapping": 1.6094161215785738e-06, "normalize_and_clip_actions": 4.73438911342908e-05, "remove_single_ts_time_rank_from_batch": 6.258862557496099e-07, "un_batch_to_individual_items": 1.5290031479157054e-05, "listify_data_for_vector_env": 6.703112384199756e-06}}, "connector_pipeline_timer": 0.00015310827425294368}, "num_agent_steps_sampled": {"vehicle_5": 1188.0, "vehicle_3": 469.00000000000006, "vehicle_2": 977.0000000000001, "vehicle_4": 1188.0, "vehicle_0": 469.00000000000006, "vehicle_1": 1039.0}, "env_to_module_sum_episodes_length_in": 45.10031688472596, "num_agent_steps_sampled_lifetime": {"vehicle_0": 7167.0, "vehicle_2": 15793.999999999993, "vehicle_4": 19028.0, "vehicle_1": 16951.999999999996, "vehicle_5": 19027.0, "vehicle_3": 7167.0}, "episode_return_mean": 2226.577751877705, "num_env_steps_sampled_lifetime": 19200.0, "time_between_sampling": 0.09582792250687953, "episode_return_min": 1911.4327372312546, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 85135.0}, "module_episode_returns_mean": {"shared_policy": 1116.8056030631064}, "episode_len_min": 108, "weights_seq_no": 84.0, "episode_duration_sec_mean": 0.06738984354010123, "num_module_steps_sampled": {"shared_policy": 5330.0}, "num_episodes_lifetime": 172.00000000000003, "episode_return_max": 2387.5183191895485, "env_to_module_sum_episodes_length_out": 45.10031688472596, "num_episodes": 12.0, "num_env_steps_sampled_lifetime_throughput": 1639.9099346931212}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005835829799873953, "agent_to_module_mapping": 0.0034094113913326883, "general_advantage_estimation": 0.017362915161589724, "add_time_dim_to_batch_and_zero_pad": 1.0716222623511447e-05, "add_columns_from_episodes_to_train_batch": 0.05143924220780687, "add_states_from_episodes_to_batch": 3.0562464961103567e-06, "numpy_to_tensor": 0.0001540716814032066, "batch_individual_items": 0.0829505553149478, "add_observations_from_episodes_to_batch": 0.0003995650515836167}}, "connector_pipeline_timer": 0.16171379490500892}, "learner_connector_sum_episodes_length_in": 1977.323470170202, "num_env_steps_trained": 516000, "num_module_steps_trained_lifetime": 7428352, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 114664800, "num_module_steps_trained": 55040, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1977.323470170202, "num_env_steps_trained_lifetime_throughput": 1046883.6404126954, "num_module_steps_trained_throughput": 69285.48187969501, "num_module_steps_trained_lifetime_throughput": 69285.07001314274}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.774524688720703, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.73256778717041, "total_loss": 8.831855773925781, "num_module_steps_trained": 55040, "num_trainable_parameters": 149763, "entropy": 0.5762957334518433, "vf_loss_unclipped": 4097.57666015625, "weights_seq_no": 85.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.21512079238891602, "policy_loss": 0.1050485223531723, "mean_kl_loss": 0.006261911708861589, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7428352, "num_module_steps_trained_lifetime_throughput": 69284.88679525118}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19200.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 32}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 85, "trial_id": "a8246_00000", "date": "2025-06-25_21-21-05", "timestamp": 1750911665, "time_this_iter_s": 62.87900495529175, "time_total_s": 2280.2112543582916, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1071a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2280.2112543582916, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 9.779775280898876, "ram_util_percent": 52.16516853932584}}
{"timers": {"training_iteration": 17.553476621868533, "restore_env_runners": 0.00281253021212387, "training_step": 17.550523477293623, "env_runner_sampling_timer": 16.230606201187246, "learner_update_timer": 1.3177211839091332, "synch_weights": 0.0008663108827845642, "synch_env_connectors": 0.05084588950110365}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.8525003290269525e-05, "add_time_dim_to_batch_and_zero_pad": 9.437499102205038e-06, "add_observations_from_episodes_to_batch": 5.8858602278633045e-05, "add_states_from_episodes_to_batch": 4.791997344000265e-06, "agent_to_module_mapping": 7.821401231922209e-06, "numpy_to_tensor": 3.015770053025335e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.81650139588908e-06, "batch_individual_items": 9.371864528168867e-06, "add_time_dim_to_batch_and_zero_pad": 2.5935502480914465e-06, "add_observations_from_episodes_to_batch": 1.5165729540127807e-05, "add_states_from_episodes_to_batch": 1.667377202293287e-06, "agent_to_module_mapping": 2.722878891353371e-06}}, "connector_pipeline_timer": 6.803883913295759e-05}, "env_reset_timer": 0.00014301700066425834, "agent_episode_returns_mean": {"vehicle_1": 503.6453354883194, "vehicle_5": 592.3222805054984, "vehicle_3": 162.33271240711213, "vehicle_2": 255.5217364772161, "vehicle_4": 617.4012850157419, "vehicle_0": 165.97202632904052}, "sample": 0.1430998743094214, "rlmodule_inference_timer": 7.028005841147624e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.17333333333333, "vehicle_2": 90.26666666666668, "vehicle_0": 40.17333333333333, "vehicle_4": 108.0, "vehicle_1": 96.36}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014514838052392753, "connector_pipeline_timer": 0.00030335030241985806, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.445795297724715e-05, "tensor_to_numpy": 1.8647432616983405e-05, "module_to_agent_unmapping": 1.648080297354496e-06, "normalize_and_clip_actions": 4.9800154245637006e-05, "remove_single_ts_time_rank_from_batch": 6.468462046264482e-07, "un_batch_to_individual_items": 1.5859113753220302e-05, "listify_data_for_vector_env": 6.850039315409759e-06}}, "connector_pipeline_timer": 0.0001691468580578764}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 745.0, "vehicle_2": 1690.9999999999998, "vehicle_4": 1983.0, "vehicle_0": 745.0, "vehicle_1": 1797.0}, "env_to_module_sum_episodes_length_in": 48.87522847316003, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3450.0, "vehicle_2": 7780.0, "vehicle_4": 9121.000000000002, "vehicle_1": 8272.0, "vehicle_5": 9121.000000000002, "vehicle_3": 3450.0}, "episode_return_mean": 2297.1953775517145, "num_env_steps_sampled_lifetime": 9200.0, "time_between_sampling": 0.5274329062722082, "episode_return_min": 2009.1637204885483, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 41194.0}, "module_episode_returns_mean": {"shared_policy": 1049.3449761533736}, "episode_len_min": 108, "weights_seq_no": 85.0, "episode_duration_sec_mean": 0.06861350993509405, "num_module_steps_sampled": {"shared_policy": 8944.0}, "num_episodes_lifetime": 79.00000000000001, "episode_return_max": 2431.799509525299, "env_to_module_sum_episodes_length_out": 48.87522847316003, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1668.1965043847176}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005845084841872693, "agent_to_module_mapping": 0.0034137176973634436, "general_advantage_estimation": 0.01737634600999949, "add_time_dim_to_batch_and_zero_pad": 1.0693640421398593e-05, "add_columns_from_episodes_to_train_batch": 0.051510199365725345, "add_states_from_episodes_to_batch": 3.049433993714742e-06, "numpy_to_tensor": 0.00015341138463708078, "batch_individual_items": 0.08256610310180693, "add_observations_from_episodes_to_batch": 0.0004002589810865291}}, "connector_pipeline_timer": 0.16142695903590917}, "learner_connector_sum_episodes_length_in": 1977.5502354685, "num_env_steps_trained": 1438000, "num_module_steps_trained_lifetime": 7520384, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 116102800, "num_module_steps_trained": 92032, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1977.5502354685, "num_env_steps_trained_lifetime_throughput": 1049645.8102620265, "num_module_steps_trained_throughput": 69347.88154503913, "num_module_steps_trained_lifetime_throughput": 69347.50389216091}, "shared_policy": {"gradients_default_optimizer_global_norm": 12.691253662109375, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.400683403015137, "total_loss": 8.28234577178955, "num_module_steps_trained": 92032, "num_trainable_parameters": 149763, "entropy": 0.37512028217315674, "vf_loss_unclipped": 4890.994140625, "weights_seq_no": 86.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.1275433897972107, "policy_loss": -0.1145910993218422, "mean_kl_loss": 0.009204081259667873, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7520384, "num_module_steps_trained_lifetime_throughput": 69347.28690289304}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9200.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 34}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 86, "trial_id": "a8246_00000", "date": "2025-06-25_21-22-09", "timestamp": 1750911729, "time_this_iter_s": 64.30443692207336, "time_total_s": 2344.515691280365, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b452020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2344.515691280365, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 8.923076923076922, "ram_util_percent": 51.929670329670316}}
{"timers": {"training_iteration": 18.015967842309845, "restore_env_runners": 0.0028234153300077014, "training_step": 18.013003635020738, "env_runner_sampling_timer": 16.691274773765365, "learner_update_timer": 1.3195307487400172, "synch_weights": 0.0008655040238969509, "synch_env_connectors": 0.05034615768607758}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0982800924684854e-05, "add_time_dim_to_batch_and_zero_pad": 6.875002873130142e-06, "add_observations_from_episodes_to_batch": 3.700839879456907e-05, "add_states_from_episodes_to_batch": 3.524798376020044e-06, "agent_to_module_mapping": 5.634002445731312e-06, "numpy_to_tensor": 2.152459928765893e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.55350047951454e-06, "batch_individual_items": 8.994120724712278e-06, "add_time_dim_to_batch_and_zero_pad": 2.473758318175678e-06, "add_observations_from_episodes_to_batch": 1.465916072131463e-05, "add_states_from_episodes_to_batch": 1.606095336823302e-06, "agent_to_module_mapping": 2.705736601365493e-06}}, "connector_pipeline_timer": 6.553203373729594e-05}, "env_reset_timer": 0.00010254979715682567, "agent_episode_returns_mean": {"vehicle_1": 507.46305399605205, "vehicle_5": 588.8739179461343, "vehicle_3": 158.82090841293336, "vehicle_2": 249.14315371632577, "vehicle_4": 616.990960222653, "vehicle_0": 167.53904242243087}, "sample": 0.13320601103004695, "rlmodule_inference_timer": 7.949033857800388e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.214285714285715, "vehicle_2": 89.61714285714284, "vehicle_0": 40.214285714285715, "vehicle_4": 108.0, "vehicle_1": 95.8742857142857}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014366979817372183, "connector_pipeline_timer": 0.0002129333995981142, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.887090429251051e-05, "tensor_to_numpy": 1.6994280140203414e-05, "module_to_agent_unmapping": 1.6104950683075411e-06, "normalize_and_clip_actions": 4.677118854254938e-05, "remove_single_ts_time_rank_from_batch": 6.343636334072781e-07, "un_batch_to_individual_items": 1.519962367434598e-05, "listify_data_for_vector_env": 6.738947744168752e-06}}, "connector_pipeline_timer": 0.00015676136279271967}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 744.0, "vehicle_2": 1630.9999999999998, "vehicle_4": 1982.0, "vehicle_0": 744.0, "vehicle_1": 1740.0}, "env_to_module_sum_episodes_length_in": 47.89303318705153, "num_agent_steps_sampled_lifetime": {"vehicle_0": 4275.0, "vehicle_2": 9462.999999999998, "vehicle_4": 11300.0, "vehicle_1": 10090.0, "vehicle_5": 11300.0, "vehicle_3": 4275.0}, "episode_return_mean": 2288.8310339222635, "num_env_steps_sampled_lifetime": 11400.0, "time_between_sampling": 0.5054452152632954, "episode_return_min": 1948.750698029995, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 50703.000000000015}, "module_episode_returns_mean": {"shared_policy": 1084.7255420207978}, "episode_len_min": 108, "weights_seq_no": 86.0, "episode_duration_sec_mean": 0.06918542256846974, "num_module_steps_sampled": {"shared_policy": 8823.0}, "num_episodes_lifetime": 100.0, "episode_return_max": 2431.799509525299, "env_to_module_sum_episodes_length_out": 47.89303318705153, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1685.6273783968454}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005855014413506529, "agent_to_module_mapping": 0.0034177834303899183, "general_advantage_estimation": 0.01739078046996929, "add_time_dim_to_batch_and_zero_pad": 1.0665033993716284e-05, "add_columns_from_episodes_to_train_batch": 0.0515633723720368, "add_states_from_episodes_to_batch": 3.0418596478580337e-06, "numpy_to_tensor": 0.00015275560081979154, "batch_individual_items": 0.08297045498080742, "add_observations_from_episodes_to_batch": 0.0004013609713257653}}, "connector_pipeline_timer": 0.16191295694554095}, "learner_connector_sum_episodes_length_in": 1977.774733113815, "num_env_steps_trained": 1420000, "num_module_steps_trained_lifetime": 7611264, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 117522800, "num_module_steps_trained": 90880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1977.774733113815, "num_env_steps_trained_lifetime_throughput": 1051990.9155984144, "num_module_steps_trained_throughput": 69389.51066745394, "num_module_steps_trained_lifetime_throughput": 69389.06337587255}, "shared_policy": {"gradients_default_optimizer_global_norm": 19.80813217163086, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.853110313415527, "total_loss": 8.959545135498047, "num_module_steps_trained": 90880, "num_trainable_parameters": 149763, "entropy": 0.4336375296115875, "vf_loss_unclipped": 4115.2802734375, "weights_seq_no": 87.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.07144838571548462, "policy_loss": 0.11076820641756058, "mean_kl_loss": 0.005194392055273056, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7611264, "num_module_steps_trained_lifetime_throughput": 69388.95651803941}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11400.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 35}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 87, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-13", "timestamp": 1750911793, "time_this_iter_s": 63.8042516708374, "time_total_s": 2408.3199429512024, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b104f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2408.3199429512024, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 9.545054945054945, "ram_util_percent": 52.09230769230767}}
{"timers": {"training_iteration": 17.857636641386694, "restore_env_runners": 0.0028416357567135815, "training_step": 17.854653973670548, "env_runner_sampling_timer": 16.531857323107733, "learner_update_timer": 1.3205968687526402, "synch_weights": 0.0008647452336117553, "synch_env_connectors": 0.04984978985924451}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 1.9770497601712123e-05, "add_time_dim_to_batch_and_zero_pad": 6.104000931372866e-06, "add_observations_from_episodes_to_batch": 3.1541498174192384e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 4.937501216772944e-06, "numpy_to_tensor": 1.9062499632127583e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.994182767377043e-06, "batch_individual_items": 9.398741733055864e-06, "add_time_dim_to_batch_and_zero_pad": 2.644015610961039e-06, "add_observations_from_episodes_to_batch": 1.5184184084437125e-05, "add_states_from_episodes_to_batch": 1.6672249618060917e-06, "agent_to_module_mapping": 2.8334063959199285e-06}}, "connector_pipeline_timer": 6.818924919429583e-05}, "env_reset_timer": 9.252049494534731e-05, "agent_episode_returns_mean": {"vehicle_1": 510.74041209152756, "vehicle_5": 596.372826239041, "vehicle_3": 162.00085668904444, "vehicle_2": 252.5670668418067, "vehicle_4": 617.1112868479319, "vehicle_0": 169.6942698975972}, "sample": 0.1331523059511513, "rlmodule_inference_timer": 7.887825471080013e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.080000000000005, "vehicle_2": 89.12857142857145, "vehicle_0": 40.080000000000005, "vehicle_4": 108.0, "vehicle_1": 95.87428571428572}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014952062769218622, "connector_pipeline_timer": 0.00019072899885941297, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0348376504952074e-05, "tensor_to_numpy": 1.7851630659387976e-05, "module_to_agent_unmapping": 1.6827499259902067e-06, "normalize_and_clip_actions": 4.922574981604692e-05, "remove_single_ts_time_rank_from_batch": 6.509483834784272e-07, "un_batch_to_individual_items": 1.589114055055278e-05, "listify_data_for_vector_env": 6.986632758910882e-06}}, "connector_pipeline_timer": 0.0001639089165400651}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 741.0, "vehicle_2": 1620.9999999999998, "vehicle_4": 1980.9999999999998, "vehicle_0": 741.0, "vehicle_1": 1752.0}, "env_to_module_sum_episodes_length_in": 46.212731218826455, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5225.0, "vehicle_2": 11542.999999999998, "vehicle_4": 13875.0, "vehicle_1": 12357.000000000004, "vehicle_5": 13875.0, "vehicle_3": 5225.0}, "episode_return_mean": 2308.486720032692, "num_env_steps_sampled_lifetime": 14000.0, "time_between_sampling": 0.35663570610922973, "episode_return_min": 1944.5044746398926, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 62100.0}, "module_episode_returns_mean": {"shared_policy": 1143.2714240550995}, "episode_len_min": 108, "weights_seq_no": 87.0, "episode_duration_sec_mean": 0.07068274078863655, "num_module_steps_sampled": {"shared_policy": 8817.0}, "num_episodes_lifetime": 125.0, "episode_return_max": 2423.6522517204285, "env_to_module_sum_episodes_length_out": 46.212731218826455, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1634.5100080796908}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005863117599366924, "agent_to_module_mapping": 0.003421168926128777, "general_advantage_estimation": 0.017411688915274403, "add_time_dim_to_batch_and_zero_pad": 1.0647133674729223e-05, "add_columns_from_episodes_to_train_batch": 0.05162711114831311, "add_states_from_episodes_to_batch": 3.036861064496126e-06, "numpy_to_tensor": 0.0001521651247787096, "batch_individual_items": 0.08258346960102268, "add_observations_from_episodes_to_batch": 0.0004023790215788423}}, "connector_pipeline_timer": 0.1616221402960991}, "learner_connector_sum_episodes_length_in": 1977.9969857826768, "num_env_steps_trained": 1420000, "num_module_steps_trained_lifetime": 7702144, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 118942800, "num_module_steps_trained": 90880, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1977.9969857826768, "num_env_steps_trained_lifetime_throughput": 1054462.691626078, "num_module_steps_trained_throughput": 69444.55120997093, "num_module_steps_trained_lifetime_throughput": 69444.16697848876}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.118824005126953, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.52955436706543, "total_loss": 8.645404815673828, "num_module_steps_trained": 90880, "num_trainable_parameters": 149763, "entropy": 0.42671528458595276, "vf_loss_unclipped": 3187.58056640625, "weights_seq_no": 88.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.19162482023239136, "policy_loss": 0.1201140359044075, "mean_kl_loss": 0.00791249517351389, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7702144, "num_module_steps_trained_lifetime_throughput": 69443.92228316962}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 88, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-15", "timestamp": 1750911795, "time_this_iter_s": 2.1850621700286865, "time_total_s": 2410.505005121231, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f746ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2410.505005121231, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 17.70172924164285, "restore_env_runners": 0.002813273989128474, "training_step": 17.698774669763857, "env_runner_sampling_timer": 16.374024844456674, "learner_update_timer": 1.3225451150651162, "synch_weights": 0.0008651782013346733, "synch_env_connectors": 0.0493613123706247}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 1.9770497601712123e-05, "add_time_dim_to_batch_and_zero_pad": 6.104000931372866e-06, "add_observations_from_episodes_to_batch": 3.1541498174192384e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 4.937501216772944e-06, "numpy_to_tensor": 1.9062499632127583e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.778128056768806e-06, "batch_individual_items": 9.192474993305728e-06, "add_time_dim_to_batch_and_zero_pad": 2.594438190298398e-06, "add_observations_from_episodes_to_batch": 1.506621054150936e-05, "add_states_from_episodes_to_batch": 1.6708841997989417e-06, "agent_to_module_mapping": 2.773962342691961e-06}}, "connector_pipeline_timer": 6.731060931693395e-05}, "env_reset_timer": 9.252049494534731e-05, "agent_episode_returns_mean": {"vehicle_1": 505.56331960201277, "vehicle_5": 599.3611841058731, "vehicle_3": 164.58260197162627, "vehicle_2": 245.96832535266876, "vehicle_4": 618.4130618238449, "vehicle_0": 166.05920204639435}, "sample": 0.13315456772574671, "rlmodule_inference_timer": 7.099569183281977e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.12, "vehicle_2": 89.08, "vehicle_0": 40.12, "vehicle_4": 108.0, "vehicle_1": 95.32}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015091155793336164, "connector_pipeline_timer": 0.00019072899885941297, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.719798240444909e-05, "tensor_to_numpy": 1.6822973163611713e-05, "module_to_agent_unmapping": 1.6614141390125058e-06, "normalize_and_clip_actions": 4.707454120666143e-05, "remove_single_ts_time_rank_from_batch": 6.413141431939275e-07, "un_batch_to_individual_items": 1.535426569022684e-05, "listify_data_for_vector_env": 6.689229778393295e-06}}, "connector_pipeline_timer": 0.00015628633743064918}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 742.9999999999999, "vehicle_2": 1628.0, "vehicle_4": 1982.0, "vehicle_0": 742.9999999999999, "vehicle_1": 1730.9999999999998}, "env_to_module_sum_episodes_length_in": 49.876230951031175, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5968.0, "vehicle_2": 13170.999999999996, "vehicle_4": 15856.999999999998, "vehicle_1": 14088.000000000004, "vehicle_5": 15856.999999999998, "vehicle_3": 5968.0}, "episode_return_mean": 2299.9476970863343, "num_env_steps_sampled_lifetime": 16000.0, "time_between_sampling": 0.32051259381596764, "episode_return_min": 1926.5180327892303, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 70909.0}, "module_episode_returns_mean": {"shared_policy": 1036.5190549325941}, "episode_len_min": 108, "weights_seq_no": 88.0, "episode_duration_sec_mean": 0.06850716425775316, "num_module_steps_sampled": {"shared_policy": 8809.0}, "num_episodes_lifetime": 143.0, "episode_return_max": 2423.6522517204285, "env_to_module_sum_episodes_length_out": 49.876230951031175, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1625.3560556691928}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00587022851331023, "agent_to_module_mapping": 0.0034253859869166955, "general_advantage_estimation": 0.0174207611860648, "add_time_dim_to_batch_and_zero_pad": 1.0629832327205521e-05, "add_columns_from_episodes_to_train_batch": 0.05170204086685196, "add_states_from_episodes_to_batch": 3.0285724386250467e-06, "numpy_to_tensor": 0.00015156305351030403, "batch_individual_items": 0.08299972698500474, "add_observations_from_episodes_to_batch": 0.00040290356139764883}}, "connector_pipeline_timer": 0.1621333018131453}, "learner_connector_sum_episodes_length_in": 1978.21701592485, "num_env_steps_trained": 1418000, "num_module_steps_trained_lifetime": 7792896, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 120360800, "num_module_steps_trained": 90752, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1978.21701592485, "num_env_steps_trained_lifetime_throughput": 1055788.1477657903, "num_module_steps_trained_throughput": 69431.47864202302, "num_module_steps_trained_lifetime_throughput": 69431.10139998059}, "shared_policy": {"gradients_default_optimizer_global_norm": 9.9393949508667, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.35195541381836, "total_loss": 8.396409034729004, "num_module_steps_trained": 90752, "num_trainable_parameters": 149763, "entropy": 0.6029608845710754, "vf_loss_unclipped": 3883.472900390625, "weights_seq_no": 89.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.2649828791618347, "policy_loss": 0.050480302423238754, "mean_kl_loss": 0.005770942196249962, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7792896, "num_module_steps_trained_lifetime_throughput": 69430.84054799717}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 89, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-18", "timestamp": 1750911798, "time_this_iter_s": 2.2692201137542725, "time_total_s": 2412.7742252349854, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1059e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2412.7742252349854, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 15.0, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 17.546319647566435, "restore_env_runners": 0.0027851808292096974, "training_step": 17.543393288486232, "env_runner_sampling_timer": 16.217341761012115, "learner_update_timer": 1.3238437334944673, "synch_weights": 0.0008653010093450035, "synch_env_connectors": 0.04887919174689825}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 1.9770497601712123e-05, "add_time_dim_to_batch_and_zero_pad": 6.104000931372866e-06, "add_observations_from_episodes_to_batch": 3.1541498174192384e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 4.937501216772944e-06, "numpy_to_tensor": 1.9062499632127583e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0040278175283856e-05, "batch_individual_items": 9.349728599499448e-06, "add_time_dim_to_batch_and_zero_pad": 2.644725776092411e-06, "add_observations_from_episodes_to_batch": 1.522802193432655e-05, "add_states_from_episodes_to_batch": 1.6974274558237484e-06, "agent_to_module_mapping": 2.826955289904111e-06}}, "connector_pipeline_timer": 6.845943965848539e-05}, "env_reset_timer": 9.252049494534731e-05, "agent_episode_returns_mean": {"vehicle_1": 525.7600841498374, "vehicle_5": 609.1269886493683, "vehicle_3": 156.27496444225315, "vehicle_2": 251.6083318591118, "vehicle_4": 618.4130516767502, "vehicle_0": 163.99733874320984}, "sample": 0.13331850273217452, "rlmodule_inference_timer": 6.574948874634955e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.3, "vehicle_2": 90.6, "vehicle_0": 40.3, "vehicle_4": 108.0, "vehicle_1": 96.5}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015240246018438064, "connector_pipeline_timer": 0.00019072899885941297, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7886221559005635e-05, "tensor_to_numpy": 1.717399555707033e-05, "module_to_agent_unmapping": 1.701148879973002e-06, "normalize_and_clip_actions": 4.819029292470972e-05, "remove_single_ts_time_rank_from_batch": 6.45342575101558e-07, "un_batch_to_individual_items": 1.5691986826138975e-05, "listify_data_for_vector_env": 6.864751125830931e-06}}, "connector_pipeline_timer": 0.0001594375174253619}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 712.9999999999999, "vehicle_2": 1677.0, "vehicle_4": 1982.0, "vehicle_0": 712.9999999999999, "vehicle_1": 1785.0}, "env_to_module_sum_episodes_length_in": 50.5533903026083, "num_agent_steps_sampled_lifetime": {"vehicle_0": 6681.0, "vehicle_2": 14847.999999999996, "vehicle_4": 17839.0, "vehicle_1": 15873.000000000004, "vehicle_5": 17839.0, "vehicle_3": 6681.0}, "episode_return_mean": 2325.1807570791248, "num_env_steps_sampled_lifetime": 18000.0, "time_between_sampling": 0.32043064059714144, "episode_return_min": 1960.9855568408966, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 79761.0}, "module_episode_returns_mean": {"shared_policy": 942.6792619013786}, "episode_len_min": 108, "weights_seq_no": 89.0, "episode_duration_sec_mean": 0.06916397080000024, "num_module_steps_sampled": {"shared_policy": 8852.0}, "num_episodes_lifetime": 161.0, "episode_return_max": 2424.6565296649933, "env_to_module_sum_episodes_length_out": 50.5533903026083, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1603.8632847376189}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0058787012281809, "agent_to_module_mapping": 0.0034314229570495784, "general_advantage_estimation": 0.017429630244204596, "add_time_dim_to_batch_and_zero_pad": 1.0645204022349363e-05, "add_columns_from_episodes_to_train_batch": 0.05177758545815335, "add_states_from_episodes_to_batch": 3.0216167085307945e-06, "numpy_to_tensor": 0.00015089908298164775, "batch_individual_items": 0.08261783596512369, "add_observations_from_episodes_to_batch": 0.00040420452576907847}}, "connector_pipeline_timer": 0.16185069004500857}, "learner_connector_sum_episodes_length_in": 1978.4348457656015, "num_env_steps_trained": 1426000, "num_module_steps_trained_lifetime": 7884160, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 121786800, "num_module_steps_trained": 91264, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1978.4348457656015, "num_env_steps_trained_lifetime_throughput": 1058876.6102836, "num_module_steps_trained_throughput": 69535.97393900715, "num_module_steps_trained_lifetime_throughput": 69535.6414015291}, "shared_policy": {"gradients_default_optimizer_global_norm": 11.432473182678223, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.77047348022461, "total_loss": 8.710949897766113, "num_module_steps_trained": 91264, "num_trainable_parameters": 149763, "entropy": 0.5099436044692993, "vf_loss_unclipped": 4809.20703125, "weights_seq_no": 90.0, "curr_kl_coeff": 0.0003707885916810483, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.06250464916229248, "policy_loss": -0.05443141236901283, "mean_kl_loss": 0.019245127215981483, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7884160, "num_module_steps_trained_lifetime_throughput": 69535.31824616763}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 90, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-20", "timestamp": 1750911800, "time_this_iter_s": 2.1632068157196045, "time_total_s": 2414.937432050705, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a68e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2414.937432050705, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 14.533333333333331, "ram_util_percent": 52.4}}
{"timers": {"training_iteration": 17.392117237750828, "restore_env_runners": 0.0027573877709283945, "training_step": 17.38921824352135, "env_runner_sampling_timer": 16.062163426321963, "learner_update_timer": 1.3248437149095509, "synch_weights": 0.0008668521692089863, "synch_env_connectors": 0.04840306274940962}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 1.9770497601712123e-05, "add_time_dim_to_batch_and_zero_pad": 6.104000931372866e-06, "add_observations_from_episodes_to_batch": 3.1541498174192384e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 4.937501216772944e-06, "numpy_to_tensor": 1.9062499632127583e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.857652470362645e-06, "batch_individual_items": 9.27504440645585e-06, "add_time_dim_to_batch_and_zero_pad": 2.634256732564426e-06, "add_observations_from_episodes_to_batch": 1.5185749058599498e-05, "add_states_from_episodes_to_batch": 1.6770133890940293e-06, "agent_to_module_mapping": 2.829376276396758e-06}}, "connector_pipeline_timer": 6.8095449103307e-05}, "env_reset_timer": 9.252049494534731e-05, "agent_episode_returns_mean": {"vehicle_1": 496.29651755571365, "vehicle_5": 599.8377547216415, "vehicle_3": 158.3990121126175, "vehicle_2": 212.37751487731933, "vehicle_4": 618.4130595731735, "vehicle_0": 161.31456716537477}, "sample": 0.1332929779234102, "rlmodule_inference_timer": 6.252728456194013e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.28, "vehicle_2": 88.18, "vehicle_0": 40.28, "vehicle_4": 108.0, "vehicle_1": 93.14}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015095484657735663, "connector_pipeline_timer": 0.00019072899885941297, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.742029948929745e-05, "tensor_to_numpy": 1.6957138015870424e-05, "module_to_agent_unmapping": 1.693383403846135e-06, "normalize_and_clip_actions": 4.783242635198743e-05, "remove_single_ts_time_rank_from_batch": 6.487169004158834e-07, "un_batch_to_individual_items": 1.5665957918470525e-05, "listify_data_for_vector_env": 6.8843173310654e-06}}, "connector_pipeline_timer": 0.00015813583681035257}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 712.0000000000001, "vehicle_2": 1622.0, "vehicle_4": 1980.9999999999998, "vehicle_0": 712.0000000000001, "vehicle_1": 1723.0}, "env_to_module_sum_episodes_length_in": 48.42885426133144, "num_agent_steps_sampled_lifetime": {"vehicle_0": 7393.0, "vehicle_2": 16469.999999999996, "vehicle_4": 19820.0, "vehicle_1": 17596.000000000004, "vehicle_5": 19820.0, "vehicle_3": 7393.0}, "episode_return_mean": 2246.6384246230127, "num_env_steps_sampled_lifetime": 20000.0, "time_between_sampling": 0.3196639980166052, "episode_return_min": 1929.037913799286, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 88492.0}, "module_episode_returns_mean": {"shared_policy": 959.9711914372444}, "episode_len_min": 108, "weights_seq_no": 90.0, "episode_duration_sec_mean": 0.0683735116601747, "num_module_steps_sampled": {"shared_policy": 8731.0}, "num_episodes_lifetime": 180.0, "episode_return_max": 2404.8228912353516, "env_to_module_sum_episodes_length_out": 48.42885426133144, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1595.6760589424603}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005889302555879015, "agent_to_module_mapping": 0.0034334016374874244, "general_advantage_estimation": 0.017438164771707128, "add_time_dim_to_batch_and_zero_pad": 1.0635001987425094e-05, "add_columns_from_episodes_to_train_batch": 0.05183473627358679, "add_states_from_episodes_to_batch": 3.0151505767705516e-06, "numpy_to_tensor": 0.00015027676217456852, "batch_individual_items": 0.08222880094549534, "add_observations_from_episodes_to_batch": 0.000405253730497823}}, "connector_pipeline_timer": 0.16153985647456978}, "learner_connector_sum_episodes_length_in": 1978.6504973079454, "num_env_steps_trained": 1408000, "num_module_steps_trained_lifetime": 7974272, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 123194800, "num_module_steps_trained": 90112, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1978.6504973079454, "num_env_steps_trained_lifetime_throughput": 1062913.818882309, "num_module_steps_trained_throughput": 69705.97561965483, "num_module_steps_trained_lifetime_throughput": 69705.63586246307}, "shared_policy": {"gradients_default_optimizer_global_norm": 22.4891414642334, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.029631614685059, "total_loss": 9.064777374267578, "num_module_steps_trained": 90112, "num_trainable_parameters": 149763, "entropy": 0.49890121817588806, "vf_loss_unclipped": 5415.765625, "weights_seq_no": 91.0, "curr_kl_coeff": 0.0005561828729696572, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.209641695022583, "policy_loss": 0.040116384625434875, "mean_kl_loss": 0.05271650105714798, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 7974272, "num_module_steps_trained_lifetime_throughput": 69705.44186942308}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 91, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-22", "timestamp": 1750911802, "time_this_iter_s": 2.1288912296295166, "time_total_s": 2417.0663232803345, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b34db20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2417.0663232803345, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 52.43333333333334}}
{"timers": {"training_iteration": 17.240567879543356, "restore_env_runners": 0.002729870143210868, "training_step": 17.237696278176127, "env_runner_sampling_timer": 15.90860195246878, "learner_update_timer": 1.3268795427604647, "synch_weights": 0.0008668694774788017, "synch_env_connectors": 0.047935433371947306}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 1.9770497601712123e-05, "add_time_dim_to_batch_and_zero_pad": 6.104000931372866e-06, "add_observations_from_episodes_to_batch": 3.1541498174192384e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 4.937501216772944e-06, "numpy_to_tensor": 1.9062499632127583e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.79208711841408e-06, "batch_individual_items": 9.332806977086818e-06, "add_time_dim_to_batch_and_zero_pad": 2.6344732563299425e-06, "add_observations_from_episodes_to_batch": 1.518297859401006e-05, "add_states_from_episodes_to_batch": 1.6751916902878152e-06, "agent_to_module_mapping": 2.815450987004992e-06}}, "connector_pipeline_timer": 6.781243228117062e-05}, "env_reset_timer": 9.252049494534731e-05, "agent_episode_returns_mean": {"vehicle_1": 500.8679885673522, "vehicle_5": 594.0984954118729, "vehicle_3": 160.6440361690521, "vehicle_2": 207.16695118308067, "vehicle_4": 618.413072218895, "vehicle_0": 160.45714820861815}, "sample": 0.13326332438561492, "rlmodule_inference_timer": 6.403878275112322e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.2, "vehicle_2": 92.73999999999998, "vehicle_0": 40.2, "vehicle_4": 108.0, "vehicle_1": 97.32}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015173400661515628, "connector_pipeline_timer": 0.00019072899885941297, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7476761440571394e-05, "tensor_to_numpy": 1.6850317700751455e-05, "module_to_agent_unmapping": 1.660139073342179e-06, "normalize_and_clip_actions": 4.833619634681251e-05, "remove_single_ts_time_rank_from_batch": 6.374389348330789e-07, "un_batch_to_individual_items": 1.5720917415511342e-05, "listify_data_for_vector_env": 6.890126954815206e-06}}, "connector_pipeline_timer": 0.00015834394164653397}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 744.0, "vehicle_2": 1693.0, "vehicle_4": 1980.9999999999998, "vehicle_0": 744.0, "vehicle_1": 1782.0}, "env_to_module_sum_episodes_length_in": 47.22657384082528, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8137.0, "vehicle_2": 18163.0, "vehicle_4": 21801.0, "vehicle_1": 19378.000000000007, "vehicle_5": 21801.0, "vehicle_3": 8137.0}, "episode_return_mean": 2241.6476904523374, "num_env_steps_sampled_lifetime": 22000.0, "time_between_sampling": 0.3184851340739428, "episode_return_min": 1926.0609447956085, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 97417.0}, "module_episode_returns_mean": {"shared_policy": 991.2828625297548}, "episode_len_min": 108, "weights_seq_no": 91.0, "episode_duration_sec_mean": 0.06844456503939, "num_module_steps_sampled": {"shared_policy": 8925.0}, "num_episodes_lifetime": 199.0, "episode_return_max": 2391.13792347908, "env_to_module_sum_episodes_length_out": 47.22657384082528, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1577.5912998374092}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0058998762003494385, "agent_to_module_mapping": 0.0034368959511358807, "general_advantage_estimation": 0.01745414937394357, "add_time_dim_to_batch_and_zero_pad": 1.0615321937738203e-05, "add_columns_from_episodes_to_train_batch": 0.051920621410823486, "add_states_from_episodes_to_batch": 3.006249087291678e-06, "numpy_to_tensor": 0.0001496231645082953, "batch_individual_items": 0.0826525583560158, "add_observations_from_episodes_to_batch": 0.0004059207731489898}}, "connector_pipeline_timer": 0.16207925998986417}, "learner_connector_sum_episodes_length_in": 1978.863992334866, "num_env_steps_trained": 1438000, "num_module_steps_trained_lifetime": 8066304, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 124632800, "num_module_steps_trained": 92032, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1978.863992334866, "num_env_steps_trained_lifetime_throughput": 1065180.653492504, "num_module_steps_trained_throughput": 69767.33235187807, "num_module_steps_trained_lifetime_throughput": 69766.91785056538}, "shared_policy": {"gradients_default_optimizer_global_norm": 12.501622200012207, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.702859878540039, "total_loss": 8.707146644592285, "num_module_steps_trained": 92032, "num_trainable_parameters": 149763, "entropy": 0.310261994600296, "vf_loss_unclipped": 4444.61474609375, "weights_seq_no": 92.0, "curr_kl_coeff": 0.0005561828729696572, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.020005345344543457, "policy_loss": 0.007381140720099211, "mean_kl_loss": 0.016261888667941093, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8066304, "num_module_steps_trained_lifetime_throughput": 69766.787771673}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 22000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 92, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-24", "timestamp": 1750911804, "time_this_iter_s": 2.239262104034424, "time_total_s": 2419.305585384369, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f2a59e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2419.305585384369, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 13.599999999999998, "ram_util_percent": 52.5}}
{"timers": {"training_iteration": 17.089491858247875, "restore_env_runners": 0.002702616441830373, "training_step": 17.086647638304342, "env_runner_sampling_timer": 15.756548298774039, "learner_update_timer": 1.3278820860829008, "synch_weights": 0.0008666299427109401, "synch_env_connectors": 0.04746482736822908}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 1.9770497601712123e-05, "add_time_dim_to_batch_and_zero_pad": 6.104000931372866e-06, "add_observations_from_episodes_to_batch": 3.1541498174192384e-05, "add_states_from_episodes_to_batch": 3.1244999263435602e-06, "agent_to_module_mapping": 4.937501216772944e-06, "numpy_to_tensor": 1.9062499632127583e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.725106856751841e-06, "batch_individual_items": 9.080324060910702e-06, "add_time_dim_to_batch_and_zero_pad": 2.57709771407588e-06, "add_observations_from_episodes_to_batch": 1.4747176436070157e-05, "add_states_from_episodes_to_batch": 1.6677211084793934e-06, "agent_to_module_mapping": 2.744629481981094e-06}}, "connector_pipeline_timer": 6.670495955225966e-05}, "env_reset_timer": 9.252049494534731e-05, "agent_episode_returns_mean": {"vehicle_1": 482.1228403043747, "vehicle_5": 586.2733027553559, "vehicle_3": 165.55826804161072, "vehicle_2": 178.59498039364814, "vehicle_4": 618.4130638504029, "vehicle_0": 154.6598880147934}, "sample": 0.13322917394932138, "rlmodule_inference_timer": 6.343248017247705e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.16, "vehicle_2": 88.24, "vehicle_0": 40.16, "vehicle_4": 108.0, "vehicle_1": 92.56}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.0001490791896867369, "connector_pipeline_timer": 0.00019072899885941297, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.708908991952407e-05, "tensor_to_numpy": 1.6638563653664642e-05, "module_to_agent_unmapping": 1.6540560498179675e-06, "normalize_and_clip_actions": 4.6060199216239516e-05, "remove_single_ts_time_rank_from_batch": 6.331751706826118e-07, "un_batch_to_individual_items": 1.5170886564753457e-05, "listify_data_for_vector_env": 6.569655906538812e-06}}, "connector_pipeline_timer": 0.00015431218655438813}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 740.0, "vehicle_2": 1587.0, "vehicle_4": 1982.0, "vehicle_0": 740.0, "vehicle_1": 1654.0000000000002}, "env_to_module_sum_episodes_length_in": 50.51781302168881, "num_agent_steps_sampled_lifetime": {"vehicle_0": 8877.0, "vehicle_2": 19750.0, "vehicle_4": 23783.0, "vehicle_1": 21032.000000000007, "vehicle_5": 23783.0, "vehicle_3": 8877.0}, "episode_return_mean": 2185.622342139483, "num_env_steps_sampled_lifetime": 24000.0, "time_between_sampling": 0.31837065150684635, "episode_return_min": 1710.2285289168358, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 106102.0}, "module_episode_returns_mean": {"shared_policy": 905.8729219841956}, "episode_len_min": 108, "weights_seq_no": 92.0, "episode_duration_sec_mean": 0.06876073672130588, "num_module_steps_sampled": {"shared_policy": 8685.0}, "num_episodes_lifetime": 217.0, "episode_return_max": 2392.994043827057, "env_to_module_sum_episodes_length_out": 50.51781302168881, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1647.5245793772388}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005903189518390593, "agent_to_module_mapping": 0.0034405319916485082, "general_advantage_estimation": 0.017452926630225414, "add_time_dim_to_batch_and_zero_pad": 1.0606258732966604e-05, "add_columns_from_episodes_to_train_batch": 0.0519802181066647, "add_states_from_episodes_to_batch": 3.0053465972682763e-06, "numpy_to_tensor": 0.00014909818283731225, "batch_individual_items": 0.08227030068244406, "add_observations_from_episodes_to_batch": 0.0004065240654134021}}, "connector_pipeline_timer": 0.16176192113997168}, "learner_connector_sum_episodes_length_in": 1979.0753524115173, "num_env_steps_trained": 1398000, "num_module_steps_trained_lifetime": 8155776, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 126030800, "num_module_steps_trained": 89472, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1979.0753524115173, "num_env_steps_trained_lifetime_throughput": 1064525.2460693296, "num_module_steps_trained_throughput": 69645.88154632234, "num_module_steps_trained_lifetime_throughput": 69645.44942349645}, "shared_policy": {"gradients_default_optimizer_global_norm": 19.753494262695312, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.71567153930664, "total_loss": 8.766441345214844, "num_module_steps_trained": 89472, "num_trainable_parameters": 149763, "entropy": 0.38688433170318604, "vf_loss_unclipped": 3982.314453125, "weights_seq_no": 93.0, "curr_kl_coeff": 0.0008342743385583162, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.18830060958862305, "policy_loss": 0.05459289997816086, "mean_kl_loss": 0.08313468098640442, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8155776, "num_module_steps_trained_lifetime_throughput": 69645.45909518776}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 93, "trial_id": "a8246_00000", "date": "2025-06-25_21-23-26", "timestamp": 1750911806, "time_this_iter_s": 2.134953022003174, "time_total_s": 2421.440538406372, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b34f7e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2421.440538406372, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 15.766666666666667, "ram_util_percent": 52.166666666666664}}
{"timers": {"training_iteration": 18.15993466966541, "restore_env_runners": 0.002675635277463683, "training_step": 18.15711724901132, "env_runner_sampling_timer": 16.827620141206285, "learner_update_timer": 1.3272779535520793, "synch_weights": 0.0008673569832896029, "synch_env_connectors": 0.0469985440945774}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.0374995074234903e-05, "add_time_dim_to_batch_and_zero_pad": 5.957997927907854e-06, "add_observations_from_episodes_to_batch": 3.183299850206822e-05, "add_states_from_episodes_to_batch": 3.0410010367631912e-06, "agent_to_module_mapping": 4.7909998102113605e-06, "numpy_to_tensor": 1.8667000404093415e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.400825002740345e-06, "batch_individual_items": 8.887725945153913e-06, "add_time_dim_to_batch_and_zero_pad": 2.5190155402508014e-06, "add_observations_from_episodes_to_batch": 1.4297307252145186e-05, "add_states_from_episodes_to_batch": 1.5958456474182597e-06, "agent_to_module_mapping": 2.648299711788809e-06}}, "connector_pipeline_timer": 6.479487568572789e-05}, "env_reset_timer": 9.23329935176298e-05, "agent_episode_returns_mean": {"vehicle_1": 477.5830253016949, "vehicle_5": 607.4853897762299, "vehicle_3": 141.2676704621315, "vehicle_2": 127.26223630219698, "vehicle_4": 618.4130691790581, "vehicle_0": 140.3101063334942}, "sample": 0.13472343653308533, "rlmodule_inference_timer": 6.431579515712082e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.56, "vehicle_2": 87.035, "vehicle_0": 40.56, "vehicle_4": 108.0, "vehicle_1": 90.335}, "num_env_steps_sampled": 1600.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014596304530900805, "connector_pipeline_timer": 0.00019145799888065085, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.612523139245557e-05, "tensor_to_numpy": 1.6068617516965347e-05, "module_to_agent_unmapping": 1.58599042534776e-06, "normalize_and_clip_actions": 4.605372571694399e-05, "remove_single_ts_time_rank_from_batch": 6.061832336780224e-07, "un_batch_to_individual_items": 1.5104926528212666e-05, "listify_data_for_vector_env": 6.513269387969531e-06}}, "connector_pipeline_timer": 0.00015204466368342966}, "num_agent_steps_sampled": {"vehicle_5": 1585.0, "vehicle_3": 594.0, "vehicle_2": 1302.0, "vehicle_4": 1585.0, "vehicle_0": 594.0, "vehicle_1": 1357.0}, "env_to_module_sum_episodes_length_in": 48.15269701318155, "num_agent_steps_sampled_lifetime": {"vehicle_0": 9471.0, "vehicle_2": 21052.0, "vehicle_4": 25368.0, "vehicle_1": 22389.000000000007, "vehicle_5": 25368.0, "vehicle_3": 9471.0}, "episode_return_mean": 2112.321496796906, "num_env_steps_sampled_lifetime": 25600.0, "time_between_sampling": 0.6043091154118663, "episode_return_min": 1710.2285289168358, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 113119.0}, "module_episode_returns_mean": {"shared_policy": 1047.7883146631718}, "episode_len_min": 108, "weights_seq_no": 93.0, "episode_duration_sec_mean": 0.06759416925498954, "num_module_steps_sampled": {"shared_policy": 7017.0}, "num_episodes_lifetime": 232.0, "episode_return_max": 2317.7566697597504, "env_to_module_sum_episodes_length_out": 48.15269701318155, "num_episodes": 15.0, "num_env_steps_sampled_lifetime_throughput": 1646.8070271023525}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0059059063732197535, "agent_to_module_mapping": 0.003440537081739718, "general_advantage_estimation": 0.017435889863925424, "add_time_dim_to_batch_and_zero_pad": 1.0595196141418046e-05, "add_columns_from_episodes_to_train_batch": 0.05196424051557579, "add_states_from_episodes_to_batch": 3.0032131634484996e-06, "numpy_to_tensor": 0.0001485059510130649, "batch_individual_items": 0.08182950476566957, "add_observations_from_episodes_to_batch": 0.0004072013247822531}}, "connector_pipeline_timer": 0.16129096484857233}, "learner_connector_sum_episodes_length_in": 1975.2845988874021, "num_env_steps_trained": 904000, "num_module_steps_trained_lifetime": 8228096, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 126934800, "num_module_steps_trained": 72320, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1975.2845988874021, "num_env_steps_trained_lifetime_throughput": 1051387.0065780892, "num_module_steps_trained_throughput": 69370.54065741281, "num_module_steps_trained_lifetime_throughput": 69370.15740456426}, "shared_policy": {"gradients_default_optimizer_global_norm": 23.665283203125, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.452520370483398, "total_loss": 9.533934593200684, "num_module_steps_trained": 72320, "num_trainable_parameters": 149763, "entropy": 0.3576628863811493, "vf_loss_unclipped": 4225.83935546875, "weights_seq_no": 94.0, "curr_kl_coeff": 0.0012514115078374743, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.0622636079788208, "policy_loss": 0.0848812535405159, "mean_kl_loss": 0.13100601732730865, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8228096, "num_module_steps_trained_lifetime_throughput": 69370.1647107733}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 25600.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 36}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 94, "trial_id": "a8246_00000", "date": "2025-06-25_21-25-32", "timestamp": 1750911932, "time_this_iter_s": 125.8896918296814, "time_total_s": 2547.3302302360535, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14a678220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2547.3302302360535, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 8.912849162011174, "ram_util_percent": 51.948044692737426}}
{"timers": {"training_iteration": 18.622499591308785, "restore_env_runners": 0.002728868924701959, "training_step": 18.61962763027121, "env_runner_sampling_timer": 17.287978899374234, "learner_update_timer": 1.3294232356865472, "synch_weights": 0.0008674225834638817, "synch_env_connectors": 0.06407993532357578}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.347949605085887e-05, "add_time_dim_to_batch_and_zero_pad": 1.0495602327864618e-05, "add_observations_from_episodes_to_batch": 5.375359614845365e-05, "add_states_from_episodes_to_batch": 5.421201785793528e-06, "agent_to_module_mapping": 8.871098543750122e-06, "numpy_to_tensor": 3.544610444805585e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.659603941515198e-06, "batch_individual_items": 9.316876388309735e-06, "add_time_dim_to_batch_and_zero_pad": 2.5446551921397258e-06, "add_observations_from_episodes_to_batch": 1.4956117476247541e-05, "add_states_from_episodes_to_batch": 1.6805562569628793e-06, "agent_to_module_mapping": 2.744245997709156e-06}}, "connector_pipeline_timer": 6.739568299038253e-05}, "env_reset_timer": 0.00015114199632080272, "agent_episode_returns_mean": {"vehicle_1": 518.5026819403968, "vehicle_5": 607.7071305004756, "vehicle_3": 122.13883122285208, "vehicle_2": 228.6466704082489, "vehicle_4": 615.92412976106, "vehicle_0": 139.00276877244312}, "sample": 0.14042218921703037, "rlmodule_inference_timer": 6.969838328936622e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.806666666666665, "vehicle_2": 91.05333333333336, "vehicle_0": 40.806666666666665, "vehicle_4": 108.0, "vehicle_1": 96.58}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014515532557164498, "connector_pipeline_timer": 0.0003510579968860839, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.426087625434245e-05, "tensor_to_numpy": 1.8817177063553475e-05, "module_to_agent_unmapping": 1.6726642232336674e-06, "normalize_and_clip_actions": 4.958169449774628e-05, "remove_single_ts_time_rank_from_batch": 6.614980266056147e-07, "un_batch_to_individual_items": 1.5698477906923705e-05, "listify_data_for_vector_env": 6.818400597322505e-06}}, "connector_pipeline_timer": 0.00016865565443308707}, "num_agent_steps_sampled": {"vehicle_5": 1983.0, "vehicle_3": 756.0, "vehicle_2": 1708.0, "vehicle_4": 1983.0, "vehicle_0": 756.0, "vehicle_1": 1797.0}, "env_to_module_sum_episodes_length_in": 48.87522847316003, "num_agent_steps_sampled_lifetime": {"vehicle_0": 3505.0, "vehicle_2": 7782.0, "vehicle_4": 9121.000000000002, "vehicle_1": 8206.000000000002, "vehicle_5": 9121.000000000002, "vehicle_3": 3505.0}, "episode_return_mean": 2231.922213149071, "num_env_steps_sampled_lifetime": 9200.0, "time_between_sampling": 0.5282053226803711, "episode_return_min": 1934.6196920871735, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 41240.0}, "module_episode_returns_mean": {"shared_policy": 1024.982914675077}, "episode_len_min": 108, "weights_seq_no": 94.0, "episode_duration_sec_mean": 0.06790825276625886, "num_module_steps_sampled": {"shared_policy": 8983.0}, "num_episodes_lifetime": 79.00000000000001, "episode_return_max": 2351.2992227077484, "env_to_module_sum_episodes_length_out": 48.87522847316003, "num_episodes": 17.0, "num_env_steps_sampled_lifetime_throughput": 1677.6376941096587}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005912382729486479, "agent_to_module_mapping": 0.0034442108808940726, "general_advantage_estimation": 0.017455794715304025, "add_time_dim_to_batch_and_zero_pad": 1.0567164156323984e-05, "add_columns_from_episodes_to_train_batch": 0.05203306311038438, "add_states_from_episodes_to_batch": 2.996511026106013e-06, "numpy_to_tensor": 0.00014789173151572862, "batch_individual_items": 0.08222821679798949, "add_observations_from_episodes_to_batch": 0.00040765514154321865}}, "connector_pipeline_timer": 0.16178792354006255}, "learner_connector_sum_episodes_length_in": 1975.531752898528, "num_env_steps_trained": 1444000, "num_module_steps_trained_lifetime": 8320512, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 128378800, "num_module_steps_trained": 92416, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1975.531752898528, "num_env_steps_trained_lifetime_throughput": 1052957.1944455074, "num_module_steps_trained_throughput": 69366.90784289743, "num_module_steps_trained_lifetime_throughput": 69366.59244814682}, "shared_policy": {"gradients_default_optimizer_global_norm": 8.714823722839355, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.81297492980957, "total_loss": 8.820646286010742, "num_module_steps_trained": 92416, "num_trainable_parameters": 149763, "entropy": 0.33906787633895874, "vf_loss_unclipped": 4185.88623046875, "weights_seq_no": 95.0, "curr_kl_coeff": 0.0018771172035485506, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.15114575624465942, "policy_loss": 0.011036527343094349, "mean_kl_loss": 0.02009633369743824, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8320512, "num_module_steps_trained_lifetime_throughput": 69366.47203838782}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9200.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 38}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 95, "trial_id": "a8246_00000", "date": "2025-06-25_21-26-37", "timestamp": 1750911997, "time_this_iter_s": 64.41848802566528, "time_total_s": 2611.7487182617188, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x13f746ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2611.7487182617188, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 9.10989010989011, "ram_util_percent": 51.987912087912086}}
{"timers": {"training_iteration": 18.457727960395676, "restore_env_runners": 0.002743169395409977, "training_step": 18.454841623968477, "env_runner_sampling_timer": 17.122447759130466, "learner_update_timer": 1.3301642562397165, "synch_weights": 0.0008676483576590684, "synch_env_connectors": 0.06345026597039718}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7166996005689725e-05, "add_time_dim_to_batch_and_zero_pad": 8.52049925015308e-06, "add_observations_from_episodes_to_batch": 4.347899812273681e-05, "add_states_from_episodes_to_batch": 4.271001671440899e-06, "agent_to_module_mapping": 7.208498573163524e-06, "numpy_to_tensor": 2.6792004064191133e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.660014742545996e-06, "batch_individual_items": 9.073946632144795e-06, "add_time_dim_to_batch_and_zero_pad": 2.5858477601928786e-06, "add_observations_from_episodes_to_batch": 1.4784327264775183e-05, "add_states_from_episodes_to_batch": 1.6752293433174615e-06, "agent_to_module_mapping": 2.740379834436144e-06}}, "connector_pipeline_timer": 6.69286874220064e-05}, "env_reset_timer": 0.00012077099745511077, "agent_episode_returns_mean": {"vehicle_1": 486.641783552851, "vehicle_5": 593.1773019177573, "vehicle_3": 129.20522337658065, "vehicle_2": 167.43445888706617, "vehicle_4": 616.1882768658229, "vehicle_0": 156.82930075679508}, "sample": 0.13537274815200714, "rlmodule_inference_timer": 7.874793942909812e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.68285714285714, "vehicle_2": 88.49428571428571, "vehicle_0": 40.68285714285714, "vehicle_4": 108.0, "vehicle_1": 92.08}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014514389234638304, "connector_pipeline_timer": 0.00027772899920819327, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9014905150729274e-05, "tensor_to_numpy": 1.7256296060929782e-05, "module_to_agent_unmapping": 1.6323381047863655e-06, "normalize_and_clip_actions": 4.6972015465980815e-05, "remove_single_ts_time_rank_from_batch": 6.431863173611381e-07, "un_batch_to_individual_items": 1.5084445591262137e-05, "listify_data_for_vector_env": 6.5898532231996495e-06}}, "connector_pipeline_timer": 0.0001579574699014261}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 741.0, "vehicle_2": 1560.9999999999998, "vehicle_4": 1982.0, "vehicle_0": 741.0, "vehicle_1": 1620.9999999999998}, "env_to_module_sum_episodes_length_in": 47.112099647129654, "num_agent_steps_sampled_lifetime": {"vehicle_0": 5670.0, "vehicle_2": 12446.0, "vehicle_4": 14866.0, "vehicle_1": 13057.999999999996, "vehicle_5": 14866.0, "vehicle_3": 5670.0}, "episode_return_mean": 2149.4763466347963, "num_env_steps_sampled_lifetime": 15000.0, "time_between_sampling": 0.3508252665865783, "episode_return_min": 1760.955022573471, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 66576.0}, "module_episode_returns_mean": {"shared_policy": 1050.2512833179746}, "episode_len_min": 108, "weights_seq_no": 95.0, "episode_duration_sec_mean": 0.06941526346571793, "num_module_steps_sampled": {"shared_policy": 8628.0}, "num_episodes_lifetime": 134.00000000000003, "episode_return_max": 2338.3607738018036, "env_to_module_sum_episodes_length_out": 47.112099647129654, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1665.5384927132013}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005922178902240434, "agent_to_module_mapping": 0.003449287522066785, "general_advantage_estimation": 0.017451901768119706, "add_time_dim_to_batch_and_zero_pad": 1.0561492475854743e-05, "add_columns_from_episodes_to_train_batch": 0.052083209979285464, "add_states_from_episodes_to_batch": 2.9915459606881346e-06, "numpy_to_tensor": 0.00014732781418291347, "batch_individual_items": 0.08186051005001763, "add_observations_from_episodes_to_batch": 0.0004085715101309194}}, "connector_pipeline_timer": 0.16148141346469208}, "learner_connector_sum_episodes_length_in": 1975.776435369543, "num_env_steps_trained": 1390000, "num_module_steps_trained_lifetime": 8409472, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 129768800, "num_module_steps_trained": 88960, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1975.776435369543, "num_env_steps_trained_lifetime_throughput": 1054592.4125352884, "num_module_steps_trained_throughput": 69372.51390860841, "num_module_steps_trained_lifetime_throughput": 69372.26381866129}, "shared_policy": {"gradients_default_optimizer_global_norm": 7.842082500457764, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.166555404663086, "total_loss": 9.19705581665039, "num_module_steps_trained": 88960, "num_trainable_parameters": 149763, "entropy": 0.3080846071243286, "vf_loss_unclipped": 4685.9072265625, "weights_seq_no": 96.0, "curr_kl_coeff": 0.0018771172035485506, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.0010155439376831055, "policy_loss": 0.03354974091053009, "mean_kl_loss": 0.01729908213019371, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8409472, "num_module_steps_trained_lifetime_throughput": 69372.04385207423}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 15000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 39}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 96, "trial_id": "a8246_00000", "date": "2025-06-25_21-26-39", "timestamp": 1750911999, "time_this_iter_s": 2.1476917266845703, "time_total_s": 2613.8964099884033, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c1e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2613.8964099884033, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 15.066666666666668, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 18.295013989541754, "restore_env_runners": 0.002715781451425213, "training_step": 18.29215490522878, "env_runner_sampling_timer": 16.95871895153915, "learner_update_timer": 1.3312038161773192, "synch_weights": 0.0008674735441001998, "synch_env_connectors": 0.06282731206073754}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7166996005689725e-05, "add_time_dim_to_batch_and_zero_pad": 8.52049925015308e-06, "add_observations_from_episodes_to_batch": 4.347899812273681e-05, "add_states_from_episodes_to_batch": 4.271001671440899e-06, "agent_to_module_mapping": 7.208498573163524e-06, "numpy_to_tensor": 2.6792004064191133e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.750518888267436e-06, "batch_individual_items": 9.214387172952089e-06, "add_time_dim_to_batch_and_zero_pad": 2.635124161025836e-06, "add_observations_from_episodes_to_batch": 1.5100386815327434e-05, "add_states_from_episodes_to_batch": 1.6839102598934653e-06, "agent_to_module_mapping": 2.7649387529630214e-06}}, "connector_pipeline_timer": 6.761825323071879e-05}, "env_reset_timer": 0.00012077099745511077, "agent_episode_returns_mean": {"vehicle_1": 467.7311436676979, "vehicle_5": 599.221342768669, "vehicle_3": 145.60598648548125, "vehicle_2": 124.48922316312792, "vehicle_4": 618.295488166809, "vehicle_0": 144.4242335796356}, "sample": 0.1351265954833876, "rlmodule_inference_timer": 7.835954175642587e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.5, "vehicle_2": 86.14000000000001, "vehicle_0": 40.5, "vehicle_4": 108.0, "vehicle_1": 90.44000000000001}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00015060676910095145, "connector_pipeline_timer": 0.00027772899920819327, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.690351827142518e-05, "tensor_to_numpy": 1.6594914282806694e-05, "module_to_agent_unmapping": 1.6514499243698542e-06, "normalize_and_clip_actions": 4.6645610253291515e-05, "remove_single_ts_time_rank_from_batch": 6.768705800798244e-07, "un_batch_to_individual_items": 1.521578448868384e-05, "listify_data_for_vector_env": 6.623427265387875e-06}}, "connector_pipeline_timer": 0.00015500559645358647}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 742.9999999999999, "vehicle_2": 1618.0, "vehicle_4": 1980.9999999999998, "vehicle_0": 742.9999999999999, "vehicle_1": 1695.9999999999998}, "env_to_module_sum_episodes_length_in": 48.80828414456274, "num_agent_steps_sampled_lifetime": {"vehicle_0": 6413.0, "vehicle_2": 14064.0, "vehicle_4": 16847.0, "vehicle_1": 14753.999999999996, "vehicle_5": 16847.0, "vehicle_3": 6413.0}, "episode_return_mean": 2099.76741897583, "num_env_steps_sampled_lifetime": 17000.0, "time_between_sampling": 0.3202192709542916, "episode_return_min": 1577.5239971876144, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 75338.0}, "module_episode_returns_mean": {"shared_policy": 974.4235827159883}, "episode_len_min": 108, "weights_seq_no": 96.0, "episode_duration_sec_mean": 0.06785658411958138, "num_module_steps_sampled": {"shared_policy": 8762.0}, "num_episodes_lifetime": 153.00000000000003, "episode_return_max": 2322.0449270009995, "env_to_module_sum_episodes_length_out": 48.80828414456274, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1638.124848210658}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005929527113198886, "agent_to_module_mapping": 0.003452440896830508, "general_advantage_estimation": 0.0174769173304627, "add_time_dim_to_batch_and_zero_pad": 1.0551707515362353e-05, "add_columns_from_episodes_to_train_batch": 0.052131411209522534, "add_states_from_episodes_to_batch": 2.9816305078519684e-06, "numpy_to_tensor": 0.000146863696009901, "batch_individual_items": 0.08147810036956053, "add_observations_from_episodes_to_batch": 0.00040936662504943906}}, "connector_pipeline_timer": 0.16118278933004287}, "learner_connector_sum_episodes_length_in": 1976.0186710158475, "num_env_steps_trained": 1412000, "num_module_steps_trained_lifetime": 8499840, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 131180800, "num_module_steps_trained": 90368, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1976.0186710158475, "num_env_steps_trained_lifetime_throughput": 1055374.095462123, "num_module_steps_trained_throughput": 69328.61729779266, "num_module_steps_trained_lifetime_throughput": 69328.35175154296}, "shared_policy": {"gradients_default_optimizer_global_norm": 21.50930404663086, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.709333419799805, "total_loss": 8.737586975097656, "num_module_steps_trained": 90368, "num_trainable_parameters": 149763, "entropy": 0.2530820965766907, "vf_loss_unclipped": 4431.41064453125, "weights_seq_no": 97.0, "curr_kl_coeff": 0.0028156759217381477, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.1414223313331604, "policy_loss": 0.030747128650546074, "mean_kl_loss": 0.02009722590446472, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8499840, "num_module_steps_trained_lifetime_throughput": 69328.16534317289}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 39}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 97, "trial_id": "a8246_00000", "date": "2025-06-25_21-26-41", "timestamp": 1750912001, "time_this_iter_s": 2.188911199569702, "time_total_s": 2616.085321187973, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b1c2fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2616.085321187973, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 14.566666666666665, "ram_util_percent": 52.0}}
{"timers": {"training_iteration": 18.75840316755636, "restore_env_runners": 0.002688666556911812, "training_step": 18.75557121534651, "env_runner_sampling_timer": 17.420833361193733, "learner_update_timer": 1.3325031792655497, "synch_weights": 0.0008667888086719941, "synch_env_connectors": 0.06221253435007868}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 3.216699624317698e-05, "add_time_dim_to_batch_and_zero_pad": 9.970501560019321e-06, "add_observations_from_episodes_to_batch": 5.1828596042469144e-05, "add_states_from_episodes_to_batch": 5.187801434658468e-06, "agent_to_module_mapping": 8.575298852520064e-06, "numpy_to_tensor": 3.3792004978749886e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.064760223671439e-06, "batch_individual_items": 8.597049965589684e-06, "add_time_dim_to_batch_and_zero_pad": 2.4657434917053407e-06, "add_observations_from_episodes_to_batch": 1.4152744349826577e-05, "add_states_from_episodes_to_batch": 1.627393456635136e-06, "agent_to_module_mapping": 2.6103919712976116e-06}}, "connector_pipeline_timer": 6.397865143229782e-05}, "env_reset_timer": 0.00014408779607038013, "agent_episode_returns_mean": {"vehicle_1": 458.6834596633911, "vehicle_5": 599.292700510025, "vehicle_3": 154.4292455005646, "vehicle_2": 103.75490699648857, "vehicle_4": 618.2332124185561, "vehicle_0": 144.36952396392823}, "sample": 0.1381019591836566, "rlmodule_inference_timer": 6.469978374176226e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.38, "vehicle_2": 85.25999999999998, "vehicle_0": 40.38, "vehicle_4": 108.0, "vehicle_1": 88.7}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014240904070769183, "connector_pipeline_timer": 0.0003392121972865425, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.548674056507976e-05, "tensor_to_numpy": 1.583727516538784e-05, "module_to_agent_unmapping": 1.5892597216723723e-06, "normalize_and_clip_actions": 4.3710542525095635e-05, "remove_single_ts_time_rank_from_batch": 6.327092959110874e-07, "un_batch_to_individual_items": 1.4489838407138057e-05, "listify_data_for_vector_env": 6.355044359022572e-06}}, "connector_pipeline_timer": 0.00014808594704727012}, "num_agent_steps_sampled": {"vehicle_5": 1982.0, "vehicle_3": 727.9999999999999, "vehicle_2": 1492.0, "vehicle_4": 1982.0, "vehicle_0": 727.9999999999999, "vehicle_1": 1552.0}, "env_to_module_sum_episodes_length_in": 50.056941798000864, "num_agent_steps_sampled_lifetime": {"vehicle_0": 7141.0, "vehicle_2": 15556.0, "vehicle_4": 18829.0, "vehicle_1": 16305.999999999996, "vehicle_5": 18829.0, "vehicle_3": 7141.0}, "episode_return_mean": 2078.763047546148, "num_env_steps_sampled_lifetime": 19000.0, "time_between_sampling": 0.9198949194918722, "episode_return_min": 1529.465095758438, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 83802.0}, "module_episode_returns_mean": {"shared_policy": 896.7302411031723}, "episode_len_min": 108, "weights_seq_no": 97.0, "episode_duration_sec_mean": 0.06740170405842946, "num_module_steps_sampled": {"shared_policy": 8464.0}, "num_episodes_lifetime": 171.00000000000003, "episode_return_max": 2334.9026827812195, "env_to_module_sum_episodes_length_out": 50.056941798000864, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1689.4004487453}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005936871012030206, "agent_to_module_mapping": 0.003454101077851919, "general_advantage_estimation": 0.017453930237150774, "add_time_dim_to_batch_and_zero_pad": 1.053036046411943e-05, "add_columns_from_episodes_to_train_batch": 0.05218649751738641, "add_states_from_episodes_to_batch": 2.9738941875473305e-06, "numpy_to_tensor": 0.0001463417190520299, "batch_individual_items": 0.08187684436584959, "add_observations_from_episodes_to_batch": 0.00041129962881552586}}, "connector_pipeline_timer": 0.16162389559676194}, "learner_connector_sum_episodes_length_in": 1976.258484305689, "num_env_steps_trained": 1364000, "num_module_steps_trained_lifetime": 8587136, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 132544800, "num_module_steps_trained": 87296, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1976.258484305689, "num_env_steps_trained_lifetime_throughput": 1057323.8940088486, "num_module_steps_trained_throughput": 69364.16556286752, "num_module_steps_trained_lifetime_throughput": 69363.90991535377}, "shared_policy": {"gradients_default_optimizer_global_norm": 32.20314407348633, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.705312728881836, "total_loss": 8.675487518310547, "num_module_steps_trained": 87296, "num_trainable_parameters": 149763, "entropy": 0.07672688364982605, "vf_loss_unclipped": 5329.81982421875, "weights_seq_no": 98.0, "curr_kl_coeff": 0.004223513882607222, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.5681443214416504, "policy_loss": -0.029218418523669243, "mean_kl_loss": 0.057022497057914734, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8587136, "num_module_steps_trained_lifetime_throughput": 69363.77180675893}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19000.0, "fault_tolerance": {"num_healthy_workers": 1, "num_remote_worker_restarts": 39}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 98, "trial_id": "a8246_00000", "date": "2025-06-25_21-27-46", "timestamp": 1750912066, "time_this_iter_s": 64.63564610481262, "time_total_s": 2680.7209672927856, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b106020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2680.7209672927856, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 9.163736263736263, "ram_util_percent": 51.98131868131868}}
{"timers": {"training_iteration": 18.592331763800814, "restore_env_runners": 0.002698806971376716, "training_step": 18.589489672363005, "env_runner_sampling_timer": 17.253560894251752, "learner_update_timer": 1.3336903299728604, "synch_weights": 0.0008672892606240152, "synch_env_connectors": 0.061598627336545246}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7812999178422615e-05, "add_time_dim_to_batch_and_zero_pad": 8.708000677870587e-06, "add_observations_from_episodes_to_batch": 4.3062496843049276e-05, "add_states_from_episodes_to_batch": 4.291501682018861e-06, "agent_to_module_mapping": 6.979498721193522e-06, "numpy_to_tensor": 2.7188001695321866e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.733328473748565e-06, "batch_individual_items": 9.219814631899724e-06, "add_time_dim_to_batch_and_zero_pad": 2.591923580992572e-06, "add_observations_from_episodes_to_batch": 1.4917558359837922e-05, "add_states_from_episodes_to_batch": 1.6723968749130888e-06, "agent_to_module_mapping": 2.741937978208658e-06}}, "connector_pipeline_timer": 6.728596851010292e-05}, "env_reset_timer": 0.000173916996573098, "agent_episode_returns_mean": {"vehicle_1": 480.4730135738848, "vehicle_5": 595.9547916800635, "vehicle_3": 152.68742826461792, "vehicle_2": 155.47494073867793, "vehicle_4": 616.8150465277263, "vehicle_0": 149.86938643319266}, "sample": 0.1345563268796859, "rlmodule_inference_timer": 6.74715226619968e-05, "agent_steps": {"vehicle_5": 108.0, "vehicle_3": 40.31714285714286, "vehicle_2": 87.84285714285714, "vehicle_0": 40.31714285714286, "vehicle_4": 108.0, "vehicle_1": 92.15714285714286}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014652057798688164, "connector_pipeline_timer": 0.00027472899819258584, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.922964972825311e-05, "tensor_to_numpy": 1.735027223096758e-05, "module_to_agent_unmapping": 1.639337150166234e-06, "normalize_and_clip_actions": 4.822371077600322e-05, "remove_single_ts_time_rank_from_batch": 6.337828973288054e-07, "un_batch_to_individual_items": 1.549858589920784e-05, "listify_data_for_vector_env": 6.7604999213727385e-06}}, "connector_pipeline_timer": 0.00015978268252932488}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 747.9999999999999, "vehicle_2": 1675.9999999999998, "vehicle_4": 1980.9999999999998, "vehicle_0": 747.9999999999999, "vehicle_1": 1770.0}, "env_to_module_sum_episodes_length_in": 46.11698632129193, "num_agent_steps_sampled_lifetime": {"vehicle_0": 12589.0, "vehicle_2": 27365.0, "vehicle_4": 33690.0, "vehicle_1": 28647.0, "vehicle_5": 33690.0, "vehicle_3": 12589.0}, "episode_return_mean": 2151.2746082099843, "num_env_steps_sampled_lifetime": 34000.0, "time_between_sampling": 0.60916252137206, "episode_return_min": 1588.7957272529602, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 148570.0}, "module_episode_returns_mean": {"shared_policy": 1027.7652990409304}, "episode_len_min": 108, "weights_seq_no": 98.0, "episode_duration_sec_mean": 0.06643754632848349, "num_module_steps_sampled": {"shared_policy": 8904.0}, "num_episodes_lifetime": 310.0, "episode_return_max": 2399.3934668302536, "env_to_module_sum_episodes_length_out": 46.11698632129193, "num_episodes": 18.999999999999996, "num_env_steps_sampled_lifetime_throughput": 1658.415993111058}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005944986461936556, "agent_to_module_mapping": 0.0034582817370625725, "general_advantage_estimation": 0.01747405218476798, "add_time_dim_to_batch_and_zero_pad": 1.0509636883600497e-05, "add_columns_from_episodes_to_train_batch": 0.052276520462234674, "add_states_from_episodes_to_batch": 2.967905208237346e-06, "numpy_to_tensor": 0.00014642039181960272, "batch_individual_items": 0.0815095159221518, "add_observations_from_episodes_to_batch": 0.00041359038253976655}}, "connector_pipeline_timer": 0.16138123205075594}, "learner_connector_sum_episodes_length_in": 1976.4958994626322, "num_env_steps_trained": 1434000, "num_module_steps_trained_lifetime": 8678912, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 133978800, "num_module_steps_trained": 91776, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1976.4958994626322, "num_env_steps_trained_lifetime_throughput": 1058912.444448747, "num_module_steps_trained_throughput": 69381.10469244054, "num_module_steps_trained_lifetime_throughput": 69380.83012049532}, "shared_policy": {"gradients_default_optimizer_global_norm": 36.15447235107422, "default_optimizer_learning_rate": 0.0003, "vf_loss": 8.652798652648926, "total_loss": 8.742534637451172, "num_module_steps_trained": 91776, "num_trainable_parameters": 149763, "entropy": 0.2932271659374237, "vf_loss_unclipped": 4671.84375, "weights_seq_no": 99.0, "curr_kl_coeff": 0.006335270591080189, "curr_entropy_coeff": 0.01, "vf_explained_var": 0.059900641441345215, "policy_loss": 0.09225782006978989, "mean_kl_loss": 0.09706590324640274, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8678912, "num_module_steps_trained_lifetime_throughput": 69380.64656010273}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 34000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 40}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 99, "trial_id": "a8246_00000", "date": "2025-06-25_21-27-48", "timestamp": 1750912068, "time_this_iter_s": 2.1536951065063477, "time_total_s": 2682.874662399292, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b34f880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2682.874662399292, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 22.599999999999998, "ram_util_percent": 52.1}}
{"timers": {"training_iteration": 18.428977009912835, "restore_env_runners": 0.0026718680717113903, "training_step": 18.426161721889308, "env_runner_sampling_timer": 17.088537056149228, "learner_update_timer": 1.335384342503125, "synch_weights": 0.0008667288680174724, "synch_env_connectors": 0.060994048983135464}, "env_runners": {"timers": {"connectors": {"batch_individual_items": 2.7812999178422615e-05, "add_time_dim_to_batch_and_zero_pad": 8.708000677870587e-06, "add_observations_from_episodes_to_batch": 4.3062496843049276e-05, "add_states_from_episodes_to_batch": 4.291501682018861e-06, "agent_to_module_mapping": 6.979498721193522e-06, "numpy_to_tensor": 2.7188001695321866e-05}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.638184626091623e-06, "batch_individual_items": 9.041379799988579e-06, "add_time_dim_to_batch_and_zero_pad": 2.5761801121548853e-06, "add_observations_from_episodes_to_batch": 1.4762221454278987e-05, "add_states_from_episodes_to_batch": 1.7001582169251903e-06, "agent_to_module_mapping": 2.7036479437541416e-06}}, "connector_pipeline_timer": 6.653161177549271e-05}, "env_reset_timer": 0.000173916996573098, "agent_episode_returns_mean": {"vehicle_1": 463.81471576929084, "vehicle_5": 594.8179244422912, "vehicle_3": 151.60857679605485, "vehicle_2": 110.28928610563278, "vehicle_4": 618.4130604171753, "vehicle_0": 145.5076889562607}, "sample": 0.13439676748753, "rlmodule_inference_timer": 7.756740980223458e-05, "agent_steps": {"vehicle_5": 107.93999999999997, "vehicle_3": 40.5, "vehicle_2": 85.52000000000002, "vehicle_0": 40.5, "vehicle_4": 108.0, "vehicle_1": 89.3}, "num_env_steps_sampled": 2000.0, "episode_len_mean": 108.0, "env_step_timer": 0.00014902240830347188, "connector_pipeline_timer": 0.00027472899819258584, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6841240531981196e-05, "tensor_to_numpy": 1.6600358781458553e-05, "module_to_agent_unmapping": 1.6276101184171554e-06, "normalize_and_clip_actions": 4.601579035975506e-05, "remove_single_ts_time_rank_from_batch": 6.348155238105245e-07, "un_batch_to_individual_items": 1.4828811639106917e-05, "listify_data_for_vector_env": 6.512370970814696e-06}}, "connector_pipeline_timer": 0.00015342747979002052}, "num_agent_steps_sampled": {"vehicle_5": 1980.9999999999998, "vehicle_3": 750.0, "vehicle_2": 1569.0000000000002, "vehicle_4": 1982.0, "vehicle_0": 750.0, "vehicle_1": 1637.0}, "env_to_module_sum_episodes_length_in": 50.3056810150377, "num_agent_steps_sampled_lifetime": {"vehicle_0": 13339.0, "vehicle_2": 28934.0, "vehicle_4": 35672.0, "vehicle_1": 30283.999999999993, "vehicle_5": 35671.0, "vehicle_3": 13339.0}, "episode_return_mean": 2084.451254527569, "num_env_steps_sampled_lifetime": 36000.0, "time_between_sampling": 0.5368310040413675, "episode_return_min": 1450.576678276062, "episode_len_max": 108, "num_module_steps_sampled_lifetime": {"shared_policy": 157239.0}, "module_episode_returns_mean": {"shared_policy": 1004.7454643321036}, "episode_len_min": 108, "weights_seq_no": 99.0, "episode_duration_sec_mean": 0.0682667576202948, "num_module_steps_sampled": {"shared_policy": 8669.0}, "num_episodes_lifetime": 328.00000000000006, "episode_return_max": 2399.3934668302536, "env_to_module_sum_episodes_length_out": 50.3056810150377, "num_episodes": 18.0, "num_env_steps_sampled_lifetime_throughput": 1672.6704378778263}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.005960193267357176, "agent_to_module_mapping": 0.003460513919749633, "general_advantage_estimation": 0.017464509162948016, "add_time_dim_to_batch_and_zero_pad": 1.0489540507160243e-05, "add_columns_from_episodes_to_train_batch": 0.052344019427635474, "add_states_from_episodes_to_batch": 2.959896140717295e-06, "numpy_to_tensor": 0.000145996187889686, "batch_individual_items": 0.08193202618295885, "add_observations_from_episodes_to_batch": 0.00041438655876064267}}, "connector_pipeline_timer": 0.1618793526402231}, "learner_connector_sum_episodes_length_in": 1976.7309404680059, "num_env_steps_trained": 1396000, "num_module_steps_trained_lifetime": 8768256, "num_trainable_parameters": 149763, "num_env_steps_trained_lifetime": 135374800, "num_module_steps_trained": 89344, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 1976.7309404680059, "num_env_steps_trained_lifetime_throughput": 1061160.2043917296, "num_module_steps_trained_throughput": 69444.50835163832, "num_module_steps_trained_lifetime_throughput": 69444.15971096112}, "shared_policy": {"gradients_default_optimizer_global_norm": 24.64419937133789, "default_optimizer_learning_rate": 0.0003, "vf_loss": 9.499809265136719, "total_loss": 9.470897674560547, "num_module_steps_trained": 89344, "num_trainable_parameters": 149763, "entropy": 0.09370939433574677, "vf_loss_unclipped": 6009.9423828125, "weights_seq_no": 100.0, "curr_kl_coeff": 0.00950290635228157, "curr_entropy_coeff": 0.01, "vf_explained_var": -0.27020180225372314, "policy_loss": -0.02840784564614296, "mean_kl_loss": 0.06846094876527786, "module_train_batch_size_mean": 128.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 8768256, "num_module_steps_trained_lifetime_throughput": 69444.11008394243}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36000.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 40}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 100, "trial_id": "a8246_00000", "date": "2025-06-25_21-27-50", "timestamp": 1750912070, "time_this_iter_s": 2.2592661380767822, "time_total_s": 2685.133928537369, "pid": 33060, "hostname": "MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class '__main__.SixGTrafficEnv'>", "env_config": {"num_vehicles": 6, "max_episode_steps": 800, "dt": 0.1, "latency": 0.001, "comm_range": 500.0}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 2000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_rllib_config.<locals>.policy_mapping_fn at 0x14b34fba0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, {}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2685.133928537369, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 21.249999999999996, "ram_util_percent": 52.52499999999999}}
